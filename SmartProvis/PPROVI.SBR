SBP
 ÿƒmain()
 

 
 '      **************************
 '      ** Provisionsberechnung **
 '      **************************
 
 '******************************************************************************************************************
 ' Provisionsberechnung STANDARD
 ' =======================================================================
 ' 27.04.93  - Anpassung an Netzwerk
 ' 07.07.93  - tempor„re Ver„nderungen fr TRANSER eingearbeitet
 ' 19.09.94  - Abbruch der Berechnung bei ProviAb>cdate%
 ' 23.06.99  - codevtab% =0 alle Vertr„ge berechnen, >0 =lfdnr.kvertrag, fr den berechnet werden soll
 
ÿÿPROVBUCHUNG(codevtab%)
 ÿ½ letzteProvisionsrechnung
 ÿ½  CALL Fehler(CalcDate$,"")
 ÿ¡disabled%("BUCHUNG6")ÿpÿ’ÿÿ
 ÿ½ lastProvi$ = ReadConfig$("PROVIS","letzteProvisionsrechnung")
 ÿ½ IF DateOK%(lastProvi$) THEN 
ÿ½ _day% = DAY (lastProvi$)
ÿ½ _month% = MONTH (lastProvi$)
ÿ½ _year% = YEAR (lastProvi$)
ÿ½ _month% = _month% + 1
ÿ½ IF _month% > 12 THEN 
ÿ½ _year% = _year% + 1
ÿ½ _month% = _month% - 12
ÿ½ END IF 
ÿ½ CalcDate$ = STR$ (_day%,"00") + "." + STR$ (_month%,"00") + "." + STR$ (_year%,"0000")
 ÿ½ ELSE 
ÿ½ CalcDate$ = DATE$ ( TODAY ,"0d.mm.yyyy")
 ÿ½ END IF 
 ÿƒDFile(3,"buchung"ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"maadrgru"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(3,"vkond"ÿ_fpw$)
 ÿƒDFile(3,"vprodukt"ÿ_fpw$)
 ÿƒDFile(3,"spezkond"ÿ_fpw$)
 ÿƒDFile(3,"AUmskto"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\"ÿGADRDat$ÿ_fpw$)
 ÿ¡anschluss%ÿ0ÿPRVCHECKLISTE$ÿ"TRUE"ÿp
CalcDate$ÿÿ(ÿQ,"0d.mm.yyyy")
ÿ‰ÿñ"STICHTAG",0,0,222,114,"Buchungsdatum","MS Sans Serif",8
ÿ|ÿñ"STICHTAG",4,0,0,222,91,0,""
ÿ|ÿñ"STICHTAG",9,6,9,23,24,2
ÿ|ÿñ"STICHTAG",5,31,15,183,10,0,"Bitte geben Sie an, zu welchem Buchungsdatum"
ÿ|ÿñ"STICHTAG",5,31,25,183,10,0,"die Provisionsberechnung durchgefhrt werden soll:"
ÿ|ÿñ"STICHTAG",5,32,40,182,10,0,"(ohne nderung des Datums oder Weglassen"
ÿ|ÿñ"STICHTAG",5,31,50,182,20,0,"der Datumsangabe, wird das angezeigte Datum verwendet)"
ÿ|ÿñ"STICHTAG",6,94,72,42,12,0,0,CalcDate$,10
ÿ|ÿñ"STICHTAG",5,30,74,58,10,0,"Buchungsdatum:"
ÿ|ÿñ"STICHTAG",1,52,94,54,14,1,"&OK",1,1
ÿ|ÿñ"STICHTAG",1,109,94,54,14,0,"&Abbrechen",0,0
ÿñ"STICHTAG",req%
ÿ¾ÿñ"STICHTAG"
ÿ¡req%ÿ1ÿp
ÿ¡DateOK%(CalcDate$)ÿp
ok%ÿ1
ÿ¡codevtab%ÿ0ÿpÿƒWriteConfig("PROVIS","letzteProvisionsrechnung",CalcDate$)
ÿ^
ok%ÿ0
ÿƒFehler("Falsche Datumsangabe!","Bitte geben Sie das Datum in der Form 'tt.mm.jjjj' ein.")
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ^
ok%ÿ1
 ÿ’ÿ¡
 ÿ¡ok%ÿ1ÿp
cdate%ÿÿ1(CalcDate$)
minimize$ÿReadINI$("PROVIS","minimize")
ÿ¡anschluss%ÿ0ÿp
ÿ¡minimize$ÿ"TRUE"ÿp
ÿÂ"PROVIS wird in den Hintergrund geschaltet!","Sie k”nnen w„hrend der Berechung andere Programme starten.",0
ÿÊÿÿÚ
ÿ’ÿ¡
ÿƒCreateLog()
ÿ’ÿ¡
 
ÿƒWriteLog("")
ÿƒWriteLog("=================================")
ÿƒWriteLog("Provisionsabrechnung vom "ÿÿ(cdate%,"0d.mm.yyyy"))
ÿƒWriteLog("=================================")
ÿƒWriteLog("")
ÿßÿe
ÿ™"kvertrag"
ÿ£ProviAb.kvertrag
ÿÉÿ`
ÿ¡codevtab%ÿ0ÿp
ÿ£lfdnr.kvertrag
ÿÉÿ¥codevtab%ÿáÿ™"Kvertrag"ÿ£lfdnr.kvertrag
ÿ^
ÿÉÿ¥"01.01.0001"ÿáÿ™"Kvertrag"ÿ£proviab.kvertrag
ÿ’ÿ¡
_p1%ÿÿA("kvertrag")
_pd$ÿ"0"
_pd%ÿÿ1
_p2%ÿ0
ÿ¡codevtab%ÿ0ÿpÿØÿOÿB("kvertrag")ÿ(ProviAb.KVERTRAGÿ	cdate%ÿBewertEinmDat.kvertragÿ	cdate%)
ÿ¡codevtab%ÿ0ÿpÿØÿOÿB("kvertrag")ÿ(ProviAb.KVERTRAGÿ	cdate%ÿBewertEinmDat.kvertragÿ	cdate%)ÿlfdnr.kvertragÿcodevtab%

 
ÿ½ Prfen auf Vorhandensein von Spezialprovisionen und ob dort welche existieren, die zun„chst von der
ÿ½ Bewertung der Firma abgezogen werden, um den Restbetrag als 100% darzustellen
GVonFirma$ÿ"n"
ÿ²",999999999.0000"
ÿ¡ÿJ(lfdnr.kvertrag,codevt.spezkond)ÿSpezProvAktiv.kvertragÿ"j"ÿok%ÿ1ÿt$ÿ"ANDREAS"ÿp
anzagvF%ÿ0
anzagvA%ÿ0

ÿØGAGvonFirma$(anzagvF%)ÿ""
	GAGvonFirma$(anzagvF%)ÿ""
	anzagvF%ÿanzagvF%ÿ1
ÿÙ
ÿØGAGvonAgentur$(anzagvA%)ÿ""
	GAGvonAgentur$(anzagvA%)ÿ""
	anzagvA%ÿanzagvA%ÿ1
ÿÙ
anzagvF%ÿ0
anzagvA%ÿ0
GSpezko$ÿ"j"
GVonFirma$ÿ"n"
ÿÉÿ`ÿ™"spezkond"ÿ£codevt.spezkond
ÿÉÿ¥lfdnr.kvertragÿáÿ™"spezkond"ÿ£codevt.spezkond
ÿØÿOÿB("spezkond")ÿcodevt.spezkondÿlfdnr.kvertrag
	ÿ¡vonFirmaAgentur.spezkondÿ"j"ÿp
GVonFirma$ÿ"j"
ÿ¡einmalig.spezkondÿ"j"ÿp
GAGvonFirma$(anzagvF%)ÿQCodeVTMA.spezkond
anzagvF%ÿanzagvF%ÿ1
ÿ^
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
GAGvonFirma$(anzagvF%)ÿQCodeVTMA.spezkond
anzagvF%ÿanzagvF%ÿ1
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ^
GVonFirma$ÿ"n"
ÿ¡einmalig.spezkondÿ"j"ÿp
GAGvonAgentur$(anzagvA%)ÿQCodeVTMA.spezkond
anzagvA%ÿanzagvA%ÿ1
ÿ^
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
GAGvonAgentur$(anzagvA%)ÿQCodeVTMA.spezkond
anzagvA%ÿanzagvA%ÿ1
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿÉÿ±ÿ™"spezkond"ÿ£codevt.spezkond
ÿÙ
ÿ^
GSpezko$ÿ"n"
ÿ’ÿ¡
ÿ½ GAGvonFirma$(anzagvF%) = ""
ÿ½ GAGvonAgentur$(anzagvA%) = ""
ÿ½ CALL Fehler("","")
 

ÿ½ -----------------------------------------
ÿ½ -- Prozentbalken und Header aktualisieren
ÿ½ -----------------------------------------
 
ÿÊÿË"Bearbeite Vertrag "ÿÿH(ÿ(_p2%,"999999"))ÿ" von "ÿÿH(ÿ(_p1%,"999999"))ÿ"  "ÿvs_NR.kvertrag
_pc%ÿÿ (100ÿ_p1%ÿ_p2%,0)
ÿ¡_pd%ÿ_pc%ÿp
_pd%ÿ_pc%
ÿ¡ÿåsys(11)ÿ36ÿÿåsys(12)ÿ36ÿp
	ÿ¡anschluss%ÿ0ÿp
ÿÊÿŸÿ(_pd%,"999")ÿ"%"
	ÿ^
ÿÊÿŸÿ(_pd%,"999")ÿ"% "ÿÿH(ÿ(ÿ5(cdate%),"00"))ÿ"/"ÿÿ-(ÿ(ÿ6(cdate%),"9999"),4)
	ÿ’ÿ¡
ÿ^
	ÿ¡anschluss%ÿ0ÿp
ÿÊÿŸtitle$ÿ" - Provisionsberechung: "ÿÿ(_pd%,"999")ÿ"% erledigt"
	ÿ^
ÿÊÿŸtitle$ÿ" - Provisionsberechung: "ÿÿ(_pd%,"999")ÿ"% "ÿÿH(ÿ(ÿ5(cdate%),"00"))ÿ"/"ÿÿ-(ÿ(ÿ6(cdate%),"9999"),4)
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ½ --------------------------------------
ÿ½ -- CheckUp fr Vertragsprovisionierung
ÿ½ --------------------------------------
ÿ¡vs_nr.kvertragÿ"70/217746"ÿp
ÿ½ CALL Fehler(vs_nr.kvertrag,"1")
ÿ’ÿ¡
ok%ÿ1
ÿ½ 030697
ÿ¡codeko.kvertragÿ
1ÿp
ok%ÿ0
ÿ^
ÿ½ CALL Fehler(Test",date$(cdate%,"0d.mm.yyyy")
ÿ½ 190298
ÿ¡ÿ1(Kndigung.KVERTRAG)ÿ1ÿÿ1(Kndigung.KVERTRAG)ÿ
cdate%ÿp
	ok%ÿ0
	ÿ½ 210597
	ÿ¡TatsKuenDat.kvertragÿKndigung.KVERTRAGÿpok%ÿ1
	ÿ¡TatsKuenDat.kvertragÿ
cdate%ÿpok%ÿ0
	ÿ¡_debug%ÿ1ÿpÿƒWriteLog("## Kndigung: "ÿÿ(lfdnr.KVERTRAG,"000000")ÿ", "ÿÿ(Kndigung.KVERTRAG,"0d.mm.yyyy"))
ÿ’ÿ¡
ÿ¡Storno.KVERTRAGÿ0ÿÿ1(Kndigung.KVERTRAG)ÿ
cdate%ÿp
	ok%ÿ0
	ÿ½ 190398
	ÿ¡TatsKuenDat.kvertragÿKndigung.KVERTRAGÿpok%ÿ1
	ÿ¡TatsKuenDat.kvertragÿ
cdate%ÿpok%ÿ0
ÿ’ÿ¡

ÿ¡ÿ1(ProviAb.KVERTRAG)ÿ
1ÿp
	ok%ÿ0
ÿ’ÿ¡
ÿ¡ÿ1(VS_Beginn.KVERTRAG)ÿ
1ÿp
	ok%ÿ0
ÿ’ÿ¡
ÿ¡ÿ1(ProviAb.KVERTRAG)ÿcdate%ÿp
	ÿ¡BewertEinmDat.kvertragÿ
1ÿp
ok%ÿ0
	ÿ^
ÿ¡BewertEinmDat.kvertragÿcdate%ÿp
ok%ÿ0
ÿ^
ÿ¡BewertCalcDat.kvertragÿ0ÿp
ok%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡cdate%ÿÿ1(letzteProvi.KVERTRAG)ÿ
27ÿp
	ok%ÿ0
	ÿ¡_debug%ÿ1ÿpÿƒWriteLog("## Zeitsperre: "ÿÿ(letzteProvi.KVERTRAG,"0d.mm.yyyy"))
ÿ’ÿ¡
ÿ¡CodeMA.KVERTRAGÿ
1ÿp
	ÿƒWriteLog("!dem Vertrag wurde keine Agentur zugeordnet")
	ÿƒAddLogInfo()
	ok%ÿ0
ÿ’ÿ¡
ÿ¡CodeGE.KVERTRAGÿ
1ÿp
	ÿƒWriteLog("!dem Vertrag wurde keine Gesellschaft zugeordnet")
	ÿƒAddLogInfo()
	ok%ÿ0
ÿ’ÿ¡
ÿ¡CodeVA.KVERTRAGÿ
1ÿp
	ÿƒWriteLog("!dem Vertrag wurde keine Sparte zugeordnet")
	ÿƒAddLogInfo()
	ok%ÿ0
ÿ’ÿ¡
ÿ¡CodeKO.KVERTRAGÿ0ÿÿ1(ProviAb.KVERTRAG)ÿcdate%ÿp
	ÿƒWriteLog("!der erwartete Eintrag in VKOND konnte nicht gefunden werden")
	ÿƒAddLogInfo()
	ok%ÿ0
ÿ’ÿ¡
ÿ¡ProvSperreJN.kvertragÿ"j"ÿp
	ok%ÿ0
	ÿƒWriteLog("  Vertrag hat Provisionssperre: "ÿVS_NR.Kvertragÿ"/"ÿGesellschaft.kvertragÿ"/"ÿsparte.kvertragÿ"/"ÿAgentur.kvertragÿ"/"ÿVNehmer.kvertrag)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ ------------------------
ÿ½ -- Aufruf der Berechnung
ÿ½ ------------------------
 
ÿ¡ok%ÿ1ÿp
ÿ½ CALL Fehler("Provision soll berechnet werden", DATE$ (cdate%,"0d.mm.yyyy"))
ÿ½ CALL Fehler("Berechnung bis", DATE$ (cdate%,"0d.mm.yyyy"))
ÿ½ IF vs_nr.kvertrag LIKE "036-800888*" THEN 
	ÿ½ CALL Fehler(vs_nr.kvertrag,"2")
ÿ½ END IF 
gezPflege%ÿ0
gezPauschale%ÿ0
gezAbschluá%ÿ0
gezStornoRes%ÿ0
GBewEinm%ÿ0
ÿƒPROVISION2()
ÿ’ÿ¡
ÿ¡codevtab%ÿ0ÿpÿÉÿ±ÿ™"KVERTRAG"ÿ£ProviAb.kvertrag
ÿ¡codevtab%ÿ0ÿpÿÉÿ±ÿ™"KVERTRAG"ÿ£lfdnr.kvertrag
_p2%ÿ_p2%ÿ1
ÿÙ
ÿ¡ReadConfig$("PROVIS","SkipStorno")ÿ"TRUE"ÿp
ÿ½ 
ÿ^
ÿƒSRZahlung(codevtab%)
ÿ’ÿ¡
ÿ¡anschluss%ÿ0ÿp
ÿßÿ³
ÿÊÿÿx
ÿÊÿŸtitle$ÿ" - Buchung"
ÿÊÿË"Provisionsabrechnung beendet"
ÿ¡PRVCHECKLISTE$ÿ"TRUE"ÿpÿƒCloseLog()
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ’ÿÿ
 
 
 ' Provisionsberechnung
 ' einzelnen Vertrag berechnen
 ' =======================================================================
 ' 29.04.93  - Prfung auf einmalige Abschluáprovi und Pauschale
 ' 27.10.93  - nderung der Differenzrechnung
 ' 24.06.94  - Protokollierung von Fehlern in Log-Datei
 ' 28.06.94 - Laufzeit%-Berechnung ge„ndert
 ' 08.07.94 - wahlweiser Bezug BW-Zeitraum auf VSBeginn oder ProvBeginn
 ' 14.07.94 - LaufzeitPro% enth„lt Laufzeit seit Provisionsbeginn
 ' 22.09.94 - Umstellung auf Verwendung von VKOND
 '             - erweitertes CheckUp
 ' 13.10.94 - Streichung der SR-Berechnung bei Pflegeprovision
 ' 08.08.97 - Provision an Hand von Zahlungseing„ngen
 
ÿÿPROVISION2()
 cfile$ÿÿ™
 ok%ÿ1
 ÿ½ **DEBUG ProviAb-Check
 cuvt%ÿlfdnr.KVERTRAG
 codema%ÿCodeMA.kvertrag
 codege%ÿCodeGE.kvertrag
 codeva%ÿCodeVA.kvertrag
 koab%ÿCodeKO.KVERTRAG
 bewertung%ÿBewertungssumme.KVERTRAG
 beitrag%ÿBeitrag.kvertrag
 ÿÉÿ`ÿ™"maadr"ÿ£codema.maadr
 ÿÉÿ¥codema.kvertragÿ™"maadr"ÿ£codema.maadr
 Gvtagentur$ÿNachname.maadrÿ","ÿvorname.maadr
 Gvtcodema%ÿcodema.maadr

 GStorWarnJN$ÿStorWarnJN.kvertrag
 ÿ¡StorWarnDatGes.kvertragÿ0ÿp
GStorWarnDGes$ÿÿ(StorWarnDatGes.kvertrag,"0d.mm.yyyy")
 ÿ^
GStorWarnDGes$ÿ""
 ÿ’ÿ¡
 ÿ¡StorWarnDatMA.kvertragÿp
GStorWarnDMA$ÿÿ(StorWarnDatMA.kvertrag,"0d.mm.yyyy")
 ÿ^
GStorWarnDMA$ÿ""
 ÿ’ÿ¡
 GStorWarnGrund$ÿStorWarnGrund.kvertrag
 GStorWarnMasn$ÿStorWarnMasn.kvertrag
 GStorWarnErg$ÿStorWarnErg.kvertrag


 ÿ¡ProviAb.KVERTRAGÿcdate%ÿp
ÿƒWriteLog("## Aufruf PROVISION2 mit ProviAb > cdate%")
ÿ½ REQUEST "ProviAb > cdate%"
 ÿ’ÿ¡
 bwbezug$ÿReadConfig$("PROVIS","Bewertungszeitraum")
 ÿ¡bwbezug$ÿ"leer"ÿbwbezug$ÿ"Provisionierungsbeginn"ÿp
BWStart%ÿÿ1(ProviAb.KVERTRAG)
 ÿ^
BWStart%ÿÿ1(VS_Beginn.KVERTRAG)
 ÿ’ÿ¡
 Laufzeit%ÿÿ ((cdate%ÿBWStart%)ÿ30,0)
 LaufzeitPro%ÿÿ ((cdate%ÿÿ1(ProviAb.KVERTRAG))ÿ30,0)
 
 ÿ½ **DEBUG Laufzeit in LOG schreiben
 ÿ¡_debug%ÿ1ÿpÿƒWriteLog("## Laufzeit: "ÿÿ(lfdnr.KVERTRAG,"000000")ÿ" - "ÿÿ(Laufzeit%,"9999")ÿ" Monate")




 
 ÿ½ *** 201100 Einbeziehung der ProzenteVerteilung von VPRODUKT ***
 codevp%ÿCodeVP.Kvertrag
 ÿÉÿ`ÿ™"Vprodukt"ÿ£codevp.vprodukt
 ÿÉÿ¥codevp%ÿ™"Vprodukt"ÿ£codevp.vprodukt
 ÿ¡codevp%ÿCodeVP.KvertragÿProzVerteilung.vproduktÿ0ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
haftvertrag%ÿSRHaftung.kvertrag
weitermachen%ÿ1
ÿÉÿ`ÿ™"VKOND"ÿ£CodeVK.VKOND
ÿÉÿ¥koab%ÿ™"VKOND"ÿ£CodeVK.VKOND
ÿØÿOÿB("vkond")ÿweitermachen%ÿ1
ÿ¡n„chsteKond.VKONDÿ0ÿp
weitermachen%ÿ0
ÿ^
ÿÉÿ¥n„chsteKond.VKONDÿ™"VKOND"ÿ£CodeVK.VKOND
ÿ’ÿ¡
ÿÙ
ÿÉÿ¥CodeKO.VKONDÿ™"GEKOND"ÿ£lfdnr.GEKOND
ÿ½ jetzt wurde die Kondition der Firma(1.Agentur) gefunden 
Vbewertung%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿProzVerteilung.vprodukt)
Vbeitrag%ÿ((Beitrag.kvertragÿ100)ÿProzVerteilung.vprodukt)
Vrest%ÿBewertungssumme.KVERTRAGÿVbewertung%
 
butext$ÿBuchungstext.zeingan1ÿ" Prov. aus NV"
VProvisNZ%ÿprovnz%
provnz%ÿ0
ÿ½ CALL SpezProvisF(butext$,codema.gekond,provnz%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1)
 ÿ^
Vbewertung%ÿBewertungssumme.KVERTRAG
VBeitrag%ÿBeitrag.kvertrag
 ÿ’ÿ¡
 ÿ½ ******************************************************************* 
 
 ÿÉÿ`ÿ™"VKOND"ÿ£CodeVK.VKOND
 ÿÉÿ¥koab%ÿáÿ™"VKOND"ÿ£CodeVK.VKOND
 
 ÿ¡ÿOÿJ(koab%,codevk.VKOND)ÿp
ÿƒWriteLog("  Vertrag wurde noch nicht an die Provisionsabrechnung bergeben")
ÿƒAddLogInfo()
ok%ÿ0
 ÿ^
ÿ½ positionieren auf die Kondition der vertragsabschlieáenden Agentur,bei der ist dann der Vorg„nger als
ÿ½ n„chsteKond.VKOND eingetragen
ÿÉÿ`ÿ™"VKOND"ÿ£CodeVK.VKOND
ÿÉÿ¥koab%ÿáÿ™"VKOND"ÿ£CodeVK.VKOND
 ÿ’ÿ¡
 
 ÿ½ es ist Spezialprovision von der Firma zu zahlen und nachdem diese von der Bewertung abgezogen wurde
 ÿ½ darf der Restbetrag als 100% angesehen werden, von dem dann die restliche Provision berechnet wird
 GBewertung%ÿVbewertung%
 GBeitrag%ÿVBeitrag%
 ÿ¡GSpezko$ÿ"j"ÿGVonFirma$ÿ"j"ÿp
ÿ½ CALL Fehler("Test auf Spezialkonditionen","")
ÿ½ positionieren auf die Kondition der Firma
weitermachen%ÿ1
ÿÉÿ`ÿ™"VKOND"ÿ£CodeVK.VKOND
ÿÉÿ¥koab%ÿ™"VKOND"ÿ£CodeVK.VKOND
ÿØÿOÿB("vkond")ÿweitermachen%ÿ1
ÿ¡n„chsteKond.VKONDÿ0ÿp
weitermachen%ÿ0
ÿ^
ÿÉÿ¥n„chsteKond.VKONDÿ™"VKOND"ÿ£CodeVK.VKOND
ÿ’ÿ¡
ÿÙ
ÿÉÿ¥CodeKO.VKONDÿ™"GEKOND"ÿ£lfdnr.GEKOND
ÿ½ jetzt wurde die Kondition der Firma(1.Agentur) gefunden, jetzt msenn die Prozente/Pauschalen vonFirma addiert
ÿ½ werden, um diese Betr„ge von der Bewertung abzuziehen, danach Erzeugung der Buchungss„tze
anzagvF%ÿ0
SpezProzent%ÿ0
SpezPausch%ÿ0
ÿØGAGvonFirma$(anzagvF%)ÿ""
ÿÉÿ`ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
ÿ¡GAGvonFirma$(anzagvF%)ÿ""ÿp
QCodeVTMA$ÿÿ-(GAGvonFirma$(anzagvF%),12)
ÿÉÿ¥QCodeVTMA$ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
ÿ¡Prozente.spezkondÿ0ÿp
	ÿ¡APjn.gekondÿ"j"ÿvonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿeinmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡gez_Abschluá.kvertragÿ"j"ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ¡CourtageJN.gekondÿ"j"ÿvonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿeinmaligerfolgt.spezkondÿ"j"ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
	ÿ’ÿ¡
	ÿ¡PflegeJN.gekondÿ"j"ÿvonCourtage.spezkondÿ"j"ÿvonAp.spezkondÿ"j"ÿeinmaligerfolgt.spezkondÿ"j"ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
	ÿ’ÿ¡
ÿ^
	ÿ¡pauschale.spezkondÿ0ÿp
ÿ¡APjn.gekondÿ"j"ÿvonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿeinmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡gez_Abschluá.kvertragÿ"j"ÿp
SpezPausch%ÿSpezPausch%ÿPauschale.spezkond
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡CourtageJN.gekondÿ"j"ÿvonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿeinmaligerfolgt.spezkondÿ"j"ÿp
SpezPausch%ÿSpezPausch%ÿPauschale.spezkond
ÿ’ÿ¡
ÿ¡PflegeJN.gekondÿ"j"ÿvonCourtage.spezkondÿ"j"ÿvonAp.spezkondÿ"j"ÿeinmaligerfolgt.spezkondÿ"j"ÿp
SpezPausch%ÿSpezPausch%ÿPauschale.spezkond
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
anzagvF%ÿanzagvF%ÿ1
ÿ’ÿ¡
ÿÙ
ÿ½ bei Abschluáprovision
ÿ¡APjn.gekondÿ"j"ÿp
ÿ¡gez_Abschluá.kvertragÿ"j"ÿp
GBewertung%ÿ((Vbewertung%ÿ100)ÿAP.gekond)ÿ((Vbewertung%ÿ100)ÿSpezProzent%)ÿSpezPausch%
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ bei Courtage
ÿ¡CourtageJN.gekondÿ"j"ÿp
GBewertung%ÿ((Vbewertung%ÿ100)ÿCourtage.gekond)ÿ((Vbewertung%ÿ100)ÿSpezProzent%)ÿSpezPausch%
ÿ’ÿ¡
ÿ½ bei Pflege
ÿ¡PflegeJN.gekondÿ"j"ÿp
GBewertung%ÿ(((Vbewertung%)ÿ100)ÿPflegeProvi.gekond)ÿ((Vbewertung%ÿ100)ÿSpezProzent%)ÿSpezPausch%
ÿ’ÿ¡
 
ÿ½ jetzt mssen die Buchungss„tze fr die Mitarbeiter angelegt werden
anzagvF%ÿ0
ÿÉÿ`ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
sr%ÿ0
Haftung%ÿ0
provsp%ÿ0
provsp1%ÿ0
ÿ½ CALL Fehler("Spezi","")
ÿØGAGvonFirma$(anzagvF%)ÿ""
QCodeVTMA$ÿÿ-(GAGvonFirma$(anzagvF%),12)
ÿÉÿ`ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
ÿÉÿ¥QCodeVTMA$ÿáÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
ÿ¡Prozente.spezkondÿ0ÿp
ÿ¡APjn.gekondÿ"j"ÿvonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿeinmaligerfolgt.spezkondÿ"j"ÿp
	ÿ¡gez_Abschluá.kvertragÿ"j"ÿp
butext$ÿVS_nr.kvertragÿ" AP Spez.Prov."
provsp1%ÿ((Vbewertung%ÿ100)ÿAP.gekond)
provsp%ÿ((provsp1%ÿ100)ÿProzente.spezkond)
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ bei Courtage
ÿ¡CourtageJN.gekondÿ"j"ÿvonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿeinmaligerfolgt.spezkondÿ"j"ÿp
	butext$ÿVS_nr.kvertragÿ" Court.Spez.Prov."
	provsp1%ÿ((Vbewertung%ÿ100)ÿCourtage.gekond)
	provsp%ÿ((provsp1%ÿ100)ÿProzente.spezkond)
ÿ’ÿ¡
ÿ½ bei Pflege
ÿ¡PflegeJN.gekondÿ"j"ÿvonCourtage.spezkondÿ"j"ÿvonAp.spezkondÿ"j"ÿeinmaligerfolgt.spezkondÿ"j"ÿp
	ÿƒSpezPflege(Laufzeit%,GBeitrag%,provsp%)
	butext$ÿVS_nr.kvertragÿ" Pflege Spez.Prov."
	ÿ½ provsp1% = (((Vbewertung%) / 100) * PflegeProvi.gekond)
	ÿ½ provsp% = ((provsp1% / 100) * Prozente.spezkond)
ÿ’ÿ¡
ÿ^
ÿ¡APjn.gekondÿ"j"ÿvonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿeinmaligerfolgt.spezkondÿ"j"ÿp
	ÿ¡gez_Abschluá.kvertragÿ"j"ÿp
butext$ÿVS_nr.kvertragÿ" AP Spez.Prov."
provsp1%ÿ((Vbewertung%ÿ100)ÿAP.gekond)
provsp%ÿPauschale.spezkond
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ bei Courtage
ÿ¡CourtageJN.gekondÿ"j"ÿvonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿeinmaligerfolgt.spezkondÿ"j"ÿp
	butext$ÿVS_nr.kvertragÿ" Court.Spez.Prov."
	provsp1%ÿ((Vbewertung%ÿ100)ÿCourtage.gekond)
	provsp%ÿPauschale.spezkond
ÿ’ÿ¡
ÿ½ bei Pflege
ÿ¡PflegeJN.gekondÿ"j"ÿvonCourtage.spezkondÿ"j"ÿvonAp.spezkondÿ"j"ÿeinmaligerfolgt.spezkondÿ"j"ÿp
	ÿƒSpezPflege(Laufzeit%,GBeitrag%,provsp%)
	butext$ÿVS_nr.kvertragÿ" Pflege Spez.Prov."
	ÿ½ provsp1% = (((Vbewertung%) / 100) * PflegeProvi.gekond)
	ÿ½ provsp% = Pauschale.spezkond
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡einmalig.spezkondÿ"j"ÿp
einmaligerfolgt.spezkondÿ"j"
EinmDatum.spezkondÿcdate%
ÿÌÿ™"Spezkond"
ÿïÿYÿ™"spezkond"
ÿïÿ™"spezkond"
ÿ’ÿ¡
ÿ½ butext$ = Buchungstext.zeingan1 + " Spez.Prov."
ÿƒSpezProvisN(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,cdate%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag)
anzagvF%ÿanzagvF%ÿ1
ÿÙ
ÿ½ positionieren auf die ursprngliche Kondition
ÿÉÿ`ÿ™"VKOND"ÿ£CodeVK.VKOND
ÿÉÿ¥koab%ÿáÿ™"VKOND"ÿ£CodeVK.VKOND
 ÿ’ÿ¡
 
 
 
 
 
 
 

 cuvt%ÿlfdnr.KVERTRAG
 codema%ÿCodeMA.kvertrag
 codege%ÿCodeGE.kvertrag
 codeva%ÿCodeVA.kvertrag
 koab%ÿCodeKO.KVERTRAG
 
 ÿ¡ÿOÿJ(koab%,codevk.VKOND)ÿp
ÿƒWriteLog("  kein Eintrag in Datei VKOND-gefunden!")
ÿƒAddLogInfo()
ok%ÿ0
 ÿ^
ÿÉÿ¥koab%ÿáÿ™"VKOND"ÿ£CodeVK.VKOND
 ÿ’ÿ¡
 vertrprov%ÿ0
 vsumAP%ÿ0
 vsumC%ÿ0
 vsumPP%ÿ0
 vsumPausch%ÿ0
 vertrsr%ÿ0
 ÿØok%ÿ1
ÿÉÿ¥CodeKO.VKONDÿ™"GEKOND"ÿ£lfdnr.GEKOND
ÿ¡ÿOÿC("GEKOND")ÿp
ÿƒWriteLog("  die angegebene Kondition ist nicht enthalten!")
ÿƒWriteLog("  SUPPORT: die in VKOND angegebene Kondition fehlt in GEKOND!")
ÿƒAddLogInfo()
ok%ÿ0
ÿ’ÿ¡
ÿ¡ok%ÿ1ÿp
vtagentur$ÿGvtagentur$
vtcodema%ÿGVTCodema%
codema%ÿCodeMA.GEKOND
haftvertrag%ÿSRHaftung.kvertrag
ÿ½ 150697
dmeinh%ÿdmeinheit.gekond
ÿ½ --------------------
ÿ½ -- Abschluáprovision
ÿ½ --------------------

ÿ¡APjn.gekondÿ"j"ÿp
ÿ½ CALL Fehler("APjn=j","")
ÿ¡gez_Abschluá.kvertragÿ"j"ÿp
	ÿ¡Geinh%ÿ0ÿp
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿAP.gekond)
	ÿ^
prov%ÿEinheiten.KVERTRAGÿEuroproEinh.gekond
	ÿ’ÿ¡
	ÿ¡haftvertrag%ÿ0ÿp
ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
haftvertrag%ÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
Haftung%ÿÿ1(VS_Beginn.kvertrag)ÿ(haftvertrag%ÿ30)
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿ0
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ^
ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung.gekondÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
Haftung%ÿÿ1(VS_Beginn.kvertrag)ÿ(Haftung.gekondÿ30)
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿÿ1
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ¡Haftung.gekondÿÿ1ÿpHaftung%ÿÿ1
	ÿ¡prov%ÿ0ÿsr%ÿ0ÿpÿƒRegProvis("AP: "ÿVS_Nr.KVERTRAG,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag)
ÿ’ÿ¡
ÿ’ÿ¡



ÿ½ --------------------
ÿ½ -- Abschluáprovision KV und Pfl
ÿ½ --------------------

ÿ¡(APKVMonatJN.gekondÿ"j"ÿAPPfMonatJN.gekondÿ"j")ÿ(KVMonatFakt.gekondÿ0ÿPflMonatFakt.gekondÿ0)ÿp
ÿ½ CALL Fehler("KV-Pfl","")
ÿ¡gez_Abschluá.kvertragÿ"j"ÿp
	ÿ¡Geinh%ÿ0ÿp
prov%ÿ(NettoBeitrag.KVERTRAGÿKVMonatFakt.gekond)ÿ(Pflegepflicht.kvertragÿPflMonatFakt.gekond)
	ÿ^
prov%ÿEinheiten.KVERTRAGÿEuroproEinh.gekond
	ÿ’ÿ¡
	ÿ¡haftvertrag%ÿ0ÿp
ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
haftvertrag%ÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
Haftung%ÿÿ1(VS_Beginn.kvertrag)ÿ(haftvertrag%ÿ30)
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿ0
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ^
ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung.gekondÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
Haftung%ÿÿ1(VS_Beginn.kvertrag)ÿ(Haftung.gekondÿ30)
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿÿ1
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ¡Haftung.gekondÿÿ1ÿpHaftung%ÿÿ1
	ÿ¡prov%ÿ0ÿsr%ÿ0ÿpÿƒRegProvis("AP-KV-Pfl: "ÿVS_Nr.KVERTRAG,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag)
ÿ’ÿ¡
ÿ’ÿ¡




ÿ½ CALL Fehler("AP", STR$ (prov%,",999999.00"))

ÿ½ ------------------
ÿ½ -- Pflegeprovision
ÿ½ ------------------
ÿ½ 13.10.94  - keine Berechung der Stornoreserve
pflege%ÿ0
ÿ¡PflegeJN.gekondÿ"j"ÿp
ÿ¡Laufzeit%ÿPflegezeit.gekondÿp
	_day%ÿÿ3(letztePflege.KVERTRAG)
	_month%ÿÿ5(letztePflege.KVERTRAG)
	_year%ÿÿ6(letztePflege.KVERTRAG)
	ÿ¡_year%ÿ
1980ÿp
_year%ÿ1980
_day%ÿ1
_month%ÿ1
	ÿ’ÿ¡
 
ÿ½ 060597 Neu Pflegeprovis nach Zahlweisen
PflegeGez$ÿ"n"
ÿ¡PflegeNachZahlw.gekondÿ"n"ÿp
ÿ½ -- abh„ngig von Zahlungsweise im Vertrag --
ÿÉÿæZW.KVERTRAG
ÿæ1
_year%ÿ_year%ÿ1
ÿæ2
_month%ÿ_month%ÿ6
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
ÿæ4
_month%ÿ_month%ÿ3
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
ÿæ6
_month%ÿ_month%ÿ2
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
ÿæ12
_month%ÿ_month%ÿ1
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
ÿæ0
_year%ÿ2100
ÿ’ÿÉ
lfdnr11%ÿlfdnr.kvertrag
ÿ¡_day%ÿ29ÿp_day%ÿ29
ÿ¡_day%ÿ27ÿ_month%ÿ2ÿp_day%ÿ027
nextpfl%ÿÿ1(ÿ(_day%,"00")ÿ"."ÿÿ(_month%,"00")ÿ"."ÿÿ(_year%,"9999"))
ÿ½ 060597 kl„ren wozu ?
ÿ¡ZW.KVERTRAGÿ0ÿletzteProvi.KVERTRAGÿ
1ÿp
ÿ½ 150597
ÿ½ prov% = (((Beitrag.KVERTRAG * ZW.KVERTRAG) / 100) * PflegeProvi.gekond)
ÿ¡PflegevomNetto.stammÿ"j"ÿp
prov%ÿ(((Beitrag.KVERTRAG)ÿ100)ÿPflegeProvi.gekond)
ÿ^
prov%ÿ(((NettoBeitrag.KVERTRAG)ÿ100)ÿPflegeProvi.gekond)
ÿ’ÿ¡
ÿ½ prov% = (((Beitrag.KVERTRAG) / 100) * PflegeProvi.gekond)
PflegeGez$ÿ"j"
pflege%ÿ1
sr%ÿ0
Haftung%ÿ0
ÿ^
ÿ¡nextpfl%ÿ	cdate%ÿp
ÿ½ 150597
ÿ½ prov% = (((Beitrag.KVERTRAG * ZW.KVERTRAG) / 100) * PflegeProvi.gekond)
ÿ½ prov% = (((Beitrag.KVERTRAG) / 100) * PflegeProvi.gekond)
ÿ¡PflegevomNetto.stammÿ"j"ÿp
prov%ÿ(((Beitrag.KVERTRAG)ÿ100)ÿPflegeProvi.gekond)
ÿ^
prov%ÿ(((NettoBeitrag.KVERTRAG)ÿ100)ÿPflegeProvi.gekond)
ÿ’ÿ¡
PflegeGez$ÿ"j"
pflege%ÿ1
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ½ -- Abh„ngig von Zahlweise in GEKOND --
_month%ÿ_month%ÿPflegeZW.GEKOND
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
ÿ¡_day%ÿ29ÿp_day%ÿ29
ÿ¡_day%ÿ27ÿ_month%ÿ2ÿp_day%ÿ027
nextpfl%ÿÿ1(ÿ(_day%,"00")ÿ"."ÿÿ(_month%,"00")ÿ"."ÿÿ(_year%,"9999"))
ÿ¡nextpfl%ÿ	cdate%ÿp
ÿ½ prov% = (((Beitrag.KVERTRAG * ZW.KVERTRAG) / 100) * PflegeProvi.gekond)
ÿ¡PflegevomNetto.stammÿ"j"ÿp
prov%ÿ(((Beitrag.KVERTRAGÿZW.KVERTRAG)ÿ100)ÿPflegeProvi.gekond)
ÿ^
prov%ÿ(((NettoBeitrag.KVERTRAGÿZW.KVERTRAG)ÿ100)ÿPflegeProvi.gekond)
ÿ’ÿ¡
PflegeGez$ÿ"j"
pflege%ÿ1
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ 030697 IF PflegeGez$ = "j" THEN CALL RegProvis("Pflege: " + VS_Nr.kvertrag,codema%,prov%,sr%,Haftung%)
ÿ¡PflegeGez$ÿ"j"ÿprov%ÿ0ÿpÿƒRegProvis("Pflege: "ÿVS_Nr.kvertrag,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag)
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ CALL Fehler("Pflege", STR$ (prov%,",999999.00"))


ÿ½ 140497 Courtage nicht rechnen, wenn CourtageEinstell angekreuzt wurde und eine Pflegeprov. gezahlt wurde 
ÿ½ 270497 IF pflege% = 1 AND CourtEinstellen.gekond = "j" THEN GOTO Pflege1404971 
ÿ½ 200597
 
ÿ¡pflege%ÿ1ÿletztePflege.kvertragÿ0ÿpÿwPflege1404971 
 
ÿ½ -----------
ÿ½ -- Courtage
ÿ½ -----------
 
ÿ¡CourtageJN.gekondÿ"j"ÿp
ÿ½ vsnrtest$ = vs_nr.kvertrag
ÿ¡vs_nr.kvertragÿ"K7704412900002 DYN DYN"ÿp
	ÿ½ CALL Fehler(vs_nr.kvertrag,"3")
ÿ’ÿ¡
ÿ½ CALL Fehler(vs_nr.kvertrag,"3")
ÿ¡BewertEinmDat.kvertragÿ0ÿBewertCalcDat.kvertragÿ
1ÿp
	GBewEinm%ÿÿ1
	ÿwBewEinmDat201299
ÿ’ÿ¡
_day%ÿÿ3(letzteProvi.KVERTRAG)
_month%ÿÿ5(letzteProvi.KVERTRAG)
_year%ÿÿ6(letzteProvi.KVERTRAG)
ÿ¡_year%ÿ
1980ÿp
	_year%ÿ1980
	_day%ÿ1
	_month%ÿ1
ÿ’ÿ¡
CourtGez$ÿ"n"
ÿ¡CourtageZWjn.gekondÿ"n"ÿp
	ÿ½ -- abh„ngig von Zahlungsweise im Vertrag --
	ÿÉÿæZW.KVERTRAG
	ÿæ1
_year%ÿ_year%ÿ1
	ÿæ2
_month%ÿ_month%ÿ6
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
	ÿæ4
_month%ÿ_month%ÿ3
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
	ÿæ6
_month%ÿ_month%ÿ2
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
	ÿæ12
_month%ÿ_month%ÿ1
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
	ÿæ0
_year%ÿ2100
	ÿ’ÿÉ
	ÿ¡_day%ÿ29ÿp_day%ÿ29
	ÿ¡_day%ÿ27ÿ_month%ÿ2ÿp_day%ÿ027
	nextprovi%ÿÿ1(ÿ(_day%,"00")ÿ"."ÿÿ(_month%,"00")ÿ"."ÿÿ(_year%,"9999"))
	nextp$ÿÿ(nextprovi%,"0d.mm.yyyy")
	ÿ¡ZW.KVERTRAGÿ0ÿletzteProvi.KVERTRAGÿ
1ÿp
ÿ¡Geinh%ÿ0ÿp
ÿ¡CourtNachBeitr$ÿ"TRUE"ÿp
prov%ÿ((Beitrag.KVERTRAGÿ100)ÿCourtage.gekond)
ÿ^
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿCourtage.gekond)
ÿ’ÿ¡
ÿ^
prov%ÿEinheiten.KVERTRAGÿEuroproeinh.gekond
ÿ’ÿ¡
CourtGez$ÿ"j"
	ÿ^
ÿ¡nextprovi%ÿ	cdate%ÿp
ÿ¡Geinh%ÿ0ÿp
ÿ¡CourtNachBeitr$ÿ"TRUE"ÿp
prov%ÿ((Beitrag.KVERTRAGÿ100)ÿCourtage.gekond)
ÿ^
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿCourtage.gekond)
ÿ’ÿ¡
ÿ^
prov%ÿEinheiten.KVERTRAGÿEuroproeinh.gekond
ÿ’ÿ¡
CourtGez$ÿ"j"
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ^
	ÿ½ -- Abh„ngig von Zahlweise in GEKOND --
	_month%ÿ_month%ÿCourtageZW.GEKOND
	ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
	ÿ’ÿ¡
	lfdnr11%ÿlfdnr.kvertrag
	ÿ¡_day%ÿ29ÿp_day%ÿ29
	ÿ¡_day%ÿ27ÿ_month%ÿ2ÿp_day%ÿ027
	nextprovi%ÿÿ1(ÿ(_day%,"00")ÿ"."ÿÿ(_month%,"00")ÿ"."ÿÿ(_year%,"9999"))
	ÿ¡nextprovi%ÿ	cdate%ÿp
ÿ¡Geinh%ÿ0ÿp
ÿ¡CourtNachBeitr$ÿ"TRUE"ÿp
prov%ÿ((Beitrag.KVERTRAGÿ100)ÿCourtage.gekond)
ÿ^
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿCourtage.gekond)
ÿ’ÿ¡
ÿ^
prov%ÿEinheiten.KVERTRAGÿEuroproeinh.gekond
ÿ’ÿ¡
CourtGez$ÿ"j"
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ 060497
ÿ½ 200597
ÿ¡haftvertrag%ÿ0ÿp
	ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftvertrag%ÿStornoResGezJN.vkondÿ"j"ÿp
StornoResGezJN$ÿ""
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
codevk%ÿcodevk.vkond
Haftung%ÿÿ1(ProviAb.kvertrag)ÿ(Haftvertrag%ÿ30)
StornoResGezJN$ÿ"x"
ÿ¡Haftung.gekondÿÿ1ÿpHaftung%ÿÿ1
ÿ’ÿ¡
	ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿÿ1
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ^
	ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung.gekondÿStornoResGezJN.vkondÿ"j"ÿp
StornoResGezJN$ÿ""
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
codevk%ÿcodevk.vkond
Haftung%ÿÿ1(ProviAb.kvertrag)ÿ(Haftung.gekondÿ30)
StornoResGezJN$ÿ"x"
ÿ¡Haftung.gekondÿÿ1ÿpHaftung%ÿÿ1
ÿ’ÿ¡
	ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿÿ1
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡StornoResGezJN$ÿ"x"ÿp
	StornoResGezJN.vkondÿ"j"
	codevk%ÿcodevk.vkond
	Workstation.vkondÿWorkstation%
	QWoNo.vkondÿÿ(Workstation%,"000000")ÿÿ(codevk.vkond,"000000")
	RecStatus.vkondÿ"c"
	ÿÌÿ™"Vkond"
	ÿïÿYÿ™"vkond"
	ÿïÿ™"vkond"
	ÿÉÿ¥codevk%ÿ™"VKOND"ÿ£CodeVK.VKOND
	StornoResGezJN$ÿ""
ÿ’ÿ¡
ÿ½ 220697
ÿ¡CourtGez$ÿ"j"ÿp
	ÿ¡sr%ÿ0ÿprov%ÿ0ÿp
ÿƒRegProvis("Courtage: "ÿVS_Nr.kvertrag,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag)
	ÿ’ÿ¡
ÿ’ÿ¡
ÿwCourt201299end
BewEinmDat201299: 
ÿ¡Geinh%ÿ0ÿp
	prov%ÿ((BewertEinm.KVERTRAGÿ100)ÿCourtage.gekond)
ÿ^
	prov%ÿEinheiten.KVERTRAGÿEuroproeinh.gekond
ÿ’ÿ¡
CourtGez$ÿ"j"
ÿ¡haftvertrag%ÿ0ÿp
	ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
haftvertrag%ÿStornoResGezJN.vkondÿ"j"ÿp
StornoResGezJN$ÿ""
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
codevk%ÿcodevk.vkond
Haftung%ÿÿ1(ProviAb.kvertrag)ÿ(haftvertrag%ÿ30)
StornoResGezJN$ÿ"x"
ÿ¡Haftung.gekondÿÿ1ÿpHaftung%ÿÿ1
ÿ’ÿ¡
	ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿ0
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ^
	ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung.gekondÿStornoResGezJN.vkondÿ"j"ÿp
StornoResGezJN$ÿ""
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
codevk%ÿcodevk.vkond
Haftung%ÿÿ1(ProviAb.kvertrag)ÿ(Haftung.gekondÿ30)
StornoResGezJN$ÿ"x"
ÿ¡Haftung.gekondÿÿ1ÿpHaftung%ÿÿ1
ÿ’ÿ¡
	ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿ0
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡StornoResGezJN$ÿ"x"ÿp
	StornoResGezJN.vkondÿ"j"
	codevk%ÿcodevk.vkond
	Workstation.vkondÿWorkstation%
	QWoNo.vkondÿÿ(Workstation%,"000000")ÿÿ(codevk.vkond,"000000")
	RecStatus.vkondÿ"c"
	ÿÌÿ™"Vkond"
	ÿïÿYÿ™"vkond"
	ÿïÿ™"vkond"
	ÿÉÿ¥codevk%ÿ™"VKOND"ÿ£CodeVK.VKOND
	StornoResGezJN$ÿ""
ÿ’ÿ¡
ÿ½ 220697
ÿ¡CourtGez$ÿ"j"ÿp
	ÿ¡sr%ÿ0ÿprov%ÿ0ÿp
ÿƒRegProvis("Courtage: "ÿVS_Nr.kvertrag,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag)
	ÿ’ÿ¡
ÿ’ÿ¡
Court201299end: 
ÿ’ÿ¡
 
 
Pflege1404971: 
 

 
 

ÿ½ ----------------
ÿ½ -- Vertragsdauer
ÿ½ ----------------
 
ÿ¡VDjn.gekondÿ"j"ÿp
ÿ¡gez_Abschluá.kvertragÿ"j"ÿp
	ÿÉÿæVS_Dauer.KVERTRAG
	ÿæVD1Dauer.gekond
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿVD1AP.gekond)
sr%ÿVD1SR.gekond
Haftung%ÿVD1HZ.GEKOND
	ÿæVD2Dauer.gekond
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿVD2AP.gekond)
sr%ÿVD2SR.gekond
Haftung%ÿVD2HZ.GEKOND
	ÿæVD3Dauer.gekond
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿVD3AP.gekond)
sr%ÿVD3SR.gekond
Haftung%ÿVD3HZ.GEKOND
	ÿæVD4Dauer.gekond
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿVD4AP.gekond)
sr%ÿVD4SR.gekond
Haftung%ÿVD4HZ.GEKOND
	ÿæVD5Dauer.gekond
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿVD5AP.gekond)
sr%ÿVD5SR.gekond
Haftung%ÿVD5HZ.GEKOND
	ÿ’ÿÉ
	ÿ¡sr%ÿ0ÿp
ÿ¡haftvertrag%ÿ0ÿp
Haftung%ÿ(haftvertrag%ÿ30)ÿÿ1(VS_beginn.kvertrag)
ÿ^
Haftung%ÿ(Haftung%ÿ30)ÿÿ1(VS_beginn.kvertrag)
ÿ’ÿ¡
	ÿ^
Haftung%ÿ0
	ÿ’ÿ¡
	ÿƒRegProvis("VD: "ÿVS_Nr.kvertrag,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag)
ÿ’ÿ¡
ÿ’ÿ¡

ÿ½ -----------------------------------
ÿ½ -- Teilzahlung/Ratenzahlung
ÿ½ -- z.Z. auf Ratenzahlung umgestellt
ÿ½ -----------------------------------
 
ÿ¡TZjn.gekondÿ"j"ÿp
ÿ¡TZRate.KVERTRAGÿ1ÿ1ÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ0.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD1.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ1.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD2.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ2.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD3.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ3.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD4.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ4.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD5.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ5.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD6.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ6.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD7.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ7.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD8.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ8.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD9.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ9.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD10.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ10.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD11.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ11.gekond)
ÿ’ÿ¡
ÿ¡prov%ÿ0ÿp
	ÿ½ 060497
	ÿ¡haftvertrag%ÿ0ÿp
ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
haftvertrag%ÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
Haftung%ÿÿ1(VS_Beginn.kvertragÿ(haftvertrag%ÿ30))
ÿ’ÿ¡
ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿÿ1
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ^
ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung.gekondÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
Haftung%ÿÿ1(VS_Beginn.kvertragÿ(Haftung.gekondÿ30))
ÿ’ÿ¡
ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿÿ1
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ½ IF sr% <> 0 THEN 
ÿ½ Haftung% = DAYS (VS_Beginn.kvertrag + (Haftung.gekond * 30))
	ÿ½ ELSE 
ÿ½ Haftung% = 0
	ÿ½ END IF 
	ÿƒRegProvis("TZ ("ÿÿH(ÿ(TZRate.KVERTRAGÿ1,"999"))ÿ". Zahlung): "ÿVS_Nr.kvertrag,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag)
ÿ^
	ÿƒWriteLog("!Konditionen fr Ratenzahlung/Teilzahlung unvollst„ndig")
	ÿƒWriteLog("    >> Rate: "ÿÿH(ÿ(TZRate.KVERTRAGÿ1,"999")))
	ÿƒWriteLog("    >> bei Abschluá:"ÿÿH(ÿ(TZ0.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD1.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ1.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD2.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ2.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD3.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ3.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD4.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ4.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD5.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ5.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD6.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ6.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD7.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ7.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD8.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ8.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD9.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ9.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD10.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ10.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD11.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ11.gekond,",999999.00")))
	ÿƒAddLogInfo()
ÿ’ÿ¡
 
ÿ’ÿ¡
 
ÿ½ ------------
ÿ½ -- Pauschale
ÿ½ ------------
 
ÿ¡PauschaleJN.gekondÿ"j"ÿp
ÿ¡gez_Pauschale.kvertragÿ"j"ÿp
	prov%ÿPauschale.gekond
	ÿ½ 060497
	ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung.gekondÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
ÿ¡haftvertrag%ÿ0ÿp
Haftung%ÿÿ1(VS_Beginn.kvertrag)ÿ(Haftvertrag%ÿ30)
ÿ^
Haftung%ÿÿ1(VS_Beginn.kvertrag)ÿ(Haftung.gekondÿ30)
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿÿ1
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ½ IF sr% <> 0 THEN 
ÿ½ Haftung% = DAYS (VS_Beginn.kvertrag) + (Haftung.gekond * 30)
	ÿ½ ELSE 
ÿ½ Haftung% = 0
	ÿ½ END IF 
	ÿƒRegProvis("Pauschale: "ÿVS_Nr.kvertrag,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag)
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ’ÿ¡
 
ÿ¡n„chsteKond.VKONDÿ0ÿp
ok%ÿ0
ÿ^
ÿÉÿ¥n„chsteKond.VKONDÿáÿ™"VKOND"ÿ£CodeVK.VKOND
ÿ’ÿ¡
 
 ÿÙ
 ÿ’ÿÿ
 

 ' RegProvis
 ' =======================================================================
 ' Zweck:   tr„gt Buchungstext der Provisionsberechnung in die Buchungs-
 '          datei ein
 ' Nutzung: CALL RegProvis(remark$,codema%,provi%,sr%,srbis%)
 '          remark$     = Buchungstext
 '          ma%         = Agenturnummer
 '          provi%      = Provisionssumme
 '          sr%         = Stornoreserve in %
 '          Haftung%    = Datum der Stornoreserveauszahlung
 ' =======================================================================
 ' 29.04.93      - Prfung auf einmalige Abschluáprovi und Pauschale
 '                 - Provisionsausweisung abzglich Stornoreserve
 ' 26.06.95      - Korrektur der Registrierung gezahlter Pauschalen
 ' 29.04.96      - getrennte Differenzbildung fr alle verschiedenen
 '                   Provisionssysteme
 '                   (alte Variante als old_RegProvis im Anschluá)
 
 
ÿÿRegProvis(remark$,ma%,provi%,sr%,Haftung%,euro1%,codew%,waehr1$)
 ÿ½ CALL Fehler("Pool1","")
 cfile$ÿÿ™
 ÿ™"kvertrag"
 _lfdnr%ÿlfdnr.KVERTRAG
 ÿÉÿ¥_lfdnr%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿÉÿ¥ma%ÿ™"maadr"ÿ£CodeMA.MAADR
 ÿÉÿ¥codeva.kvertragÿ™"sparten"ÿ£codeva.sparten
 codevp%ÿcodevp.kvertrag
 ÿÉÿ`ÿ™"VPRODUKT"ÿ£codevp.vprodukt
 ÿÉÿ¥codevp%ÿ™"VPRODUKT"ÿ£codevp.vprodukt
 ÿ½ -- bereits gezahlte Provisionen verallgemeinern
 ÿ½ IF remark$ LIKE "Abschlu*" THEN 
ÿ½ vertrprov% = vsumAP%
 ÿ½ ELSE IF remark$ LIKE "Courta*" THEN 
ÿ½ vertrprov% = vsumC%
 ÿ½ ELSE IF remark$ LIKE "Pflege*" THEN 
ÿ½ vertrprov% = vsumPP%
 ÿ½ ELSE IF remark$ LIKE "Pauschal*" THEN 
ÿ½ vertrprov% = vsumPausch%
 ÿ½ ELSE IF remark$ LIKE "VD*" THEN 
ÿ½ vertrprov% = vsumAP%
 ÿ½ END IF 
 bewerteimz%ÿ0
 ÿ¡BewertEinmDat.kvertragÿ0ÿBewertCalcDat.kvertragÿ
1ÿp
bewerteimz%ÿ1
 ÿ’ÿ¡
 ÿ½ -- Bearbeitung bei letzter Agentur in der Struktur
 nurprov%ÿ0
 ÿ¡(CodeMA.maadrÿvorg„nger.maadr)ÿ(Vorg„nger.MAADRÿ
1)ÿp

ÿ¡bewerteimz%ÿ1ÿp
ÿ½ BewertCalcDat.kvertrag = cdate%
BewertCalcDat.kvertragÿBewertEinmDat.kvertrag
ÿ^
letzteProvi.kvertragÿcdate%
ÿ’ÿ¡
ÿ¡remark$ÿ"TZ (*"ÿp
TZRate.KVERTRAGÿTZRate.KVERTRAGÿ1
ÿ’ÿ¡
 ÿ^
ÿ¡Geinh%ÿÿ1ÿnurProv.stammÿ"j"ÿp
ÿ¡ma%ÿvtcodema%ÿp
ÿ^
ÿ¡dochProv.maadrÿ"j"ÿp
	nurprov%ÿÿ1
	provi%ÿ0
	sr%ÿ0
	haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡


 ÿ½ -- Einmalzahlungen/Berechnungen Stornoreserve registrieren --
 ÿ¡remark$ÿ"Abschlu*"ÿremark$ÿ"VD*"ÿremark2$ÿ"AP*"ÿremark$ÿ"AP*"ÿpgezAbschluá%ÿ1
 ÿ¡remark$ÿ"Pflege*"ÿpgezPflege%ÿ1
 ÿ¡remark$ÿ"Pauschal*"ÿpgezPauschale%ÿ1
 ÿ¡CodeMA.MAADRÿVorg„nger.MAADRÿVorg„nger.MAADRÿ
1ÿp
ÿ¡gezAbschluá%ÿ1ÿpgez_Abschluá.kvertragÿ"j"
ÿ¡gezPflege%ÿ1ÿpletztePflege.kvertragÿcdate%
ÿ¡gezPauschale%ÿ1ÿpgez_Pauschale.kvertragÿ"j"
 ÿ’ÿ¡

 ÿ½ CALL QuickStore("KVERTRAG")
 ÿÌÿ™"KVERTRAG"
 ÿïÿYÿ™"KVERTRAG"
 ÿïÿ™"kvertrag"
 ÿßÿe
 ÿ™"buchung"
 ÿ
 CodeBU.buchungÿÿI("buchung",1)
 CodeBU%ÿCodeBU.buchung
 ÿ¡bewerteimz%ÿ1ÿp
Datum.buchungÿBewertEinmDat.kvertrag
 ÿ^
Datum.buchungÿcdate%
 ÿ’ÿ¡
 ÿ½ CALL Fehler ( DATE$ (cdate%,"0d.mm.yyyy"),"")
 F„lligkeit.buchungÿcdate%
 ÿ½ 19062002
 ÿ¡bewerteimz%ÿ1ÿp
F„lligkeit.buchungÿBewertEinmDat.kvertrag
 ÿ’ÿ¡
 CodeVT.buchungÿlfdnr.kvertrag
 ÿ¡Kndigung.MAADRÿ
cdate%ÿNachfolger.MAADRÿ0ÿp
ÿ¡remark$ÿ"Abschlu*"ÿremark$ÿ"AP*"ÿremark$ÿ"VD*"ÿremark$ÿ"Pauschal*"ÿpkondart%ÿ0
ÿ¡remark$ÿ"Pflege*"ÿpkondart%ÿ2
ÿ¡remark$ÿ"Court*"ÿremark$ÿ"*Court*"ÿpkondart%ÿ1
ÿ½ CodeMA.buchung = Nachfolger.MAADR
ÿ½ ma1% = Nachfolger.MAADR
ÿ½ Buchungstext.buchung = remark$ + " (Umbuchung von " + Nachname.MAADR + ", " + LEFT$ (Vorname.MAADR,1) + ".)"
	ÿ½ *********************************************************************************************************************
ÿÉÿækondart%
ÿæ0,3,4
ÿ½ AP
ÿ¡Kuenap.maadrÿ"j"ÿp
ÿ½ AP wir weitergezahlt
ÿ¡PausUVzahl.maadrÿ
1ÿp
CodeMA.buchungÿma%
ma1%ÿma%
Buchungstext.buchungÿÿ+(remark$,70)
ÿ^
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchungÿma%
ma1%ÿma%
Buchungstext.buchungÿÿ+(remark$,70)
ÿ^
CodeMA.buchungÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
Buchungstext.buchungÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchungÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
Buchungstext.buchungÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿæ1
ÿ½ Courtage
ÿ¡KuenCourt1.maadrÿ"j"ÿp
ÿ½ die erste courtage soll noch gezahlt werden
ÿ¡KuenCourt1.kvertragÿ"j"ÿp
ÿÉÿYÿáÿ™"kvertrag"
KuenCourt1.kvertragÿ"j"
ÿÌÿ™"kvertrag"
ÿ¡PausUVzahl.maadrÿ
1ÿp
CodeMA.buchungÿma%
ma1%ÿma%
Buchungstext.buchungÿÿ+(remark$,70)
ÿ^
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchungÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
Buchungstext.buchungÿÿ+(remark$,70)

ÿ^
CodeMA.buchungÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
Buchungstext.buchungÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchungÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
Buchungstext.buchungÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ^
ÿ¡KuenCourtAlle.maadrÿ"j"ÿp
ÿÉÿYÿáÿ™"kvertrag"
KuenCourt1.kvertragÿ"j"
ÿÌÿ™"kvertrag"
ÿ¡PausUVzahl.maadrÿ
1ÿp
CodeMA.buchungÿma%
ma1%ÿma%
Buchungstext.buchungÿÿ+(remark$,70)
ÿ^
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchungÿma%
ma1%ÿma%
Buchungstext.buchungÿÿ+(remark$,70)
ÿ^
CodeMA.buchungÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
Buchungstext.buchungÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchungÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
Buchungstext.buchungÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡

ÿæ2,5
ÿ½ Pflege
ÿ¡KuenPflege.maadrÿ"j"ÿp
ÿ¡PausUVzahl.maadrÿ
1ÿp
CodeMA.buchungÿma%
ma1%ÿma%
Buchungstext.buchungÿÿ+(remark$,70)
ÿ^
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchungÿma%
ma1%ÿma%
Buchungstext.buchungÿÿ+(remark$,70)
ÿ^
CodeMA.buchungÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
Buchungstext.buchungÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchungÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
Buchungstext.buchungÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡

ÿ’ÿÉ
	ÿ½ ********************************************************************************************************************* 
 ÿ^
CodeMA.buchungÿma%
ma1%ÿma%
ÿ¡bewerteimz%ÿ1ÿp
Buchungstext.buchungÿremark$ÿ"- Erst.Zahl."
ÿ^
Buchungstext.buchungÿremark$
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡dmeinh%ÿ0ÿpeinheit%ÿprovi%ÿdmeinh%
 ÿÉÿ¥ma1%ÿáÿ™"maadr"ÿ£codema.maadr

 ÿ¡remark$ÿ"Pauschal*"ÿp
ÿ¡haftung%ÿ0ÿsr%ÿ0ÿsrjn.gekondÿ"j"ÿp
SRBetrag%ÿ((provi%)ÿ100)ÿsr%
ÿ^
SRBetrag%ÿ0
ÿ’ÿ¡
betr%ÿprovi%ÿSRBetrag%
 ÿ^
ÿ¡haftung%ÿ0ÿsr%ÿ0ÿsrjn.gekondÿ"j"ÿp
SRBetrag%ÿ((provi%ÿvertrprov%)ÿ100)ÿsr%
ÿ^
SRBetrag%ÿ0
ÿ’ÿ¡
ÿ¡Geinh%ÿ0ÿp
betr%ÿprovi%ÿvertrprov%ÿSRBetrag%
ÿ^
ÿ¡nurprov.stammÿ"j"ÿnurprov%ÿÿ1ÿp
betr%ÿ0
SRBetrag%ÿ0
ÿ^
betr%ÿprovi%ÿvertrprov%ÿSRBetrag%
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡

 Stornoreserve.maadrÿStornoreserve.maadrÿSRBetrag%
 StornoreserveEU.maadrÿÿ0(ÿ(Stornoreserve.maadrÿeuro1%,"999999999.00"))
 abst%ÿStornoreserve.maadr
 absteu%ÿStornoreserveEU.maadr
 ÿ¡codema.maadrÿ1ÿp
ÿ²"99999999.000"
ÿ½ CALL Fehler("","")
 ÿ’ÿ¡
 einheitkv%ÿ0
 ÿ½ CALL Fehler(sparte.sparten,"")
 ÿ¡EinheitSach.stammÿ"j"ÿp
ÿ¡SparteIstSach.spartenÿ1ÿp
ÿ¡ma1%ÿvtcodema%ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿp
	Einheiten.maadrÿEinheiten.maadrÿeinheit%
	einheitkv%ÿeinheit%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
	ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertrag
einheitkv%ÿeinheiten.kvertrag
	ÿ’ÿ¡
ÿ^
	ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿ(einheiten.kvertragÿÿ1)
einheitkv%ÿeinheiten.kvertragÿÿ1
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡EinheitAusGeko.stammÿ
1ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
	Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertrag
	einheitkv%ÿeinheiten.kvertrag
ÿ’ÿ¡
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
	Einheiten.maadrÿEinheiten.maadrÿ(einheiten.kvertragÿÿ1)
	einheitkv%ÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ^
ÿ¡EinheitAusGeko.stammÿ
1ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertrag
einheitkv%ÿeinheiten.kvertrag
ÿ’ÿ¡
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿ(einheiten.kvertragÿÿ1)
einheitkv%ÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡ma1%ÿvtcodema%ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿp
EigEinheiten.maadrÿEigEinheiten.maadrÿeinheit%
EinheitGes.maadrÿEinheitGes.maadrÿeinheit%
einheitkv%ÿeinheit%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
EigEinheiten.maadrÿEigEinheiten.maadrÿeinheiten.kvertrag
EinheitGes.maadrÿEinheitGes.maadrÿeinheiten.kvertrag
einheitkv%ÿeinheiten.kvertrag
ÿ’ÿ¡
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
EigEinheiten.maadrÿEigEinheiten.maadrÿ(einheiten.kvertragÿÿ1)
EinheitGes.maadrÿEinheitGes.maadrÿ(einheiten.kvertragÿÿ1)
einheitkv%ÿ(einheiten.kvertragÿÿ1)
ÿ’ÿ¡
ÿ’ÿ¡
StorWarnJN.buchungÿGStorWarnJN$
StorWarnDatGes.buchungÿGStorWarnDGes$
StorWarnDatMA.buchungÿGStorWarnDMA$
StorWarnGrund.buchungÿGStorWarnGrund$
StorWarnMasn.buchungÿGStorWarnMasn$
StorWarnErg.buchungÿGStorWarnErg$
 ÿ^
sEinheitGes.maadrÿsEinheitGes.maadrÿeinheitkv%
 ÿ’ÿ¡
 
 ÿ½ IF CodeMA.MAADR = Vorg„nger.MAADR OR Vorg„nger.MAADR < 1 THEN CALL Fehler( STR$ (betr%,"99999999.00"),"Volumen?")
 ÿ½ ****************************AUSZAHLUNGSSPERRE**********************************
 eigen%ÿ0
 PSpAll$ÿPROVSperreAll.maadr
 PSpAllSeit%ÿPSperreAllSeit.maadr
 PROVSpEig$ÿPROVSperreEig.maadr
 PSpESeit%ÿPSperreESeit.maadr
 ÿ½ CALL Fehler("","")
 ÿ¡ma1%ÿvtcodema%ÿp
eigen%ÿ1
 ÿ’ÿ¡
 ÿ¡PspAll$ÿ"j"ÿp
ÿ¡PSpAllSeit%ÿ	cdate%ÿp
ÿ½ IF ma1% = 529 THEN CALL Fehler("TRIEBSCH","")
AuszahlSperKo.maadrÿAuszahlSperKo.maadrÿbetr%
AuszahlSperKoEU.maadrÿÿ0(ÿ(AuszahlSperKo.maadrÿeuro1%,"999999999.00"))
ÿ’ÿ¡
 ÿ^
ÿ¡eigen%ÿ1ÿPROVSpEig$ÿ"j"ÿp
ÿ¡PSpESeit%ÿ	cdate%ÿp
AuszahlSperKo.maadrÿAuszahlSperKo.maadrÿbetr%
AuszahlSperKoEU.maadrÿÿ0(ÿ(AuszahlSperKo.maadrÿeuro1%,"999999999.00"))
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ ****************************AUSZAHLUNGSSPERRE Ende**********************************  
 ÿ¡betr%ÿ0ÿp
GesVolumen.maadrÿGesVolumen.maadrÿVolumen.KVERTRAG
ÿ¡ma1%ÿvtcodema%ÿp
EigVolumen.maadrÿEigVolumen.maadrÿVolumen.KVERTRAG
ÿ’ÿ¡
 ÿ^
GesVolumen.maadrÿGesVolumen.maadrÿ(Volumen.KVERTRAGÿÿ1)
ÿ¡ma1%ÿvtcodema%ÿp
EigVolumen.maadrÿEigVolumen.maadrÿ(Volumen.KVERTRAGÿÿ1)
ÿ’ÿ¡
 ÿ’ÿ¡
 AuszahlAB.maadrÿAuszahlAB.maadrÿbetr%
 AuszahlEUAB.maadrÿÿ0(ÿ(AuszahlAB.maadrÿeuro1%,"999999999.00"))

 AuszProvABGes.maadrÿAuszProvABGes.maadrÿbetr%
 AuszProvABGesEU.maadrÿÿ0(ÿ(AuszProvABGes.maadrÿeuro1%,"999999999.00"))

 ÿ½ Workstation.maadr = Workstation%
 ÿ½ QWoNo.maadr = STR$ (Workstation%,"000000") + STR$ (codema.maadr,"000000")
 RecStatus.maadrÿ"c"
 ÿÌÿ™"maadr"
 ÿïÿYÿ™"maadr"
 ÿ½ *****************************************************************************************************
 ÿ½ Zentralberechnung des Kontostandes
 zusatz%ÿ0
 ÿƒZentrKTO(ma%,cdate%,betr%,SRBetrag%,codew%,euro1%,waehr1$,PSpAll$,PSpAllSeit%,PROVSpEig$,PSpESeit%,eigen%,zusatz%,einheitkv%)
 ÿ½ ***************************************************************************************************** 
 ÿ½ CALL ZentrAGZaehl(ma%,"EINHEIT",Bewertungssumme.kvertrag,Volumen.kvertrag,einheit%,Antragsdatum.kvertrag,0)
 ÿ¡mwstprovjn.vproduktÿ"j"ÿmwstprov.vproduktÿ0ÿp
mwstprov%ÿmwstprov.vprodukt
ÿ½ CALL Fehler( STR$ (mwstprov%,"999.00"), STR$ (betr%,"999.00"))
ÿ¡Mwstpflicht.maadrÿ"j"ÿp
ÿ¡mwstprovbn.gekondÿ"n"ÿp
ÿ½ Netto
nettoeu%ÿbetr%
NettoEu.buchungÿbetr%
mwstbetrag%ÿ(betr%ÿmwstprov%)ÿ100
mwstbetrag$ÿÿ(mwstbetrag%,"9999999.00")
mwstbetrag%ÿÿ0(mwstbetrag$)
Betrag.buchungÿnettoeu%ÿmwstbetrag%
betrag%ÿBetrag.buchung
BetragEu.buchungÿbetrag%

ÿ^
ÿ½ brutto
Betrag.buchungÿbetr%
BetragEu.buchungÿbetr%
nettobetrag%ÿ(betr%ÿ100)ÿ(mwstprov%ÿ100)
nettobetrag$ÿÿ(nettobetrag%,"9999999.00")
nettobetrag%ÿÿ0(nettobetrag$)
mwstbetrag%ÿbetr%ÿnettobetrag%
NettoEu.buchungÿnettobetrag%
ÿ’ÿ¡
MWSTProz.buchungÿmwstprov%
MWSTBetragEu.buchungÿmwstbetrag%
ÿ^
BetragEu.buchungÿbetr%
Betrag.buchungÿbetr%
NettoEu.buchungÿbetr%
MWSTProz.buchungÿ0
MWSTBetragEu.buchungÿ0
ÿ’ÿ¡
 ÿ^
BetragEu.buchungÿbetr%
Betrag.buchungÿbetr%
NettoEu.buchungÿbetr%
MWSTProz.buchungÿ0
MWSTBetragEu.buchungÿ0
 ÿ’ÿ¡
 Gesamtbetrag.BUCHUNGÿprovi%
 codemagr.buchungÿCodemagr.maadr
 CodeAGDir.buchungÿCodeagdir.maadr
 Kostenstelle.buchungÿKostenstelle.maadr
 DebitorKto.buchungÿDebitorkto.maadr
 KreditorKto.buchungÿKreditorkto.maadr
 ÿ¡bewerteimz%ÿ1ÿp
Bewertungssumme.BUCHUNGÿBewertEinm.kvertrag
 ÿ^
Bewertungssumme.BUCHUNGÿBewertungssumme.KVERTRAG
 ÿ’ÿ¡
 ProvBasiswert.buchungÿBewertungssumme.buchung
 umrechnung.buchungÿeuro1%
 vsumme.buchungÿvsumme.kvertrag
 vsummeEU.buchungÿÿ0(ÿ(vsumme.kvertragÿumrechnung.buchung,"999999999.00"))
 BeitragBrut.buchungÿBeitrag.kvertrag
 BeitragNet.buchungÿNettoBeitrag.kvertrag
 BeitragBrutEu.buchungÿÿ0(ÿ(Beitrag.kvertragÿumrechnung.buchung,"999999999.00"))
 BeitragNetEu.buchungÿÿ0(ÿ(NettoBeitrag.kvertragÿumrechnung.buchung,"999999999.00"))
 zw.buchungÿzw.kvertrag
 mwst.buchungÿmwst.kvertrag
 VS_Beginn.buchungÿVS_Beginn.kvertrag
 ÿ¡zw.buchungÿ0ÿp
JahresBBrut.buchungÿBeitragBrut.buchungÿzw.buchung
JahresBNet.buchungÿBeitragNet.buchungÿzw.buchung
JahresBBrutEu.buchungÿÿ0(ÿ(JahresBBrut.buchungÿumrechnung.buchung,"999999999.00"))
JahresBNetEu.buchungÿÿ0(ÿ(JahresBNet.buchungÿumrechnung.buchung,"999999999.00"))
 ÿ^
JahresBBrut.buchungÿBeitragBrut.buchung
JahresBNet.buchungÿBeitragNet.buchung
JahresBBrutEu.buchungÿÿ0(ÿ(JahresBBrut.buchungÿumrechnung.buchung,"999999999.00"))
JahresBNetEu.buchungÿÿ0(ÿ(JahresBNet.buchungÿumrechnung.buchung,"999999999.00"))
 ÿ’ÿ¡
 Volumen.BUCHUNGÿVolumen.KVERTRAG
 Bewertung2.buchungÿBewertungssumme.kvertrag
 APJN.buchungÿAPjn.gekond
 CourtJN.buchungÿCourtageJN.gekond
 SRjn.buchungÿSRJN.gekond
 PflegeJN.buchungÿPflegeJN.gekond
 APProzente.buchungÿAP.gekond
 CourtProzente.buchungÿCourtage.gekond
 PflegProzente.buchungÿPflegeProvi.gekond
 SRProzente.buchungÿsr.gekond
 Kndigung.BUCHUNGÿKndigung.KVERTRAG
 CodeKU.BUCHUNGÿCodeKU.KVERTRAG
 vtagentur.buchungÿGvtagentur$
 vtcodema.buchungÿGvtcodema%
 ÿ¡EinheitSach.stammÿ"j"ÿp
ÿ¡SparteIstSach.spartenÿ1ÿp
ÿ¡ma1%ÿvtcodema%ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchungÿeinheit%
ÿ¡betr%ÿ0ÿp
	ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchungÿeinheiten.kvertrag
ÿ^
	ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchungÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchungÿeinheit%
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchungÿeinheiten.kvertrag
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchungÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ^
ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchungÿeinheit%
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchungÿeinheiten.kvertrag
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchungÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
 ÿ’ÿ¡
 
 agentur.buchungÿÿ+(ÿH(nachname.maadr)ÿ", "ÿÿH(vorname.maadr)ÿ", "ÿÿH(Agenturnr.maadr)ÿ" , Stufe:"ÿÿ(stufe.maadr,"000"),100)
 ÿÉÿ¥CodeVA.kvertragÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 Sparte.BUCHUNGÿSparte.SPARTEN
 ÿÉÿ¥CodeKU.KVERTRAGÿ™GAdrDat$ÿ£CodeKU.GAdrDat$
 Nachname.BUCHUNGÿNachname.GAdrDat$
 Vorname.BUCHUNGÿVorname.GAdrDat$
 Bewertung2Eu.buchungÿÿ0(ÿ(Bewertung2.buchungÿeuro1%,"999999999.00"))
 codew.buchungÿcodew%
 waehrung.buchungÿwaehr1$
 ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
 Gesellschaft.BUCHUNGÿGesellschaft.GEADR
 Provision.buchungÿ"j"
 ÿ¡PRVCHECKLISTE$ÿ"TRUE"ÿp
codebumon.buchungÿcodebumon.buchmon
 ÿ’ÿ¡
 ÿ¡sr%ÿ0ÿp
SRgezahlt.buchungÿ"j"
SR.buchungÿ0
 ÿ^
ÿ½ 060497
ÿ¡Haftung%ÿÿ1ÿp
SRAuszahlung.buchungÿ0
SR.buchungÿSRBetrag%
ÿ^
SRAuszahlung.buchungÿHaftung%
SR.buchungÿSRBetrag%
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ CALL QuickStore("buchung")
timestamp$ÿÿ(ÿQ,"yymmdd")ÿÿ(ÿ9(ÿR)ÿ100ÿÿ:(ÿR),"0000")
timestamp%ÿÿ0(timestamp$)
Timestamp.buchungÿtimestamp%
QuickCode.BUCHUNGÿÿ(CodeMA.BUCHUNG,"000000")ÿÿ(Datum.BUCHUNG,"yyyymm0d")
QCodeMAPROD.buchungÿÿ(CodeMA.buchung,"000000")ÿVSNRPack$(Gesellschaft.buchung)ÿVSNRPack$(Sparte.buchung)
QCodeMAVT.buchungÿÿ(codema.buchung,"000000")ÿÿ(codevt.buchung,"000000")
ÿ¡Workstation%ÿ0ÿpWorkstation.BuchungÿWorkstation%
ÿ¡Workstation%ÿ0ÿpQWoNo.Buchungÿÿ(Workstation%,"000000")ÿÿ(CodeBu.Buchung,"000000")
RecStatus.Buchungÿ"c"
ÿ¡umrechnung.buchungÿ0ÿpumrechnung.buchungÿ1
ÿ¡gebuchtjn.buchungÿ1ÿpgebuchtjn.buchungÿ0
gebuchtJNDat.buchungÿÿ(gebuchtjn.buchung,"0")ÿÿ(datum.buchung,"yyyymm0d")
gebuchtJNMADat.buchungÿÿ(gebuchtjn.buchung,"0")ÿÿ(Codema.buchung,"000000")ÿÿ(datum.buchung,"yyyymm0d")
ÿƒBUDMEuro(umrechnung.buchung)
CodeEingGE.BUCHUNGÿCodeEingGE.kvertrag
EingereichtBei.BUCHUNGÿEingereichtBei.kvertrag
ÿÌÿ™"buchung"
 ÿ½ -- Zahlungseingang prfen --
 ÿ½ 070897
 ÿ¡check.KVERTRAGÿ"j"ÿp
ÿ½ CALL Fehler("Check auf Pool","")
_lfdnr%ÿlfdnr.KVERTRAG
ÿÉÿ¥_lfdnr%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿ½ pool% = (Pool.KVERTRAG - Betrag.BUCHUNG) * 100
ÿ¡Geinh%ÿÿ1ÿp
ÿ½ pool% = (Pool.KVERTRAG - betr%) * 100
sr$ÿÿ(sr.buchung,",999999.00")
betr$ÿÿ(betr%,",9999999.00")
pool$ÿÿ(Pool.KVERTRAG,",9999999.00")
bsumme%ÿbetr%ÿsr.buchung
ÿ½ CALL Fehler("Betrag: " + betr$ + " SR: " + sr$ + " Pool: " + pool$,"")
pool%ÿ(Pool.KVERTRAGÿbsumme%)ÿ100
pool1$ÿÿ(pool%,"999999999999")
poolges%ÿ(ÿ0(pool1$))ÿ100
pool.kvertragÿpoolges%
ÿ½ CALL Fehler("Betrag: " + betr$ + " SR: " + sr$ + " ErgebnisPool: " + STR$ (pool.kvertrag,",999999.00"),"")
ÿ^
zwprov%ÿprovi%ÿvertrprov%
pool1%ÿPool.KVERTRAG
pool%ÿ(Pool.KVERTRAGÿzwprov%)ÿ100
pool1$ÿÿ(pool%,"999999999999")
poolges%ÿ(ÿ0(pool1$))ÿ100
pool.kvertragÿpoolges%
ÿ’ÿ¡
 
ÿ¡Pool.KVERTRAGÿ
0ÿp
Mahnung.KVERTRAGÿ"j"
ÿƒWriteLog("  fehlender Zahlungseingang von Gesellschaft")
ÿƒAddLogInfo()
ÿ’ÿ¡
ÿƒQuickStore("KVERTRAG")
ÿ¡Pool.KVERTRAGÿ
0ÿp
ÿÉÿ¥codebu%ÿáÿ™"Buchung"ÿ£codebu.buchung
Mahnung.BUCHUNGÿ"j"
ÿƒQuickStore("buchung")
ÿ’ÿ¡
 

 ÿ’ÿ¡
 
 
 ÿ½ -- Aufsummierung der einzelnen Provisionsarten
 ÿ½    fr Differenzberechnung
 ÿ¡remark$ÿ"Abschl*"ÿremark$ÿ"AP*"ÿremark2$ÿ"AP*"ÿp
vsumAP%ÿprovi%
 ÿ^ÿ¡remark$ÿ"Courta*"ÿp
vsumC%ÿprovi%
 ÿ^ÿ¡remark$ÿ"Pflege*"ÿp
vsumPP%ÿprovi%
 ÿ^ÿ¡remark$ÿ"Pauschal*"ÿp
vsumPausch%ÿprovi%
 ÿ^ÿ¡remark$ÿ"VD*"ÿp
vsumAP%ÿprovi%
 ÿ^
vertrprov%ÿprovi%
 ÿ’ÿ¡
 vertrprov%ÿprovi%
 
 ÿ’ÿÿ
 
 

 ' Korrekturbuchung
 ' =======================================================================
 ' 27.10.93  - wahlweise Eingabe des Rechnungsbeginns

ÿÿBUKORREKTUR()
 ÿ¡disabled%("BUCHUNG6")ÿpÿ’ÿÿ
 Anschluss%ÿ1
 ÿÂ"Die Korrekturbuchung l”scht alle Buchungen und setzt","die Vertragsdatei zurck! Fortfahren?",135,req%
 ÿ¡req%ÿ1ÿp

CalcDate$ÿReadConfig$("PROVIS","KorrekturAb")
ÿ¡CalcDate$ÿ"leer"ÿpCalcDate$ÿ""
ÿ‰ÿñ"ANSCHLUSS",0,0,191,92,"Buchungskorrektur","MS Sans Serif",8
ÿ|ÿñ"ANSCHLUSS",4,0,0,191,68,0,""
ÿ|ÿñ"ANSCHLUSS",9,9,12,21,23,2
ÿ|ÿñ"ANSCHLUSS",5,38,12,144,20,0,"Bitte geben Sie ein, ab welchem Stichtag die Provisionen berechnet werden sollen:"
ÿ|ÿñ"ANSCHLUSS",5,38,42,33,10,0,"Stich&tag:"
ÿ|ÿñ"ANSCHLUSS",6,73,41,51,11,0,0,CalcDate$,20
ÿ|ÿñ"ANSCHLUSS",1,34,72,55,14,1,"&OK",1,1
ÿ|ÿñ"ANSCHLUSS",1,92,72,55,14,0,"&Abbrechen",0,0
ÿñ"ANSCHLUSS",req%
ÿ¾ÿñ"ANSCHLUSS"
ÿ¡req%ÿ1ÿp
ÿ¡DateOK%(CalcDate$)ÿp
ÿƒCreateLog()
ÿßÿe
ÿƒServer("LOADMESSAGE","")
ÿƒServer("MESSAGE","Bitte warten... Alle Provisionsbuchungen werden aus der Buchungsdatei gel”scht. (Dieser Vorgang kann bei gr”áeren Datenbest„nden einige Zeit in Anspruch nehmen.)")
ÿƒDFile(3,"buchung"ÿ_fpw$)
ÿƒDFile(3,"ZEINGANG"ÿ_fpw$)
ÿƒDFile(3,"gekond"ÿ_fpw$)
ÿƒDFile(3,"maadr"ÿ_fpw$)
ÿƒDFile(3,"maadrgru"ÿ_fpw$)
ÿƒDFile(3,"kvertrag"ÿ_fpw$)
ÿƒDFile(3,"vkond"ÿ_fpw$)

ÿƒWriteConfig("PROVIS","KorrekturAb",CalcDate$)
ÿÊÿË"Buchungsdatei wird gel”scht..."
ÿ™"KVERTRAG"
ÿ½ SELECT FIRST FILE "KVERTRAG" INDEX ProviAB.KVERTRAG
startprovi%ÿProviAB.KVERTRAG
ÿ½ 220897 REMOVE FROM FILE "BUCHUNG" WHERE Provision.BUCHUNG LIKE "j"
ÿ¡ÿJ(_ppath$ÿ"but1.sbf")ÿpÿ(_ppath$ÿ"but1.*")
ÿÊÿiÿŸ"",0,0
ÿÉCodeBU.buchung,CodeMA.buchung,Datum.buchung,Krzel.buchung,Betrag.buchung,SR.buchung,SRAuszahlung.buchung,
Buchungstext.buchung,Provision.buchung,CodeVT.buchung,SRgezahlt.buchung,TimeStamp.buchung,Nachname.buchung,
Vorname.buchung,VS_Beginn.buchung,Sparte.buchung,Kndigung.buchung,Gesellschaft.buchung,Bewertungssumme.buchung,
CodeKU.buchung,Volumen.buchung,Gesamtbetrag.buchung,Sperre.buchung,gezahlt.buchung,gezahlt_am.buchung,QuickCode.buchung,
Mahnung.buchung,Einheiten.buchung,VTAgentur.buchung,umrechnung.buchung,codew.buchung,waehrung.buchung,waehrungBezeich.buchung,
GesamtbetragEU.buchung,BetragEU.buchung,SREU.buchung,BewertungssumEU.buchung,gezahltEU.buchung,vtcodema.buchung
ÿĞProvision.buchungÿ"j"
ÿµÿÁ
ÿqÿ™_ppath$ÿ"BUT1"
ÿ’ÿÉ
ÿ¾ÿaÿ™"buchung"
ÿ™"but1"
ÿ£codebu
ÿÉÿ`
ÿØÿOÿB("but1")
	ÿ™"Buchung"
	ÿÿ™"Buchung"
 
	codebu.buchungÿÿI("Buchung",1)
	codema.buchungÿcodema.but1
	datum.buchungÿdatum.but1
	krzel.buchungÿkrzel.but1
	betrag.buchungÿbetrag.but1
	sr.buchungÿsr.but1
	srauszahlung.buchungÿsrauszahlung.but1
	buchungstext.buchungÿbuchungstext.but1
	provision.buchungÿprovision.but1
	codevt.buchungÿcodevt.but1
	SRgezahlt.buchungÿsrgezahlt.but1
	Nachname.buchungÿnachname.but1
	vorname.buchungÿvorname.but1
	VS_Beginn.buchungÿVS_Beginn.but1
	Sparte.buchungÿsparte.but1
	Kndigung.buchungÿKndigung.but1
	Gesellschaft.buchungÿGesellschaft.but1
	Bewertungssumme.buchungÿBewertungssumme.but1
	Codeku.buchungÿcodeku.but1
	Volumen.buchungÿVolumen.but1
	Gesamtbetrag.buchungÿGesamtbetrag.but1
	Sperre.buchungÿsperre.but1
	gezahlt.buchungÿgezahlt.but1
	gezahlt_am.buchungÿgezahlt_am.but1
	Mahnung.buchungÿmahnung.but1
	Einheiten.buchungÿeinheiten.but1
	vtagentur.buchungÿvtagentur.but1
	vtcodema.buchungÿvtcodema.but1
	umrechnung.buchungÿumrechnung.but1
	codew.buchungÿcodew.but1
	waehrung.buchungÿwaehrung.but1
	waehrungBezeich.buchungÿwaehrungBezeich.but1
	GesamtbetragEU.buchungÿGesamtbetragEU.but1
	BetragEU.buchungÿBetragEU.but1
	SREU.buchungÿSREU.but1
	BewertungssumEU.buchungÿBewertungssumEU.but1
	gezahltEU.buchungÿgezahltEU.but1
	ÿƒQuickStore("Buchung")
	ÿ™"but1"
	ÿÉÿ±ÿ™"but1"
ÿÙ
ÿ½ CALL Fehler("D1","")
ÿ†ÿ™"but1"
ÿ½ ** CALL Server("MESSAGE","Bitte warten..." + CHR$ (10) + CHR$ (13) + "Zahlungseingang wird gel”scht.")
ÿ½ ** REMOVE FROM FILE "ZEINGANG"
ÿƒServer("MESSAGE","Bitte warten..."ÿÿ(13)ÿÿ(10)ÿ"Die Vertragsdatei wird zurckgesetzt.")
ÿÊÿË"Vertragsdatei wird zurckgesetzt..."
ÿ™"KVERTRAG"
ÿÍBewertcalcDat ÿ0:letzteProvi ÿ0:gez_Abschluá.KVERTRAGÿ"":gez_Pauschale.KVERTRAGÿ""
TZRate.KVERTRAGÿ0:letztePflege.KVERTRAGÿ0:Pool.KVERTRAGÿ0:Mahnung.KVERTRAGÿ"n"
ÿ’ÿÍ
ÿ†ÿ™"kvertrag"
ÿƒDFile(3,"kvertrag"ÿ_fpw$)
ÿ™"VKOND"
ÿÍSTORNOResGezJN.vkondÿ""
ÿ’ÿÍ
ÿ†ÿ™"vkond"
ÿƒDFile(3,"vkond"ÿ_fpw$)
ÿ½ 060497
ÿ™"Aumskto"
ÿ£codema
ÿÍkonto01 ÿ0:konto02 ÿ0:konto03 ÿ0:konto04 ÿ0:konto05 ÿ0:konto06 ÿ0:konto07 ÿ0:konto08 ÿ0:konto09 ÿ0:konto10 ÿ0:konto11 ÿ0:konto12 ÿ0:kontoGes ÿ0
konto01EU ÿ0:konto02eu ÿ0:konto03eu ÿ0:konto04eu ÿ0:konto05eu ÿ0:konto06eu ÿ0:konto07eu ÿ0:konto08eu ÿ0:konto09eu ÿ0:konto10eu ÿ0:konto11eu ÿ0:konto12eu ÿ0:kontoGeseu ÿ0
storno01 ÿ0:storno02 ÿ0:storno03 ÿ0:storno04 ÿ0:storno05 ÿ0:storno06 ÿ0:storno07 ÿ0:storno08 ÿ0:storno09 ÿ0:storno10 ÿ0:storno11 ÿ0:storno12 ÿ0:stornoGes ÿ0
storno01eu ÿ0:storno02eu ÿ0:storno03eu ÿ0:storno04eu ÿ0:storno05eu ÿ0:storno06eu ÿ0:storno07eu ÿ0:storno08eu ÿ0:storno09eu ÿ0:storno10eu ÿ0:storno11eu ÿ0:storno12eu ÿ0:stornoGeseu ÿ0
skonto01 ÿ0:skonto02 ÿ0:skonto03 ÿ0:skonto04 ÿ0:skonto05 ÿ0:skonto06 ÿ0:skonto07 ÿ0:skonto08 ÿ0:skonto09 ÿ0:skonto10 ÿ0:skonto11 ÿ0:skonto12 ÿ0:skontoGes ÿ0
skonto01EU ÿ0:skonto02eu ÿ0:skonto03eu ÿ0:skonto04eu ÿ0:skonto05eu ÿ0:skonto06eu ÿ0:skonto07eu ÿ0:skonto08eu ÿ0:skonto09eu ÿ0:skonto10eu ÿ0:skonto11eu ÿ0:skonto12eu ÿ0:skontoGeseu ÿ0
ekonto01 ÿ0:ekonto02 ÿ0:ekonto03 ÿ0:ekonto04 ÿ0:ekonto05 ÿ0:ekonto06 ÿ0:ekonto07 ÿ0:ekonto08 ÿ0:ekonto09 ÿ0:ekonto10 ÿ0:ekonto11 ÿ0:ekonto12 ÿ0:ekontoGes ÿ0
ekonto01EU ÿ0:ekonto02eu ÿ0:ekonto03eu ÿ0:ekonto04eu ÿ0:ekonto05eu ÿ0:ekonto06eu ÿ0:ekonto07eu ÿ0:ekonto08eu ÿ0:ekonto09eu ÿ0:ekonto10eu ÿ0:ekonto11eu ÿ0:ekonto12eu ÿ0:ekontoGeseu ÿ0
dkonto01 ÿ0:dkonto02 ÿ0:dkonto03 ÿ0:dkonto04 ÿ0:dkonto05 ÿ0:dkonto06 ÿ0:dkonto07 ÿ0:dkonto08 ÿ0:dkonto09 ÿ0:dkonto10 ÿ0:dkonto11 ÿ0:dkonto12 ÿ0:dkontoGes ÿ0
dkonto01EU ÿ0:dkonto02eu ÿ0:dkonto03eu ÿ0:dkonto04eu ÿ0:dkonto05eu ÿ0:dkonto06eu ÿ0:dkonto07eu ÿ0:dkonto08eu ÿ0:dkonto09eu ÿ0:dkonto10eu ÿ0:dkonto11eu ÿ0:dkonto12eu ÿ0:dkontoGeseu ÿ0
ÿ’ÿÍ
ÿ†ÿ™"aumskto"
ÿƒDFile(3,"aumskto"ÿ_fpw$)
ÿ™"Aumskto"
ÿ£codema 
ÿ™"MAADR"
ÿ£codema.maadr
ÿÍAuszahlAB.maadrÿ(erfAuszahlAB.maadrÿÿ1)ÿzusAuszahl.maadr:AuszahlEUAB.maadrÿ(erfAuszahlEUAB.maadrÿÿ1)ÿzusAuszahlEU.maadr
ÿ’ÿÍ
ÿ†ÿ™"maadr"
ÿƒDFile(3,"maadr"ÿ_fpw$)
ÿ™"MAADR"
ÿ£codema.maadr
ÿÍStornoreserve.maadrÿ0:Einheiten.maadrÿ0:EigEinheiten.maadrÿ0:GesVolumen.maadrÿ0:EigVolumen.maadrÿ0:AuszahlSperKo.maadrÿ0:AuszahlSperKoEU.maadrÿ0:StornoreserveEU.maadrÿ0
ÿ’ÿÍ
ÿ†ÿ™"maadr"
ÿƒDFile(3,"maadr"ÿ_fpw$)
ÿ™"MAADR"
ÿ£codema.maadr
ÿ½ 220697
ÿ™"Buchung"
ÿ£codema.buchung
ÿÉÿ`
ÿØÿOÿB("BUCHUNG")
	ÿ¡Buchungstext.buchungÿ"Stornorck*"ÿBetrag ÿ
0ÿp
ÿÉÿ¥codema.buchungÿáÿ™"maadr"ÿ£codema.maadr
Stornoreserve.maadrÿStornoreserve.maadrÿsr.buchung
StornoreserveEU.maadrÿÿ0(ÿ(Stornoreserve.maadrÿumrechnung.buchung,"999999999.00"))
Einheiten.maadrÿEinheiten.maadrÿEinheiten.buchung
ÿ½ Workstation.maadr = Workstation%
ÿ½ QWoNo.maadr = STR$ (Workstation%,"000000") + STR$ (codema.maadr,"000000")
RecStatus.maadrÿ"c"
ÿÌÿ™"maadr"
ÿïÿYÿ™"maadr"
ÿïÿ™"maadr"
	ÿ’ÿ¡
	ÿ™"Buchung"
	ÿÉÿ±
ÿÙ
ÿ™"Kvertrag"
ÿ½ CALL Fehler("POOL aufbauen","")
ÿƒBUKOPrep1()
ÿƒServer("UNLOADMESSAGE","")
ÿƒWriteLog(">>Korrekturbuchung ab Stichtag "ÿCalcDate$)
ÿ½ SET TODAY StartDatum$
cmonat%ÿÿ5(CalcDate$)
cjahr%ÿÿ6(CalcDate$)
ctag%ÿÿ3(CalcDate$)
ÿ½ Vertr„ge bis zum heutigen Tag hochrechnen
ÿ½ 150697 ctag% = DAY ( TODAY )
ÿ½ 030697 WHILE DAYS (CalcDate$) < TODAY 
ÿØÿ1(CalcDate$)ÿ
ÿQÿ1
	ÿƒPROVBUCHUNG(0)
	cmonat%ÿcmonat%ÿ1
	ÿ¡cmonat%ÿ13ÿp
cmonat%ÿ1
cjahr%ÿcjahr%ÿ1
	ÿ’ÿ¡
	CalcDate$ÿÿ(ctag%,"00")ÿ"."ÿÿ(cmonat%,"00")ÿ"."ÿÿ(cjahr%,"0000")
ÿÙ
ÿßÿ³
ÿÊÿÿx
ÿÊÿË"Bereit"
ÿƒCloseLog()
ÿ^
ÿƒFehler("Falsches Datumsformat!","Das Datum muá in der Form 'tt.mm.jj' eingegeben werden.")
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 Anschluss%ÿ0
 ÿ’ÿÿ
 
 ' Vorbereitung der Buchungskorrektur
 ' Aufbau der Vertragspools fr Zahlungseingangskontrolle
 ' =======================================================================

ÿÿBUKOPrep1()
 ÿ¡ÿA("ZEINGANG")ÿ
1ÿpÿ’ÿÿ
 ÿßÿe
 ÿÊÿË"Aufbau der Eingangskonten..."
 ÿƒServer("MESSAGE","Bitte warten..."ÿÿ(13)ÿÿ(10)ÿ"Die Eingangskonten werden neu aufgebaut.")
 ÿ™"ZEINGANG"
 ÿ£CodeVT.ZEINGANG
 ÿÉÿ`
 ÿÉÿ¥CodeVT.ZEINGANGÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 lv%ÿ0
 ÿØÿOÿB("ZEINGANG")
ÿ¡CodeVT.ZEINGANGÿlv%ÿp
ÿÊÿË"Aufbau der Eingangskonten...(Vertrag "ÿVS_NR.KVERTRAGÿ")"
ÿ¡lv%ÿ0ÿpÿƒQuickStore("KVERTRAG")
ÿÉÿ¥CodeVT.ZEINGANGÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
lv%ÿCodeVT.ZEINGANG
ÿ’ÿ¡
 
Pool%ÿ(Pool.KVERTRAGÿBetrag.ZEINGANG)ÿ100
pool1$ÿÿ(pool%,"999999999999")
poolges%ÿ(ÿ0(pool1$))ÿ100
pool.kvertragÿpoolges%
ÿÉÿ±ÿ™"ZEINGANG"ÿ£CodeVT.ZEINGANG
 ÿÙ
 ÿƒQuickStore("KVERTRAG")
 ÿßÿ³
 ÿ½ CALL Fehler("Poolaufbau zu ende","")
 ÿ’ÿÿ
 
 
 ' Zahlung von Stornoreserven
 ' =======================================================================
 
ÿÿSRZahlung(codevtab%)
 ÿßÿe
 ÿ¡cdate%ÿ0ÿpcdate%ÿÿQ
 ÿ™"BUCHUNG"
 ÿ¡codevtab%ÿ
1ÿp
ÿ£CodeBU.BUCHUNG
ÿÉÿ`ÿ™"Buchung"ÿ£CodeBU.BUCHUNG
 ÿ^
ÿ£codevt.BUCHUNG
ÿÉÿ`ÿ™"Buchung"ÿ£codevt.BUCHUNG
ÿÉÿ¥codevtab%ÿáÿ™"Buchung"ÿ£codevt.BUCHUNG
 ÿ’ÿ¡
 fmax%ÿÿA("BUCHUNG")
 lp%ÿ0
 cp%ÿ0
 fcount%ÿ0
 
 ÿ¡codevtab%ÿ
1ÿpÿØÿOÿB("BUCHUNG")
 ÿ¡codevtab%ÿ0ÿpÿØÿOÿB("BUCHUNG")ÿcodevt.buchungÿcodevtab%
fcount%ÿfcount%ÿ1
cp%ÿÿ(100ÿfmax%ÿfcount%)
ÿ¡lp%ÿcp%ÿp
lp%ÿcp%
ÿÊÿË"Auszahlung Stornoreserve: "ÿÿH(ÿ(lp%,"999"))ÿ"%"
ÿ’ÿ¡
ÿ½ 060497
ÿ¡SRgezahlt.BUCHUNGÿ"j"ÿSRAuszahlung.BUCHUNGÿ
cdate%ÿSRAuszahlung.BUCHUNGÿ0ÿmahnung.buchungÿ"j"ÿp
_cubu%ÿCodeBU.BUCHUNG
_CodeMA%ÿCodeMA.BUCHUNG
_CodeVT%ÿCodeVT.BUCHUNG
_SR%ÿSR.BUCHUNG
Agentur$ÿAgentur.buchung
betr%ÿSR.BUCHUNGÿÿ1
euro1%ÿumrechnung.buchung
waehr1$ÿwaehrung.buchung
codew%ÿcodew.buchung
ÿÉÿ¥_cubu%ÿáÿ™"BUCHUNG"ÿ£CodeBU.BUCHUNG
SRGezahlt.BUCHUNGÿ"j"
ÿƒQuickStore("BUCHUNG")
ÿÉÿ¥_Codema%ÿáÿ™"maadr"ÿ£codema.maadr
ÿ½ 060497
Stornoreserve.maadrÿStornoreserve.maadrÿ_SR%
StornoreserveEU.maadrÿÿ0(ÿ(Stornoreserve.maadrÿumrechnung.buchung,"999999999.00"))
ÿ½ Workstation.maadr = Workstation%
ÿ½ QWoNo.maadr = STR$ (Workstation%,"000000") + STR$ (codema.maadr,"000000")
RecStatus.maadrÿ"c"


abst%ÿStornoreserve.maadr
absteu%ÿStornoreserveEU.maadr
 
ÿ½ ****************************AUSZAHLUNGSSPERRE**********************************
eigen%ÿ0
PSpAll$ÿPROVSperreAll.maadr
PSpAllSeit%ÿPSperreAllSeit.maadr
PROVSpEig$ÿPROVSperreEig.maadr
PSpESeit%ÿPSperreESeit.maadr
ÿ½ CALL Fehler("","")
eigen%ÿ1
ÿ¡PspAll$ÿ"j"ÿp
ÿ¡PSpAllSeit%ÿ	cdate%ÿp
	ÿ½ IF ma1% = 529 THEN CALL Fehler("TRIEBSCH","")
	AuszahlSperKo.maadrÿAuszahlSperKo.maadrÿ_SR%
	AuszahlSperKoEU.maadrÿÿ0(ÿ(AuszahlSperKo.maadrÿeuro1%,"999999999.00"))
ÿ’ÿ¡
ÿ^
ÿ¡eigen%ÿ1ÿPROVSpEig$ÿ"j"ÿp
	ÿ¡PSpESeit%ÿ	cdate%ÿp
AuszahlSperKo.maadrÿAuszahlSperKo.maadrÿ_SR%
AuszahlSperKoEU.maadrÿÿ0(ÿ(AuszahlSperKo.maadrÿeuro1%,"999999999.00"))
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ ****************************AUSZAHLUNGSSPERRE Ende**********************************  
AuszahlAB.maadrÿAuszahlAB.maadrÿ_SR%
AuszahlEUAB.maadrÿÿ0(ÿ(AuszahlAB.maadrÿeuro1%,"999999999.00"))
AuszProvABGes.maadrÿAuszProvABGes.maadrÿ_SR%
AuszProvABGesEU.maadrÿÿ0(ÿ(AuszProvABGes.maadrÿeuro1%,"999999999.00"))
ÿ½ Workstation.maadr = Workstation%
ÿ½ QWoNo.maadr = STR$ (Workstation%,"000000") + STR$ (codema.maadr,"000000")
RecStatus.maadrÿ"c"
ÿÌÿ™"maadr"
ÿïÿYÿ™"maadr"
ÿ½ *****************************************************************************************************
ÿ½ Zentralberechnung des Kontostandes
zusatz%ÿ0
ÿƒZentrKTO(_CodeMA%,cdate%,_SR%,betr%,codew%,euro1%,waehr1$,PSpAll$,PSpAllSeit%,PROVSpEig$,PSpESeit%,eigen%,zusatz%,0)
ÿ½ *****************************************************************************************************  


ÿÉÿ¥_CodeVT%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿÿ™"BUCHUNG"
CodeBU.BUCHUNGÿÿI("BUCHUNG",1)
Datum.BUCHUNGÿcdate%
CodeVT.BUCHUNGÿ_CodeVT%
CodeMA.BUCHUNGÿ_CodeMA%
SR.BUCHUNGÿ0ÿ_SR%
Betrag.BUCHUNGÿ_SR%
Agentur.buchungÿAgentur$
Buchungstext.BUCHUNGÿ"SR-Auszahlung "ÿVS_Nr.KVERTRAG
Bewertungssumme.BUCHUNGÿBewertungssumme.KVERTRAG
Kndigung.BUCHUNGÿKndigung.KVERTRAG
VS_Beginn.BUCHUNGÿVS_Beginn.KVERTRAG
umrechnung.buchungÿeuro1%
codew.buchungÿcodew%
waehrung.buchungÿwaehr1$
CodeKU.BUCHUNGÿCodeKU.KVERTRAG
SReu.BUCHUNGÿÿ0(ÿ(sr.buchungÿeuro1%,"999999999.00"))
Betrageu.BUCHUNGÿÿ0(ÿ(betrag.buchungÿeuro1%,"999999999.00"))

vsumme.buchungÿvsumme.kvertrag
vsummeEU.buchungÿÿ0(ÿ(vsumme.kvertragÿeuro1%,"999999999.00"))
BeitragBrut.buchungÿBeitrag.kvertrag
BeitragNet.buchungÿNettoBeitrag.kvertrag
BeitragBrutEu.buchungÿÿ0(ÿ(Beitrag.kvertragÿumrechnung.buchung,"999999999.00"))
BeitragNetEu.buchungÿÿ0(ÿ(NettoBeitrag.kvertragÿumrechnung.buchung,"999999999.00"))
zw.buchungÿzw.kvertrag
mwst.buchungÿmwst.kvertrag
ÿ¡zw.buchungÿ0ÿp
JahresBBrut.buchungÿBeitragBrut.buchungÿzw.buchung
JahresBNet.buchungÿBeitragNet.buchungÿzw.buchung
JahresBBrutEu.buchungÿÿ0(ÿ(JahresBBrut.buchungÿumrechnung.buchung,"999999999.00"))
JahresBNetEu.buchungÿÿ0(ÿ(JahresBNet.buchungÿumrechnung.buchung,"999999999.00"))
ÿ^
JahresBBrut.buchungÿBeitragBrut.buchung
JahresBNet.buchungÿBeitragNet.buchung
JahresBBrutEu.buchungÿÿ0(ÿ(JahresBBrut.buchungÿumrechnung.buchung,"999999999.00"))
JahresBNetEu.buchungÿÿ0(ÿ(JahresBNet.buchungÿumrechnung.buchung,"999999999.00"))
ÿ’ÿ¡


ÿÉÿ¥CodeVA.kvertragÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
Sparte.BUCHUNGÿSparte.SPARTEN
ÿÉÿ¥CodeKU.KVERTRAGÿ™GAdrDat$ÿ£CodeKU.GAdrDat$
Nachname.BUCHUNGÿNachname.GAdrDat$
Vorname.BUCHUNGÿVorname.GAdrDat$
ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
Gesellschaft.BUCHUNGÿGesellschaft.GEADR
SRgezahlt.buchungÿ"j"
Provision.BUCHUNGÿ"j"
SR.buchungÿ0ÿ_SR%
ÿƒQuickStore("BUCHUNG")
ÿÉÿ¥_cubu%ÿ™"BUCHUNG"ÿ£CodeBU.BUCHUNG
ÿ’ÿ¡
ÿ¡codevtab%ÿ
1ÿpÿÉÿ±ÿ™"BUCHUNG"ÿ£CodeBU.BUCHUNG
ÿ¡codevtab%ÿ0ÿpÿÉÿ±ÿ™"BUCHUNG"ÿ£CodeVT.BUCHUNG
 ÿÙ
 ÿßÿ³
 ÿ’ÿÿ
 



 

 
 
 '********************************************************************************************************************
 '*         PROVISIONSABRECHNUNG - RealCASH                                                                          *
 '********************************************************************************************************************

ÿÿPROVBUZEIN()
 ÿ¡disabled%("BUCHUNG6")ÿpÿ’ÿÿ
 ÿ¡GVertrID%ÿ0ÿp
ÿ½ supervis im exclusiv-modus ”ffnen, um herauszufinden, ob noch jemand im Programm eingeloggt ist
ÿ¡ÿ´("supervis")ÿpÿ†ÿ™"supervis"
ÿƒDFile(4,"supervis"ÿ_fpw$)
 ÿ’ÿ¡
 ÿ¡ÿOÿ´("buchung1")ÿpÿƒDFile(3,"buchung1"ÿ_fpw$)
 ÿ¡ÿOÿ´("zeingan1")ÿpÿƒDFile(3,"zeingan1"ÿ_fpw$)
 ÿ¡ÿOÿ´("sparten")ÿpÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿ¡ÿOÿ´("geadr")ÿpÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿ¡ÿOÿ´("gekond")ÿpÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿ¡ÿOÿ´("maadr")ÿpÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿ¡ÿOÿ´("maadrgru")ÿpÿƒDFile(3,"maadrgru"ÿ_fpw$)
 ÿ¡ÿOÿ´("kvertrag")ÿpÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿ¡ÿOÿ´("kvfael")ÿpÿƒDFile(3,"kvfael"ÿ_fpw$)
 ÿ¡ÿOÿ´("vkond")ÿpÿƒDFile(3,"vkond"ÿ_fpw$)
 ÿ¡ÿOÿ´("spezkond")ÿpÿƒDFile(3,"spezkond"ÿ_fpw$)
 ÿ¡ÿOÿ´("foerkond")ÿpÿƒDFile(3,"foerkond"ÿ_fpw$)
 ÿ¡ÿOÿ´(GADRDat$)ÿpÿƒDFile(2,"OFFICE\"ÿGADRDat$ÿ_fpw$)
 ÿ¡ÿA("maadr")ÿ
20000ÿp
ÿÿGAGvonFirma$(ÿA("maadr"))
ÿÿGAGvonAgentur$(ÿA("maadr"))
ÿÿGAGFrAgentur$(ÿA("maadr"),2)
 ÿ^
ÿÿGAGvonFirma$(20000)
ÿÿGAGvonAgentur$(20000)
ÿÿGAGFrAgentur$(20000,2)
 ÿ’ÿ¡
 PROVBU$ÿ"TRUE"
 ÿ¡anschluss%ÿ0ÿp

CalcDate$ÿÿ(ÿQ,"0d.mm.yyyy")
ÿ¡GVertrID%ÿ0ÿp
ÿÉÿ`ÿ™"STAMM"
GRealStorno%ÿRealStorno.stamm
ÿ¡DateOK%(CalcDate$)ÿp
ok%ÿ1
CalcDate%ÿÿ1(CalcDate$)
ÿ¡codevtab%ÿ0ÿpÿƒWriteConfig("PROVIS","letzteProvisionsrechnung",CalcDate$)
ÿ^
ok%ÿ0
ÿƒFehler("Falsche Datumsangabe!","Bitte geben Sie das Datum in der Form 'tt.mm.jjjj' ein.")
ÿ’ÿ¡
ÿ¡ProvSperreJN.kvertragÿ"j"ÿp
ok%ÿ0
ÿ’ÿ¡
ÿ^
ÿ‰ÿñ"STICHTAG",0,0,222,114,"Buchungsdatum","MS Sans Serif",8
ÿ|ÿñ"STICHTAG",4,0,0,222,91,0,""
ÿ|ÿñ"STICHTAG",9,6,9,23,24,2
ÿ|ÿñ"STICHTAG",5,31,15,183,10,0,"Bitte geben Sie an, bis zu welchem ZE-Datum"
ÿ|ÿñ"STICHTAG",5,31,25,183,10,0,"die Zahlungseing„nge verarbeitet werden sollen:"
ÿ|ÿñ"STICHTAG",6,94,72,42,12,0,0,CalcDate$,10
ÿ|ÿñ"STICHTAG",5,30,74,58,10,0,"Buchungsdatum:"
ÿ|ÿñ"STICHTAG",1,52,94,54,14,1,"&OK",1,1
ÿ|ÿñ"STICHTAG",1,109,94,54,14,0,"&Abbrechen",0,0
ÿñ"STICHTAG",req%
ÿ¾ÿñ"STICHTAG"
ÿ¡req%ÿ1ÿp
ÿÉÿ`ÿ™"STAMM"
GRealStorno%ÿRealStorno.stamm
ÿ¡DateOK%(CalcDate$)ÿp
	ok%ÿ1
	CalcDate%ÿÿ1(CalcDate$)
	ÿ¡codevtab%ÿ0ÿpÿƒWriteConfig("PROVIS","letzteProvisionsrechnung",CalcDate$)
ÿ^
	ok%ÿ0
	ÿƒFehler("Falsche Datumsangabe!","Bitte geben Sie das Datum in der Form 'tt.mm.jjjj' ein.")
ÿ’ÿ¡
ÿ^
Greqstati%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ^
ok%ÿ1
 ÿ’ÿ¡
 ÿ¡ok%ÿ1ÿp
ÿ½ 260698
ÿßÿe
ÿÊÿË"Bitte warten, es wird zun„chst die Zahlungseingangsdatei geprft"
ÿ¾ÿaÿ™"Zeingan1"ÿĞcodevt.zeingan1ÿ
1
ÿÊÿË""
cdate%ÿÿ1(CalcDate$)
minimize$ÿReadINI$("PROVIS","minimize")
ÿ¡anschluss%ÿ0ÿp
ÿ¡minimize$ÿ"TRUE"ÿp
ÿÂ"PROVIS wird in den Hintergrund geschaltet!","Sie k”nnen w„hrend der Berechung andere Programme starten.",0
ÿÊÿÿÚ
ÿ’ÿ¡
ÿƒCreateLog()
ÿ’ÿ¡
ÿƒWriteLog("")
ÿƒWriteLog("=================================")
ÿƒWriteLog("Provisionsabrechnung vom "ÿÿ(cdate%,"0d.mm.yyyy"))
ÿƒWriteLog("=================================")
ÿƒWriteLog("")
ÿßÿe
ÿ™"zeingan1"
ÿ½ INDEX gebuchtJN.zeingan1
ÿ£codeaz.zeingan1
ÿ¡ÿA("zeingan1")ÿ0ÿp
ÿÉÿ`ÿá
ÿ^
ÿÉÿb
ÿ’ÿ¡
ÿ¡GVertrID%ÿ0ÿp
ÿ¡ÿJ(GVertrID%,codevt.zeingan1)ÿp
ÿ™"zeingan1"
ÿ£codevt.zeingan1
ÿÉÿ`ÿ™"zeingan1"ÿ£codevt.zeingan1
ÿÉÿ¥GVertrID%ÿáÿ™"zeingan1"ÿ£codevt.zeingan1
ÿ¡GZEID%ÿ0ÿp
	ÿÉÿ¥GZEID%ÿáÿ™"zeingan1"ÿ£codeaz.zeingan1
	ÿ¡codeaz.zeingan1ÿGZEID%ÿp
ÿÉÿ`ÿ™"zeingan1"ÿ£codeaz.zeingan1
ÿÉÿ¥GZEID%ÿáÿ™"zeingan1"ÿ£codeaz.zeingan1
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿƒFehler("Zu diesem Vertrag existieren noch keine Zahlungseing„nge!","Verarbeitung kann nicht fortgesetzt werden!")
ÿ’ÿÿ
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ IF UCASE$ (gebuchtJN.zeingan1) <> "N" THEN 
ÿ½ ON ERROR GOTO zaa2208971
ÿ½ SELECT KEY "N" LOCK FILE "zeingan1" INDEX gebuchtJN.zeingan1
ÿ½ GOTO zaa2208972
zaa2208971: 
ÿ½ SELECT LAST 
ÿ½ END IF 
ÿ³ÿ_ÿwErrorHandler
zaa2208972: 
_p1%ÿÿA("zeingan1")
_pd$ÿ"0"
_pd%ÿÿ1
_p2%ÿ0
gebuchtJN$ÿ"N"
f%ÿ0
ff%ÿ0
ÿ½ WHILE NOT EOF ("zeingan1") AND gebuchtJN.zeingan1 = gebuchtJN$
ÿ¡GVertrID%ÿ0ÿpÿØÿOÿB("zeingan1")ÿcodevt.zeingan1ÿGVertrID%
ÿ¡GVertrID%ÿ0ÿpÿØÿOÿB("zeingan1")
ÿ½ testaz% = codeaz.zeingan1
ÿ¡codeaz.zeingan1ÿ80ÿp
ÿ½ CALL Fehler("codaz=80","")
ÿ’ÿ¡
geb$ÿgebuchtJNT.zeingan1
ÿ¡geb$ÿ"J"ÿgebuchtJN.zeingan1ÿ"J"ÿp
ca%ÿcodeaz.zeingan1
ÿ¡ÿOÿJ(codeaz.zeingan1,codeaz.buchung1)ÿp
ÿ½ Satz wurde schon auf "J" gesetzt, aber keine Buchungen da, wahrscheinlich Rechner abgestrzt
ÿƒWriteLog("  ZE war schon auf zwischenverarbeitet gesetzt, ab keine Buchung da: VS_NR: "ÿVS_NR.KVERTRAG)
gebuchtJNT.zeingan1ÿ""
ÿÌÿ™"zeingan1"
ÿÉÿ`ÿ™"zeingan1"ÿ£codeaz.zeingan1
ÿÉÿ¥ca%ÿáÿ™"zeingan1"ÿ£codeaz.zeingan1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡gebuchtJNT.zeingan1ÿ"J"ÿp
zzzein1%ÿcodeaz.zeingan1

ÿ½ 220897 WHILE NOT EOF ("kvertrag") AND ProviAb.KVERTRAG <= cdate%
ÿ™"zeingan1"
ÿ¡ÿOÿJ(codevt.zeingan1,lfdnr.kvertrag)ÿp
ÿ½ CALL Fehler( STR$ (lfdnr.kvertrag),"VS_NR existiert in Vertragsdatei nicht " + vs_NR.zeingan1)
ÿ^
ÿ’ÿ¡
ÿÉÿ¥codevt.zeingan1ÿ™"Kvertrag"ÿ£lfdnr.kvertrag
ÿ¡vs_nr.kvertragÿ"6134239P"ÿp
ÿ½ CALL Fehler("Bertest","6134239P")
ÿ’ÿ¡

koab%ÿCodeKO.KVERTRAG
ÿ¡ÿOÿJ(koab%,codevk.VKOND)ÿp
ok%ÿ0
ÿƒWriteLog("  Vertrag wurde noch nicht an die Provisionsabrechnung bergeben")
ÿƒAddLogInfo()
ÿ^
ok%ÿ1
ÿ’ÿ¡

ÿ½ nur noch Zahlungseing„nge bis zu einem bestimmten Datum hochrechnen lassen
CalcDate%ÿÿ1(CalcDate$)
ÿ¡BuchungsDatum.zeingan1ÿCalcDate%ÿp
ok%ÿ0
ÿƒWriteLog("Zahlungseingang liegt auáerhalb des Berechnugsdatums: "ÿÿ(BuchungsDatum.zeingan1,"0d.mm.yyyy")ÿ" "ÿBuchungstext.zeingan1ÿ"  "ÿÿ(Bewertung.zeingan1))
ÿ’ÿ¡

ÿ½ Prfen auf Vorhandensein von Spezialprovisionen und ob dort welche existieren, die zun„chst von der
ÿ½ Bewertung der Firma abgezogen werden, um den Restbetrag als 100% darzustellen
GVonFirma$ÿ"n"
ÿ²",999999999.0000"
ÿ¡ProvSperreJN.kvertragÿ"j"ÿp
ok%ÿ0
ÿƒWriteLog("  Vertrag hat Provisionssperre: "ÿVS_NR.Kvertragÿ"/"ÿGesellschaft.kvertragÿ"/"ÿsparte.kvertragÿ"/"ÿAgentur.kvertragÿ"/"ÿVNehmer.kvertrag)
ÿƒWriteLog("  ")
ÿ’ÿ¡
 
ÿ¡ÿJ(lfdnr.kvertrag,codevt.spezkond)ÿSpezProvAktiv.kvertragÿ"j"ÿok%ÿ1ÿp
anzagvF%ÿ0
anzagvA%ÿ0
anzagvFre%ÿ0

ÿØGAGvonFirma$(anzagvF%)ÿ""
	GAGvonFirma$(anzagvF%)ÿ""
	anzagvF%ÿanzagvF%ÿ1
ÿÙ
ÿØGAGvonAgentur$(anzagvA%)ÿ""
	GAGvonAgentur$(anzagvA%)ÿ""
	anzagvA%ÿanzagvA%ÿ1
ÿÙ
ÿØGAGFrAgentur$(anzagvFre%,0)ÿ""
	GAGFrAgentur$(anzagvFre%,0)ÿ""
	GAGFrAgentur$(anzagvFre%,1)ÿ""
	anzagvFre%ÿanzagvFre%ÿ1
ÿÙ
anzagvF%ÿ0
anzagvA%ÿ0
anzagvFre%ÿ0

GSpezko$ÿ"j"
GVonFirma$ÿ"n"
ÿ½ CALL Fehler("Andi-Kondtest","")
ÿ½ SELECT FIRST FILE "spezkond" INDEX codevt.spezkond
ÿ½ SELECT KEY lfdnr.kvertrag FILE "spezkond" INDEX codevt.spezkond
file1$ÿÿ™
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿSpezProvNormal.stammÿ"j"ÿp
	ÿ™"spezkond"
	ÿ£QCodeVTsort.spezkond
	QCodeVTsort$ÿÿ(lfdnr.kvertrag,"000000")ÿ"000000"
	ÿÉÿ`ÿ™"spezkond"ÿ£QCodeVTsort.spezkond
	ÿÉÿ¥QCodeVTsort$ÿ™"spezkond"ÿ£QCodeVTsort.spezkond
ÿ^
	ÿ™"spezkond"
	ÿ£QCodeVTMA.spezkond
	QCodeVTMA$ÿÿ(lfdnr.kvertrag,"000000")ÿ"000000"
	ÿÉÿ`ÿ™"spezkond"ÿ£QCodeVTMA.spezkond
	ÿÉÿ¥QCodeVTMA$ÿ™"spezkond"ÿ£QCodeVTMA.spezkond
ÿ’ÿ¡
ÿØÿOÿB("spezkond")ÿcodevt.spezkondÿlfdnr.kvertrag
	ja%ÿÿ1
	ÿ¡vonFirmaAgentur.spezkondÿ"n"ÿp
GVonFirma$ÿ"j"
ÿ¡einmalig.spezkondÿ"j"ÿp
ÿ¡kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿkondart.zeingan1ÿ4ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonAP.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ1ÿp
ÿ¡vonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ2ÿkondart.zeingan1ÿ5ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonAP.spezkondÿ"j"ÿp
ÿ¡vonPflege.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡ja%ÿÿ1ÿp
GAGvonFirma$(anzagvF%)ÿQCodeVTMA.spezkond
GVonFirma$ÿ"j"
anzagvF%ÿanzagvF%ÿ1
ÿ’ÿ¡
ÿ^
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿkondart.zeingan1ÿ4ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonAP.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ1ÿp
ÿ¡vonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ2ÿkondart.zeingan1ÿ5ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonAP.spezkondÿ"j"ÿp
ÿ¡vonPflege.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡ja%ÿÿ1ÿp
GAGvonFirma$(anzagvF%)ÿQCodeVTMA.spezkond
GVonFirma$ÿ"j"
anzagvF%ÿanzagvF%ÿ1
ÿ’ÿ¡
ÿ^
ÿ¡sr.spezkondÿ0ÿBewertung.zeingan1ÿ
0ÿp
ÿ¡kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿkondart.zeingan1ÿ4ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonAP.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ1ÿp
ÿ¡vonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ2ÿkondart.zeingan1ÿ5ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonAP.spezkondÿ"j"ÿp
ÿ¡vonPflege.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡ja%ÿÿ1ÿp
GAGvonFirma$(anzagvF%)ÿQCodeVTMA.spezkond
GVonFirma$ÿ"j"
anzagvF%ÿanzagvF%ÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ^
ÿ¡vonFirmaAgentur.spezkondÿ"j"ÿp
GVonFirma$ÿ"n"
ÿ½ CALL Fehler("Andi Spezkondi test","")
akondart%ÿkondart.zeingan1
ÿ¡einmalig.spezkondÿ"j"ÿp
ÿ¡kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿkondart.zeingan1ÿ4ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonAP.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ1ÿp
ÿ¡vonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ2ÿkondart.zeingan1ÿ5ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonAP.spezkondÿ"j"ÿp
ÿ¡vonPflege.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡ja%ÿÿ1ÿp
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿSpezProvNormal.stammÿ"j"ÿp
GAGvonAgentur$(anzagvA%)ÿQCodeVTsort.spezkond
ÿ^
GAGvonAgentur$(anzagvA%)ÿQCodeVTMA.spezkond
ÿ’ÿ¡
anzagvA%ÿanzagvA%ÿ1
ÿ’ÿ¡
ÿ^
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿkondart.zeingan1ÿ4ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonAP.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ1ÿp
ÿ¡vonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ2ÿkondart.zeingan1ÿ5ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonAP.spezkondÿ"j"ÿp
ÿ¡vonPflege.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡ja%ÿÿ1ÿp
ÿ½ GAGvonAgentur$(anzagvA%) = QCodeVTMA.spezkond
 
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿSpezProvNormal.stammÿ"j"ÿp
GAGvonAgentur$(anzagvA%)ÿQCodeVTsort.spezkond
ÿ^
GAGvonAgentur$(anzagvA%)ÿQCodeVTMA.spezkond
ÿ’ÿ¡
anzagvA%ÿanzagvA%ÿ1
ÿ’ÿ¡
ÿ^
ÿ¡sr.spezkondÿ0ÿBewertung.zeingan1ÿ
0ÿp
ÿ¡kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿkondart.zeingan1ÿ4ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonAP.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ1ÿp
ÿ¡vonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ2ÿkondart.zeingan1ÿ5ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonAP.spezkondÿ"j"ÿp
ÿ¡vonPflege.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡ja%ÿÿ1ÿp
ÿ½ GAGvonAgentur$(anzagvA%) = QCodeVTMA.spezkond
 
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿSpezProvNormal.stammÿ"j"ÿp
GAGvonAgentur$(anzagvA%)ÿQCodeVTsort.spezkond
ÿ^
GAGvonAgentur$(anzagvA%)ÿQCodeVTMA.spezkond
ÿ’ÿ¡
anzagvA%ÿanzagvA%ÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡vonFirmaAgentur.spezkondÿ"c"ÿp
GVonFirma$ÿ"c"
ÿ¡einmalig.spezkondÿ"j"ÿp
ÿ¡kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿkondart.zeingan1ÿ4ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonAP.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ1ÿp
ÿ¡vonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ2ÿkondart.zeingan1ÿ5ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonAP.spezkondÿ"j"ÿp
ÿ¡vonPflege.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡ja%ÿÿ1ÿp
GAGFrAgentur$(anzagvFre%,0)ÿQCodeVTMA.spezkond
GAGFrAgentur$(anzagvFre%,1)ÿÿ(vonCodeMA.spezkond,"000000")
anzagvFre%ÿanzagvFre%ÿ1
ÿ’ÿ¡
ÿ^
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿkondart.zeingan1ÿ4ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonAP.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ1ÿp
ÿ¡vonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ2ÿkondart.zeingan1ÿ5ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonAP.spezkondÿ"j"ÿp
ÿ¡vonPflege.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡ja%ÿÿ1ÿp
GAGFrAgentur$(anzagvFre%,0)ÿQCodeVTMA.spezkond
GAGFrAgentur$(anzagvFre%,1)ÿÿ(vonCodeMA.spezkond,"000000")
anzagvFre%ÿanzagvFre%ÿ1
ÿ’ÿ¡
ÿ^
ÿ¡sr.spezkondÿ0ÿBewertung.zeingan1ÿ
0ÿp
ÿ¡kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿkondart.zeingan1ÿ4ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonAP.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ1ÿp
ÿ¡vonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ2ÿkondart.zeingan1ÿ5ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿvonAP.spezkondÿ"j"ÿp
ÿ¡vonPflege.spezkondÿ"j"ÿpja%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡ja%ÿÿ1ÿp
GAGFrAgentur$(anzagvFre%,0)ÿQCodeVTMA.spezkond
GAGFrAgentur$(anzagvFre%,1)ÿÿ(vonCodeMA.spezkond,"000000")
anzagvFre%ÿanzagvFre%ÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ½ SELECT NEXT FILE "spezkond" INDEX codevt.spezkond
	ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿSpezProvNormal.stammÿ"j"ÿp
ÿÉÿ±ÿ™"spezkond"ÿ£QCodeVTsort.spezkond
	ÿ^
ÿÉÿ±ÿ™"spezkond"ÿ£QCodeVTMA.spezkond
	ÿ’ÿ¡
ÿÙ
ÿ™file1$
ÿ^
GSpezko$ÿ"n"
ÿ’ÿ¡
GAGvonFirma$(anzagvF%)ÿ""
GAGvonAgentur$(anzagvA%)ÿ""
GAGFrAgentur$(anzagvFre%,0)ÿ""
GAGFrAgentur$(anzagvFre%,1)ÿ""
ÿ½ -----------------------------------------
ÿ½ -- Prozentbalken und Header aktualisieren
ÿ½ -----------------------------------------
 
ÿÊÿË"prfe ZE: "ÿÿH(ÿ(_p2%,"999999"))ÿ" von "ÿÿH(ÿ(_p1%,"999999"))ÿ" tats. fr Verarb. vorgeschl.: "ÿÿH(ÿ(ff%,"999999"))ÿ" bereits vorher verarbeitet: "ÿÿH(ÿ(f%,"999999"))
_pc%ÿÿ (100ÿ_p1%ÿ_p2%,0)
ÿ¡_pd%ÿ_pc%ÿp
_pd%ÿ_pc%
ÿ¡ÿåsys(11)ÿ36ÿÿåsys(12)ÿ36ÿp
	ÿ¡anschluss%ÿ0ÿp
ÿÊÿŸÿ(_pd%,"999")ÿ"%"
	ÿ^
ÿÊÿŸÿ(_pd%,"999")ÿ"% "ÿÿH(ÿ(ÿ5(cdate%),"00"))ÿ"/"ÿÿ-(ÿ(ÿ6(cdate%),"9999"),4)
	ÿ’ÿ¡
ÿ^
	ÿ¡anschluss%ÿ0ÿp
ÿÊÿŸtitle$ÿ" - Provisionsberechung: "ÿÿ(_pd%,"999")ÿ"% erledigt"
	ÿ^
ÿÊÿŸtitle$ÿ" - Provisionsberechung: "ÿÿ(_pd%,"999")ÿ"% "ÿÿH(ÿ(ÿ5(cdate%),"99"))ÿ"/"ÿÿ-(ÿ(ÿ6(cdate%),"9999"),2)
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ½ --------------------------------------
ÿ½ -- CheckUp fr Vertragsprovisionierung
ÿ½ --------------------------------------
ÿ½ ok% = 1

ÿ½ ------------------------
ÿ½ -- Aufruf der Berechnung
ÿ½ ------------------------
ÿ¡ok%ÿ1ÿp
gezPflege%ÿ0
gezPauschale%ÿ0
gezAbschluá%ÿ0
gezStornoRes%ÿ0
GStornoDiff%ÿ0
ÿ½ CALL Fehler("ab hier testen wegen Einzelberechnung!","")
ÿƒPROVISZEIN2()
ff%ÿff%ÿ1
ÿ’ÿ¡
ÿ™"zeingan1"
ÿ¡GVertrID%ÿ0ÿp
ÿ£codeaz.zeingan1
ÿÉÿ`ÿ™"zeingan1"ÿ£codeaz.zeingan1
ÿÉÿ¥zzzein1%ÿ™"zeingan1"ÿ£codeaz.zeingan1
ÿ^
ÿ£codeaz.zeingan1
ÿÉÿ`ÿ™"zeingan1"ÿ£codeaz.zeingan1
ÿÉÿ¥zzzein1%ÿ™"zeingan1"ÿ£codeaz.zeingan1
ÿ’ÿ¡
ÿ^
f%ÿf%ÿ1
ÿÊÿË"Suche nach nicht verarbeiteten Zahlungseing„ngen, schon verarbeitet: "ÿÿ(f%,",9999999")
ÿ’ÿ¡
ÿ½ SELECT NEXT LOCK FILE "zeingan1" INDEX gebuchtJN.zeingan1
ÿ¡GVertrID%ÿ0ÿp
ÿÉÿ±ÿáÿ™"zeingan1"ÿ£codeaz.zeingan1
ÿ^
ÿ™"zeingan1"
ÿ£codevt.zeingan1
ÿÉÿ±ÿáÿ™"zeingan1"ÿ£codevt.zeingan1
ÿ’ÿ¡
ÿ¡codeaz.zeingan1ÿzzzein1%ÿÿOÿB("zeingan1")ÿGVertrID%ÿ0ÿp
ÿ½ CALL Fehler("Fehlerkorrektur interne CODEAZ: " + STR$ (codeaz.zeingan1,"000000"),"Der Fehler wird automatisch korrigiert und die Verarbeitung nochmal begonnen!")
_p2%ÿÿI("zeingan1",1)
_p2%ÿÿI("zeingan1",1)
codeaz.zeingan1ÿÿI("zeingan1",1)
ÿÌÿ™"zeingan1"
ÿïÿYÿ™"zeingan1"
ÿÉÿ`ÿáÿ™"zeingan1"ÿ£codeaz.zeingan1
_p2%ÿ0
f%ÿ0
ff%ÿ0
ÿÊÿË"Fehlerkorrektur"
ÿ’ÿ¡
ÿ½ gebuchtJN$ = gebuchtJN.zeingan1
_p2%ÿ_p2%ÿ1
ÿÙ
ÿ¡GVertrID%ÿ0ÿp
ÿ™"zeingan1"
ÿ£codeaz.zeingan1
ÿÉÿ`ÿá
j%ÿÿA("Zeingan1")
i%ÿ0
f%ÿ0
ze%ÿ0
ÿØÿOÿB("Zeingan1")
i%ÿi%ÿ1
ÿ¡gebuchtJNT.zeingan1ÿ"J"ÿgebuchtJN.zeingan1ÿ"J"ÿp
	gebuchtjn.zeingan1ÿ"J"
	ÿÌÿ™"zeingan1"
	ÿïÿYÿ™"zeingan1"
ÿ^
	ÿ¡gebuchtJNT.zeingan1ÿ"J"ÿp
f%ÿf%ÿ1
ÿ¡Bewertung.zeingan1ÿ0ÿp
ze%ÿze%ÿ1
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿÊÿËÿ(i%,",99999999")ÿ" von "ÿÿ(j%,",99999999")ÿ" bearbeitet, nicht verarbeitete Zahlungseing„nge "ÿÿ(f%,",99999999")ÿ" / davon mit Wert 0,00 "ÿÿ(ze%,",99999999")
ÿÉÿ±ÿáÿ™"zeingan1"ÿ£codeaz.zeingan1
ÿÙ
ÿ^
ÿ™"zeingan1"
ÿ£codevt.zeingan1
ÿÉÿ`
ÿÉÿ¥GVertrID%ÿáÿ™"zeingan1"ÿ£codevt.zeingan1
j%ÿÿA("Zeingan1")
i%ÿ0
f%ÿ0
ÿØÿOÿB("Zeingan1")ÿcodevt.zeingan1ÿGVertrID%
i%ÿi%ÿ1
ÿ¡gebuchtJNT.zeingan1ÿ"J"ÿgebuchtJN.zeingan1ÿ"J"ÿp
	gebuchtjn.zeingan1ÿ"J"
	ÿÌÿ™"zeingan1"
	ÿïÿYÿ™"zeingan1"
ÿ^
	ÿ¡gebuchtJNT.zeingan1ÿ"J"ÿp
f%ÿf%ÿ1
ÿ¡Bewertung.zeingan1ÿ0ÿp
ze%ÿze%ÿ1
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿÊÿËÿ(i%,",99999999")ÿ" von "ÿÿ(j%,",99999999")ÿ" bearbeitet, nicht verarbeitete Zahlungseing„nge "ÿÿ(f%,",99999999")ÿ" / davon mit Wert 0,00 "ÿÿ(ze%,",99999999")
ÿÉÿ±ÿáÿ™"zeingan1"ÿ£codevt.zeingan1
ÿÙ
ÿ’ÿ¡
GnoverZein%ÿf%
ÿ¡Greqstati%ÿ1ÿp
ÿ¡GAFSK$ÿ"TRUE"ÿp
ÿÂ"nicht verarbeitete Zahlungseing„nge "ÿÿ(GnoverZein%,"99999999"),"Siehe dazu Protokolldatei!",2
ÿ^
ÿƒFehler("nicht verarbeitete Zahlungseing„nge "ÿÿ(GnoverZein%,"99999999")ÿ" / davon mit Wert 0,00 "ÿÿ(ze%,",99999999"),"Siehe dazu Protokolldatei!")
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ UPDATE gebuchtjn.zeingan1 = gebuchtjnT.zeingan1 WHERE UCASE$ (gebuchtJNT.zeingan1) = "J"
ÿ½ END UPDATE 
e230897: 
ÿ³ÿ_ÿwErrorHandler
ÿ™"maadr"
ÿÉÿ`
ÿ™"Buchung1"
ÿÉÿ`
ÿ½ 26022003
ÿ½ CALL Fehler(ReadConfig$("PROVIS","SkipStorno"),"")
ÿ¡ReadConfig$("PROVIS","SkipStorno")ÿ"TRUE"ÿp
ÿ½ 
ÿ^
ÿƒSRZahlungZein()
ÿ’ÿ¡
ÿ¡anschluss%ÿ0ÿp
ÿßÿ³
ÿÊÿÿx
ÿÊÿŸtitle$ÿ" - Buchung"
ÿÊÿË"Provisionsabrechnung beendet"
ÿ¡GAFSK$ÿ"TRUE"ÿp
ÿ^
ÿƒCloseLog()
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡GAFSK$ÿ"TRUE"ÿp
ÿ½ todo
ÿÂ"Nachkontrolle der Vertragss„tze auf fehlende ZE","",2
ÿ½ Nachkontrolle der Vertragss„tze auf fehlende ZE
b%ÿÿ1(calcdate$)
b$ÿÿ(b%,"mm.yyyy.0d")
bumon%ÿÿ0(ÿ+(b$,2))
ÿ½ CALL Fehler( STR$ (bumon%,"00")," Buchungsmonat")
ÿ™"KVFAEL"
ÿ£codevt.kvfael
ÿÉÿ`ÿáÿ™"KVFAEL"ÿ£codevt.kvfael
ÿ½ SELECT KEY "n" LOCK FILE "KVFAEL" INDEX erledigt.kvfael
ÿ½ WHILE NOT EOF ("KVFAEL") AND erledigt.kvfael <> "j"
z2606021%ÿ0
ÿØÿOÿB("KVFAEL")
erstz%ÿ0
ÿ¡f„lligam.kvfaelÿ0ÿabserledigt.kvfaelÿ"j"ÿp
	ÿ½ CALL Fehler("f„„lig am","")
	erwProvAnz%ÿerwProvAnz.kvfael
	ÿ¡erwProvAnz.kvfaelÿ0ÿperwProvAnz%ÿ4
	ÿÉÿ`ÿ™"KVERTRAG"ÿ£lfdnr.kvertrag
	ÿÉÿ¥codevt.kvfaelÿ™"KVERTRAG"ÿ£lfdnr.kvertrag
	GVTcodema%ÿcodema.kvertrag
	ÿÉÿ`ÿ™"maadr"ÿ£codema.maadr
	ÿÉÿ¥GVTcodema%ÿ™"maadr"ÿ£codema.maadr
	GVTAgentur$ÿNachname.maadrÿ","ÿvorname.maadr
	ÿ½ 07082003  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 
	codevp%ÿcodevp.kvertrag
	ÿÉÿ`ÿ™"VPRODUKT"ÿ£codevp.vprodukt
	ÿÉÿ¥codevp%ÿ™"VPRODUKT"ÿ£codevp.vprodukt
	ÿÉÿ`ÿ™"VPGekond"ÿ£codevp.VPGekond
	ÿÉÿ¥codevp%ÿ™"VPGekond"ÿ£codevp.VPGekond
	erwProvAnzVP%ÿerwProvAnzVP.vpgekond
	ÿ¡erwProvAnzVP%ÿ0ÿperwProvAnzVP%ÿ6
	ÿ½ * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 
	ÿ½ 16012003
	ÿ¡vs_nr.kvertragÿ"321654987*"ÿp
ÿ½ CALL Fehler("321654987","Test auf Storno")
	ÿ’ÿ¡
	ÿ½ erwProv% = Beitrag.kvertrag * erwProvAnz%
	erwProv%ÿVMProv.kvfael
	Beitrag%ÿBeitrag.kvertrag
	ÿ½ 07082003 test1% = VAL ( LEFT$ ( DATE$ (f„lligam.kvfael,"mm.yyyy.0d"),2)) + erwProvAnz%
	tafael$ÿÿ(f„lligam.kvfael,"0d.mm.yyyy")
	test1%ÿÿ0(ÿ+(ÿ(f„lligam.kvfael,"mm.yyyy.0d"),2))ÿerwProvAnzVP%
	jahrtest%ÿÿ0(ÿ+(ÿ(f„lligam.kvfael,"yyyy.mm.0d"),4))
	jahrtoday%ÿjahrtest%
	aktjahr%ÿÿ0(ÿ+(ÿ(ÿQ,"yyyy.mm.0d"),4))
	ÿ¡test1%ÿ12ÿp
t1%ÿtest1%ÿ12
test1%ÿt1%
jahrtest%ÿjahrtest%ÿ1
	ÿ’ÿ¡
	ÿ¡TatsKuenDat.kvertragÿ0ÿp
test1%ÿbumon%
	ÿ’ÿ¡
	ÿ¡vs_nr.kvertragÿ"321654987*"ÿp
ÿ½ CALL Fehler("F„lligkeit: " + DATE$ (f„lligam.kvfael,"0d.mm.yyyy") + " jetzt " + STR$ (bumon%,"00") + " " + STR$ (aktjahr%,"0000")," Kndigung: " + STR$ (test1%,"00") + " " + STR$ (jahrtest%,"0000"))
	ÿ’ÿ¡
	ÿ¡test1%ÿ	bumon%ÿjahrtest%ÿaktjahr%ÿp
ÿ½ 4.-> auf 6.(ge„ndert erwProvAnzVP% aus erwProvAnzVP.vpgekond) Zahlung  nicht erolgt, Provosion muá zurckgerechnet werden
ÿ½ CALL Fehler( STR$ (bumon%,"00"), STR$ (test%,"00"))
ÿ½ SELECT FIRST FILE "KVERTRAG" INDEX lfdnr.kvertrag
ÿ½ SELECT KEY codevt.kvfael FILE "KVERTRAG" INDEX lfdnr.kvertrag
 
ÿ½ erwProv% = Beitrag.kvertrag * 4
gezprov%ÿgezProv.kvfaelÿ2.0
gezprov$ÿÿH(ÿ(gezprov%,"99999999.00"))
erwProv$ÿÿH(ÿ(erwProv%,"99999999.00"))
erwProv%ÿÿ0(erwProv$)
gezprov%ÿÿ0(gezProv$)
ÿ¡gezProv%ÿ
erwProv%ÿp
ÿ¡gez_Abschluá.kvfaelÿ"j"ÿp
ÿ½ es wurde Provision gezahlt
ÿ½ CALL Fehler("zu wenig gezahlter Beitrag","")

ÿƒWriteLog("Stornierung: "ÿvs_nr.kvertragÿ" -F„lligkeit war: "ÿÿ(f„lligam.kvfael,"0d.mm.yyyy")ÿ" Knd.Monat: "ÿÿ(test1%,"00")ÿ"/"ÿÿ(jahrtest%,"0000"))

ÿÉÿ`ÿ™"buchung1"ÿ£codevt.buchung1
ÿÉÿ¥codevt.kvfaelÿ™"buchung1"ÿ£codevt.buchung1
ÿ½ 12112001
ÿ½ also beim rckbuchen máte zuerst die VMProv mit negativem Wert der Fa. 
ÿ½ gutgeschrieben werden und es máte der erste Minusbetrag auf pos Betrag 
ÿ½ gesetzt werden
ÿ½ dann die Buchungen der MA einsammeln und mit negativem Vorzeichen dazu 
ÿ½ Buchungssatz erstellen und in kvfael -> TgezProvAnz=0
ÿ½ 
ÿÉÿ`ÿ™"buchung1"ÿ£codebu.buchung1
ÿÉÿ¥codebu.kvfaelÿ™"buchung1"ÿ£codebu.buchung1
ÿ½ ma%=Firma
ma%ÿcodema.buchung1
ÿ³ÿ_ÿwdimerr260620021
ÿ×gez%(10000,2)
dimerr260620021: 
ÿ³ÿ_ÿwErrorHandler
ÿÿgez%(10000,2)
ÿÉÿ`ÿ™"buchung1"ÿ£codevt.buchung1
ÿÉÿ¥codevt.kvfaelÿ™"buchung1"ÿ£codevt.buchung1
ÿ½ SELECT FIRST FILE "kvertrag" INDEX lfdnr.kvertrag
ÿ½ SELECT KEY codevt.kvfael FILE "kvertrag" INDEX lfdnr.kvertrag
remark$ÿ"Courtage "ÿVS_nr.kvertragÿ" Storno wg.Fehlbeitrag"
i1211%ÿ0
ÿØÿOÿB("buchung1")ÿcodevt.buchung1ÿcodevt.kvfael
ÿ¡codema.buchung1ÿma%ÿp
gez%(i1211%,0)ÿcodema.buchung1
gez%(i1211%,1)ÿbetrag.buchung1
i1211%ÿi1211%ÿ1
ÿ’ÿ¡
ÿÉÿ±ÿ™"buchung1"ÿ£codevt.buchung1
ÿÙ
ÿÉÿ`ÿ™"buchung1"ÿ£codevt.buchung1
ÿÉÿ¥codevt.kvfaelÿ™"buchung1"ÿ£codevt.buchung1
ÿ½ CALL Fehler("Analyse auf zu stornierende Zahlungen wegen fehlendem Zahlungseingang!","")
sumprov%ÿ0
ÿØÿOÿB("buchung1")ÿcodevt.buchung1ÿcodevt.kvfael

ÿ¡codema.buchung1ÿma%ÿerstz%ÿ0ÿp
ÿ¡buchungstext.buchung1ÿ"Erstz*"ÿbuchungstext.buchung1ÿ"*Erstz*"ÿp
provi%ÿvmprov.kvfael
sumprov%ÿsumprov%ÿprovi%
sr%ÿ0
Haftung%ÿ0
datumz%ÿÿQ
f„lligkeit%ÿ0
euro1%ÿumrechnung.kvertrag
waehr1$ÿwaehrung.kvertrag
zein%ÿ0
remark2$ÿ""
gez_Abschluá.kvfaelÿ"n"
codebu.buchung1ÿ0
erledigt.kvfaelÿ"n"
TgezProvAnz.kvfaelÿ0
autokuend.kvfaelÿ"j"
StornoBetrag.kvfaelÿsumprov%
ÿÌÿ™"KVFAEL"
ÿïÿYÿ™"KVFAEL"
remark$ÿ"Courtage "ÿVS_nr.kvertragÿ" Stor.1.Zahl.wg.Fehlbeitrag"
vertrprov%ÿ0
vsumC%ÿ0
vsumA%ÿ0
vsumPP%ÿ0
ÿƒStoRegProv(remark$,ma%,provi%,sr%,Haftung%,datumz%,f„lligkeit%,euro1%,codew%,waehr1$,zein%,remark2$)
erstz%ÿerstz%ÿ1
ÿ^
ÿ’ÿ¡
ÿ’ÿ¡

ÿÉÿ±ÿ™"buchung1"ÿ£codevt.buchung1
ÿÙ
ÿ¡i1211%ÿ0ÿp
remark$ÿ"Courtage "ÿVS_nr.kvertragÿ" Storno wg.Fehlbeitrag"
ÿ›i%ÿ0ÿqi1211%ÿ1
provi%ÿgez%(i%,1)ÿÿ1
sumprov%ÿsumprov%ÿprovi%
ÿ½ SELECT KEY codevt% LOCK FILE "KVFAEL" INDEX codevt.kvfael
ÿ½ StornoBetrag.kvfael = sumprov%
ÿ½ STORE FILE "KVFAEL"
ÿ½ UNLOCK CURRENT FILE "KVFAEL"
ma%ÿgez%(i%,0)
sr%ÿ0
Haftung%ÿ0
datumz%ÿÿQ
f„lligkeit%ÿ0
euro1%ÿumrechnung.kvertrag
waehr1$ÿwaehrung.kvertrag
zein%ÿ0
remark2$ÿ""
vertrprov%ÿ0
vsumC%ÿ0
vsumA%ÿ0
vsumPP%ÿ0
ÿƒStoRegProv(remark$,ma%,provi%,sr%,Haftung%,datumz%,f„lligkeit%,euro1%,codew%,waehr1$,zein%,remark2$)
ÿ±i%
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
abserledigt.kvfaelÿ"j"
ÿÌÿ™"KVFAEL"
ÿïÿ™"KVFAEL"
ÿ½ 12.08.2002
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
z2606021%ÿz2606021%ÿ1
ÿÊÿËÿ(z2606021%,",99999999")ÿ" verarbeitet von "ÿÿ(ÿA("KVFAEL"),",9999999999")
ÿÉÿ±ÿáÿ™"KVFAEL"ÿ£codevt.kvfael
ÿßÿe
ÿÙ
ÿ¡GAFSK$ÿ"TRUE"ÿpÿƒCloseLog()
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿßÿ³
 PROVBU$ÿ"False"
 ÿ½ supervis war exclusiv-modus ”ffnen, um herauszufinden, ob noch jemand im Programm eingeloggt ist
 ÿ½ jetzt die exclusiv-ge”ffnete schlieáen, um allen das Programm verfgbar zu machen
 ÿ¡ÿ´("supervis")ÿpÿ†ÿ™"supervis"
 ÿƒDFile(2,"supervis"ÿ_fpw$)
 ÿ’ÿÿ
 
 




ÿÿStoRegProv(remark$,ma%,provi%,sr%,Haftung%,datumz%,f„lligkeit%,euro1%,codew%,waehr1$,zein%,remark2$)
 ÿ½ IF vs_nr.kvertrag LIKE "1111*" THEN CALL Fehler("Buchung","")
 cfile$ÿÿ™
 ÿ™"kvertrag"
 _lfdnr%ÿlfdnr.KVERTRAG
 ÿÉÿ¥_lfdnr%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿÉÿ¥ma%ÿ™"maadr"ÿ£CodeMA.MAADR
 ÿÉÿ¥codeva.kvertragÿ™"sparten"ÿ£codeva.sparten
 ÿ½ -- bereits gezahlte Provisionen verallgemeinern
 ÿ¡remark2$ÿ"Abschl*"ÿremark$ÿ"AP*"ÿremark2$ÿ"AP*"ÿremark$ÿ"Ersatz*"ÿp
vertrprov%ÿvsumAP%
 ÿ^ÿ¡remark2$ÿ"Courta*"ÿp
vertrprov%ÿvsumC%
 ÿ^ÿ¡remark2$ÿ"Storno wg.Kndigung*"ÿp
vertrprov%ÿvsumC%
 ÿ^ÿ¡remark2$ÿ"Pflege*"ÿp
vertrprov%ÿvsumPP%
 ÿ^ÿ¡remark2$ÿ"Pauschal*"ÿp
vertrprov%ÿvsumPausch%
 ÿ^ÿ¡remark2$ÿ"VD*"ÿp
vertrprov%ÿvsumAP%
 ÿ’ÿ¡
 
 ÿ½ IF vs_nr.kvertrag LIKE "020260197022" THEN 
ÿ½ CALL Fehler(nachname.maadr,"")
 ÿ½ END IF 
 
 ÿ½ -- Bearbeitung bei letzter Agentur in der Struktur
 ÿ¡(CodeMA.maadrÿvorg„nger.maadr)ÿ(Vorg„nger.MAADRÿ
1)ÿp
letzteProvi.kvertragÿdatumz%
ÿ¡remark$ÿ"TZ (*"ÿp
TZRate.KVERTRAGÿTZRate.KVERTRAGÿ1
ÿ’ÿ¡
 ÿ’ÿ¡
 
 ÿ½ -- Einmalzahlungen/Berechnungen Stornoreserve registrieren --
 ÿ¡remark2$ÿ"Abschl*"ÿremark2$ÿ"AP*"ÿremark$ÿ"AP*"ÿremark2$ÿ"Abschl*"ÿremark2$ÿ"VD*"ÿremark$ÿ"Ersatz*"ÿpgezAbschluá%ÿ1
 ÿ¡remark2$ÿ"Pflege*"ÿpgezPflege%ÿ1
 ÿ¡remark2$ÿ"Pauschal*"ÿpgezPauschale%ÿ1
 ÿ¡CodeMA.MAADRÿVorg„nger.MAADRÿVorg„nger.MAADRÿ
1ÿp
ÿ¡gezAbschluá%ÿ1ÿpgez_Abschluá.kvertragÿ"j"
ÿ¡gezPflege%ÿ1ÿpletztePflege.kvertragÿdatumz%
ÿ¡gezPauschale%ÿ1ÿpgez_Pauschale.kvertragÿ"j"
 ÿ’ÿ¡

 ÿ½ CALL QuickStore("KVERTRAG")
 ÿÌÿ™"kvertrag"
 ÿïÿYÿ™"kvertrag"
 ÿ½ CALL Fehler(nachname.maadr,"")
 ÿ½ *********************************** F”rderkonditionen ************************************************
 ÿ¡ÿJ(ma%,voncodema.foerkond)ÿp
ffile$ÿÿ™
ÿ™"foerkond"
ÿ£voncodema.foerkond
ÿÉÿ`ÿ£voncodema.foerkond
ÿÉÿ¥ma%ÿ™"foerkond"ÿ£voncodema.foerkond
proz%ÿ0
pausch%ÿ0
GFdate$ÿÿ(fdate.stamm,"0d.mm.yyyy")
ÿ¡DateOK%(GFDate$)ÿp
ÿ^
GFdate$ÿ""
ÿ’ÿ¡
ÿ¡GFdate$ÿ""ÿp
gfdate%ÿÿ1(GFDate$)
ÿ¡Antragsdatum.KVERTRAGÿ
gfdate%ÿp
ProviAb1%ÿVS_Beginn.KVERTRAG
ÿ^
ProviAb1%ÿAntragsdatum.KVERTRAG
ÿ’ÿ¡
ÿ^
ÿ¡Gvueb$ÿ"TRUE"ÿp
ProviAb1%ÿAntragsdatum.KVERTRAG
ÿ^
ProviAb1%ÿVS_Beginn.KVERTRAG
ÿ’ÿ¡
ÿ’ÿ¡
ÿØÿOÿB("foerkond")ÿvoncodema.foerkondÿma%
ÿ½ jetzt Buchung erzeugen
ok%ÿ0
ÿ¡BWvon.foerkondÿ0ÿp
ÿ¡BWBis.foerkondÿ0ÿp
	ÿ½ Datumseinschr„nkung fr BWVon und BWBis
	ÿ¡ProviAb1%ÿBWvon.foerkondÿProviAb1%ÿ	BWBis.foerkondÿpok%ÿÿ1
ÿ^
	ÿ½ Datumseinschr„nkung fr BWvon
	ÿ¡ProviAb1%ÿBWvon.foerkondÿpok%ÿÿ1
ÿ’ÿ¡
ÿ^
ÿ¡BWBis.foerkondÿ0ÿp
	ÿ½ Datumseinschr„nkung fr BWBis
	ÿ¡ProviAb1%ÿ	BWBis.foerkondÿpok%ÿÿ1
ÿ^
	ÿ½ keine Datumseinschr„nkung
	ok%ÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡VvonCodema.foerkondÿ0ÿp
ÿ¡VvonCodema.foerkondÿCodema.kvertragÿpok%ÿ0
ÿ’ÿ¡
ÿ¡ok%ÿÿ1ÿp
ÿ½ Aufruf der Weiterverarbeitung
ÿ¡prozente.foerkondÿ0ÿp
	proz%ÿproz%ÿprozente.foerkond
ÿ^
	pausch%ÿpausch%ÿpauschale.foerkond
ÿ’ÿ¡
mma%ÿcodema.foerkond
prozent%ÿprozente.foerkond
pauschal%ÿpauschale.foerkond
ÿ½ Aufruf fr den der F”P bekommt
ppp%ÿprovi%ÿvertrprov%
srnull%ÿsr%
ÿƒRegProvFoerd(remark$,ma%,mma%,ppp%,srnull%,Haftung%,datumz%,f„lligkeit%,euro1%,codew%,waehr1$,zein%,remark2$,prozent%,pauschal%)
ÿ½ jetzt negativen Buchungssatz erzeugen fr den, dem die F”P abgezogen wird
ppp%ÿ(provi%ÿvertrprov%)ÿÿ1
srnull%ÿsr%
pauschal%ÿpauschal%ÿÿ1
ÿƒRegProvFoerd(remark$,mma%,ma%,ppp%,srnull%,Haftung%,datumz%,f„lligkeit%,euro1%,codew%,waehr1$,zein%,remark2$,prozent%,pauschal%)
ÿ’ÿ¡
ÿÉÿ±ÿ™"foerkond"ÿ£voncodema.foerkond
ÿÙ
ÿ½ VS_Beginn.KVERTRAG
ÿ™ffile$
 ÿ’ÿ¡
 ÿ½ ******************************************  Ende F”rderkonditionen *************************************************
 
 ÿ™"buchung1"
 ÿÿ™"buchung1"
 CodeBU.buchung1ÿÿI("buchung1",1)
 ÿ½ codeaz.buchung1 = codeaz.zeingan1
 Datum.buchung1ÿdatumz%
 f„lligkeit.buchung1ÿf„lligkeit%
 ÿ½ Ausgabeauf.buchung1 = ausgabeauf.zeingan1
 CodeVT.buchung1ÿlfdnr.kvertrag
 testtext$ÿ"*"ÿvs_nr.kvertragÿ"*"
 umrechnung.buchung1ÿeuro1%
 ÿ¡Kndigung.MAADRÿ	datumz%ÿNachfolger.MAADRÿ0ÿp
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
 ÿ^
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿvs_nr.kvertrag,70)
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡dmeinh%ÿ0ÿpeinheit%ÿprovi%ÿdmeinh%
 
 ÿ½ IF haftung% = - 1 AND sr% <> 0 THEN 
ÿ½ SRBetrag% = ((provi% - vertrprov%) / 100) * sr%
 ÿ½ END IF 
 
 ÿ½ IF haftung% <> 0 AND sr% <> 0 THEN 
ÿ½ SRBetrag% = ((provi% - vertrprov%) / 100) * sr%
 ÿ½ ELSE 
ÿ½ SRBetrag% = 0
 ÿ½ END IF 
 
 ÿ½ 31072001 prfen auf sr%
 
 ÿ½ CALL Fehler("SR","")
 ÿ¡remark2$ÿ"Pauschal*"ÿp
ÿ¡haftung%ÿ0ÿsr%ÿ0ÿp
ÿ¡provi%ÿ0ÿp
SRBetrag%ÿ((provi%)ÿ100)ÿsr%
ÿ¡SRBetrag%ÿ
0ÿpSRBetrag%ÿ0
ÿ^
ÿ¡SRRck.stammÿ"j"ÿp
	ÿ¡StornoVerrech.maadrÿ"j"ÿp
SRBetrag%ÿ((provi%ÿvertrprov%)ÿ100)ÿsr%
ÿ¡SRBetrag%ÿ
0ÿpSRBetrag%ÿ0
	ÿ^
SRBetrag%ÿ0
	ÿ’ÿ¡
ÿ^
	SRBetrag%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
SRBetrag%ÿ0
ÿ’ÿ¡
betr%ÿprovi%ÿSRBetrag%
 ÿ^
ÿ¡haftung%ÿ0ÿsr%ÿ0ÿp
ÿ¡provi%ÿ0ÿp
SRBetrag%ÿ((provi%ÿvertrprov%)ÿ100)ÿsr%
ÿ¡SRBetrag%ÿ
0ÿpSRBetrag%ÿ0
ÿ^
ÿ¡SRRck.stammÿ"j"ÿp
	ÿ¡StornoVerrech.maadrÿ"j"ÿp
SRBetrag%ÿ((provi%ÿvertrprov%)ÿ100)ÿsr%
ÿ½ IF SRBetrag% < 0 THEN SRBetrag% = 0
	ÿ^
SRBetrag%ÿ0
	ÿ’ÿ¡
ÿ^
	SRBetrag%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
SRBetrag%ÿ0
ÿ’ÿ¡
betr%ÿprovi%ÿvertrprov%ÿSRBetrag%
 ÿ’ÿ¡
 ÿÉÿ¥ma1%ÿáÿ™"maadr"ÿ£codema.maadr
 Stornoreserve.maadrÿStornoreserve.maadrÿSRBetrag%
 StornoreserveEU.maadrÿÿ0(ÿ(Stornoreserve.maadrÿeuro1%,"999999999.00"))
 einheitkv%ÿ0
 ÿ¡EinheitSach.stammÿ"j"ÿp
ÿ¡SparteIstSach.spartenÿ1ÿp
ÿ¡ma1%ÿvtcodema%ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿp
	Einheiten.maadrÿEinheiten.maadrÿeinheit%
	einheitkv%ÿeinheit%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
	ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertrag
einheitkv%ÿeinheiten.kvertrag
	ÿ’ÿ¡
ÿ^
	ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿ(einheiten.kvertragÿÿ1)
einheitkv%ÿeinheiten.kvertragÿÿ1
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡EinheitAusGeko.stammÿ
1ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
	Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertrag
	einheitkv%ÿeinheiten.kvertrag
ÿ’ÿ¡
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
	Einheiten.maadrÿEinheiten.maadrÿ(einheiten.kvertragÿÿ1)
	einheitkv%ÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ^
ÿ¡EinheitAusGeko.stammÿ
1ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertrag
einheitkv%ÿeinheiten.kvertrag
ÿ’ÿ¡
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿ(einheiten.kvertragÿÿ1)
einheitkv%ÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡ma1%ÿvtcodema%ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿp
EigEinheiten.maadrÿEigEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
EigEinheiten.maadrÿEigEinheiten.maadrÿeinheiten.kvertrag
einheitkv%ÿeinheiten.kvertrag
ÿ’ÿ¡
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
EigEinheiten.maadrÿEigEinheiten.maadrÿ(einheiten.kvertragÿÿ1)
einheitkv%ÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
EinheitGes.maadrÿEinheitGes.maadrÿeinheitkv%
 ÿ^
sEinheitGes.maadrÿsEinheitGes.maadrÿeinheitkv%
 ÿ’ÿ¡
 ÿ½ gesvol% = GesVolumen.maadr
 ÿ½ eigvol% = EigVolumen.maadr
 ÿ½ betr% = provi% - vertrprov% - SRBetrag%
 ÿ½ CALL Fehler("ges:" + STR$ (gesvol%,"99999"),"Eig:" + STR$ (eigvol%,"99999"))
 
 ÿ½ ****************************AUSZAHLUNGSSPERRE**********************************
 eigen%ÿ0
 PSpAll$ÿPROVSperreAll.maadr
 PSpAllSeit%ÿPSperreAllSeit.maadr
 PROVSpEig$ÿPROVSperreEig.maadr
 PSpESeit%ÿPSperreESeit.maadr
 
 ÿ¡ma1%ÿvtcodema%ÿp
eigen%ÿ1
 ÿ’ÿ¡
 ÿ¡PspAll$ÿ"j"ÿp
ÿ¡PSpAllSeit%ÿ	datumz%ÿp
ÿ½ IF ma1% = 529 THEN CALL Fehler("TRIEBSCH","")
AuszahlSperKo.maadrÿAuszahlSperKo.maadrÿbetr%
AuszahlSperKoEU.maadrÿÿ0(ÿ(AuszahlSperKo.maadrÿeuro1%,"999999999.00"))
ÿ’ÿ¡
 ÿ^
ÿ¡eigen%ÿ1ÿPROVSpEig$ÿ"j"ÿp
ÿ¡PSpESeit%ÿ	datumz%ÿp
AuszahlSperKo.maadrÿAuszahlSperKo.maadrÿbetr%
AuszahlSperKoEU.maadrÿÿ0(ÿ(AuszahlSperKo.maadrÿeuro1%,"999999999.00"))
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ ****************************AUSZAHLUNGSSPERRE Ende********************************** 
 ÿ¡betr%ÿ0ÿp
GesVolumen.maadrÿGesVolumen.maadrÿVolumen.KVERTRAG
ÿ¡ma1%ÿvtcodema%ÿp
EigVolumen.maadrÿEigVolumen.maadrÿVolumen.KVERTRAG
ÿ’ÿ¡
 ÿ^
GesVolumen.maadrÿGesVolumen.maadrÿ(Volumen.KVERTRAGÿÿ1)
ÿ¡ma1%ÿvtcodema%ÿp
EigVolumen.maadrÿEigVolumen.maadrÿ(Volumen.KVERTRAGÿÿ1)
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ gesvol% = GesVolumen.maadr
 ÿ½ eigvol% = EigVolumen.maadr
 AuszahlAB.maadrÿAuszahlAB.maadrÿbetr%
 AuszahlEUAB.maadrÿÿ0(ÿ(AuszahlAB.maadrÿeuro1%,"999999999.00"))
 AuszProvABGes.maadrÿAuszProvABGes.maadrÿbetr%
 AuszProvABGesEU.maadrÿÿ0(ÿ(AuszProvABGes.maadrÿeuro1%,"999999999.00"))
 ÿ½ Workstation.maadr = Workstation%
 ÿ½ QWoNo.maadr = STR$ (Workstation%,"000000") + STR$ (codema.maadr,"000000")
 RecStatus.maadrÿ"c"
 ÿÌÿ™"maadr"
 ÿïÿYÿ™"maadr"
 Betrag.buchung1ÿbetr%
 ÿ½ *****************************************************************************************************
 ÿ½ Zentralberechnung des Kontostandes
 zusatz%ÿ0
 ÿƒZentrKTO(ma%,datumz%,betr%,SRBetrag%,codew%,euro1%,waehr1$,PSpAll$,PSpAllSeit%,PROVSpEig$,PSpESeit%,eigen%,zusatz%,einheitkv%)
 ÿ½ *****************************************************************************************************
 Gesamtbetrag.buchung1ÿprovi%

 Bewertungssumme.buchung1ÿBewertung.zeingan1
 ÿ¡GAFSK$ÿ"TRUE"ÿ(Buchungstext.buchung1ÿ"*Storno wg.Fehl*"ÿBuchungstext.buchung1ÿ"Storno wg.Fehl*")ÿp
Bewertungssumme.buchung1ÿBewertungssumme.kvertrag
 ÿ’ÿ¡
 ProvBasiswert.buchung1ÿBewertung.zeingan1
 KundEinzahlung.buchung1ÿBewertungssumme.kvertrag
 KundEinzahluEu.buchung1ÿÿ0(ÿ(Bewertungssumme.kvertragÿumrechnung.buchung1,"999999999.00"))
 ÿ¡betrag.buchung1ÿ0ÿp
Volumen.buchung1ÿVolumen.KVERTRAG
 ÿ^
Volumen.buchung1ÿVolumen.KVERTRAGÿÿ1
 ÿ’ÿ¡
 
 Kndigung.buchung1ÿKndigung.KVERTRAG
 VS_Beginn.buchung1ÿVS_Beginn.KVERTRAG
 Bewertung2.buchung1ÿBewertKV.zeingan1
 ÿ¡GAFSK$ÿ"TRUE"ÿ(Buchungstext.buchung1ÿ"*Storno wg.Fehl*"ÿBuchungstext.buchung1ÿ"Storno wg.Fehl*")ÿp
Bewertung2.buchung1ÿBewertungssumme.kvertrag
 ÿ’ÿ¡
 CodeKU.buchung1ÿCodeKU.KVERTRAG

 vtagentur.buchung1ÿGVTAgentur$
 vtcodema.buchung1ÿGVTcodema%
 
 
 vsumme.buchung1ÿvsumme.kvertrag
 vsummeEU.buchung1ÿÿ0(ÿ(vsumme.kvertragÿumrechnung.buchung1,"999999999.00"))
 BeitragBrut.buchung1ÿBeitrag.kvertrag
 BeitragNet.buchung1ÿNettoBeitrag.kvertrag
 BeitragBrutEu.buchung1ÿÿ0(ÿ(Beitrag.kvertragÿumrechnung.buchung1,"999999999.00"))
 BeitragNetEu.buchung1ÿÿ0(ÿ(NettoBeitrag.kvertragÿumrechnung.buchung1,"999999999.00"))
 zw.buchung1ÿzw.kvertrag
 mwst.buchung1ÿmwst.kvertrag
 ÿ¡zw.buchung1ÿ0ÿp
JahresBBrut.buchung1ÿBeitragBrut.buchung1ÿzw.buchung1
JahresBNet.buchung1ÿBeitragNet.buchung1ÿzw.buchung1
JahresBBrutEu.buchung1ÿÿ0(ÿ(JahresBBrut.buchung1ÿumrechnung.buchung1,"999999999.00"))
JahresBNetEu.buchung1ÿÿ0(ÿ(JahresBNet.buchung1ÿumrechnung.buchung1,"999999999.00"))
 ÿ^
JahresBBrut.buchung1ÿBeitragBrut.buchung1
JahresBNet.buchung1ÿBeitragNet.buchung1
JahresBBrutEu.buchung1ÿÿ0(ÿ(JahresBBrut.buchung1ÿumrechnung.buchung1,"999999999.00"))
JahresBNetEu.buchung1ÿÿ0(ÿ(JahresBNet.buchung1ÿumrechnung.buchung1,"999999999.00"))
 ÿ’ÿ¡
 
 APJN.buchung1ÿAPjn.gekond
 CourtJN.buchung1ÿCourtageJN.gekond
 SRjn.buchung1ÿSRJN.gekond
 PflegeJN.buchung1ÿPflegeJN.gekond
 APProzente.buchung1ÿAP.gekond
 CourtProzente.buchung1ÿCourtage.gekond
 PflegProzente.buchung1ÿPflegeProvi.gekond
 SRProzente.buchung1ÿsr.gekond
 codew.buchung1ÿcodew%
 waehrung.buchung1ÿwaehr1$

 ÿ¡EinheitSach.stammÿ"j"ÿp
ÿ¡SparteIstSach.spartenÿ1ÿp
ÿ¡ma1%ÿvtcodema%ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchung1ÿeinheit%
ÿ¡betr%ÿ0ÿp
	ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertrag
ÿ^
	ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchung1ÿeinheit%
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertrag
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ^
ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchung1ÿeinheit%
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertrag
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
 ÿ’ÿ¡

 ÿÉÿ¥CodeVA.kvertragÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 Sparte.buchung1ÿSparte.SPARTEN
 ÿÉÿ¥CodeKU.KVERTRAGÿ™GAdrDat$ÿ£CodeKU.GAdrDat$
 Nachname.buchung1ÿNachname.GAdrDat$
 Vorname.buchung1ÿVorname.GAdrDat$
 ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
 Gesellschaft.buchung1ÿGesellschaft.GEADR
 Provision.buchung1ÿ"j"
 ÿ¡sr%ÿ0ÿp
SRgezahlt.buchung1ÿ"j"
SR.buchung1ÿ0
 ÿ^
ÿ½ 060497
ÿ¡Haftung%ÿÿ1ÿp
SRAuszahlung.buchung1ÿ0
SR.buchung1ÿSRBetrag%
ÿ^
SRAuszahlung.buchung1ÿHaftung%
SR.buchung1ÿSRBetrag%
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ CALL QuickStore("Buchung1")
 agentur.buchung1ÿÿ+(ÿH(nachname.maadr)ÿ", "ÿÿH(vorname.maadr)ÿ", "ÿÿH(Agenturnr.maadr)ÿ" , Stufe:"ÿÿ(stufe.maadr,"000"),100)
 QuickCode.BUCHUNG1ÿÿ(CodeMA.BUCHUNG1,"000000")ÿÿ(Datum.BUCHUNG1,"yyyymm0d")
 QCodeMAPROD.buchung1ÿÿ(CodeMA.buchung1,"000000")ÿVSNRPack$(Gesellschaft.buchung1)ÿVSNRPack$(Sparte.buchung1)
 Workstation.Buchung1ÿWorkstation%
 QWoNo.Buchung1ÿÿ(Workstation%,"000000")ÿÿ(CodeBu.Buchung1,"000000")
 RecStatus.Buchung1ÿ"c"
 ÿƒBU1DMEuro(umrechnung.buchung1)
 buday.buchung1ÿÿ3(Datum.buchung1)
 QCodeMAVT.buchung1ÿÿ(codema.buchung1,"000000")ÿÿ(codevt.buchung1,"000000")
 timestamp$ÿÿ(ÿQ,"yymmdd")ÿÿ(ÿ9(ÿR)ÿ100ÿÿ:(ÿR),"0000")
 timestamp%ÿÿ0(timestamp$)
 timestamp.buchung1ÿtimestamp%
	ÿ¡gebuchtjn.buchung1ÿ1ÿpgebuchtjn.buchung1ÿ0
	gebuchtJNDat.buchung1ÿÿ(gebuchtjn.buchung1,"0")ÿÿ(datum.buchung1,"yyyymm0d")
	gebuchtJNMADat.buchung1ÿÿ(gebuchtjn.buchung1,"0")ÿÿ(Codema.buchung1,"000000")ÿÿ(datum.buchung1,"yyyymm0d")
 ÿÌÿ™"Buchung1"
 ÿïÿYÿ™"Buchung1"
 ÿßÿe
 ÿ½ -- Aufsummierung der einzelnen Provisionsarten
 ÿ½    fr Differenzberechnung
 ÿ¡remark2$ÿ"Abschl*"ÿremark2$ÿ"AP*"ÿremark$ÿ"AP*"ÿremark$ÿ"Abschl*"ÿremark$ÿ"Ersatz*"ÿp
vsumAP%ÿprovi%
 ÿ^ÿ¡remark2$ÿ"Courta*"ÿp
vsumC%ÿprovi%
 ÿ^ÿ¡remark2$ÿ"Pflege*"ÿp
vsumPP%ÿprovi%
 ÿ^ÿ¡remark2$ÿ"Pauschal*"ÿp
vsumPausch%ÿprovi%
 ÿ^ÿ¡remark2$ÿ"VD*"ÿp
vsumAP%ÿprovi%
 ÿ^
vertrprov%ÿprovi%
 ÿ’ÿ¡
 ÿ’ÿÿ














 ' Provisionsberechnung
 ' einzelnen Vertrag berechnen
 ' =======================================================================

ÿÿPROVISZEIN2()
 cfile$ÿÿ™
 ok%ÿ1

 
zp22089702: 
 cuvt%ÿlfdnr.KVERTRAG
 codema%ÿCodeMA.kvertrag
 codege%ÿCodeGE.kvertrag
 codeva%ÿCodeVA.kvertrag
 koab%ÿCodeKO.KVERTRAG
 bewertung%ÿBewertung.zeingan1
 GbewertungOld%ÿBewertung.zeingan1
 ÿÉÿ`ÿ™"maadr"ÿ£codema.maadr
 ÿÉÿ¥codema%ÿ™"maadr"ÿ£codema.maadr
 Gvtagentur$ÿnachname.maadrÿ","ÿvorname.maadr
 Gvtcodema%ÿcodema.maadr
 ÿ½ GAGFrAgentur$(anzagvFre%,1)
 GStorWarnJN$ÿStorWarnJN.kvertrag
 ÿ¡StorWarnDatGes.kvertragÿ0ÿp
GStorWarnDGes$ÿÿ(StorWarnDatGes.kvertrag,"0d.mm.yyyy")
 ÿ^
GStorWarnDGes$ÿ""
 ÿ’ÿ¡
 ÿ¡StorWarnDatMA.kvertragÿp
GStorWarnDMA$ÿÿ(StorWarnDatMA.kvertrag,"0d.mm.yyyy")
 ÿ^
GStorWarnDMA$ÿ""
 ÿ’ÿ¡
 GStorWarnGrund$ÿStorWarnGrund.kvertrag
 GStorWarnMasn$ÿStorWarnMasn.kvertrag
 GStorWarnErg$ÿStorWarnErg.kvertrag
 
 ÿ½ *** 201100 Einbeziehung der ProzenteVerteilung von VPRODUKT ***
 codevp%ÿCodeVP.Kvertrag
 ÿÉÿ`ÿ™"Vprodukt"ÿ£codevp.vprodukt
 ÿÉÿ¥codevp%ÿ™"Vprodukt"ÿ£codevp.vprodukt
 ÿ¡codevp%ÿCodeVP.KvertragÿProzVerteilung.vproduktÿ0ÿp
haftvertrag%ÿSRHaftung.kvertrag
weitermachen%ÿ1
ÿÉÿ`ÿ™"VKOND"ÿ£CodeVK.VKOND
ÿÉÿ¥koab%ÿ™"VKOND"ÿ£CodeVK.VKOND
ÿØÿOÿB("vkond")ÿweitermachen%ÿ1
ÿ¡n„chsteKond.VKONDÿ0ÿp
weitermachen%ÿ0
ÿ^
ÿÉÿ¥n„chsteKond.VKONDÿ™"VKOND"ÿ£CodeVK.VKOND
ÿ’ÿ¡
ÿÙ
ÿÉÿ¥CodeKO.VKONDÿ™"GEKOND"ÿ£lfdnr.GEKOND
ÿ½ jetzt wurde die Kondition der Firma(1.Agentur) gefunden 
Vbewertung%ÿ((Bewertung.zeingan1ÿ100)ÿProzVerteilung.vprodukt)
Vrest%ÿBewertung.zeingan1ÿVbewertung%
ÿ¡kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿp
ÿ¡APjn.gekondÿ"j"ÿp
provnz%ÿvrest%ÿ100ÿAP.gekond
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ2ÿp
ÿ¡PflegeJN.gekondÿ"j"ÿp
provnz%ÿvrest%ÿ100ÿPflegeProvi.gekond
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ1ÿp
ÿ¡CourtageJN.gekondÿ"j"ÿp
provnz%ÿvrest%ÿ100ÿCourtage.gekond
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ¡kondart.zeingan1ÿ4ÿp
ÿ¡DynamikPjn.gekondÿ"j"ÿp
provnz%ÿvrest%ÿ100ÿDynamikProz.gekond
ÿ’ÿ¡
ÿ’ÿ¡

ÿ¡kondart.zeingan1ÿ4ÿp
ÿ¡Betreujn.gekondÿ"j"ÿp
provnz%ÿvrest%ÿ100ÿBetreuProz.gekond
ÿ’ÿ¡
ÿ’ÿ¡

ÿ¡SRjn.gekondÿ"j"ÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
ÿ¡Haftvertrag%ÿ0ÿp
	ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftvertrag%ÿ30)
	ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftvertrag%ÿ30)
	ÿ’ÿ¡
ÿ^
	ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftung.gekondÿ30)
	ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftung.gekondÿ30)
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftung.gekondÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
butext$ÿBuchungstext.zeingan1ÿ" Prov. aus NV"
VProvisNZ%ÿprovnz%
provnz%ÿ0
ÿ½ CALL SpezProvisF(butext$,codema.gekond,provnz%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1)
 ÿ^
Vbewertung%ÿBewertung.zeingan1
 ÿ’ÿ¡
 ÿ½ ******************************************************************* 

 ÿ½ ******************************************************************* 
 
 ÿÉÿ`ÿ™"VKOND"ÿ£CodeVK.VKOND
 ÿÉÿ¥koab%ÿ™"VKOND"ÿ£CodeVK.VKOND
 
 ÿ¡ÿOÿJ(koab%,codevk.VKOND)ÿp
ÿƒWriteLog("  Vertrag wurde noch nicht an die Provisionsabrechnung bergeben")
ÿƒAddLogInfo()
ok%ÿ0
 ÿ^
ÿ½ positionieren auf die Kondition der vertragsabschlieáenden Agentur,bei der ist dann der Vorg„nger als
ÿ½ n„chsteKond.VKOND eingetragen
ÿÉÿ`ÿ™"VKOND"ÿ£CodeVK.VKOND
ÿÉÿ¥koab%ÿ™"VKOND"ÿ£CodeVK.VKOND
 ÿ’ÿ¡
 
 ÿ½ es ist Spezialprovision von der Firma zu zahlen und nachdem diese von der Bewertung abgezogen wurde
 ÿ½ darf der Restbetrag als 100% angesehen werden, von dem dann die restliche Provision berechnet wird
 ÿ¡vs_nr.kvertragÿ"25139*"ÿp
ÿ½ CALL Fehler("Spezprov von Agentur","2")
 ÿ’ÿ¡
 GBewertung%ÿVbewertung%
 okspez%ÿÿ1
 ÿ¡GFPB%ÿÿ1ÿp
ÿ¡Bewertung.zeingan1ÿ0ÿsr.zeingan1ÿ0ÿp
okspez%ÿ0
ÿ^
bwspez$ÿÿH(ÿ(Bewertung.zeingan1,"999999999.00"))
srspez$ÿÿH(ÿ(sr.zeingan1ÿÿ1,"999999999.00"))
ÿ¡bwspez$ÿsrspez$ÿpokspez%ÿ0
ÿ½ CALL Fehler(bwspez$,srspez$)
ÿ’ÿ¡

 ÿ’ÿ¡
 ÿ¡GSpezko$ÿ"j"ÿGVonFirma$ÿ"j"ÿokspez%ÿÿ1ÿp
ÿ½ CALL Fehler("Test auf Spezialkonditionen","")
ÿ½ positionieren auf die Kondition der Firma
weitermachen%ÿ1
ÿÉÿ`ÿ™"VKOND"ÿ£CodeVK.VKOND
ÿÉÿ¥koab%ÿ™"VKOND"ÿ£CodeVK.VKOND
ÿØÿOÿB("vkond")ÿweitermachen%ÿ1
ÿ¡n„chsteKond.VKONDÿ0ÿp
weitermachen%ÿ0
ÿ^
ÿÉÿ¥n„chsteKond.VKONDÿ™"VKOND"ÿ£CodeVK.VKOND
ÿ’ÿ¡
ÿÙ
ÿÉÿ¥CodeKO.VKONDÿ™"GEKOND"ÿ£lfdnr.GEKOND
ÿ½ jetzt wurde die Kondition der Firma(1.Agentur) gefunden, jetzt msenn die Prozente/Pauschalen vonFirma addiert
ÿ½ werden, um diese Betr„ge von der Bewertung abzuziehen, danach Erzeugung der Buchungss„tze
anzagvF%ÿ0
SpezProzent%ÿ0
SpezPausch%ÿ0
QCodeVTMAold$ÿ""
ÿØGAGvonFirma$(anzagvF%)ÿ""
ÿÉÿ`ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
QCodeVTMA$ÿÿ-(GAGvonFirma$(anzagvF%),12)
ÿ¡GAGvonFirma$(anzagvF%)ÿ""ÿp
ÿ¡QCodeVTMA$ÿQCodeVTMAold$ÿp
ÿ½ QCodeVTMA$ = RIGHT$ (GAGvonFirma$(anzagvF%),12)
QCodeVTMAold$ÿQCodeVTMA$
ÿÉÿ¥QCodeVTMA$ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
okspezko%ÿ0
ÿØÿOÿB("Spezkond")ÿQCodeVTMA.spezkondÿQCodeVTMA$
	ÿ¡Prozente.spezkondÿ0ÿp
kondart1%ÿkondart.zeingan1
vonCourtage$ÿvonCourtage.spezkond
vonPflege$ÿvonPflege.spezkond
vonAP$ÿvonAP.spezkond
ÿ½ AP
abproz%ÿProzente.spezkond
 
ÿ½ IF kondart.zeingan1 = 0 OR kondart.zeingan1 = 3 AND vonCourtage.spezkond <> "j" AND vonPflege.spezkond <> "j" THEN 
ÿ¡kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿkondart.zeingan1ÿ4ÿp
ok%ÿÿ1
ÿ¡vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonAP.spezkondÿ"j"ÿpok%ÿ0
ÿ’ÿ¡
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡ok%ÿÿ1ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
ÿ’ÿ¡
ÿ^
ÿ¡bewertung.zeingan1ÿ
0ÿsr.spezkondÿ0ÿp
ÿ¡ok%ÿÿ1ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ Courtage
ÿ½ IF kondart.zeingan1 = 1 AND vonAP.spezkond <> "j" AND vonPflege.spezkond <> "j" THEN 
ÿ¡kondart.zeingan1ÿ1ÿp
ok%ÿÿ1
ÿ¡vonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿpok%ÿ0
ÿ’ÿ¡
ÿ½ SpezProzent% = SpezProzent% + Prozente.spezkond
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡ok%ÿÿ1ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
ÿ’ÿ¡
ÿ^
ÿ¡bewertung.zeingan1ÿ
0ÿsr.spezkondÿ0ÿp
ÿ¡ok%ÿÿ1ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ½ Pflege
ÿ½ IF kondart.zeingan1 = 2 AND vonCourtage.spezkond <> "j" AND vonAp.spezkond <> "j" AND einmaligerfolgt.spezkond <> "j" THEN 
ÿ¡kondart.zeingan1ÿ2ÿkondart.zeingan1ÿ5ÿp
ok%ÿÿ1
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ok%ÿ0
ÿ^
ÿ¡vonCourtage.spezkondÿ"j"ÿvonAp.spezkondÿ"j"ÿp
ÿ¡vonPflege.spezkondÿ"j"ÿpok%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡ok%ÿÿ1ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ^
ÿ¡pauschale.spezkondÿ0ÿp
ÿ½ IF kondart.zeingan1 = 0 OR kondart.zeingan1 = 3 AND vonCourtage.spezkond <> "j" AND vonPflege.spezkond <> "j" THEN 
ÿ¡kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿkondart.zeingan1ÿ4ÿp
ok%ÿÿ1
ÿ¡vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonAP.spezkondÿ"j"ÿpok%ÿ0
ÿ’ÿ¡
ÿ½ SpezPausch% = SpezPausch% + Pauschale.spezkond
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡ok%ÿÿ1ÿp
SpezPausch%ÿSpezPausch%ÿPauschale.spezkond
ÿ’ÿ¡
ÿ^
ÿ¡ok%ÿÿ1ÿp
ÿ¡bewertung.zeingan1ÿ
0ÿsr.spezkondÿ0ÿp
SpezPausch%ÿSpezPausch%ÿPauschale.spezkondÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ IF kondart.zeingan1 = 1 AND vonAP.spezkond <> "j" AND vonPflege.spezkond <> "j" THEN 
ÿ¡kondart.zeingan1ÿ1ÿp
ok%ÿÿ1
ÿ¡vonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿpok%ÿ0
ÿ’ÿ¡
ÿ½ SpezPausch% = SpezPausch% + Pauschale.spezkond
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡ok%ÿÿ1ÿp
SpezPausch%ÿSpezPausch%ÿPauschale.spezkond
ÿ’ÿ¡
ÿ^
ÿ¡ok%ÿÿ1ÿp
ÿ¡bewertung.zeingan1ÿ
0ÿsr.spezkondÿ0ÿp
SpezPausch%ÿSpezPausch%ÿPauschale.spezkondÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ IF kondart.zeingan1 = 2 AND vonCourtage.spezkond <> "j" AND vonAp.spezkond <> "j" AND einmaligerfolgt.spezkond <> "j" THEN 
ÿ¡kondart.zeingan1ÿ2ÿkondart.zeingan1ÿ5ÿp
ok%ÿÿ1
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ok%ÿ0
ÿ^
ÿ¡vonCourtage.spezkondÿ"j"ÿvonAp.spezkondÿ"j"ÿp
ÿ¡vonPflege.spezkondÿ"j"ÿpok%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡ok%ÿÿ1ÿp
SpezPausch%ÿSpezPausch%ÿPauschale.spezkond
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿÉÿ±ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
ÿÙ
ÿ’ÿ¡
anzagvF%ÿanzagvF%ÿ1
ÿ’ÿ¡
ÿÙ
 
kondart%ÿkondart.zeingan1
ÿ½ bei Abschluáprovision
ÿ½ CALL Fehler("%Pausch","")

ÿ¡kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿp
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
GBewertung%ÿVbewertung%ÿSpezPausch%
ÿ^
GBewertung%ÿ((Vbewertung%ÿ100)ÿAP.gekond)ÿ((Vbewertung%ÿ100)ÿSpezProzent%)ÿSpezPausch%
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ4ÿp
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
GBewertung%ÿVbewertung%ÿSpezPausch%
ÿ^
GBewertung%ÿ((Vbewertung%ÿ100)ÿDynamikProz.gekond)ÿ((Vbewertung%ÿ100)ÿSpezProzent%)ÿSpezPausch%
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ bei Courtage
ÿ¡kondart.zeingan1ÿ1ÿp
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
GBewertung%ÿVbewertung%ÿSpezPausch%
ÿ^
GBewertung%ÿ((Vbewertung%ÿ100)ÿCourtage.gekond)ÿ((Vbewertung%ÿ100)ÿSpezProzent%)ÿSpezPausch%
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ bei Pflege
ÿ¡kondart.zeingan1ÿ2ÿp
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
GBewertung%ÿVbewertung%ÿSpezPausch%
ÿ^
GBewertung%ÿ(((Vbewertung%)ÿ100)ÿPflegeProvi.gekond)ÿ((Vbewertung%ÿ100)ÿSpezProzent%)ÿSpezPausch%
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondart.zeingan1ÿ5ÿp
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
GBewertung%ÿVbewertung%ÿSpezPausch%
ÿ^
GBewertung%ÿ(((Vbewertung%)ÿ100)ÿBetreuProz.gekond)ÿ((Vbewertung%ÿ100)ÿSpezProzent%)ÿSpezPausch%
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ½ jetzt mssen die Buchungss„tze fr die Mitarbeiter angelegt werden
anzagvF%ÿ0
ÿÉÿ`ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
sr%ÿ0
Haftung%ÿ0
provsp%ÿ0
provsp1%ÿ0
ÿ½ CALL Fehler("Spezi","")

Haftung%ÿ0
provsp%ÿ0
provsp1%ÿ0
ÿ½ CALL Fehler("Spezi","")
QCodeVTMAold$ÿ""
ÿØGAGvonFirma$(anzagvF%)ÿ""
QCodeVTMA$ÿÿ-(GAGvonFirma$(anzagvF%),12)
ÿÉÿ`ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
ÿÉÿ¥QCodeVTMA$ÿáÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
ÿ¡QCodeVTMA$ÿQCodeVTMAold$ÿp
QCodeVTMAold$ÿQCodeVTMA$
ÿØÿOÿB("Spezkond")ÿQCodeVTMA.spezkondÿQCodeVTMA$
ÿ¡Prozente.spezkondÿ0ÿp
	abproz%ÿProzente.spezkond
	ÿ½ IF kondart.zeingan1 = 0 OR kondart.zeingan1 = 3 AND vonCourtage.spezkond <> "j" AND vonPflege.spezkond <> "j" THEN 
	ÿ¡kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿkondart.zeingan1ÿ4ÿp
ok%ÿÿ1
ÿ¡vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonAP.spezkondÿ"j"ÿpok%ÿ0
ÿ’ÿ¡
ÿ¡ok%ÿÿ1ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
provsp1%ÿ((Vbewertung%ÿ100)ÿAP.gekond)
ÿ¡kondart.zeingan1ÿ4ÿp
provsp1%ÿ((Vbewertung%ÿ100)ÿDynamikProz.gekond)
ÿ’ÿ¡
provsp%ÿ((provsp1%ÿ100)ÿProzente.spezkond)
ÿ¡sr.spezkondÿ0ÿp
sr%ÿsr.spezkond
ÿ¡sr%ÿ0ÿp
Haftv%ÿsrlz.spezkond
ÿ¡Haftv%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftv%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftv%ÿ30)
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftv%ÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ^
ÿ¡bewertung.zeingan1ÿ
0ÿsr.spezkondÿ0ÿp
provsp1%ÿ((Vbewertung%ÿ100)ÿAP.gekond)
ÿ¡kondart.zeingan1ÿ4ÿp
provsp1%ÿ((Vbewertung%ÿ100)ÿDynamikProz.gekond)
ÿ’ÿ¡
provsp%ÿ((provsp1%ÿ100)ÿProzente.spezkond)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ½ bei Courtage
	ÿ½ IF kondart.zeingan1 = 1 AND vonAP.spezkond <> "j" AND vonPflege.spezkond <> "j" THEN 
	ÿ¡kondart.zeingan1ÿ1ÿp
ok%ÿÿ1
ÿ¡vonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿpok%ÿ0
ÿ’ÿ¡
ÿ¡ok%ÿÿ1ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
provsp1%ÿ((Vbewertung%ÿ100)ÿCourtage.gekond)
provsp%ÿ((provsp1%ÿ100)ÿProzente.spezkond)
ÿ¡sr.spezkondÿ0ÿp
sr%ÿsr.spezkond
ÿ¡sr%ÿ0ÿp
Haftv%ÿsrlz.spezkond
ÿ¡Haftv%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftv%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftv%ÿ30)
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftv%ÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ^
ÿ¡bewertung.zeingan1ÿ
0ÿsr.spezkondÿ0ÿp
provsp1%ÿ((Vbewertung%ÿ100)ÿCourtage.gekond)
provsp%ÿ((provsp1%ÿ100)ÿProzente.spezkond)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡

	ÿ’ÿ¡
	ÿ½ bei Pflege
	ÿ½ IF kondart.zeingan1 = 2 AND vonCourtage.spezkond <> "j" AND vonAp.spezkond <> "j" AND einmaligerfolgt.spezkond <> "j" THEN 
	ÿ¡kondart.zeingan1ÿ2ÿkondart.zeingan1ÿ5ÿp
ok%ÿÿ1
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ok%ÿ0
ÿ^
ÿ¡vonCourtage.spezkondÿ"j"ÿvonAp.spezkondÿ"j"ÿp
ÿ¡vonPflege.spezkondÿ"j"ÿpok%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡ok%ÿÿ1ÿp
provsp1%ÿ(((Vbewertung%)ÿ100)ÿPflegeProvi.gekond)
ÿ¡kondart.zeingan1ÿ5ÿp
provsp1%ÿ(((Vbewertung%)ÿ100)ÿBetreuProz.gekond)
ÿ’ÿ¡
provsp%ÿ((provsp1%ÿ100)ÿProzente.spezkond)
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ^
	ÿ½ IF kondart.zeingan1 = 0 OR kondart.zeingan1 = 3 AND vonCourtage.spezkond <> "j" AND vonPflege.spezkond <> "j" THEN 
	ÿ¡kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿkondart.zeingan1ÿ4ÿp
ok%ÿÿ1
ÿ¡vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonAP.spezkondÿ"j"ÿpok%ÿ0
ÿ’ÿ¡
ÿ¡ok%ÿÿ1ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
provsp1%ÿ((Vbewertung%ÿ100)ÿAP.gekond)
ÿ¡kondart.zeingan1ÿ4ÿp
provsp1%ÿ((Vbewertung%ÿ100)ÿDynamikProz.gekond)
ÿ’ÿ¡
ÿ½ 30092005
ÿ½ CALL Fehler("Spezkond","Pauschale")
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
provsp%ÿPauschale.spezkond
GEinhEinmSpez%ÿEinheiten.kvertragÿprovsp%ÿbewertung%
ÿ’ÿ¡
ÿ¡sr.spezkondÿ0ÿp
sr%ÿsr.spezkond
ÿ¡sr%ÿ0ÿp
Haftv%ÿsrlz.spezkond
ÿ¡Haftv%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftv%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftv%ÿ30)
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftv%ÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ^
ÿ¡bewertung.zeingan1ÿ
0ÿsr.spezkondÿ0ÿp
provsp1%ÿ((Vbewertung%ÿ100)ÿAP.gekond)
ÿ¡kondart.zeingan1ÿ4ÿp
provsp1%ÿ((Vbewertung%ÿ100)ÿDynamikProz.gekond)
ÿ’ÿ¡
provsp%ÿPauschale.spezkondÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ½ bei Courtage
	ÿ½ IF kondart.zeingan1 = 1 AND vonAP.spezkond <> "j" AND vonPflege.spezkond <> "j" THEN 
	ÿ¡kondart.zeingan1ÿ1ÿp
ok%ÿÿ1
ÿ¡vonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡vonCourtage.spezkondÿ"j"ÿpok%ÿ0
ÿ’ÿ¡
ÿ¡ok%ÿÿ1ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
provsp1%ÿ((Vbewertung%ÿ100)ÿCourtage.gekond)
provsp%ÿPauschale.spezkond
ÿ¡sr.spezkondÿ0ÿp
sr%ÿsr.spezkond
ÿ¡sr%ÿ0ÿp
Haftv%ÿsrlz.spezkond
ÿ¡Haftv%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftv%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftv%ÿ30)
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftv%ÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ^
ÿ¡bewertung.zeingan1ÿ
0ÿsr.spezkondÿ0ÿp
provsp1%ÿ((Vbewertung%ÿ100)ÿCourtage.gekond)
provsp%ÿPauschale.spezkondÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ½ bei Pflege
	ÿ½ IF kondart.zeingan1 = 2 AND vonCourtage.spezkond <> "j" AND vonAp.spezkond <> "j" AND einmaligerfolgt.spezkond <> "j" THEN 
	ÿ¡kondart.zeingan1ÿ2ÿkondart.zeingan1ÿ5ÿp
ok%ÿÿ1
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ok%ÿ0
ÿ^
ÿ¡vonCourtage.spezkondÿ"j"ÿvonAp.spezkondÿ"j"ÿp
ÿ¡vonPflege.spezkondÿ"j"ÿpok%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡ok%ÿÿ1ÿp
provsp1%ÿ(((Vbewertung%)ÿ100)ÿPflegeProvi.gekond)
ÿ¡kondart.zeingan1ÿ5ÿp
provsp1%ÿ(((Vbewertung%)ÿ100)ÿBetreuProz.gekond)
ÿ’ÿ¡
provsp%ÿPauschale.spezkond
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡einmalig.spezkondÿ"j"ÿp
	einmaligerfolgt.spezkondÿ"j"
	EinmDatum.spezkondÿBuchungsDatum.zeingan1
	ÿÌÿ™"Spezkond"
	ÿïÿYÿ™"spezkond"
	ÿïÿ™"spezkond"
ÿ’ÿ¡
butext$ÿBuchungstext.zeingan1ÿ" Spez.Prov."
ÿ¡provsp%ÿ0ÿpÿƒSpezProvisF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1)
provsp%ÿ0
ÿÉÿ±ÿáÿ™"spezkond"ÿ£QCodeVTMA.spezkond
ÿÙ
ÿ’ÿ¡
anzagvF%ÿanzagvF%ÿ1
ÿÙ
 


ÿ½ positionieren auf die ursprngliche Kondition
ÿÉÿ`ÿ™"VKOND"ÿ£CodeVK.VKOND
ÿÉÿ¥koab%ÿáÿ™"VKOND"ÿ£CodeVK.VKOND
 ÿ’ÿ¡
 
 GStornoDiff%ÿ0
 vertrprov%ÿ0
 ok%ÿ1
 vsumAP%ÿ0
 vsumC%ÿ0
 vsumPP%ÿ0
 vsumPausch%ÿ0
 vertrsr%ÿ0
 provsp%ÿ0
 provsp1%ÿ0
 GBewertungOrig%ÿGBewertung%
 i222%ÿ0
 ÿØok%ÿ1
ÿßÿe
ÿÉÿ`ÿ™"GEKOND"ÿ£lfdnr.GEKOND
ÿÉÿ¥CodeKO.VKONDÿ™"GEKOND"ÿ£lfdnr.GEKOND
ÿ¡ÿOÿC("GEKOND")ÿp
ÿƒWriteLog("  die angegebene Kondition ist nicht enthalten!")
ÿƒWriteLog("  SUPPORT: die in VKOND angegebene Kondition fehlt in GEKOND, bitte Vertrag deaktivieren und erneut an die Provisionsabrechnung bergeben!")
ÿƒAddLogInfo()
ok%ÿ0
ÿ’ÿ¡
ÿ¡ok%ÿ1ÿp
vtagentur$ÿGvtagentur$
vtcodema%ÿGVTCodema%
haftvertrag%ÿSRHaftung.kvertrag
dmeinh%ÿdmeinheit.gekond
codema%ÿCodeMA.GEKOND
vsnrab$ÿvs_nr.kvertrag
lfab%ÿlfdnr.kvertrag
codema1ab%ÿcodema.kvertrag



ÿ½ 15092004

ÿ½ --------------------
ÿ½ -- Abschluáprovision
ÿ½ --------------------

 
ÿ¡kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿp
ÿ½ CALL Fehler("AP Anfang",vs_nr.kvertrag)
ÿ¡APjn.gekondÿ"j"ÿp
	remark2$ÿ"AP"
	ÿ½ Bercksichtigung der Spezialprovision
	ÿ½ prov% = ((GBewertung% / 100) * AP.gekond)
	ÿ¡GSpezko$ÿ"j"ÿp
ÿ½ CALL Fehler("Test auf Spezialkonditionen","")
ÿ¡codema.gekondÿcodema.kvertragÿp
prov%ÿ((GBewertung%ÿ100)ÿAP.gekond)
ÿÉÿ`ÿ™"stamm"
fieinh$ÿFirmaEinhTab.stamm
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
ÿ¡APEurEinh.gekondÿ0ÿp
prov%ÿGBewertung%ÿAPEurEinh.gekondÿFirmaEurEinh.stamm
ÿ^
eurpeinh%ÿeuroproeinh.GEKOND
fireur%ÿFirmaEurEinh.stamm
prov%ÿGBewertung%ÿeuroproeinh.GEKONDÿFirmaEurEinh.stamm
ÿ’ÿ¡
ÿ’ÿ¡
SpezProzent%ÿ0
SpezPausch%ÿ0
anzagvA%ÿ0
provtotal%ÿ0
GSpezProzEinh%ÿ0
GSpezBWEinh%ÿ0

ÿ½ ***** Einheitensystem Provisionsteilung mit Agentur**************************************
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿSpezProvNormal.stammÿ"j"ÿp
ÿØGAGvonAgentur$(anzagvA%)ÿ""
QCodeVTsort$ÿÿ-(GAGvonAgentur$(anzagvA%),18)
ÿÉÿ`ÿ™"Spezkond"ÿ£QCodeVTsort.spezkond
ÿÉÿ¥QCodeVTsort$ÿáÿ™"Spezkond"ÿ£QCodeVTsort.spezkond
butext$ÿBuchungstext.zeingan1ÿ" Spez.Prov."
ÿ¡Prozente.spezkondÿ0ÿp
ÿ¡(vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j")ÿvonAP.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡GSpezProzEinh%ÿ0ÿp
GSpezProzEinh%ÿProzente.spezkond
GSpezBWEinh%ÿGBewertung%ÿGSpezProzEinh%ÿ100
GBewertung%ÿGBewertung%ÿGSpezBWEinh%
GEinhEinmSpez%ÿEinheiten.kvertragÿGSpezProzEinh%ÿ100
ÿ’ÿ¡
ÿ¡APEurEinh.spezkondÿ0ÿp
APEurEinh%ÿAPEurEinh.spezkond

ÿ½ GSpezProzEinh% = Prozente.spezkond
ÿ½ GSpezBWEinh% = prov% * GSpezProzEinh% / 100
ÿ½ GBewertung% = GBewertung% - GSpezBWEinh%
ÿ½ GEinhEinmSpez% = Einheiten.kvertrag * GSpezProzEinh% / 100

provsp%ÿGSpezBWEinh%ÿAPEurEinh.spezkondÿFirmaEurEinh.stamm
ÿ^
europroeinh%ÿeuroproeinh.spezKOND
ÿ½ 05102006

ÿ½ GSpezProzEinh% = Prozente.spezkond
ÿ½ GSpezBWEinh% = prov% * GSpezProzEinh% / 100
ÿ½ GBewertung% = GBewertung% - GSpezBWEinh%
ÿ½ GEinhEinmSpez% = Einheiten.kvertrag * GSpezProzEinh% / 100

ÿ¡europroeinh.spezKONDÿ0ÿp
provsp%ÿGSpezBWEinh%ÿeuroproeinh.spezKONDÿFirmaEurEinh.stamm
ÿ^
provsp%ÿGSpezBWEinh%
ÿ’ÿ¡
ÿ’ÿ¡
provold%ÿprovsp%
provdiff%ÿprovsp%ÿprovges%
provges%ÿprovges%ÿprovdiff%
provsp%ÿprovdiff%
ÿ½ CALL Fehler("Spezprov hier","Provgesamt: " + STR$ (provges%,"999999.00") + "  Provdiff: " + STR$ (provdiff%,"999999.00"))
ÿ½ **************************************************************************
ÿ^
ÿ¡bewertung.zeingan1ÿ
0ÿsr.spezkondÿ0ÿp
ÿ’ÿ¡
ÿ’ÿ¡
ÿƒSpezProvisF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡einmalig.spezkondÿ"j"ÿp
einmaligerfolgt.spezkondÿ"j"
EinmDatum.spezkondÿBuchungsDatum.zeingan1
ÿÌÿ™"Spezkond"
ÿïÿYÿ™"spezkond"
ÿïÿ™"spezkond"
ÿ’ÿ¡
anzagvA%ÿanzagvA%ÿ1
ÿÙ
provtotal%ÿ0
ÿ½ ***** Einheitensystem Ende ***********************************
ÿ^
ÿØGAGvonAgentur$(anzagvA%)ÿ""
QCodeVTMA$ÿÿ-(GAGvonAgentur$(anzagvA%),12)
ÿÉÿ`ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
ÿÉÿ¥QCodeVTMA$ÿáÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
butext$ÿBuchungstext.zeingan1ÿ" Spez.Prov."
ÿ¡Prozente.spezkondÿ0ÿp
ÿ¡(vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j")ÿvonAP.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
ÿ¡APEurEinh.gekondÿ0ÿp
provsp1%ÿGBewertung%ÿAPEurEinh.gekondÿFirmaEurEinh.stamm
ÿ^
eurpeinh%ÿeuroproeinh.GEKOND
fireur%ÿFirmaEurEinh.stamm
provsp1%ÿGBewertung%ÿeuroproeinh.GEKONDÿFirmaEurEinh.stamm
ÿ’ÿ¡
ÿ^
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
provsp1%ÿ((GBewertung%ÿ100)ÿAP.gekond)
ÿ’ÿ¡

ÿ½ CALL Fehler("Spezprov hier","04.09.2005")
provsp%ÿ((provsp1%ÿ100)ÿProzente.spezkond)
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿ½ *************** SR von Spezialprovision zufgen **************************
ÿ¡sr.spezkondÿ0ÿp
sr%ÿsr.spezkond
ÿ¡sr%ÿ0ÿp
Haftv%ÿsrlz.spezkond
ÿ¡Haftv%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftv%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftv%ÿ30)
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftv%ÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ **************************************************************************
ÿ^
ÿ¡bewertung.zeingan1ÿ
0ÿsr.spezkondÿ0ÿp
ÿ’ÿ¡
ÿ’ÿ¡
ÿƒSpezProvisF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1)
ÿ’ÿ¡
ÿ^
ÿ¡pauschale.spezkondÿ0ÿp
ÿ¡(vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j")ÿvonAP.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡GBewertung%ÿ0ÿp
SpezPausch%ÿSpezPPausch%ÿPauschale.spezkond
provsp%ÿPauschale.spezkond
ÿ’ÿ¡
ÿ¡GBewertung%ÿ
0ÿp
SpezPausch%ÿSpezPPausch%ÿ(Pauschale.spezkondÿÿ1)
provsp%ÿPauschale.spezkondÿÿ1
ÿ’ÿ¡

provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿ½ *************** SR von Spezialprovision zufgen **************************
ÿ¡sr.spezkondÿ0ÿp
sr%ÿsr.spezkond
ÿ¡sr%ÿ0ÿp
Haftv%ÿsrlz.spezkond
ÿ¡Haftv%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
!Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftv%ÿ30)
ÿ^
!Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftv%ÿ30)
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftv%ÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ ************************************************************************** 
ÿ^
ÿ’ÿ¡
ÿƒSpezProvisF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡einmalig.spezkondÿ"j"ÿp
einmaligerfolgt.spezkondÿ"j"
EinmDatum.spezkondÿBuchungsDatum.zeingan1
ÿÌÿ™"Spezkond"
ÿïÿYÿ™"spezkond"
ÿïÿ™"spezkond"
ÿ’ÿ¡
anzagvA%ÿanzagvA%ÿ1
ÿÙ
ÿ’ÿ¡


ÿ½ *****15082001************neue Spezialprovision, die einem anderen Vermittler abgezogen wird*********
anzagvFre%ÿ0
ÿ½ GAGFrAgentur$(anzagvFre%,0)
ÿØGAGFrAgentur$(anzagvFre%,0)ÿ""
QCodeVTMA$ÿGAGFrAgentur$(anzagvFre%,0)
vonCodeMA%ÿÿ0(GAGFrAgentur$(anzagvFre%,1))
ÿÉÿ`ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
ÿÉÿ¥QCodeVTMA$ÿáÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
butext$ÿBuchungstext.zeingan1ÿ" Spez.Prov."
ÿ¡Prozente.spezkondÿ0ÿp
ÿ¡(vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j")ÿvonAP.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
provsp1%ÿ((GBewertung%ÿ100)ÿAP.gekond)
provsp%ÿ((provsp1%ÿ100)ÿProzente.spezkond)
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿ½ *************** SR von Spezialprovision zufgen **************************
ÿ¡sr.spezkondÿ0ÿp
sr%ÿsr.spezkond
ÿ¡sr%ÿ0ÿp
Haftv%ÿsrlz.spezkond
ÿ¡Haftv%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftv%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftv%ÿ30)
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftv%ÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ **************************************************************************
ÿ^
ÿ¡bewertung.zeingan1ÿ
0ÿsr.spezkondÿ0ÿp
ÿ’ÿ¡
ÿ’ÿ¡
ÿƒSpezProvisFF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,vonCodeMA%)
ÿ’ÿ¡
ÿ^
ÿ¡pauschale.spezkondÿ0ÿp
ÿ¡(vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j")ÿvonAP.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡GBewertung%ÿ0ÿp
SpezPausch%ÿSpezPPausch%ÿPauschale.spezkond
provsp%ÿPauschale.spezkond
ÿ’ÿ¡
ÿ¡GBewertung%ÿ
0ÿp
SpezPausch%ÿSpezPPausch%ÿ(Pauschale.spezkondÿÿ1)
provsp%ÿPauschale.spezkondÿÿ1
ÿ’ÿ¡
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿ½ *************** SR von Spezialprovision zufgen **************************
ÿ¡sr.spezkondÿ0ÿp
sr%ÿsr.spezkond
ÿ¡sr%ÿ0ÿp
Haftv%ÿsrlz.spezkond
ÿ¡Haftv%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftv%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftv%ÿ30)
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftv%ÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ ************************************************************************** 
ÿ^
ÿ’ÿ¡
ÿƒSpezProvisFF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,vonCodeMA%)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡einmalig.spezkondÿ"j"ÿp
einmaligerfolgt.spezkondÿ"j"
EinmDatum.spezkondÿBuchungsDatum.zeingan1
ÿÌÿ™"Spezkond"
ÿïÿYÿ™"spezkond"
ÿïÿ™"spezkond"
ÿ’ÿ¡
anzagvFre%ÿanzagvFre%ÿ1
ÿÙ
ÿ½ *****************ENDE Spezialisteprovision ************************************************************************************** 
 



p1508200101: 


ÿ½ prov% = ((GBewertung% / 100) * AP.gekond) - ((GBewertung% / 100) * SpezProzent%) - SpezPausch%
ÿ½ prov% = provges%
andisrtest%ÿsr.zeingan1
andisrjn$ÿSRjn.gekond
prov%ÿ((GBewertung%ÿ100)ÿAP.gekond)
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
ÿ¡APEurEinh.gekondÿ0ÿp
prov%ÿGBewertung%ÿAPEurEinh.gekondÿFirmaEurEinh.stamm
ÿ^
prov%ÿGBewertung%ÿeuroproeinh.GEKONDÿFirmaEurEinh.stamm
ÿ’ÿ¡
ÿ’ÿ¡
vsumAP%ÿprovtotal%
ÿ^
andisrtest%ÿsr.zeingan1
andisrjn$ÿSRjn.gekond
prov%ÿ((GBewertung%ÿ100)ÿAP.gekond)
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
ÿ¡APEurEinh.gekondÿ0ÿp
prov%ÿGBewertung%ÿAPEurEinh.gekondÿFirmaEurEinh.stamm
ÿ^
prov%ÿGBewertung%ÿeuroproeinh.GEKONDÿFirmaEurEinh.stamm
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½**************** ELSE von GSpezko$="j"
	ÿ^
prov%ÿ((GBewertung%ÿ100)ÿAP.gekond)
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
ÿ¡APEurEinh.gekondÿ0ÿp
prov%ÿGBewertung%ÿAPEurEinh.gekondÿFirmaEurEinh.stamm
ÿ^
euproeinh123%ÿeuroproeinh.GEKOND
fieureinh%ÿFirmaEurEinh.stamm
prov%ÿGBewertung%ÿeuroproeinh.GEKONDÿFirmaEurEinh.stamm
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ½ IF gez_Abschluá.kvertrag <> "j" THEN 
	ÿ½ prov% = ((Bewertungssumme.KVERTRAG / 100) * AP.gekond)
	andisrtest%ÿsr.zeingan1
	andisrjn$ÿSRjn.gekond
	ssok%ÿ0
	ÿ¡FirmaEinhTab.stammÿ"j"ÿp
ÿ¡SRjn.gekondÿ"j"ÿprov%ÿ0ÿsr.zeingan1ÿ0ÿp
ssok%ÿÿ1
ÿ’ÿ¡
	ÿ^
ÿ¡SRjn.gekondÿ"j"ÿp
ssok%ÿÿ1
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ¡ssok%ÿÿ1ÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
 
ÿ¡Haftvertrag%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftvertrag%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftvertrag%ÿ30)
ÿ’ÿ¡
ÿ^
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftung.gekondÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftung.gekondÿ30)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftung.gekondÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
	ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ½ 161197 IF Haftung = - 1 THEN 
ÿ½ 161197sr% = sr.gekond
ÿ½ 161197Haftung% = 0
ÿ½ 161197ELSE 
ÿ½ 161197sr% = 0
ÿ½ 161197Haftung% = 0
ÿ½ 161197END IF 
	ÿ’ÿ¡
	ÿ¡n„chsteKond.VKONDÿ0ÿp
prov%ÿprov%ÿVProvisNZ%
VProvisNZ%ÿ0
	ÿ’ÿ¡

	ÿ¡GBewertung%ÿ0ÿsr.zeingan1ÿ0ÿp
ÿƒRegProvisZ(Buchungstext.zeingan1,codema%,prov%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,remark2$)
	ÿ^
ÿ¡kondart.zeingan1ÿ0ÿp
ÿ¡prov%ÿ0ÿsr%ÿ0ÿp
ÿƒRegProvisZ(Buchungstext.zeingan1,codema%,prov%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,remark2$)
ÿ’ÿ¡
ÿ^
ÿ¡prov%ÿ0ÿsr%ÿ0ÿp
ÿƒRegProvisZ(Buchungstext.zeingan1,codema%,prov%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,remark2$)
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ^
	ÿÉÿ¥codema%ÿ™"maadr"ÿ£codema.maadr
	ÿƒWriteLog("keine AP fr Vertrag: "ÿVS_Nr.KVERTRAGÿ" Agentur: "ÿnachname.maadrÿ", "ÿvorname.maadrÿ", "ÿAgenturnr.maadrÿ" definiert!")
ÿ’ÿ¡
ÿ’ÿ¡











ÿ½ --------------------
ÿ½ -- Dynamik AP
ÿ½ --------------------
ÿ½ CALL Fehler("","")
 
ÿ¡kondart.zeingan1ÿ4ÿp
ÿ¡DynamikPjn.gekondÿ"j"ÿp
	remark2$ÿ"Dynamik AP"
	ÿ¡FirmaEinhTab.stammÿ"j"ÿp
remark2$ÿ"Dynamik"
	ÿ’ÿ¡
 
	ÿ½ Bercksichtigung der Spezialprovision
	ÿ½ prov% = ((GBewertung% / 100) * AP.gekond)
	ÿ¡GSpezko$ÿ"j"ÿp
ÿ½ CALL Fehler("Test auf Spezialkonditionen","")
ÿ¡codema.gekondÿcodema.kvertragÿp
prov%ÿ((GBewertung%ÿ100)ÿDynamikProz.gekond)
SpezProzent%ÿ0
SpezPausch%ÿ0
anzagvA%ÿ0
provtotal%ÿ0
ÿØGAGvonAgentur$(anzagvA%)ÿ""
QCodeVTMA$ÿÿ-(GAGvonAgentur$(anzagvA%),12)
ÿÉÿ`ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
ÿÉÿ¥QCodeVTMA$ÿáÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
butext$ÿBuchungstext.zeingan1ÿ" Spez.Prov."
ÿ¡Prozente.spezkondÿ0ÿp
ÿ¡(vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j")ÿvonAP.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
provsp1%ÿ((GBewertung%ÿ100)ÿDynamikProz.gekond)
provsp%ÿ((provsp1%ÿ100)ÿProzente.spezkond)
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿ½ *************** SR von Spezialprovision zufgen **************************
ÿ¡sr.spezkondÿ0ÿp
sr%ÿsr.spezkond
ÿ¡sr%ÿ0ÿp
Haftv%ÿsrlz.spezkond
ÿ¡Haftv%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftv%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftv%ÿ30)
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftv%ÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ **************************************************************************
ÿ^
ÿ¡bewertung.zeingan1ÿ
0ÿsr.spezkondÿ0ÿp
ÿ’ÿ¡
ÿ’ÿ¡
ÿƒSpezProvisF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1)
ÿ’ÿ¡
ÿ^
ÿ¡pauschale.spezkondÿ0ÿp
ÿ¡(vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j")ÿvonAP.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡GBewertung%ÿ0ÿp
SpezPausch%ÿSpezPPausch%ÿPauschale.spezkond
provsp%ÿPauschale.spezkond
ÿ’ÿ¡
ÿ¡GBewertung%ÿ
0ÿp
SpezPausch%ÿSpezPPausch%ÿ(Pauschale.spezkondÿÿ1)
provsp%ÿPauschale.spezkondÿÿ1
ÿ’ÿ¡

provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿ½ *************** SR von Spezialprovision zufgen **************************
ÿ¡sr.spezkondÿ0ÿp
sr%ÿsr.spezkond
ÿ¡sr%ÿ0ÿp
Haftv%ÿsrlz.spezkond
ÿ¡Haftv%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftv%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftv%ÿ30)
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftv%ÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ ************************************************************************** 
ÿ^
ÿ’ÿ¡
ÿƒSpezProvisF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡einmalig.spezkondÿ"j"ÿp
einmaligerfolgt.spezkondÿ"j"
EinmDatum.spezkondÿBuchungsDatum.zeingan1
ÿÌÿ™"Spezkond"
ÿïÿYÿ™"spezkond"
ÿïÿ™"spezkond"
ÿ’ÿ¡
anzagvA%ÿanzagvA%ÿ1
ÿÙ
 
ÿ½ GOTO p1508200101
 
 
ÿ½ *****15082001************neue Spezialprovision, die einem anderen Vermittler abgezogen wird*********
anzagvFre%ÿ0
ÿ½ GAGFrAgentur$(anzagvFre%,0)
ÿØGAGFrAgentur$(anzagvFre%,0)ÿ""
QCodeVTMA$ÿGAGFrAgentur$(anzagvFre%,0)
vonCodeMA%ÿÿ0(GAGFrAgentur$(anzagvFre%,1))
ÿÉÿ`ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
ÿÉÿ¥QCodeVTMA$ÿáÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
butext$ÿBuchungstext.zeingan1ÿ" Spez.Prov."
ÿ¡Prozente.spezkondÿ0ÿp
ÿ¡(vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j")ÿvonAP.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
provsp1%ÿ((GBewertung%ÿ100)ÿDynamikProz.gekond)
provsp%ÿ((provsp1%ÿ100)ÿProzente.spezkond)
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿ½ *************** SR von Spezialprovision zufgen **************************
ÿ¡sr.spezkondÿ0ÿp
sr%ÿsr.spezkond
ÿ¡sr%ÿ0ÿp
Haftv%ÿsrlz.spezkond
ÿ¡Haftv%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftv%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftv%ÿ30)
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftv%ÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ **************************************************************************
ÿ^
ÿ¡bewertung.zeingan1ÿ
0ÿsr.spezkondÿ0ÿp
ÿ’ÿ¡
ÿ’ÿ¡
ÿƒSpezProvisFF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,vonCodeMA%)
ÿ’ÿ¡
ÿ^
ÿ¡pauschale.spezkondÿ0ÿp
ÿ¡(vonCourtage.spezkondÿ"j"ÿvonPflege.spezkondÿ"j")ÿvonAP.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡GBewertung%ÿ0ÿp
SpezPausch%ÿSpezPPausch%ÿPauschale.spezkond
provsp%ÿPauschale.spezkond
ÿ’ÿ¡
ÿ¡GBewertung%ÿ
0ÿp
SpezPausch%ÿSpezPPausch%ÿ(Pauschale.spezkondÿÿ1)
provsp%ÿPauschale.spezkondÿÿ1
ÿ’ÿ¡
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿ½ *************** SR von Spezialprovision zufgen **************************
ÿ¡sr.spezkondÿ0ÿp
sr%ÿsr.spezkond
ÿ¡sr%ÿ0ÿp
Haftv%ÿsrlz.spezkond
ÿ¡Haftv%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftv%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftv%ÿ30)
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftv%ÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ ************************************************************************** 
ÿ^
ÿ’ÿ¡
ÿƒSpezProvisFF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,vonCodeMA%)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡einmalig.spezkondÿ"j"ÿp
einmaligerfolgt.spezkondÿ"j"
EinmDatum.spezkondÿBuchungsDatum.zeingan1
ÿÌÿ™"Spezkond"
ÿïÿYÿ™"spezkond"
ÿïÿ™"spezkond"
ÿ’ÿ¡
anzagvFre%ÿanzagvFre%ÿ1
ÿÙ
ÿ½ ******************************************************************************************************* 
 
 
 
 
p1508200101: 
 
 
ÿ½ prov% = ((GBewertung% / 100) * AP.gekond) - ((GBewertung% / 100) * SpezProzent%) - SpezPausch%
ÿ½ prov% = provges%
prov%ÿ((GBewertung%ÿ100)ÿDynamikProz.gekond)
vsumAP%ÿprovtotal%
ÿ^
prov%ÿ((GBewertung%ÿ100)ÿDynamikProz.gekond)
ÿ’ÿ¡
	ÿ^
prov%ÿ((GBewertung%ÿ100)ÿDynamikProz.gekond)
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
ÿ¡DynEurEinh.gekondÿ0ÿp
prov%ÿGBewertung%ÿDynEurEinh.gekondÿFirmaEurEinh.stamm
ÿ^
prov%ÿGBewertung%ÿeuroproeinh.GEKONDÿFirmaEurEinh.stamm
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ½ IF gez_Abschluá.kvertrag <> "j" THEN 
	ÿ½ prov% = ((Bewertungssumme.KVERTRAG / 100) * AP.gekond)
	
	ÿ½ IF SRjn.gekond = "j" THEN 
	ÿ½ IF SRjn.gekond = "j" AND prov% <> 0 AND sr.zeingan1 = 0 THEN 
	ssok%ÿ0
	ÿ¡FirmaEinhTab.stammÿ"j"ÿp
ÿ¡SRjn.gekondÿ"j"ÿprov%ÿ0ÿsr.zeingan1ÿ0ÿpssok%ÿÿ1
	ÿ^
ÿ¡SRjn.gekondÿ"j"ÿpssok%ÿÿ1
	ÿ’ÿ¡
	ÿ¡ssok%ÿÿ1ÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
 
ÿ¡Haftvertrag%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftvertrag%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftvertrag%ÿ30)
ÿ’ÿ¡
ÿ^
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftung.gekondÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftung.gekondÿ30)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftung.gekondÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
	ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ½ 161197 IF Haftung = - 1 THEN 
ÿ½ 161197sr% = sr.gekond
ÿ½ 161197Haftung% = 0
ÿ½ 161197ELSE 
ÿ½ 161197sr% = 0
ÿ½ 161197Haftung% = 0
ÿ½ 161197END IF 
	ÿ’ÿ¡
	ÿ¡n„chsteKond.VKONDÿ0ÿp
prov%ÿprov%ÿVProvisNZ%
VProvisNZ%ÿ0
	ÿ’ÿ¡
	ÿ¡GBewertung%ÿ0ÿsr.zeingan1ÿ0ÿp
ÿ¡kondart.zeingan1ÿ4ÿp
ÿƒRegProvisZ(Buchungstext.zeingan1,codema%,prov%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,remark2$)
ÿ’ÿ¡
	ÿ^
ÿ¡kondart.zeingan1ÿ4ÿp
ÿ¡prov%ÿ0ÿsr%ÿ0ÿpÿƒRegProvisZ(Buchungstext.zeingan1,codema%,prov%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,remark2$)
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ^
	ÿÉÿ¥codema%ÿ™"maadr"ÿ£codema.maadr
	ÿƒWriteLog("keine Dynamik AP fr Vertrag: "ÿVS_Nr.KVERTRAGÿ" Agentur: "ÿnachname.maadrÿ", "ÿvorname.maadrÿ", "ÿAgenturnr.maadrÿ" definiert!")
ÿ’ÿ¡
ÿ’ÿ¡
 
 












 
ÿ½ ----------------
ÿ½ -- Vertragsdauer
ÿ½ ----------------
 
ÿ¡VDjn.gekondÿ"j"ÿp
	remark2$ÿ"VD"
	ÿ½ IF gez_Abschluá.kvertrag <> "j" THEN 
ÿÉÿæVS_Dauer.KVERTRAG
ÿæVD1Dauer.gekond
prov%ÿ((GBewertung%ÿ100)ÿVD1AP.gekond)
sr%ÿVD1SR.gekond
Haftung1%ÿVD1HZ.GEKOND
ÿ¡Haftung1%ÿÿ1ÿpHaftung%ÿ0
ÿæVD2Dauer.gekond
prov%ÿ((GBewertung%ÿ100)ÿVD2AP.gekond)
sr%ÿVD2SR.gekond
Haftung1%ÿVD2HZ.GEKOND
ÿ¡Haftung1%ÿÿ1ÿpHaftung%ÿ0
ÿæVD3Dauer.gekond
prov%ÿ((GBewertung%ÿ100)ÿVD3AP.gekond)
sr%ÿVD3SR.gekond
Haftung1%ÿVD3HZ.GEKOND
ÿ¡Haftung1%ÿÿ1ÿpHaftung%ÿ0
ÿæVD4Dauer.gekond
prov%ÿ((GBewertung%ÿ100)ÿVD4AP.gekond)
sr%ÿVD4SR.gekond
Haftung1%ÿVD4HZ.GEKOND
ÿ¡Haftung1%ÿÿ1ÿpHaftung%ÿ0
ÿæVD5Dauer.gekond
prov%ÿ((GBewertung%ÿ100)ÿVD5AP.gekond)
sr%ÿVD5SR.gekond
Haftung1%ÿVD5HZ.GEKOND
ÿ¡Haftung1%ÿÿ1ÿpHaftung%ÿ0
ÿ’ÿÉ
ÿ¡sr%ÿ0ÿHaftung%ÿ0ÿp
ÿ½ Haftung% = (Haftung% * 30) + DAYS (VS_beginn.kvertrag)
ÿ¡Haftvertrag%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftvertrag%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftvertrag%ÿ30)
ÿ’ÿ¡
ÿ^
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftung1%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftung1%ÿ30)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ¡Haftung%ÿÿ1ÿp
ÿ½ Haftung% = 0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ½ CALL RegProvis("VD: " + VS_Nr.kvertrag,codema%,prov%,sr%,Haftung%)
ÿ¡prov%ÿ0ÿsr%ÿ0ÿpÿƒRegProvisZ(Buchungstext.zeingan1,codema%,prov%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,remark2$)
	ÿ½ END IF 
ÿ’ÿ¡
 
 
 
 
ÿ½ IF APjn.gekond <> "j" AND VDjn.gekond <> "j" THEN 
	ÿ½ keine AP Kondit definiert
	ÿ½ SELECT KEY codema% FILE "maadr" INDEX codema.maadr
	ÿ½ CALL WriteLog("keine AP fr Vertrag: " + VS_Nr.KVERTRAG + " Agentur: " + nachname.maadr + ", " + vorname.maadr + ", " + Agenturnr.maadr + " definiert!")
ÿ½ END IF 
ÿ½ END IF 
 
ÿ½ ------------------
ÿ½ -- Pflegeprovision
ÿ½ ------------------
ÿ½ 13.10.94  - keine Berechung der Stornoreserve
pflege%ÿ0
PflegeGez$ÿ"n"

ÿ¡kondart.zeingan1ÿ2ÿp
ÿ½ CALL Fehler("Pflege",vs_nr.kvertrag)
ÿ¡PflegeJN.gekondÿ"j"ÿp
	remark2$ÿ"Pflege"
	ÿ¡GSpezko$ÿ"j"ÿp
ÿ½ CALL Fehler("Test auf Spezialkonditionen","")
ÿ¡codema.gekondÿcodema.kvertragÿp
prov%ÿ((GBewertung%ÿ100)ÿPflegeProvi.gekond)
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
ÿ¡PflEurEinh.gekondÿ0ÿp
prov%ÿ(GBewertung%)ÿ(PflEurEinh.gekondÿFirmaEurEinh.stamm)
ÿ^
prov%ÿ(GBewertung%)ÿ(europroeinh.GEKONDÿFirmaEurEinh.stamm)
ÿ’ÿ¡
ÿ’ÿ¡
SpezProzent%ÿ0
SpezPausch%ÿ0
anzagvA%ÿ0
provtotal%ÿ0
GSpezProzEinh%ÿ0
GSpezBWEinh%ÿ0
 
ÿØGAGvonAgentur$(anzagvA%)ÿ""
QCodeVTMA$ÿÿ-(GAGvonAgentur$(anzagvA%),12)
ÿÉÿ`ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
ÿÉÿ¥QCodeVTMA$ÿáÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
butext$ÿBuchungstext.zeingan1ÿ" Spez.Prov."
ÿ¡Prozente.spezkondÿ0ÿp
ÿ¡(vonCourtage.spezkondÿ"j"ÿvonAP.spezkondÿ"j")ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
ÿ¡PflEurEinh.gekondÿ0ÿp
provsp1%ÿ(GBewertung%)ÿ(PflEurEinh.gekondÿFirmaEurEinh.stamm)
ÿ^
provsp1%ÿ(GBewertung%)ÿ(europroeinh.GEKONDÿFirmaEurEinh.stamm)
ÿ’ÿ¡
ÿ^
provsp1%ÿ((GBewertung%ÿ100)ÿPflegeProvi.gekond)
ÿ’ÿ¡
provsp%ÿ((provsp1%ÿ100)ÿProzente.spezkond)
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿƒSpezProvisF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡pauschale.spezkondÿ0ÿp
ÿ¡(vonCourtage.spezkondÿ"j"ÿvonAP.spezkondÿ"j")ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡GBewertung%ÿ0ÿp
SpezPausch%ÿSpezPPausch%ÿPauschale.spezkond
provsp%ÿPauschale.spezkond
ÿ’ÿ¡
ÿ¡GBewertung%ÿ
0ÿp
SpezPausch%ÿSpezPPausch%ÿ(Pauschale.spezkondÿÿ1)
provsp%ÿPauschale.spezkondÿÿ1
ÿ’ÿ¡
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿƒSpezProvisF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡einmalig.spezkondÿ"j"ÿp
einmaligerfolgt.spezkondÿ"j"
EinmDatum.spezkondÿBuchungsDatum.zeingan1
ÿÌÿ™"Spezkond"
ÿïÿYÿ™"spezkond"
ÿïÿ™"spezkond"
ÿ’ÿ¡
anzagvA%ÿanzagvA%ÿ1
ÿÙ

ÿ½ ************* neue Spezialprovision  Pflege *************************************************************
anzagvFre%ÿ0
ÿ½ GAGFrAgentur$(anzagvFre%,0)
ÿØGAGFrAgentur$(anzagvFre%,0)ÿ""
QCodeVTMA$ÿGAGFrAgentur$(anzagvFre%,0)
vonCodeMA%ÿÿ0(GAGFrAgentur$(anzagvFre%,1))
ÿÉÿ`ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
ÿÉÿ¥QCodeVTMA$ÿáÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
butext$ÿBuchungstext.zeingan1ÿ" Spez.Prov."
ÿ¡Prozente.spezkondÿ0ÿp
ÿ¡(vonCourtage.spezkondÿ"j"ÿvonAP.spezkondÿ"j")ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
provsp1%ÿ((GBewertung%ÿ100)ÿPflegeProvi.gekond)
provsp%ÿ((provsp1%ÿ100)ÿProzente.spezkond)
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿƒSpezProvisFF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,vonCodeMA%)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡pauschale.spezkondÿ0ÿp
ÿ¡(vonCourtage.spezkondÿ"j"ÿvonAP.spezkondÿ"j")ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡GBewertung%ÿ0ÿp
SpezPausch%ÿSpezPPausch%ÿPauschale.spezkond
provsp%ÿPauschale.spezkond
ÿ’ÿ¡
ÿ¡GBewertung%ÿ
0ÿp
SpezPausch%ÿSpezPPausch%ÿ(Pauschale.spezkondÿÿ1)
provsp%ÿPauschale.spezkondÿÿ1
ÿ’ÿ¡
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿƒSpezProvisFF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,vonCodeMA%)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡einmalig.spezkondÿ"j"ÿp
einmaligerfolgt.spezkondÿ"j"
EinmDatum.spezkondÿBuchungsDatum.zeingan1
ÿÌÿ™"Spezkond"
ÿïÿYÿ™"spezkond"
ÿïÿ™"spezkond"
ÿ’ÿ¡
anzagvFre%ÿanzagvFre%ÿ1
ÿÙ
ÿ½ **********************Ende neue Spezialprov Pflege ******************************************************



ÿ½ prov% = ((GBewertung% / 100) * PflegeProvi.gekond) - ((GBewertung% / 100) * SpezProzent%) - SpezPausch%
ÿ½ prov% = provges%
prov%ÿ(((GBewertung%)ÿ100)ÿPflegeProvi.gekond)
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
ÿ¡PflEurEinh.gekondÿ0ÿp
prov%ÿGBewertung%ÿPflEurEinh.gekondÿFirmaEurEinh.stamm
ÿ^
prov%ÿGBewertung%ÿeuroproeinh.GEKONDÿFirmaEurEinh.stamm
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ vsumAP% = provtotal%
vsumPP%ÿprovtotal%
ÿ^
prov%ÿ(((GBewertung%)ÿ100)ÿPflegeProvi.gekond)
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
aeuroproei%ÿeuroproeinh.gekond
aFirmaEui%ÿFirmaEurEinh.stamm
ÿ¡PflEurEinh.gekondÿ0ÿp
prov%ÿGBewertung%ÿPflEurEinh.gekondÿFirmaEurEinh.stamm
ÿ^
prov%ÿGBewertung%ÿeuroproeinh.GEKONDÿFirmaEurEinh.stamm
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ^
prov%ÿ(((GBewertung%)ÿ100)ÿPflegeProvi.gekond)
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
aeuroproei%ÿeuroproeinh.gekond
aFirmaEui%ÿFirmaEurEinh.stamm
ÿ¡PflEurEinh.gekondÿ0ÿp
prov%ÿGBewertung%ÿPflEurEinh.gekondÿFirmaEurEinh.stamm
ÿ^
prov%ÿGBewertung%ÿeuroproeinh.GEKONDÿFirmaEurEinh.stamm
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ½ prov% = (((GBewertung%) / 100) * PflegeProvi.gekond)
	pflegeGez$ÿ"j"
	pflege%ÿ1
	sr%ÿ0
	Haftung%ÿ0
	ÿ¡n„chsteKond.VKONDÿ0ÿp
prov%ÿprov%ÿVProvisNZ%
VProvisNZ%ÿ0
	ÿ’ÿ¡
	ÿ¡PflegeGez$ÿ"j"ÿprov%ÿ0ÿpÿƒRegProvisZ(Buchungstext.zeingan1,codema%,prov%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,remark2$)
ÿ^
	ÿ½ keine Pflege Kondit definiert
	ÿÉÿ¥codema%ÿ™"maadr"ÿ£codema.maadr
	ÿ¡GAFSK$ÿ"TRUE"ÿp
ÿ¡pfleganzfehl.gekondÿ""ÿp
ÿƒWriteLog("keine Pflege fr Vertrag: "ÿVS_Nr.KVERTRAGÿ" Agentur: "ÿnachname.maadrÿ", "ÿvorname.maadrÿ", "ÿAgenturnr.maadrÿ" definiert!")
ÿ’ÿ¡
	ÿ^
ÿƒWriteLog("keine Pflege fr Vertrag: "ÿVS_Nr.KVERTRAGÿ" Agentur: "ÿnachname.maadrÿ", "ÿvorname.maadrÿ", "ÿAgenturnr.maadrÿ" definiert!")
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡




ÿ½ ------------------
ÿ½ -- Betreuung
ÿ½ ------------------
ÿ½ 13.10.94  - keine Berechung der Stornoreserve
pflege%ÿ0
PflegeGez$ÿ"n"

ÿ¡kondart.zeingan1ÿ5ÿp
ÿ½ CALL Fehler("Betreuung","")
ÿ¡BetreuJN.gekondÿ"j"ÿp
	remark2$ÿ"Betreuung"
	ÿ¡FirmaEinhTab.stammÿ"j"ÿp
remark2$ÿ"Folge"
	ÿ’ÿ¡
	ÿ¡GSpezko$ÿ"j"ÿp
ÿ½ CALL Fehler("Test auf Spezialkonditionen","")
ÿ¡codema.gekondÿcodema.kvertragÿp
prov%ÿ((GBewertung%ÿ100)ÿBetreuProz.gekond)
SpezProzent%ÿ0
SpezPausch%ÿ0
anzagvA%ÿ0
provtotal%ÿ0
ÿØGAGvonAgentur$(anzagvA%)ÿ""
QCodeVTMA$ÿÿ-(GAGvonAgentur$(anzagvA%),12)
ÿÉÿ`ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
ÿÉÿ¥QCodeVTMA$ÿáÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
butext$ÿBuchungstext.zeingan1ÿ" Spez.Prov."
ÿ¡Prozente.spezkondÿ0ÿp
ÿ¡(vonCourtage.spezkondÿ"j"ÿvonAP.spezkondÿ"j")ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
provsp1%ÿ((GBewertung%ÿ100)ÿPflegeProvi.gekond)
provsp%ÿ((provsp1%ÿ100)ÿProzente.spezkond)
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿƒSpezProvisF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡pauschale.spezkondÿ0ÿp
ÿ¡(vonCourtage.spezkondÿ"j"ÿvonAP.spezkondÿ"j")ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡GBewertung%ÿ0ÿp
SpezPausch%ÿSpezPPausch%ÿPauschale.spezkond
provsp%ÿPauschale.spezkond
ÿ’ÿ¡
ÿ¡GBewertung%ÿ
0ÿp
SpezPausch%ÿSpezPPausch%ÿ(Pauschale.spezkondÿÿ1)
provsp%ÿPauschale.spezkondÿÿ1
ÿ’ÿ¡
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿƒSpezProvisF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡einmalig.spezkondÿ"j"ÿp
einmaligerfolgt.spezkondÿ"j"
EinmDatum.spezkondÿBuchungsDatum.zeingan1
ÿÌÿ™"Spezkond"
ÿïÿYÿ™"spezkond"
ÿïÿ™"spezkond"
ÿ’ÿ¡
anzagvA%ÿanzagvA%ÿ1
ÿÙ
 
 
ÿ½ ************* neue Spezialprovision  Pflege *************************************************************
anzagvFre%ÿ0
ÿ½ GAGFrAgentur$(anzagvFre%,0)
ÿØGAGFrAgentur$(anzagvFre%,0)ÿ""
QCodeVTMA$ÿGAGFrAgentur$(anzagvFre%,0)
vonCodeMA%ÿÿ0(GAGFrAgentur$(anzagvFre%,1))
ÿÉÿ`ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
ÿÉÿ¥QCodeVTMA$ÿáÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
butext$ÿBuchungstext.zeingan1ÿ" Spez.Prov."
ÿ¡Prozente.spezkondÿ0ÿp
ÿ¡(vonCourtage.spezkondÿ"j"ÿvonAP.spezkondÿ"j")ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
provsp1%ÿ((GBewertung%ÿ100)ÿBetreuProz.gekond)
provsp%ÿ((provsp1%ÿ100)ÿProzente.spezkond)
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿƒSpezProvisFF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,vonCodeMA%)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡pauschale.spezkondÿ0ÿp
ÿ¡(vonCourtage.spezkondÿ"j"ÿvonAP.spezkondÿ"j")ÿvonPflege.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡GBewertung%ÿ0ÿp
SpezPausch%ÿSpezPPausch%ÿPauschale.spezkond
provsp%ÿPauschale.spezkond
ÿ’ÿ¡
ÿ¡GBewertung%ÿ
0ÿp
SpezPausch%ÿSpezPPausch%ÿ(Pauschale.spezkondÿÿ1)
provsp%ÿPauschale.spezkondÿÿ1
ÿ’ÿ¡
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿƒSpezProvisFF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,vonCodeMA%)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡einmalig.spezkondÿ"j"ÿp
einmaligerfolgt.spezkondÿ"j"
EinmDatum.spezkondÿBuchungsDatum.zeingan1
ÿÌÿ™"Spezkond"
ÿïÿYÿ™"spezkond"
ÿïÿ™"spezkond"
ÿ’ÿ¡
anzagvFre%ÿanzagvFre%ÿ1
ÿÙ
ÿ½ **********************Ende neue Spezialprov Pflege ******************************************************
 
 
 
ÿ½ prov% = ((GBewertung% / 100) * PflegeProvi.gekond) - ((GBewertung% / 100) * SpezProzent%) - SpezPausch%
ÿ½ prov% = provges%
prov%ÿ(((GBewertung%)ÿ100)ÿBetreuProz.gekond)
vsumPP%ÿprovtotal%
ÿ^
prov%ÿ(((GBewertung%)ÿ100)ÿBetreuProz.gekond)
ÿ’ÿ¡
	ÿ^
prov%ÿ(((GBewertung%)ÿ100)ÿBetreuProz.gekond)
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
ÿ¡FolgEurEinh.gekondÿ0ÿp
prov%ÿGBewertung%ÿFolgEurEinh.gekondÿFirmaEurEinh.stamm
ÿ^
prov%ÿGBewertung%ÿeuroproeinh.GEKONDÿFirmaEurEinh.stamm
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ½ prov% = (((GBewertung%) / 100) * PflegeProvi.gekond)
	pflegeGez$ÿ"j"
	pflege%ÿ1
	sr%ÿ0
	Haftung%ÿ0
	ÿ¡n„chsteKond.VKONDÿ0ÿp
prov%ÿprov%ÿVProvisNZ%
VProvisNZ%ÿ0
	ÿ’ÿ¡
	ÿ¡PflegeGez$ÿ"j"ÿprov%ÿ0ÿpÿƒRegProvisZ(Buchungstext.zeingan1,codema%,prov%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,remark2$)
ÿ^
	ÿ½ keine AP Kondit definiert
	ÿÉÿ¥codema%ÿ™"maadr"ÿ£codema.maadr
	ÿƒWriteLog("keine Betreuung-Pflege fr Vertrag: "ÿVS_Nr.KVERTRAGÿ" Agentur: "ÿnachname.maadrÿ", "ÿvorname.maadrÿ", "ÿAgenturnr.maadrÿ" definiert!")
ÿ’ÿ¡
ÿ’ÿ¡
 





 
ÿ½ -----------
ÿ½ -- Courtage
ÿ½ -----------
ÿ½ CALL Fehler("Courtage","Andiiiiii")
ÿ¡vs_nr.kvertragÿ"A2180488401"ÿp
i222%ÿi222%ÿ1
ÿ½ CALL Fehler(vs_nr.zeingan1, STR$ (i222%) + "   " + STR$ (TgezProvAnz.kvfael))
ÿ’ÿ¡
GAFSKLALA%ÿ0
CourtGez$ÿ"n"
ÿ¡kondart.zeingan1ÿ1ÿp
ÿ½ CALL Fehler("Courtage","Andiiiiii")
ÿ¡CourtageJN.gekondÿ"j"ÿp
	remark2$ÿ"Courtage"
	lala%ÿ0
	ÿ¡ÿJ(codevp.kvertrag,codevp.vpgekond)ÿp
ÿÉÿ¥codevp.kvertragÿ™"VPGEKOND"ÿ£codevp.vpgekond
ÿ¡afsk.vpgekondÿ"j"ÿplala%ÿÿ1
	ÿ’ÿ¡
	ÿ¡GAFSK$ÿ"TRUE"ÿlala%ÿÿ1ÿp
ÿ½ CALL Fehler("Courtage","Andiiiiii-AFSK")
GAFSKLALA%ÿÿ1
remark2$ÿ""
ÿÉÿ`ÿ™"KVFAEL"ÿ£codevt.kvfael
ÿÉÿ¥lfdnr.kvertragÿáÿ™"KVFAEL"ÿ£codevt.kvfael
ÿ½ 03092002
ÿ¡abserledigt.kvfaelÿ"j"ÿp
ÿ¡n„chsteKond.VKONDÿ0ÿp
ÿ¡TgezProvAnz.kvfaelÿ1ÿp
GBewertung%ÿGBewertungOrig%
gezProv.kvfaelÿgezProv.kvfaelÿBewertung.zeingan1
ÿ¡Bewertung.zeingan1ÿ0ÿp
gezProvAnz.kvfaelÿgezProvAnz.kvfaelÿ1
ÿ^
gezProvAnz.kvfaelÿgezProvAnz.kvfaelÿ1
ÿ’ÿ¡
ÿÌÿ™"KVFAEL"
ÿïÿYÿ™"KVFAEL"
prov%ÿ((GBewertung%ÿ100)ÿCourtage.gekond)
ÿwcberafs03092002
ÿ’ÿ¡
ÿ^
ÿwcp190620021
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡erwProvAnz.kvfaelÿ0ÿperwProvAnz.kvfaelÿ4
erwProv%ÿBeitrag.kvertragÿerwProvAnz.kvfael
ÿ¡f„lligam.kvfaelÿ
1ÿpf„lligam.kvfaelÿProviAB.kvertrag
ÿ¡VMProv.kvfaelÿ0ÿp
VMProv.kvfaelÿerwProv%
VMProvEu.kvfaelÿÿ0(ÿ(VMProv.kvfaelÿumrechnung.kvertrag,"999999999.00"))
ÿ’ÿ¡
ÿ¡erledigt.kvfaelÿ"j"ÿf„lligam.kvfaelÿ0ÿp
ÿ¡TgezProvAnz.kvfaelÿ1ÿp
gez%ÿgezProv.kvfaelÿBewertung.zeingan1
ÿ^
gez%ÿgezProv.kvfael
ÿ’ÿ¡

ÿ¡gez%ÿ
erwProv%ÿautokuend.kvfaelÿ"j"ÿperledigt.kvfaelÿ"n"
ÿ’ÿ¡
weitab%ÿÿ1
ÿ¡autokuend.kvfaelÿ"j"ÿp
ÿ½ es wurde autom.gekndigt, da fehlender Beitrag
b%ÿÿ1(calcdate$)
b$ÿÿ(b%,"mm.yyyy.0d")
bumon%ÿÿ0(ÿ+(b$,2))
erwProvAnz%ÿerwProvAnz.kvfael
ÿ¡erwProvAnz.kvfaelÿ0ÿperwProvAnz%ÿ4
erwProv%ÿBeitrag.kvertragÿerwProvAnz%
test1%ÿÿ0(ÿ+(ÿ(f„lligam.kvfael,"mm.yyyy.0d"),2))ÿerwProvAnz%
ÿ¡test1%ÿ
bumon%ÿp
gezProv%ÿgezProv.kvfaelÿBewertung.zeingan1ÿ2.0
ÿ¡gezProv%ÿ
erwProv%ÿp
ÿ½ die ZE gleichen nicht die geforderten Monatsbeitr„ge aus
weitab%ÿ0
ÿ^
StornoBetrag.kvfaelÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡erledigt.kvfaelÿ"j"ÿf„lligam.kvfaelÿ0ÿp
ÿ¡codema.kvertragÿcodema.gekondÿweitab%ÿÿ1ÿp
ÿ½ 19062002
ÿ½ CALL Fehler("","")
anz%ÿBewertung.zeingan1ÿBeitrag.kvertrag
gezProv.kvfaelÿgezProv.kvfaelÿBewertung.zeingan1
gezProvEu.kvfaelÿÿ0(ÿ(gezProv.kvfaelÿumrechnung.zeingan1,"999999999.00"))
ÿ¡Bewertung.zeingan1ÿ
0ÿp
gezProvAnz.kvfaelÿgezProvAnz.kvfaelÿanz%
TgezProvAnz.kvfaelÿTgezProvAnz.kvfaelÿ1
ÿ½ jetzt muá dem Vermittler die VMProv storniert werden
ÿ½ GBewertung% = VMProv.kvfael * - 1
GBewertung%ÿ0
StornoBetrag.kvfaelÿStornoBetrag.kvfaelÿGBewertung%
StornoBetrEU.kvfaelÿÿ0(ÿ(StornoBetrag.kvfaelÿumrechnung.zeingan1,"999999999.00"))
StornoDat.kvfaelÿBuchungsdatum.zeingan1
ÿ½ gez_Abschluá.kvfael = "n"
ÿ½ gezahltam.kvfael = 0
ÿ^
ÿ½ Bewertung >0 
gezProvAnz.kvfaelÿgezProvAnz.kvfaelÿanz%
TgezProvAnz.kvfaelÿTgezProvAnz.kvfaelÿ1
gezahltam.kvfaelÿBuchungsdatum.Zeingan1
ÿ¡StornoBetrag.kvfaelÿ
0ÿp
StornoBetrag.kvfaelÿStornoBetrag.kvfaelÿVMProv.kvfael
StornoBetrEU.kvfaelÿÿ0(ÿ(StornoBetrag.kvfaelÿumrechnung.zeingan1,"999999999.00"))
StornoDat.kvfaelÿBuchungsdatum.zeingan1
ÿ’ÿ¡
ÿ¡StornoBetrag.kvfaelÿ0ÿp
StornoDat.kvfaelÿ0
ÿ’ÿ¡
ÿ¡gez_Abschluá.kvfaelÿ"j"ÿp
GBewertung%ÿ0
ÿ’ÿ¡
ÿ¡gez_Abschluá.kvfaelÿ"j"ÿStornoDat.kvfaelÿ
1ÿgezProvAnz.kvfaelÿ0ÿp
GBewertung%ÿVMProv.kvfael
gez_Abschluá.kvfaelÿ"j"
erwProv%ÿBeitrag.kvertragÿerwProvAnz.kvfael
ÿ¡erwProv%ÿgezProv.kvfaelÿperledigt.kvfaelÿ"j"
ÿ’ÿ¡
ÿ’ÿ¡

ÿÌÿ™"KVFAEL"
ÿïÿYÿ™"KVFAEL"
ÿ^
ÿ½ wenn nicht codema.kvertrag = codema.gekond
ÿ¡n„chsteKond.VKONDÿ0ÿp
ÿ¡weitab%ÿÿ1ÿp
ÿ¡TgezProvAnz.kvfaelÿ1ÿp
GBewertung%ÿGBewertungOrig%
ÿ^
vertrprov%ÿ0
vsumC%ÿ0
vsumA%ÿ0
vsumPP%ÿ0
vf%ÿ(VMProv.kvfaelÿÿ1)
remark2$ÿ"Erstzahl."
GBewertung%ÿGBewertungOrig%ÿ(VMProv.kvfaelÿÿ1)
ÿ’ÿ¡
ÿ^
anz%ÿBewertung.zeingan1ÿBeitrag.kvertrag
gezProvAnz.kvfaelÿgezProvAnz.kvfaelÿanz%
gezProv.kvfaelÿgezProv.kvfaelÿBewertung.zeingan1
gezProvEu.kvfaelÿÿ0(ÿ(gezProv.kvfaelÿumrechnung.zeingan1,"999999999.00"))
ÿÌÿ™"KVFAEL"
ÿïÿYÿ™"KVFAEL"
GBewertung%ÿBewertung.zeingan1
ÿ’ÿ¡
ÿ^
ÿ¡weitab%ÿÿ1ÿp
ÿ¡TgezProvAnz.kvfaelÿ
2ÿp
GBewertung%ÿVMProv.kvfael
ÿ^
GBewertung%ÿ0
ÿ’ÿ¡
ÿ^
GBewertung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿwend0911971
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ¡GSpezko$ÿ"j"ÿp
ÿ¡codema.gekondÿcodema.kvertragÿp
ÿ½ CALL Fehler("Test auf Spezialkonditionen","")
provges%ÿ((GBewertung%ÿ100)ÿCourtage.gekond)
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿSpezProvNormal.stammÿ"j"ÿp
ÿ¡APEurEinh.gekondÿ0ÿp
provges%ÿGBewertung%ÿAPEurEinh.gekondÿFirmaEurEinh.stamm
ÿ^
eurpeinh%ÿeuroproeinh.GEKOND
fireur%ÿFirmaEurEinh.stamm
provges%ÿGBewertung%ÿeuroproeinh.GEKONDÿFirmaEurEinh.stamm
ÿ’ÿ¡
ÿ’ÿ¡
SpezProzent%ÿ0
SpezPausch%ÿ0
anzagvA%ÿ0
provtotal%ÿ0
ÿØGAGvonAgentur$(anzagvA%)ÿ""
QCodeVTMA$ÿÿ-(GAGvonAgentur$(anzagvA%),12)
ÿÉÿ`ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
ÿÉÿ¥QCodeVTMA$ÿáÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
butext$ÿBuchungstext.zeingan1ÿ" Spez.Prov."
ÿ¡Prozente.spezkondÿ0ÿp
ÿ¡(vonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j")ÿvonCourtage.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
provsp1%ÿ((GBewertung%ÿ100)ÿCourtage.gekond)
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿSpezProvNormal.stammÿ"j"ÿp
ÿ¡APEurEinh.gekondÿ0ÿp
provsp1%ÿGBewertung%ÿAPEurEinh.gekondÿFirmaEurEinh.stamm
ÿ^
eurpeinh%ÿeuroproeinh.GEKOND
fireur%ÿFirmaEurEinh.stamm
provsp1%ÿGBewertung%ÿeuroproeinh.GEKONDÿFirmaEurEinh.stamm
ÿ’ÿ¡
ÿ’ÿ¡
provsp%ÿ((provsp1%ÿ100)ÿProzente.spezkond)
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿ½ *************** SR von Spezialprovision zufgen **************************
ÿ¡sr.spezkondÿ0ÿp
sr%ÿsr.spezkond
ÿ¡sr%ÿ0ÿp
Haftv%ÿsrlz.spezkond
ÿ¡Haftv%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftv%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftv%ÿ30)
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftv%ÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ ************************************************************************** 
ÿ^
ÿ’ÿ¡
ÿƒSpezProvisF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1)
ÿ’ÿ¡
ÿ^
ÿ¡pauschale.spezkondÿ0ÿp
ÿ¡(vonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j")ÿvonCourtage.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡GBewertung%ÿ0ÿp
SpezPausch%ÿSpezPPausch%ÿPauschale.spezkond
provsp%ÿPauschale.spezkond
ÿ’ÿ¡
ÿ¡GBewertung%ÿ
0ÿp
SpezPausch%ÿSpezPPausch%ÿ(Pauschale.spezkondÿÿ1)
provsp%ÿPauschale.spezkondÿÿ1
ÿ’ÿ¡
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿ½ *************** SR von Spezialprovision zufgen **************************
ÿ¡sr.spezkondÿ0ÿp
sr%ÿsr.spezkond
ÿ¡sr%ÿ0ÿp
Haftv%ÿsrlz.spezkond
ÿ¡Haftv%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftv%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftv%ÿ30)
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftv%ÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ ************************************************************************** 
ÿ^
ÿ’ÿ¡
ÿƒSpezProvisF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡einmalig.spezkondÿ"j"ÿp
einmaligerfolgt.spezkondÿ"j"
EinmDatum.spezkondÿBuchungsDatum.zeingan1
ÿÌÿ™"Spezkond"
ÿïÿYÿ™"spezkond"
ÿïÿ™"spezkond"
ÿ’ÿ¡
anzagvA%ÿanzagvA%ÿ1
ÿÙ

ÿ½ ******************* neue Spezialprovision Courtage ************************************************
anzagvFre%ÿ0
ÿ½ GAGFrAgentur$(anzagvFre%,0)
ÿØGAGFrAgentur$(anzagvFre%,0)ÿ""
QCodeVTMA$ÿGAGFrAgentur$(anzagvFre%,0)
vonCodeMA%ÿÿ0(GAGFrAgentur$(anzagvFre%,1))
ÿÉÿ`ÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
ÿÉÿ¥QCodeVTMA$ÿáÿ™"Spezkond"ÿ£QCodeVTMA.spezkond
butext$ÿBuchungstext.zeingan1ÿ" Spez.Prov."
ÿ¡Prozente.spezkondÿ0ÿp
ÿ¡(vonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j")ÿvonCourtage.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
SpezProzent%ÿSpezProzent%ÿProzente.spezkond
provsp1%ÿ((GBewertung%ÿ100)ÿCourtage.gekond)
provsp%ÿ((provsp1%ÿ100)ÿProzente.spezkond)
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿ½ *************** SR von Spezialprovision zufgen **************************
ÿ¡sr.spezkondÿ0ÿp
sr%ÿsr.spezkond
ÿ¡sr%ÿ0ÿp
Haftv%ÿsrlz.spezkond
ÿ¡Haftv%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftv%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftv%ÿ30)
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftv%ÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ ************************************************************************** 
ÿ^
ÿ’ÿ¡
ÿƒSpezProvisFF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,vonCodeMA%)
ÿ’ÿ¡
ÿ^
ÿ¡pauschale.spezkondÿ0ÿp
ÿ¡(vonAP.spezkondÿ"j"ÿvonPflege.spezkondÿ"j")ÿvonCourtage.spezkondÿ"j"ÿp
ÿ¡einmaligerfolgt.spezkondÿ"j"ÿp
ÿ¡GBewertung%ÿ0ÿp
SpezPausch%ÿSpezPPausch%ÿPauschale.spezkond
provsp%ÿPauschale.spezkond
ÿ’ÿ¡
ÿ¡GBewertung%ÿ
0ÿp
SpezPausch%ÿSpezPPausch%ÿ(Pauschale.spezkondÿÿ1)
provsp%ÿPauschale.spezkondÿÿ1
ÿ’ÿ¡
provges%ÿprovges%ÿprovsp%
provtotal%ÿprovtotal%ÿprovsp%
ÿ½ *************** SR von Spezialprovision zufgen **************************
ÿ¡sr.spezkondÿ0ÿp
sr%ÿsr.spezkond
ÿ¡sr%ÿ0ÿp
Haftv%ÿsrlz.spezkond
ÿ¡Haftv%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftv%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftv%ÿ30)
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftv%ÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ’ÿ¡
ÿ½ ************************************************************************** 
ÿ^
ÿ’ÿ¡
ÿƒSpezProvisFF(butext$,codema.spezkond,codema%,provsp%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,vonCodeMA%)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡einmalig.spezkondÿ"j"ÿp
einmaligerfolgt.spezkondÿ"j"
EinmDatum.spezkondÿBuchungsDatum.zeingan1
ÿÌÿ™"Spezkond"
ÿïÿYÿ™"spezkond"
ÿïÿ™"spezkond"
ÿ’ÿ¡
anzagvFre%ÿanzagvFre%ÿ1
ÿÙ
ÿ½ ******************* Ende Spezialprovision Courtage ************************************************
ÿ½ prov% = ((GBewertung% / 100) * Courtage.gekond) - ((GBewertung% / 100) * SpezProzent%) - SpezPausch%
ÿ½ prov% = provges%
vsumC%ÿprovtotal%
prov%ÿ((GBewertung%ÿ100)ÿCourtage.gekond)
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿSpezProvNormal.stammÿ"j"ÿp
ÿ¡APEurEinh.gekondÿ0ÿp
prov%ÿGBewertung%ÿAPEurEinh.gekondÿFirmaEurEinh.stamm
ÿ^
eurpeinh%ÿeuroproeinh.GEKOND
fireur%ÿFirmaEurEinh.stamm
prov%ÿGBewertung%ÿeuroproeinh.GEKONDÿFirmaEurEinh.stamm
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
prov%ÿ((GBewertung%ÿ100)ÿCourtage.gekond)
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿSpezProvNormal.stammÿ"j"ÿp
ÿ¡APEurEinh.gekondÿ0ÿp
prov%ÿGBewertung%ÿAPEurEinh.gekondÿFirmaEurEinh.stamm
ÿ^
eurpeinh%ÿeuroproeinh.GEKOND
fireur%ÿFirmaEurEinh.stamm
prov%ÿGBewertung%ÿeuroproeinh.GEKONDÿFirmaEurEinh.stamm
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ^
prov%ÿ((GBewertung%ÿ100)ÿCourtage.gekond)
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
ÿ¡CourtEurEinh.gekondÿ0ÿp
prov%ÿGBewertung%ÿCourtEurEinh.gekondÿFirmaEurEinh.stamm
ÿ^
prov%ÿGBewertung%ÿeuroproeinh.GEKONDÿFirmaEurEinh.stamm
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
cberafs03092002: 
	ÿ½ prov% = ((GBewertung% / 100) * Courtage.gekond)
	CourtGez$ÿ"j"
	ssok%ÿ0
	ÿ¡FirmaEinhTab.stammÿ"j"ÿp
ÿ¡SRjn.gekondÿ"j"ÿprov%ÿ0ÿsr.zeingan1ÿ0ÿpssok%ÿÿ1
	ÿ^
ÿ¡SRjn.gekondÿ"j"ÿpssok%ÿÿ1
	ÿ’ÿ¡
	ÿ¡ssok%ÿÿ1ÿp
	ÿ½ IF SRjn.gekond = "j" AND prov% <> 0 AND sr.zeingan1 = 0 THEN 
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
ÿ½ Haftung% = DAYS (F„lligkeit.zeingan1) + (Haftung.gekond * 30)
ÿ¡Haftvertrag%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftvertrag%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftvertrag%ÿ30)
ÿ’ÿ¡
ÿ^
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftung.gekondÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftung.gekondÿ30)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ¡Haftung.gekondÿÿ1ÿp
Haftung%ÿÿ1
ÿ’ÿ¡
	ÿ^
Haftung%ÿ0
sr%ÿ0
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ½ 161197 IF Haftung = - 1 THEN 
ÿ½ 161197 sr% = sr.gekond
ÿ½ 161197 Haftung% = 0
ÿ½ 161197 ELSE 
ÿ½ 161197 sr% = 0
ÿ½ 161197 Haftung% = 0
ÿ½ 161197 END IF 
	ÿ’ÿ¡
	ÿ¡n„chsteKond.VKONDÿ0ÿp
prov%ÿprov%ÿVProvisNZ%
VProvisNZ%ÿ0
	ÿ’ÿ¡
cp190620021:
	ÿ¡GBewertung%ÿ0ÿsr.zeingan1ÿ0ÿp
ÿƒRegProvisZ(Buchungstext.zeingan1,codema%,prov%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,remark2$)
	ÿ^
ÿ¡GAFSK$ÿ"TRUE"ÿp
ÿ¡prov%ÿ0ÿpÿƒRegProvisZ(Buchungstext.zeingan1,codema%,prov%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,remark2$)
ÿ^
ÿ¡prov%ÿ0ÿsr%ÿ0ÿpÿƒRegProvisZ(Buchungstext.zeingan1,codema%,prov%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,remark2$)
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ^
	ÿ½ keine CP Kondit definiert
	ÿÉÿ¥codema%ÿ™"maadr"ÿ£codema.maadr
	ÿƒWriteLog("keine Courtage fr Vertrag: "ÿVS_Nr.KVERTRAGÿ" Agentur: "ÿnachname.maadrÿ", "ÿvorname.maadrÿ", "ÿAgenturnr.maadrÿ" definiert!")
ÿ’ÿ¡
 
ÿ’ÿ¡

















 ÿwend0911971 








ÿ½ ------------
ÿ½ -- Pauschale
ÿ½ ------------
 
ÿ¡PauschaleJN.gekondÿ"j"ÿp
ÿ¡gez_Pauschale.kvertragÿ"j"ÿp
	remark2$ÿ"Pauschale"
	prov%ÿPauschale.gekond
	ÿ½ 060497
	ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung.gekondÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
ÿ½ Haftung% = DAYS (VS_Beginn.kvertrag) + (Haftung.gekond * 30)
ÿ¡Haftvertrag%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftvertrag%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftvertrag%ÿ30)
ÿ’ÿ¡
ÿ^
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftung.gekondÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftung.gekondÿ30)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿÿ1
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ½ IF sr% <> 0 THEN 
ÿ½ Haftung% = DAYS (VS_Beginn.kvertrag) + (Haftung.gekond * 30)
	ÿ½ ELSE 
ÿ½ Haftung% = 0
	ÿ½ END IF 
	ÿ½ CALL RegProvis("Pauschale: " + VS_Nr.kvertrag,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag,remark2$)
	remark2$ÿ"Pauschale"
	ÿƒRegProvisZ("Pauschale: "ÿVS_Nr.zeingan1,codema%,prov%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,remark2$)
ÿ’ÿ¡
ÿ’ÿ¡
 
 










 ÿ½ 091197 **** Anfang ****
 ÿ½ -----------------------------------
ÿ½ -- Teilzahlung/Ratenzahlung
ÿ½ -- z.Z. auf Ratenzahlung umgestellt
ÿ½ -----------------------------------
 
ÿ¡TZjn.gekondÿ"j"ÿp
ÿ¡TZRate.KVERTRAGÿ1ÿ1ÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ0.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD1.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ1.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD2.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ2.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD3.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ3.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD4.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ4.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD5.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ5.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD6.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ6.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD7.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ7.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD8.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ8.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD9.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ9.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD10.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ10.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD11.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ11.gekond)
ÿ’ÿ¡
ÿ¡prov%ÿ0ÿp
	ÿ½ 060497
	ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung ÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿpHaftung%ÿÿ1(VS_Beginn.kvertragÿ(Haftung.gekondÿ30))
	ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿ0
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ½ IF sr% <> 0 THEN 
ÿ½ Haftung% = DAYS (VS_Beginn.kvertrag + (Haftung.gekond * 30))
	ÿ½ ELSE 
ÿ½ Haftung% = 0
	ÿ½ END IF 
	ÿƒRegProvis("TZ ("ÿÿH(ÿ(TZRate.KVERTRAGÿ1,"999"))ÿ". Zahlung): "ÿVS_Nr.kvertrag,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.zeingan1,waehrung.zeingan1)
ÿ^
	ÿƒWriteLog("!Konditionen fr Ratenzahlung/Teilzahlung unvollst„ndig")
	ÿƒWriteLog("    >> Rate: "ÿÿH(ÿ(TZRate.KVERTRAGÿ1,"999")))
	ÿƒWriteLog("    >> bei Abschluá:"ÿÿH(ÿ(TZ0.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD1.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ1.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD2.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ2.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD3.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ3.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD4.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ4.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD5.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ5.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD6.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ6.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD7.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ7.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD8.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ8.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD9.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ9.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD10.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ10.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD11.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ11.gekond,",999999.00")))
	ÿƒAddLogInfo()
ÿ’ÿ¡
 
ÿ’ÿ¡
 
ÿ½ ------------
ÿ½ -- Pauschale
ÿ½ ------------
 
ÿ¡PauschaleJN.gekondÿ"j"ÿp
ÿ¡gez_Pauschale.kvertragÿ"j"ÿp
	remark2$ÿ"Pauschale"
	prov%ÿPauschale.gekond
	ÿ½ 060497
	ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung.gekondÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
ÿ½ Haftung% = DAYS (VS_Beginn.kvertrag) + (Haftung.gekond * 30)
ÿ¡Haftvertrag%ÿ0ÿp
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftvertrag%ÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftvertrag%ÿ30)
ÿ’ÿ¡
ÿ^
ÿ¡F„lligkeit.zeingan1ÿ0ÿp
Haftung%ÿÿ1(F„lligkeit.zeingan1)ÿ(Haftung.gekondÿ30)
ÿ^
Haftung%ÿÿ1(BuchungsDatum.zeingan1)ÿ(Haftung.gekondÿ30)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿÿ1
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ½ IF sr% <> 0 THEN 
ÿ½ Haftung% = DAYS (VS_Beginn.kvertrag) + (Haftung.gekond * 30)
	ÿ½ ELSE 
ÿ½ Haftung% = 0
	ÿ½ END IF 
	ÿ½ CALL RegProvis("Pauschale: " + VS_Nr.kvertrag,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag,remark2$)
	remark2$ÿ"Pauschale"
	ÿƒRegProvisZ(Buchungstext.zeingan1,codema%,prov%,sr%,Haftung%,Buchungsdatum.zeingan1,f„lligkeit.zeingan1,umrechnung.zeingan1,codew.zeingan1,waehrung.zeingan1,codeaz.zeingan1,remark2$)
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ’ÿ¡
 
 ÿ½ 091197 **** Ende ****
end0911971:
 
ÿ¡n„chsteKond.VKONDÿ0ÿp
ok%ÿ0
ÿ^
ÿÉÿ¥n„chsteKond.VKONDÿáÿ™"VKOND"ÿ£CodeVK.VKOND
ÿ’ÿ¡
ÿßÿe
 ÿÙ
 ÿ’ÿÿ
 

 ' RegProvis fr RealCASH
 ' =======================================================================
 ' Zweck:   tr„gt Buchungstext der Provisionsberechnung in die Buchungs-
 '          datei ein
 ' Nutzung: CALL RegProvisZ(remark$,codema%,provi%,sr%,srbis%)
 '          remark$     = Buchungstext
 '          ma%         = Agenturnummer
 '          provi%      = Provisionssumme
 '          sr%         = Stornoreserve in %
 '          Haftung%    = Datum der Stornoreserveauszahlung
 ' =======================================================================
 ' 29.04.93      - Prfung auf einmalige Abschluáprovi und Pauschale
 '                 - Provisionsausweisung abzglich Stornoreserve
 ' 26.06.95      - Korrektur der Registrierung gezahlter Pauschalen
 ' 29.04.96      - getrennte Differenzbildung fr alle verschiedenen
 '                   Provisionssysteme
 '                   (alte Variante als old_RegProvis im Anschluá)
 
ÿÿRegProvisZ(remark$,ma%,provi%,sr%,Haftung%,datumz%,f„lligkeit%,euro1%,codew%,waehr1$,zein%,remark2$)
 ÿ¡remark2$ÿ""ÿremark$ÿ""ÿpremark2$ÿremark$
 ÿ¡remark$ÿ""ÿremark2$ÿ""ÿpremark$ÿremark2$
 ÿ½ CALL Fehler("RegProvisZ -remark2:" + remark2$ + "   Remark: " + remark$,"Provi:" + STR$ (provi%,",999999.00"))
 
 cfile$ÿÿ™
 ÿ™"kvertrag"
 _lfdnr%ÿlfdnr.KVERTRAG
 ÿÉÿ`ÿ™"kvertrag"ÿ£lfdnr.kvertrag
 ÿÉÿ¥_lfdnr%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿÉÿ¥ma%ÿ™"maadr"ÿ£CodeMA.MAADR
 ÿÉÿ¥codeva.kvertragÿ™"sparten"ÿ£codeva.sparten
 ÿ½ IF vs_nr.kvertrag LIKE "4545*" THEN CALL Fehler("Buchung",Nachname.maadr)
 codevp%ÿcodevp.kvertrag
 ÿÉÿ`ÿ™"VPRODUKT"ÿ£codevp.vprodukt
 ÿÉÿ¥codevp%ÿ™"VPRODUKT"ÿ£codevp.vprodukt

 ÿ½ CALL Fehler(nachname.maadr,remark$)

 ÿ½ -- bereits gezahlte Provisionen verallgemeinern
 kondartab%ÿkondart.zeingan1
 ÿ¡remark2$ÿ"Abschl*"ÿremark$ÿ"Ersatz*"ÿremark$ÿ"AP*"ÿremark2$ÿ"AP*"ÿremark$ÿ"Abschl*"ÿremark$ÿ"Dyn*"ÿkondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿkondart.zeingan1ÿ4ÿp
vertrprov%ÿvsumAP%
 ÿ’ÿ¡
 ÿ¡remark2$ÿ"Courta*"ÿkondart.zeingan1ÿ1ÿp
vertrprov%ÿvsumC%
 ÿ’ÿ¡
 ÿ¡remark2$ÿ"Pflege*"ÿremark2$ÿ"Betreu*"ÿkondart.zeingan1ÿ2ÿkondart.zeingan1ÿ5ÿp
vertrprov%ÿvsumPP%
 ÿ’ÿ¡
 ÿ¡remark2$ÿ"Pauschal*"ÿp
vertrprov%ÿvsumPausch%
 ÿ’ÿ¡
 ÿ¡remark2$ÿ"VD*"ÿp
vertrprov%ÿvsumAP%
 ÿ’ÿ¡

 ÿ¡vs_nr.kvertragÿ"123"ÿp
ÿ½ CALL Fehler(nachname.maadr,"")
 ÿ’ÿ¡

 ÿ½ -- Bearbeitung bei letzter Agentur in der Struktur
 ÿ¡(CodeMA.maadrÿvorg„nger.maadr)ÿ(Vorg„nger.MAADRÿ
1)ÿp
letzteProvi.kvertragÿdatumz%
ÿ¡remark$ÿ"TZ (*"ÿp
TZRate.KVERTRAGÿTZRate.KVERTRAGÿ1
ÿ’ÿ¡
 ÿ’ÿ¡
 
 ÿ½ -- Einmalzahlungen/Berechnungen Stornoreserve registrieren --
 ÿ¡(remark2$ÿ"Abschlu*"ÿremark2$ÿ"VD*"ÿremark$ÿ"Ersatz*"ÿremark$ÿ"Abschl*"ÿremark$ÿ"AP*"ÿremark2$ÿ"AP*"ÿremark$ÿ"Dyn*")ÿ(kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿkondart.zeingan1ÿ4)ÿp
gezAbschluá%ÿ1
 ÿ’ÿ¡
 ÿ¡(remark2$ÿ"Pflege*"ÿremark$ÿ"Betreu*")ÿ(kondart.zeingan1ÿ2ÿkondart.zeingan1ÿ5)ÿpgezPflege%ÿ1
 ÿ¡remark2$ÿ"Pauschal*"ÿpgezPauschale%ÿ1
 ÿ¡CodeMA.MAADRÿVorg„nger.MAADRÿVorg„nger.MAADRÿ
1ÿp
ÿ¡gezAbschluá%ÿ1ÿpgez_Abschluá.kvertragÿ"j"
ÿ¡gezPflege%ÿ1ÿpletztePflege.kvertragÿdatumz%
ÿ¡gezPauschale%ÿ1ÿpgez_Pauschale.kvertragÿ"j"
 ÿ’ÿ¡

 ÿ½ CALL QuickStore("KVERTRAG")
 ÿÌÿ™"kvertrag"
 ÿïÿYÿ™"KVERTRAG"
 ÿïÿ™"KVERTRAG"
 ÿ¡gebuchtJNT.zeingan1ÿ"J"ÿp
ÿÉÿ¥zein%ÿáÿ™"zeingan1"ÿ£codeaz.zeingan1
gebuchtJNT.zeingan1ÿ"J"
ÿÌÿ™"zeingan1"
ÿïÿYÿ™"Zeingan1"
ÿïÿ™"zeingan1"
 ÿ’ÿ¡
 ÿ½ CALL Fehler(nachname.maadr,"Code komplettieren!!!!")
 ÿ½ *********************************** F”rderkonditionen ************************************************
 ÿ¡ÿJ(ma%,voncodema.foerkond)ÿGFoerdVerr%ÿÿ1ÿp
ÿ½ CALL Fehler(nachname.maadr,"F”rderkond!!!!")
ffile$ÿÿ™
ÿ™"foerkond"
ÿ£voncodema.foerkond
ÿÉÿ`ÿ™"foerkond"ÿ£voncodema.foerkond
ÿÉÿ¥ma%ÿ™"foerkond"ÿ£voncodema.foerkond
proz%ÿ0
pausch%ÿ0
ÿ½ CALL Fehler("GFdate$: " + GFdate$,"")
ÿ¡GFdate$ÿ""ÿp
gfdate%ÿÿ1(GFDate$)
ÿ¡Antragsdatum.KVERTRAGÿ
gfdate%ÿp
ProviAb1%ÿVS_Beginn.KVERTRAG
ÿ^
ProviAb1%ÿAntragsdatum.KVERTRAG
ÿ’ÿ¡
ÿ^
ÿ¡Gvueb$ÿ"TRUE"ÿp
ProviAb1%ÿAntragsdatum.KVERTRAG
ÿ^
ProviAb1%ÿVS_Beginn.KVERTRAG
ÿ’ÿ¡
ÿ’ÿ¡
ÿØÿOÿB("foerkond")ÿvoncodema.foerkondÿma%
ÿ½ jetzt Buchung erzeugen
ok%ÿ0
ÿ¡BWvon.foerkondÿ0ÿp
ÿ¡BWBis.foerkondÿ0ÿp
	ÿ½ Datumseinschr„nkung fr BWVon und BWBis
	ÿ¡ProviAb1%ÿBWvon.foerkondÿProviAb1%ÿ	BWBis.foerkondÿpok%ÿÿ1
ÿ^
	ÿ½ Datumseinschr„nkung fr BWvon
	ÿ¡ProviAb1%ÿBWvon.foerkondÿpok%ÿÿ1
ÿ’ÿ¡
ÿ^
ÿ¡BWBis.foerkondÿ0ÿp
	ÿ½ Datumseinschr„nkung fr BWBis
	ÿ¡ProviAb1%ÿ	BWBis.foerkondÿpok%ÿÿ1
ÿ^
	ÿ½ keine Datumseinschr„nkung
	ok%ÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡VvonCodema.foerkondÿ0ÿp
ÿ¡VvonCodema.foerkondÿCodema.kvertragÿpok%ÿ0
ÿ’ÿ¡
ÿ¡ok%ÿÿ1ÿp
ÿ½ Aufruf der Weiterverarbeitung
ÿ¡prozente.foerkondÿ0ÿp
	proz%ÿproz%ÿprozente.foerkond
ÿ^
	pausch%ÿpausch%ÿpauschale.foerkond
ÿ’ÿ¡
mma%ÿcodema.foerkond
prozent%ÿprozente.foerkond
pauschal%ÿpauschale.foerkond
ÿ½ Aufruf fr den der F”P bekommt
ppp%ÿprovi%ÿvertrprov%
srnull%ÿsr%
ÿ½ CALL Fehler("Test","F™P auf Normal " + STR$ (ppp%,",9999999.00"))
ÿ¡ppp%ÿ0ÿpÿƒRegProvFoerd(remark$,ma%,mma%,ppp%,srnull%,Haftung%,datumz%,f„lligkeit%,euro1%,codew%,waehr1$,zein%,remark2$,prozent%,pauschal%)
ÿ½ jetzt negativen Buchungssatz erzeugen fr den, dem die F”P abgezogen wird
ppp%ÿ(provi%ÿvertrprov%)ÿÿ1
srnull%ÿsr%
pauschal%ÿpauschal%ÿÿ1
ÿ¡ppp%ÿ0ÿpÿƒRegProvFoerd(remark$,mma%,ma%,ppp%,srnull%,Haftung%,datumz%,f„lligkeit%,euro1%,codew%,waehr1$,zein%,remark2$,prozent%,pauschal%)
ÿ’ÿ¡
ÿÉÿ±ÿ™"foerkond"ÿ£voncodema.foerkond
ÿÙ
ÿ½ VS_Beginn.KVERTRAG
ÿ™ffile$
 ÿ’ÿ¡
 ÿ½ ******************************************  Ende F”rderkonditionen *************************************************

 ÿ™"buchung1"
 ÿÿ™"buchung1"
 CodeBU%ÿÿI("buchung1",1)
 CodeBU.buchung1ÿCodeBU%
 codeaz.buchung1ÿcodeaz.zeingan1
 Datum.buchung1ÿdatumz%
 f„lligkeit.buchung1ÿf„lligkeit%
 Ausgabeauf.buchung1ÿausgabeauf.zeingan1
 CodeVT.buchung1ÿlfdnr.kvertrag
 testtext$ÿ"*"ÿvs_nr.kvertragÿ"*"
ÿ¡ÿH(fs24Satz_ID2.kvertrag)ÿ""ÿp
FS24Satz_ID.buchung1ÿFS24Satz_ID2.kvertrag
ÿ^
FS24Satz_ID.buchung1ÿFS24Satz_ID.kvertrag
ÿ’ÿ¡
 umrechnung.buchung1ÿeuro1%
 ÿ½ CALL Fehler("TEST " + STR$ (ma%,"000000"), STR$ (provi%,"9999.00"))
 ÿ½ 08102002
 ÿ½ CALL Fehler(nachname.maadr, STR$ (provi%,"9999.00"))
 ÿ¡GRealStorno%ÿÿ1ÿp
ÿ½ CALL Fehler(Buchungstext.buchung1, STR$ (provi%,"9999.00"))
ÿ½ CALL Fehler(nachname.maadr, STR$ (provi%,"9999.00"))
ÿ¡provi%ÿ0ÿp
ÿ½ 27.07.2008
ÿ¡Kndigung.MAADRÿ0ÿKndigung.MAADRÿ
datumz%ÿNachfolger.MAADRÿ0ÿp
ÿ¡f„lligkeit.zeingan1ÿ0ÿp
	afael1$ÿÿ(f„lligkeit.zeingan1,"0d.mm.yyyy")
	afkuen1$ÿÿ(Kndigung.MAADR,"0d.mm.yyyy")

	ÿ¡f„lligkeit.zeingan1ÿ
Kndigung.MAADRÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
	ÿ^
ÿ½ ***************************************************************************************
ÿ½ Kondart abfragen
kondart%ÿkondart.zeingan1

ÿÉÿækondart%
ÿæ0,3,4
ÿ½ AP
ÿ¡Kuenap.maadrÿ"j"ÿp
ÿ½ AP wird weitergezahlt
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle AP weiterzahlen -> es sollen auch die AP der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿæ1
ÿ½ Courtage
ÿ¡KuenCourt1.maadrÿ"j"ÿp
ÿ½ die erste courtage soll noch gezahlt werden
ÿ¡KuenCourt1.kvertragÿ"j"ÿp
ÿ½ SELECT CURRENT LOCK FILE "kvertrag"
ÿÉÿ`ÿ™"kvertrag"ÿ£lfdnr.kvertrag
ÿÉÿ¥_lfdnr%ÿáÿ™"kvertrag"ÿ£lfdnr.kvertrag
KuenCourt1.kvertragÿ"j"
ÿÌÿ™"kvertrag"
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle Courtagen weiterzahlen -> es sollen auch die Court.der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡KuenCourtAlle.maadrÿ"j"ÿp
ÿ½ SELECT CURRENT LOCK FILE "kvertrag"
ÿÉÿ`ÿ™"kvertrag"ÿ£lfdnr.kvertrag
ÿÉÿ¥_lfdnr%ÿáÿ™"kvertrag"ÿ£lfdnr.kvertrag
KuenCourt1.kvertragÿ"j"
ÿÌÿ™"kvertrag"
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle Courtagen weiterzahlen -> es sollen auch die Court.der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿæ2,5
ÿ½ Pflege
ÿ¡KuenPflege.maadrÿ"j"ÿp
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle Pflege weiterzahlen -> es sollen auch die Pflege der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿÉ
ÿ½ *************************************************************************************** 
	ÿ’ÿ¡
ÿ^
ÿ½ ***************************************************************************************
ÿ½ Kondart abfragen
kondart%ÿkondart.zeingan1

ÿÉÿækondart%
ÿæ0,3,4
ÿ½ AP
ÿ¡Kuenap.maadrÿ"j"ÿp
ÿ½ AP wir weitergezahlt
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle AP weiterzahlen -> es sollen auch die AP der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿæ1
ÿ½ Courtage
ÿ¡KuenCourt1.maadrÿ"j"ÿp
ÿ½ die erste courtage soll noch gezahlt werden
ÿ¡KuenCourt1.kvertragÿ"j"ÿp
ÿ½ SELECT CURRENT LOCK FILE "kvertrag"
ÿÉÿ`ÿ™"kvertrag"ÿ£lfdnr.kvertrag
ÿÉÿ¥_lfdnr%ÿáÿ™"kvertrag"ÿ£lfdnr.kvertrag
KuenCourt1.kvertragÿ"j"
ÿÌÿ™"kvertrag"
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle Courtagen weiterzahlen -> es sollen auch die Court.der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡KuenCourtAlle.maadrÿ"j"ÿp
ÿ½ SELECT CURRENT LOCK FILE "kvertrag"
ÿÉÿ`ÿ™"kvertrag"ÿ£lfdnr.kvertrag
ÿÉÿ¥_lfdnr%ÿáÿ™"kvertrag"ÿ£lfdnr.kvertrag
KuenCourt1.kvertragÿ"j"
ÿÌÿ™"kvertrag"
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle Courtagen weiterzahlen -> es sollen auch die Court.der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿæ2,5
ÿ½ Pflege
ÿ¡KuenPflege.maadrÿ"j"ÿp
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle Pflege weiterzahlen -> es sollen auch die Pflege der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿÉ
ÿ½ *************************************************************************************** 
ÿ’ÿ¡
ÿ^
ÿ½ vertragsabschlieáender Vermittler wird belastet
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
	Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
	Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿvs_nr.kvertrag,70)
	ÿ¡GAFSK$ÿ"TRUE"ÿp
ÿ¡autokuend.kvfaelÿ"j"ÿp
Buchungstext.buchung1ÿremark$
remark2$ÿ" wiederh.Prov."
ÿ^
Buchungstext.buchung1ÿremark$
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡provi%ÿ	0ÿp
ÿ½ Wenn einem Mitarbeiter gekndigt wurde und man gesagt hat, daá dessen Provisionen an Mitarbeiter X umgewiesen
ÿ½ werden, dann soll aber im Stornofall, der gekndigte Mitarbeiter belastet werden, deshalb also nur Umweisen,
ÿ½ wenn provi%>0 
ÿ¡f„lligkeit.zeingan1ÿ0ÿp
ÿ¡Kndigung.MAADRÿ
datumz%ÿNachfolger.MAADRÿ0ÿp
	afael1$ÿÿ(f„lligkeit.zeingan1,"0d.mm.yyyy")
	afkuen1$ÿÿ(Kndigung.MAADR,"0d.mm.yyyy")
	ÿ¡f„lligkeit.zeingan1ÿKndigung.MAADRÿp
ÿ½ die Agentur an die umgewiesen wurde muá belastet werden
ÿ½ ***************************************************************************************
ÿ½ Kondart abfragen
kondart%ÿkondart.zeingan1

ÿÉÿækondart%
ÿæ0,3,4
ÿ½ AP
ÿ¡Kuenap.maadrÿ"j"ÿp
ÿ½ AP wir weitergezahlt
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle AP weiterzahlen -> es sollen auch die AP der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿæ1
ÿ½ Courtage
ÿ¡KuenCourt1.maadrÿ"j"ÿp
ÿ½ die erste courtage soll noch gezahlt werden
ÿ¡KuenCourt1.kvertragÿ"j"ÿp
ÿ½ SELECT CURRENT LOCK FILE "kvertrag"
ÿÉÿ`ÿ™"kvertrag"ÿ£lfdnr.kvertrag
ÿÉÿ¥_lfdnr%ÿáÿ™"kvertrag"ÿ£lfdnr.kvertrag
KuenCourt1.kvertragÿ"j"
ÿÌÿ™"kvertrag"
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle Courtagen weiterzahlen -> es sollen auch die Court.der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡KuenCourtAlle.maadrÿ"j"ÿp
ÿ½ SELECT CURRENT LOCK FILE "kvertrag"
ÿÉÿ`ÿ™"kvertrag"ÿ£lfdnr.kvertrag
ÿÉÿ¥_lfdnr%ÿáÿ™"kvertrag"ÿ£lfdnr.kvertrag
KuenCourt1.kvertragÿ"j"
ÿÌÿ™"kvertrag"
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle Courtagen weiterzahlen -> es sollen auch die Court.der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿæ2,5
ÿ½ Pflege
ÿ¡KuenPflege.maadrÿ"j"ÿp
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle Pflegen weiterzahlen -> es sollen auch die Pflege der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿÉ
ÿ½ *************************************************************************************** 
	ÿ^
ÿ½ vertragsabschlieáender Vermittler wird belastet
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿvs_nr.kvertrag,70)
ÿ¡GAFSK$ÿ"TRUE"ÿp
ÿ¡autokuend.kvfaelÿ"j"ÿp
Buchungstext.buchung1ÿremark$
remark2$ÿ" wiederh.Prov."
ÿ^
Buchungstext.buchung1ÿremark$
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ^
	ÿ½ vertragsabschlieáender Vermittler wird belastet
	CodeMA.buchung1ÿma%
	ma1%ÿma%
	ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
	ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿvs_nr.kvertrag,70)
ÿ¡GAFSK$ÿ"TRUE"ÿp
ÿ¡autokuend.kvfaelÿ"j"ÿp
Buchungstext.buchung1ÿremark$
remark2$ÿ" wiederh.Prov."
ÿ^
Buchungstext.buchung1ÿremark$
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡f„lligkeit.zeingan1ÿ0ÿp
ÿ½ F„lligkeit=0, die vertragsabschlieáende Agentur muá belastet werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
	Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
	Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿvs_nr.kvertrag,70)
	ÿ¡GAFSK$ÿ"TRUE"ÿp
ÿ¡autokuend.kvfaelÿ"j"ÿp
Buchungstext.buchung1ÿremark$
remark2$ÿ" wiederh.Prov."
ÿ^
Buchungstext.buchung1ÿremark$
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡GRealStorno%ÿÿ1ÿp
ÿ½ CALL Fehler("Kndigung: " + DATE$ (Kndigung.MAADR,"0d.mm.yyyy"),"datumz: " +  DATE$ (datumz%,"0d.mm.yyyy"))
ÿ¡Kndigung.MAADRÿ
datumz%ÿNachfolger.MAADRÿ0ÿp
ÿ¡f„lligkeit.zeingan1ÿ0ÿp
afael1$ÿÿ(f„lligkeit.zeingan1,"0d.mm.yyyy")
afkuen1$ÿÿ(Kndigung.MAADR,"0d.mm.yyyy")
ÿ¡f„lligkeit.zeingan1ÿ
Kndigung.MAADRÿp
	ÿ½ CodeMA.buchung1 = ma%
	ÿ½ ma1% = ma%
	ÿ½ IF remark$ LIKE testtext$ THEN 
	ÿ½   Buchungstext.buchung1 = LEFT$ (remark$,70)
	ÿ½ ELSE 
ÿ½ Buchungstext.buchung1 = LEFT$ (remark$ + " " + vs_nr.kvertrag,70)
	ÿ½ END IF 
kondart%ÿkondart.zeingan1

ÿÉÿækondart%
ÿæ0,3,4
ÿ½ AP
ÿ¡Kuenap.maadrÿ"j"ÿp
ÿ½ AP wir weitergezahlt
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle AP weiterzahlen -> es sollen auch die AP der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿæ1
ÿ½ Courtage
ÿ¡KuenCourt1.maadrÿ"j"ÿp
ÿ½ die erste courtage soll noch gezahlt werden
ÿ¡KuenCourt1.kvertragÿ"j"ÿp
ÿ½ SELECT CURRENT LOCK FILE "kvertrag"
ÿÉÿ`ÿ™"kvertrag"ÿ£lfdnr.kvertrag
ÿÉÿ¥_lfdnr%ÿáÿ™"kvertrag"ÿ£lfdnr.kvertrag
KuenCourt1.kvertragÿ"j"
ÿÌÿ™"kvertrag"
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle Courtagen weiterzahlen -> es sollen auch die Court.der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡KuenCourtAlle.maadrÿ"j"ÿp
ÿ½ SELECT CURRENT LOCK FILE "kvertrag"
ÿÉÿ`ÿ™"kvertrag"ÿ£lfdnr.kvertrag
ÿÉÿ¥_lfdnr%ÿáÿ™"kvertrag"ÿ£lfdnr.kvertrag
KuenCourt1.kvertragÿ"j"
ÿÌÿ™"kvertrag"
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle Courtagen weiterzahlen -> es sollen auch die Court.der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿæ2,5
ÿ½ Pflege
ÿ¡KuenPflege.maadrÿ"j"ÿp
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle Pflege weiterzahlen -> es sollen auch die Pflege der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿÉ
ÿ^
ÿ½ ***************************************************************************************
ÿ½ Kondart abfragen
kondart%ÿkondart.zeingan1

ÿÉÿækondart%
ÿæ0,3,4
ÿ½ AP
ÿ¡Kuenap.maadrÿ"j"ÿp
ÿ½ AP wir weitergezahlt
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle AP weiterzahlen -> es sollen auch die AP der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿæ1
ÿ½ Courtage
ÿ¡KuenCourt1.maadrÿ"j"ÿp
ÿ½ die erste courtage soll noch gezahlt werden
ÿ¡KuenCourt1.kvertragÿ"j"ÿp
ÿ½ SELECT CURRENT LOCK FILE "kvertrag"
ÿÉÿ`ÿ™"kvertrag"ÿ£lfdnr.kvertrag
ÿÉÿ¥_lfdnr%ÿáÿ™"kvertrag"ÿ£lfdnr.kvertrag
KuenCourt1.kvertragÿ"j"
ÿÌÿ™"kvertrag"
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle Courtagen weiterzahlen -> es sollen auch die Court.der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡KuenCourtAlle.maadrÿ"j"ÿp
ÿ½ SELECT CURRENT LOCK FILE "kvertrag"
ÿÉÿ`ÿ™"kvertrag"ÿ£lfdnr.kvertrag
ÿÉÿ¥_lfdnr%ÿáÿ™"kvertrag"ÿ£lfdnr.kvertrag
KuenCourt1.kvertragÿ"j"
ÿÌÿ™"kvertrag"
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle Courtagen weiterzahlen -> es sollen auch die Court.der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿæ2,5
ÿ½ Pflege
ÿ¡KuenPflege.maadrÿ"j"ÿp
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle Pflege weiterzahlen -> es sollen auch die Pflege der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿÉ
ÿ½ *************************************************************************************** 
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡f„lligkeit.zeingan1ÿ0ÿp
ÿ½ CodeMA.buchung1 = Nachfolger.MAADR
ÿ½ ma1% = Nachfolger.MAADR
ÿ½ IF remark$ LIKE testtext$ THEN 
	ÿ½ Buchungstext.buchung1 = LEFT$ (remark$ + " (Umbuchung von " + Nachname.MAADR + ", " + LEFT$ (Vorname.MAADR,1) + ".)",70)
ÿ½ ELSE 
	ÿ½ Buchungstext.buchung1 = LEFT$ (remark$ + " " + VS_NR.kvertrag + " (Umbuchung von " + Nachname.MAADR + ", " + LEFT$ (Vorname.MAADR,1) + ".)",70)
ÿ½ END IF 
ÿ½ ***************************************************************************************
ÿ½ Kondart abfragen
kondart%ÿkondart.zeingan1

ÿÉÿækondart%
ÿæ0,3,4
ÿ½ AP
ÿ¡Kuenap.maadrÿ"j"ÿp
ÿ½ AP wir weitergezahlt
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle AP weiterzahlen -> es sollen auch die AP der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿæ1
ÿ½ Courtage
ÿ¡KuenCourt1.maadrÿ"j"ÿp
ÿ½ die erste courtage soll noch gezahlt werden
ÿ¡KuenCourt1.kvertragÿ"j"ÿp
ÿ½ SELECT CURRENT LOCK FILE "kvertrag"
ÿÉÿ`ÿ™"kvertrag"ÿ£lfdnr.kvertrag
ÿÉÿ¥_lfdnr%ÿáÿ™"kvertrag"ÿ£lfdnr.kvertrag
KuenCourt1.kvertragÿ"j"
ÿÌÿ™"kvertrag"
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und 1. Courtage weiterzahlen -> es sollen auch die Court.der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡KuenCourtAlle.maadrÿ"j"ÿp
ÿ½ SELECT CURRENT LOCK FILE "kvertrag"
ÿÉÿ`ÿ™"kvertrag"ÿ£lfdnr.kvertrag
ÿÉÿ¥_lfdnr%ÿáÿ™"kvertrag"ÿ£lfdnr.kvertrag
KuenCourt1.kvertragÿ"j"
ÿÌÿ™"kvertrag"
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle Courtagen weiterzahlen -> es sollen auch die Court.der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿæ2,5
ÿ½ Pflege
ÿ¡KuenPflege.maadrÿ"j"ÿp
ÿ¡PausUVzahl.maadrÿ
1ÿp
ÿ½ bei Kndigung und alle Pflege weiterzahlen -> es sollen auch die Pflege der Struktur gezahlt werden
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
ÿ½ Provisionen aus Struktur an Nachfolger zahlen
ÿ¡ma%ÿvtcodema%ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertrag,70)
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ^
Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿVS_NR.kvertragÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿÉ
ÿ½ *************************************************************************************** 
ÿ’ÿ¡
ÿ^
CodeMA.buchung1ÿma%
ma1%ÿma%
ÿ¡remark$ÿtesttext$ÿp
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
test123$ÿ"*"ÿvs_nr.kvertragÿ"*"
ÿ½ CALL Fehler(test123$,remark$)
ÿ¡remark$ÿtest123$ÿp
	Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
	Buchungstext.buchung1ÿÿ+(remark$ÿ" "ÿvs_nr.kvertrag,70)
ÿ’ÿ¡
ÿ¡GAFSK$ÿ"TRUE"ÿp
	ÿ¡autokuend.kvfaelÿ"j"ÿp
Buchungstext.buchung1ÿremark$
remark2$ÿ" wiederh.Prov."
	ÿ^
Buchungstext.buchung1ÿremark$
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ CALL Fehler("dmeinheit " + Buchungstext.buchung1, STR$ (provi%,"9999.00"))
 ÿ¡dmeinh%ÿ0ÿpeinheit%ÿprovi%ÿdmeinh%
 ÿ¡EinheitAusGeko.stammÿ
1ÿp
 ÿ^
einheit%ÿEinheiten.kvertrag
ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿeinheit%ÿ0ÿp
einheit%ÿGBewertung%ÿFirmaEurEinh.stamm
ÿ’ÿ¡

 ÿ’ÿ¡
 ÿ¡GAFSK$ÿ"TRUE"ÿGAFSKLALA%ÿÿ1ÿp
testgfask$ÿBuchungstext.buchung1ÿ" "ÿÿH(remark2$)
Buchungstext.buchung1ÿÿ+(testgfask$,70)
 ÿ’ÿ¡
 ÿ½ CALL Fehler(buchungstext.buchung1,"")
 ÿ½ IF haftung% = - 1 AND sr% <> 0 THEN 
ÿ½ SRBetrag% = ((provi% - vertrprov%) / 100) * sr%
 ÿ½ END IF 
 
 ÿ½ IF haftung% <> 0 AND sr% <> 0 THEN 
ÿ½ SRBetrag% = ((provi% - vertrprov%) / 100) * sr%
 ÿ½ ELSE 
ÿ½ SRBetrag% = 0
 ÿ½ END IF 

 ÿ½ 31072001 prfen auf sr%

 ÿ½ CALL Fehler("SR","")
 ÿ¡remark2$ÿ"Pauschal*"ÿp
ÿ¡haftung%ÿ0ÿsr%ÿ0ÿp
ÿ¡provi%ÿ0ÿp
SRBetrag%ÿ((provi%)ÿ100)ÿsr%
ÿ¡SRBetrag%ÿ
0ÿpSRBetrag%ÿ0
ÿ^
ÿ¡SRRck.stammÿ"j"ÿp
	ÿ¡StornoVerrech.maadrÿ"j"ÿp
SRBetrag%ÿ((provi%ÿvertrprov%)ÿ100)ÿsr%
ÿ¡SRBetrag%ÿ
0ÿpSRBetrag%ÿ0
	ÿ^
SRBetrag%ÿ0
	ÿ’ÿ¡
ÿ^
	SRBetrag%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
SRBetrag%ÿ0
ÿ’ÿ¡
betr%ÿprovi%ÿSRBetrag%
ÿ½ CALL Fehler("betr%","")
 ÿ^
ÿ¡haftung%ÿ0ÿsr%ÿ0ÿp
ÿ¡provi%ÿ0ÿp
SRBetrag%ÿÿ0(ÿ(((provi%ÿvertrprov%)ÿ100)ÿsr%,"999999999.00"))
ÿ¡SRBetrag%ÿ
0ÿpSRBetrag%ÿ0
ÿ^
ÿ¡SRRck.stammÿ"j"ÿp
	ÿ¡StornoVerrech.maadrÿ"j"ÿp
SRBetrag%ÿÿ0(ÿ(((provi%ÿvertrprov%)ÿ100)ÿsr%,"999999999.00"))
ÿ½ IF SRBetrag% < 0 THEN SRBetrag% = 0
	ÿ^
SRBetrag%ÿ0
	ÿ’ÿ¡
ÿ^
	SRBetrag%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
SRBetrag%ÿ0
ÿ’ÿ¡
ÿ½ CALL Fehler("betr%","")
betr%ÿprovi%ÿvertrprov%ÿSRBetrag%
 ÿ’ÿ¡
 ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
ÿ¡sr.zeingan1ÿ0ÿp
SRBetrag%ÿ(sr.zeingan1ÿeuroproeinh.GEKONDÿFirmaEurEinh.stamm)ÿGStornoDiff%
GStornoDiff%ÿGStornoDiff%ÿSRBetrag%
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿÉÿ¥ma1%ÿáÿ™"maadr"ÿ£codema.maadr
 ÿ½ CALL Fehler(nachname.maadr,"")
 Stornoreserve.maadrÿStornoreserve.maadrÿSRBetrag%
 StornoreserveEU.maadrÿÿ0(ÿ(Stornoreserve.maadrÿeuro1%,"999999999.00"))

 ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
srtest%ÿsr.zeingan1ÿÿ1
bwtest%ÿbewertung.zeingan1
ÿ¡srtest%ÿbwtest%ÿp
ÿ½ CALL Fehler("Einh nicht hochz„hlen","")
ÿ½ diese ZE ist eine SRZahlung, deshalb keine Einheiten hochz„hlen
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿpEinhNichtBuchJN.zeingan1ÿ"j"
ÿ’ÿ¡
ÿ¡FTabnurEinh.stammÿ"j"ÿma1%ÿvtcodema%ÿpEinhNichtBuchJN.zeingan1ÿ"j"
ÿ¡EigVertrag.kvertragÿ"j"ÿnoBerechEinhEig.stammÿ"j"ÿpEinhNichtBuchJN.zeingan1ÿ"j"
ÿ¡GFPB%ÿÿ1ÿEigVertrag.kvertragÿ"j"ÿGBewertung%ÿGBewertungOld%ÿp
einheit%ÿGBewertung%ÿEinheiten.kvertragÿGBewertungOld%
ÿ’ÿ¡
 ÿ’ÿ¡
 
 einheitkv%ÿ0
 ÿ¡EinheitSach.stammÿ"j"ÿp
ÿ¡SparteIstSach.spartenÿ1ÿp
ÿ¡ma1%ÿvtcodema%ÿp
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
	ÿ¡EinheitAusGeko.stammÿ
1ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
	ÿ’ÿ¡
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
ÿ’ÿ¡
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%ÿÿ1
einheitkv%ÿeinheit%ÿÿ1
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ^

ÿ’ÿ¡
ÿ^
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿp
	Einheiten.maadrÿEinheiten.maadrÿeinheit%
	einheitkv%ÿeinheit%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
	ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
	ÿ’ÿ¡
ÿ^
	ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%ÿÿ1
einheitkv%ÿeinheit%ÿÿ1
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ^
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
	Einheiten.maadrÿEinheiten.maadrÿeinheit%
	einheitkv%ÿeinheit%
ÿ’ÿ¡
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
	Einheiten.maadrÿEinheiten.maadrÿeinheit%ÿÿ1
	einheitkv%ÿeinheit%ÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡ma1%ÿvtcodema%ÿp
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿp
EigEinheiten.maadrÿEigEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
EinheitGes.maadrÿEinheitGes.maadrÿeinheitkv%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
	EigEinheiten.maadrÿEigEinheiten.maadrÿeinheit%
	einheitkv%ÿeinheit%
	EinheitGes.maadrÿEinheitGes.maadrÿeinheitkv%
ÿ’ÿ¡
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
	EigEinheiten.maadrÿEigEinheiten.maadrÿeinheit%ÿÿ1
	einheitkv%ÿeinheit%ÿÿ1
	EinheitGes.maadrÿEinheitGes.maadrÿeinheitkv%
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
StorWarnJN.buchung1ÿGStorWarnJN$
StorWarnDatGes.buchung1ÿGStorWarnDGes$
StorWarnDatMA.buchung1ÿGStorWarnDMA$
StorWarnGrund.buchung1ÿGStorWarnGrund$
StorWarnMasn.buchung1ÿGStorWarnMasn$
StorWarnErg.buchung1ÿGStorWarnErg$
 ÿ^
sEinheitGes.maadrÿsEinheitGes.maadrÿeinheitkv%
 ÿ’ÿ¡

 ÿ½ gesvol% = GesVolumen.maadr
 ÿ½ eigvol% = EigVolumen.maadr
 ÿ½ betr% = provi% - vertrprov% - SRBetrag%
 ÿ½ CALL Fehler("ges:" + STR$ (gesvol%,"99999"),"Eig:" + STR$ (eigvol%,"99999"))

 ÿ½ ****************************AUSZAHLUNGSSPERRE**********************************
 eigen%ÿ0
 PSpAll$ÿPROVSperreAll.maadr
 PSpAllSeit%ÿPSperreAllSeit.maadr
 PROVSpEig$ÿPROVSperreEig.maadr
 PSpESeit%ÿPSperreESeit.maadr
 
 ÿ¡ma1%ÿvtcodema%ÿp
eigen%ÿ1
 ÿ’ÿ¡
 ÿ¡PspAll$ÿ"j"ÿp
ÿ¡PSpAllSeit%ÿ	datumz%ÿp
ÿ½ IF ma1% = 529 THEN CALL Fehler("TRIEBSCH","")
AuszahlSperKo.maadrÿAuszahlSperKo.maadrÿbetr%
AuszahlSperKoEU.maadrÿÿ0(ÿ(AuszahlSperKo.maadrÿeuro1%,"999999999.00"))
ÿ’ÿ¡
 ÿ^
ÿ¡eigen%ÿ1ÿPROVSpEig$ÿ"j"ÿp
ÿ¡PSpESeit%ÿ	datumz%ÿp
AuszahlSperKo.maadrÿAuszahlSperKo.maadrÿbetr%
AuszahlSperKoEU.maadrÿÿ0(ÿ(AuszahlSperKo.maadrÿeuro1%,"999999999.00"))
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ ****************************AUSZAHLUNGSSPERRE Ende********************************** 
 ÿ¡betr%ÿ0ÿp
GesVolumen.maadrÿGesVolumen.maadrÿVolumen.KVERTRAG
ÿ¡ma1%ÿvtcodema%ÿp
EigVolumen.maadrÿEigVolumen.maadrÿVolumen.KVERTRAG
ÿ’ÿ¡
 ÿ^
GesVolumen.maadrÿGesVolumen.maadrÿ(Volumen.KVERTRAGÿÿ1)
ÿ¡ma1%ÿvtcodema%ÿp
EigVolumen.maadrÿEigVolumen.maadrÿ(Volumen.KVERTRAGÿÿ1)
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ gesvol% = GesVolumen.maadr
 ÿ½ eigvol% = EigVolumen.maadr
 AuszahlAB.maadrÿAuszahlAB.maadrÿbetr%
 AuszahlEUAB.maadrÿÿ0(ÿ(AuszahlAB.maadrÿeuro1%,"999999999.00"))
 AuszProvABGes.maadrÿAuszProvABGes.maadrÿbetr%
 AuszProvABGesEU.maadrÿÿ0(ÿ(AuszProvABGes.maadrÿeuro1%,"999999999.00"))
 ÿ½ Workstation.maadr = Workstation%
 ÿ½ QWoNo.maadr = STR$ (Workstation%,"000000") + STR$ (codema.maadr,"000000")
 RecStatus.maadrÿ"c"
 betr$ÿÿH(ÿ(betr%,"99999999.00"))
 betr%ÿÿ0(betr$)
 ÿÌÿ™"maadr"
 ÿïÿYÿ™"maadr"
 ÿ½ CALL Fehler("Buch " + STR$ (codema%,"000000"),"vsv betrag " + STR$ (betr%,",999999.00"))
 ÿ½ CALL Fehler("vsv","")
 ÿ¡codema%ÿ1ÿgfsc%ÿÿ1ÿp
vsvs%ÿ2
vsvjn$ÿ"j"
 ÿ’ÿ¡
 ÿ¡gfsc%ÿÿ1ÿp
vsvjn$ÿvsvjn.gekond
vsvs%ÿvsv.gekond
 ÿ’ÿ¡
 ÿ¡vsvjn$ÿ"j"ÿvsvs%ÿ0ÿgezPflege%ÿ1ÿprovi%ÿ0ÿp
ÿ¡betr%ÿ0ÿp
vsv.buchung1ÿ0
ÿ^
ÿ¡betr%ÿ0ÿp
vsv%ÿ(betr%ÿvsvs%)ÿ100
betr%ÿbetr%ÿvsv%
Betrag.buchung1ÿbetr%
vsv.buchung1ÿvsv%
ÿ^
vsv%ÿ(betr%ÿvsvs%)ÿ100
betr%ÿbetr%ÿvsv%
Betrag.buchung1ÿbetr%
vsv.buchung1ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ^
Betrag.buchung1ÿbetr%
 ÿ’ÿ¡

 ÿ¡mwstprovjn.vproduktÿ"j"ÿmwstprov.vproduktÿ0ÿp
mwstprov%ÿmwstprov.vprodukt
ÿ½ CALL Fehler( STR$ (mwstprov%,"999.00"), STR$ (betr%,"999.00"))
ÿ¡Mwstpflicht.maadrÿ"j"ÿp
ÿ¡mwstprovbn.gekondÿ"n"ÿp
ÿ½ Netto
nettoeu%ÿbetr%
NettoEu.buchung1ÿbetr%
mwstbetrag%ÿ(betr%ÿmwstprov%)ÿ100
mwstbetrag$ÿÿ(mwstbetrag%,"9999999.00")
mwstbetrag%ÿÿ0(mwstbetrag$)
Betrag.buchung1ÿnettoeu%ÿmwstbetrag%
betrag%ÿBetrag.buchung1
BetragEu.buchung1ÿbetrag%
ÿ^
ÿ½ brutto
Betrag.buchung1ÿbetr%
BetragEu.buchung1ÿbetr%
nettobetrag%ÿ(betr%ÿ100)ÿ(mwstprov%ÿ100)
nettobetrag$ÿÿ(nettobetrag%,"9999999.00")
nettobetrag%ÿÿ0(nettobetrag$)
mwstbetrag%ÿbetr%ÿnettobetrag%
NettoEu.buchung1ÿnettobetrag%
ÿ½ mwstbetrag% = Betrag.buchung - NettoEu.buchung
ÿ’ÿ¡
MWSTProz.buchung1ÿmwstprov%
MWSTBetragEu.buchung1ÿmwstbetrag%
ÿ^
Betrag.buchung1ÿbetr%
BetragEu.buchung1ÿbetr%
NettoEu.buchung1ÿbetr%
MWSTProz.buchung1ÿ0
MWSTBetragEu.buchung1ÿ0
ÿ’ÿ¡
 ÿ^
Betrag.buchung1ÿbetr%
BetragEu.buchung1ÿbetr%
NettoEu.buchung1ÿbetr%
MWSTProz.buchung1ÿ0
MWSTBetragEu.buchung1ÿ0
 ÿ’ÿ¡
 codemagr.buchung1ÿCodemagr.maadr
 CodeAGDir.buchung1ÿCodeagdir.maadr
 Kostenstelle.buchung1ÿKostenstelle.maadr
 DebitorKto.buchung1ÿDebitorkto.maadr
 KreditorKto.buchung1ÿKreditorkto.maadr




 ÿ½ *************************************************************************************************************************************
 ÿ½ Zentralberechnung des Kontostandes
 zusatz%ÿ0
 ÿ½ 23062004 CALL ZentrKTO(ma%,datumz%,betr%,SRBetrag%,codew%,euro1%,waehr1$,PSpAll$,PSpAllSeit%,PROVSpEig$,PSpESeit%,eigen%,zusatz%)
 ÿƒZentrKTO(ma1%,datumz%,betr%,SRBetrag%,codew%,euro1%,waehr1$,PSpAll$,PSpAllSeit%,PROVSpEig$,PSpESeit%,eigen%,zusatz%,einheitkv%)
 ÿ½ *************************************************************************************************************************************
 Gesamtbetrag.buchung1ÿprovi%
 Bewertungssumme.buchung1ÿBewertung.zeingan1
 ProvBasiswert.buchung1ÿBewertung.zeingan1
 ÿ¡KundEinzahlung.zeingan1ÿ0ÿp
KundEinzahlung.buchung1ÿKundEinzahlung.zeingan1
KundEinzahluEu.buchung1ÿÿ0(ÿ(KundEinzahlung.zeingan1ÿumrechnung.buchung1,"999999999.00"))
 ÿ^
KundEinzahlung.buchung1ÿBewertungssumme.kvertrag
KundEinzahluEu.buchung1ÿÿ0(ÿ(Bewertungssumme.kvertragÿumrechnung.buchung1,"999999999.00"))
 ÿ’ÿ¡
 ÿ¡betrag.buchung1ÿ0ÿp
Volumen.buchung1ÿVolumen.KVERTRAG
 ÿ^
Volumen.buchung1ÿVolumen.KVERTRAGÿÿ1
 ÿ’ÿ¡
 
 Kndigung.buchung1ÿKndigung.KVERTRAG
 ÿ¡GAFSK$ÿ"TRUE"ÿp
VS_Beginn.buchung1ÿVS_Beginn.KVERTRAG
 ÿ^
ÿ¡AnlageDatum.zeingan1ÿ
1ÿp
VS_Beginn.buchung1ÿVS_Beginn.KVERTRAG
ÿ^
VS_Beginn.buchung1ÿAnlageDatum.zeingan1
ÿ’ÿ¡
 ÿ’ÿ¡
 Bewertung2.buchung1ÿBewertKV.zeingan1
 ÿ¡GAFSK$ÿ"TRUE"ÿp
ÿ¡kundeinzahlung.zeingan1ÿ0ÿp
Bewertung2.buchung1ÿkundeinzahlung.zeingan1
Bewertung2EU.buchung1ÿÿ0(ÿ(kundeinzahlung.zeingan1ÿumrechnung.zeingan1,"999999999.00"))
ÿ’ÿ¡
 ÿ’ÿ¡
 CodeKU.buchung1ÿCodeKU.KVERTRAG
 vtagentur.buchung1ÿGvtagentur$
 vtcodema.buchung1ÿGvtcodema%
 Antragsnr.buchung1ÿAntragsnr.KVERTRAG
 vs_nr.buchung1ÿvs_nr.KVERTRAG
 UnterVermNr.buchung1ÿUnterVermNr.KVERTRAG
 vsumme.buchung1ÿvsumme.kvertrag
 vsummeEU.buchung1ÿÿ0(ÿ(vsumme.kvertragÿumrechnung.buchung1,"999999999.00"))
 BeitragBrut.buchung1ÿBeitrag.kvertrag
 BeitragNet.buchung1ÿNettoBeitrag.kvertrag
 BeitragBrutEu.buchung1ÿÿ0(ÿ(Beitrag.kvertragÿumrechnung.buchung1,"999999999.00"))
 BeitragNetEu.buchung1ÿÿ0(ÿ(NettoBeitrag.kvertragÿumrechnung.buchung1,"999999999.00"))
 zw.buchung1ÿzw.kvertrag
 mwst.buchung1ÿmwst.kvertrag
 ÿ¡zw.buchung1ÿ0ÿp
JahresBBrut.buchung1ÿBeitragBrut.buchung1ÿzw.buchung1
JahresBNet.buchung1ÿBeitragNet.buchung1ÿzw.buchung1
JahresBBrutEu.buchung1ÿÿ0(ÿ(JahresBBrut.buchung1ÿumrechnung.buchung1,"999999999.00"))
JahresBNetEu.buchung1ÿÿ0(ÿ(JahresBNet.buchung1ÿumrechnung.buchung1,"999999999.00"))
 ÿ^
JahresBBrut.buchung1ÿBeitragBrut.buchung1
JahresBNet.buchung1ÿBeitragNet.buchung1
JahresBBrutEu.buchung1ÿÿ0(ÿ(JahresBBrut.buchung1ÿumrechnung.buchung1,"999999999.00"))
JahresBNetEu.buchung1ÿÿ0(ÿ(JahresBNet.buchung1ÿumrechnung.buchung1,"999999999.00"))
 ÿ’ÿ¡

 APJN.buchung1ÿAPjn.gekond
 CourtJN.buchung1ÿCourtageJN.gekond
 SRjn.buchung1ÿSRJN.gekond
 PflegeJN.buchung1ÿPflegeJN.gekond
 APProzente.buchung1ÿAP.gekond
 CourtProzente.buchung1ÿCourtage.gekond
 PflegProzente.buchung1ÿPflegeProvi.gekond
 SRProzente.buchung1ÿsr.gekond

VSVjn.buchung1ÿvsvjn$
VSVProz.buchung1ÿvsvs%
DynamikPjn.buchung1ÿDynamikPjn.gekond
DynamikProz.buchung1ÿDynamikProz.gekond
Betreujn.buchung1ÿBetreujn.gekond
BetreuProz.buchung1ÿBetreuProz.gekond


 codew.buchung1ÿcodew%
 waehrung.buchung1ÿwaehr1$
 ÿ½ GOTO w030420061
 ÿ½ ***************************************************************************************************************
 ÿ½ wurde weiter oben schon gemacht
 ÿ¡EinheitSach.stammÿ"j"ÿp
ÿ¡SparteIstSach.spartenÿ1ÿp
ÿ¡ma1%ÿvtcodema%ÿp
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
	ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchung1ÿeinheit%
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheit%
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheit%ÿÿ1
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchung1ÿeinheit%
ÿ¡betr%ÿ0ÿp
	ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheit%
ÿ^
	ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheit%ÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ^
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchung1ÿeinheit%
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheit%
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheit%ÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ ***************************************************************************************************************

w030420061: 
 ÿÉÿ¥CodeVA.kvertragÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 Sparte.buchung1ÿSparte.SPARTEN
 ÿÉÿ¥CodeKU.KVERTRAGÿ™GAdrDat$ÿ£CodeKU.GAdrDat$
 Nachname.buchung1ÿNachname.GAdrDat$
 Vorname.buchung1ÿVorname.GAdrDat$
 ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
 Gesellschaft.buchung1ÿÿ+(Gesellschaft.GEADR,30)
 Provision.buchung1ÿ"j"
 ÿ¡sr%ÿ0ÿp
SRgezahlt.buchung1ÿ"j"
SR.buchung1ÿ0
 ÿ^
ÿ½ 060497
ÿ¡Haftung%ÿÿ1ÿp
SRAuszahlung.buchung1ÿ0
SR.buchung1ÿSRBetrag%
ÿ^
SRAuszahlung.buchung1ÿHaftung%
SR.buchung1ÿSRBetrag%
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
ÿ¡SRBetrag%ÿ0ÿp
ÿ¡GFPB%ÿÿ1ÿp
SRAuszahlung.buchung1ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ CALL QuickStore("Buchung1")
 agentur.buchung1ÿÿ+(ÿH(nachname.maadr)ÿ", "ÿÿH(vorname.maadr)ÿ", "ÿÿH(Agenturnr.maadr)ÿ" , Stufe:"ÿÿ(stufe.maadr,"000"),100)
 QuickCode.BUCHUNG1ÿÿ(CodeMA.BUCHUNG1,"000000")ÿÿ(Datum.BUCHUNG1,"yyyymm0d")
 QCodeMAPROD.buchung1ÿÿ(CodeMA.buchung1,"000000")ÿVSNRPack$(Gesellschaft.buchung1)ÿVSNRPack$(Sparte.buchung1)
 Workstation.Buchung1ÿWorkstation%
 QWoNo.Buchung1ÿÿ(Workstation%,"000000")ÿÿ(CodeBu.Buchung1,"000000")
 RecStatus.Buchung1ÿ"c"
 ÿƒBU1DMEuro(umrechnung.buchung1)
 buday.buchung1ÿÿ3(Datum.buchung1)
 QCodeMAVT.buchung1ÿÿ(codema.buchung1,"000000")ÿÿ(codevt.buchung1,"000000")
 timestamp$ÿÿ(ÿQ,"yymmdd")ÿÿ(ÿ9(ÿR)ÿ100ÿÿ:(ÿR),"0000")
 timestamp%ÿÿ0(timestamp$)
 timestamp.buchung1ÿtimestamp%
	ÿ¡gebuchtjn.buchung1ÿ1ÿpgebuchtjn.buchung1ÿ0
	gebuchtJNDat.buchung1ÿÿ(gebuchtjn.buchung1,"0")ÿÿ(datum.buchung1,"yyyymm0d")
	gebuchtJNMADat.buchung1ÿÿ(gebuchtjn.buchung1,"0")ÿÿ(Codema.buchung1,"000000")ÿÿ(datum.buchung1,"yyyymm0d")
 ÿÌÿ™"Buchung1"
 ÿïÿYÿ™"Buchung1"
 ÿ¡GAFSK$ÿ"TRUE"ÿp
ÿ¡remark2$ÿ"erst*"ÿremark$ÿ"erst*"ÿp
ÿÉÿ`ÿ™"KVFAEL"ÿ£codevt.kvfael
ÿÉÿ¥lfdnr.kvertragÿáÿ™"KVFAEL"ÿ£codevt.kvfael
codebu.kvfaelÿcodebu%
ÿÌÿ™"kvfael"
ÿïÿYÿ™"kvfael"
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿßÿe
 ÿ½ -- Aufsummierung der einzelnen Provisionsarten
 ÿ½    fr Differenzberechnung
 gesetz11%ÿ0
 ÿ¡(remark2$ÿ"Abschlu*"ÿremark$ÿ"Ersatz*"ÿremark2$ÿ"Dyn*"ÿremark2$ÿ"AP*"ÿremark$ÿ"AP*")ÿ(kondart.zeingan1ÿ0ÿkondart.zeingan1ÿ3ÿkondart.zeingan1ÿ4)ÿp
vsumAP%ÿprovi%
gesetz11%ÿÿ1
 ÿ’ÿ¡
 ÿ¡(remark2$ÿ"Courta*"ÿremark$ÿ"Courta*")ÿkondart.zeingan1ÿ1ÿp
vsumC%ÿprovi%
gesetz11%ÿÿ1
 ÿ’ÿ¡
 ÿ¡(remark2$ÿ"Pflege*"ÿremark2$ÿ"Betreu*")ÿ(kondart.zeingan1ÿ2ÿkondart.zeingan1ÿ5)ÿp
vsumPP%ÿprovi%
gesetz11%ÿÿ1
 ÿ’ÿ¡
 ÿ¡remark2$ÿ"Pauschal*"ÿremark$ÿ"Pauschal*"ÿp
vsumPausch%ÿprovi%
gesetz11%ÿÿ1
 ÿ’ÿ¡
 ÿ¡remark2$ÿ"VD*"ÿremark$ÿ"VD*"ÿp
vsumAP%ÿprovi%
gesetz11%ÿÿ1
 ÿ^
ÿ¡gesetz11%ÿ0ÿp
vertrprov%ÿprovi%
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ 09102002
 ÿÉÿ`ÿ™"maadr"ÿ£codema.maadr
 ÿÉÿ¥ma%ÿ™"maadr"ÿ£codema.maadr
 ÿ½ Vorschussbehandlung
 ÿ¡ma%ÿcodema.kvertragÿp
ÿ½ fr den Mitarbeiter wurde eine Vertragsprovision errechnet, deshalb Rckbelastung des Vorschusses, falls einer gezahlt wurde
ÿ¡kzv.kvertragÿ"j"ÿFS24DatVors.kvertragÿ0ÿFS24Vors.kvertragÿ0ÿFS24VorsRu.kvertragÿ"j"ÿp
abf$ÿÿ™
ÿ½ Vorschuá muá zurckgerechnet werden
ÿ½ wie Zusatzbuchung machen
ÿÿ™"buchung1"
CodeBU.buchung1ÿÿI("buchung1",1)
ÿ¡ÿH(FS24Satz_ID2.kvertrag)ÿ""ÿp
FS24Satz_ID.buchung1ÿFS24Satz_ID2.kvertrag
ÿ^
FS24Satz_ID.buchung1ÿFS24Satz_ID.kvertrag
ÿ’ÿ¡
F„lligkeit.buchung1ÿÿQ
Sparte.buchung1ÿSparte.SPARTEN
vs_Beginn.buchung1ÿvs_beginn.kvertrag
Nachname.buchung1ÿNachname.GAdrDat$
Vorname.buchung1ÿVorname.GAdrDat$
Gesellschaft.buchung1ÿGesellschaft.GEADR
Provision.buchung1ÿ""
codeku.buchung1ÿcodeku.kvertrag
CodeMA.buchung1ÿma1%
ÿÉÿ`ÿ™"maadr"ÿ£codema.maadr
ÿÉÿ¥ma%ÿ™"maadr"ÿ£codema.maadr
codevt.buchung1ÿlfdnr.kvertrag
Buchungstext.buchung1ÿ"Rckzahlung Vorschuss: "ÿVS_NR.kvertrag
VTAgentur.buchung1ÿÿ+(Nachname.maadrÿ","ÿvorname.maadr,100)
Datum.buchung1ÿÿQ
sbetr%ÿFS24Vors.kvertragÿÿ1
Betrag.buchung1ÿFS24Vors.kvertragÿÿ1
VTCodema.buchung1ÿma1%
Codew.buchung1ÿ3
umrechnung.buchung1ÿ1
waehrung.buchung1ÿ"EUR"
BetragEU.buchung1ÿÿ0(ÿ(Betrag.buchung1ÿumrechnung.buchung1,"99999999.00"))
vtagentur.buchung1ÿÿ+(ÿH(nachname.maadr)ÿ", "ÿÿH(vorname.maadr)ÿ", "ÿÿH(Agenturnr.maadr)ÿ" , Stufe:"ÿÿ(stufe.maadr,"000"),100)
agentur.buchung1ÿÿ+(ÿH(nachname.maadr)ÿ", "ÿÿH(vorname.maadr)ÿ", "ÿÿH(Agenturnr.maadr)ÿ" , Stufe:"ÿÿ(stufe.maadr,"000"),100)
QuickCode.BUCHUNG1ÿÿ(CodeMA.BUCHUNG1,"000000")ÿÿ(Datum.BUCHUNG1,"yyyymm0d")
QCodeMAPROD.buchung1ÿÿ(CodeMA.buchung1,"000000")ÿVSNRPack$(Gesellschaft.buchung1)ÿVSNRPack$(Sparte.buchung1)
Workstation.Buchung1ÿWorkstation%
QWoNo.Buchung1ÿÿ(Workstation%,"000000")ÿÿ(CodeBu.Buchung1,"000000")
RecStatus.Buchung1ÿ"c"
ÿƒBU1DMEuro(umrechnung.buchung1)
buday.buchung1ÿÿ3(Datum.buchung1)
vorschujn.buchung1ÿ1
QCodeMAVT.buchung1ÿÿ(codema.buchung1,"000000")ÿÿ(codevt.buchung1,"000000")
timestamp$ÿÿ(ÿQ,"yymmdd")ÿÿ(ÿ9(ÿR)ÿ100ÿÿ:(ÿR),"0000")
timestamp%ÿÿ0(timestamp$)
Timestamp.buchung1ÿtimestamp%
	ÿ¡gebuchtjn.buchung1ÿ1ÿpgebuchtjn.buchung1ÿ0
	gebuchtJNDat.buchung1ÿÿ(gebuchtjn.buchung1,"0")ÿÿ(datum.buchung1,"yyyymm0d")
	gebuchtJNMADat.buchung1ÿÿ(gebuchtjn.buchung1,"0")ÿÿ(Codema.buchung1,"000000")ÿÿ(datum.buchung1,"yyyymm0d")

CodeEingGE.BUCHUNG1ÿCodeEingGE.kvertrag
EingereichtBei.BUCHUNG1ÿEingereichtBei.kvertrag


ÿÌÿ™"Buchung1"
ÿ™"kvertrag"
ÿÉÿ`ÿ™"kvertrag"ÿ£lfdnr.kvertrag
ÿÉÿ¥codevt.buchung1ÿáÿ™"kvertrag"ÿ£lfdnr.kvertrag
FS24DatVorsR.kvertragÿÿQ
FS24VorsRu.kvertragÿ"j"
ÿÌÿ™"kvertrag"
ÿƒZentrKTO(ma1%,datumz%,sbetr%,0,3,1,"EUR",PSpAll$,PSpAllSeit%,PROVSpEig$,PSpESeit%,1,zusatz%,0)

ÿÉÿ¥ma1%ÿáÿ™"maadr"ÿ£codema.maadr
AuszahlAB.maadrÿAuszahlAB.maadrÿsbetr%
AuszahlEUAB.maadrÿÿ0(ÿ(AuszahlAB.maadrÿeuro1%,"999999999.00"))
zusAuszahl.maadrÿzusAuszahl.maadrÿsbetr%
zusAuszahlEU.maadrÿÿ0(ÿ(zusAuszahl.maadrÿeuro1%,"999999999.00"))
aktZusB.maadrÿaktZusB.maadrÿsbetr%
aktZusBEU.maadrÿÿ0(ÿ(aktZusB.maadrÿeuro1%,"999999999.00"))
ÿÌÿ™"maadr"
ÿïÿYÿ™"maadr"
ÿ™abf$
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡remark2$ÿ"Cour*"ÿremark2$ÿ"*Cour*"ÿremark$ÿ"Cour*"ÿremark$ÿ"*Cour*"ÿkondart.zeingan1ÿ1ÿp
ÿÉÿ`ÿ™"kvertrag"ÿ£lfdnr.kvertrag
ÿÉÿ¥_lfdnr%ÿáÿ™"kvertrag"ÿ£lfdnr.kvertrag
KuenCourt1.kvertragÿ"j"
ÿÌÿ™"kvertrag"
 ÿ’ÿ¡
 ÿ’ÿÿ
 
 
ÿÿRegProvFoerd(remark$,vonma%,fuerma%,provi%,sr%,Haftung%,datumz%,f„lligkeit%,euro1%,codew%,waehr1$,zein%,remark2$,prozent%,pauschal%)
 ÿ¡remark2$ÿ""ÿremark$ÿ""ÿpremark2$ÿremark$
 ÿ¡remark$ÿ""ÿremark2$ÿ""ÿpremark$ÿremark2$
 ÿ½ sr% = 0
 cfile$ÿÿ™
 ÿ™"kvertrag"
 _lfdnr%ÿlfdnr.KVERTRAG
 ma%ÿfuerma%
 ÿÉÿ¥_lfdnr%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿÉÿ`ÿ™"maadr"ÿ£CodeMA.MAADR
 ÿÉÿ¥ma%ÿ™"maadr"ÿ£CodeMA.MAADR
 
 codevp%ÿcodevp.kvertrag
 ÿÉÿ`ÿ™"VPRODUKT"ÿ£codevp.vprodukt
 ÿÉÿ¥codevp%ÿ™"VPRODUKT"ÿ£codevp.vprodukt

 ÿ¡prozent%ÿ0ÿp
betr1%ÿ(provi%ÿprozent%)ÿ100
SRBetrag%ÿ((betr1%)ÿ100)ÿsr%
betr%ÿbetr1%ÿSRBetrag%
 ÿ^
ÿ½ Pauschale
betr1%ÿpauschal%
SRBetrag%ÿ((betr1%)ÿ100)ÿsr%
betr%ÿbetr1%ÿSRBetrag%
 ÿ’ÿ¡

 ÿ¡(betr%ÿ0ÿsr%ÿ0)ÿma%ÿ0ÿp
 ÿ^
ÿwend2006011501
 ÿ’ÿ¡

 ÿ™"buchung1"
 ÿ
 CodeBU.buchung1ÿÿI("buchung1",1)
 codeaz.buchung1ÿcodeaz.zeingan1
 Datum.buchung1ÿdatumz%
 f„lligkeit.buchung1ÿf„lligkeit%
 Ausgabeauf.buchung1ÿausgabeauf.zeingan1
 CodeVT.buchung1ÿlfdnr.kvertrag
 ÿ¡Kndigung.MAADRÿ	datumz%ÿNachfolger.MAADRÿ0ÿp
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
 ÿ^
CodeMA.buchung1ÿma%
ma1%ÿma%
Buchungstext.buchung1ÿÿ+(remark$,70)
 ÿ’ÿ¡
 
 Buchungstext.buchung1ÿÿ+(Buchungstext.buchung1ÿ" F”P",70)
 ÿÉÿ¥ma1%ÿáÿ™"maadr"ÿ£codema.maadr
 ÿ½ vertrprov% = 0
 ÿ½ SRBetrag% = 0
 ÿ¡prozent%ÿ0ÿp
betr1%ÿ(provi%ÿprozent%)ÿ100
SRBetrag%ÿ((betr1%)ÿ100)ÿsr%
betr%ÿbetr1%ÿSRBetrag%
 ÿ^
ÿ½ Pauschale
betr1%ÿpauschal%
SRBetrag%ÿ((betr1%)ÿ100)ÿsr%
betr%ÿbetr1%ÿSRBetrag%
 ÿ’ÿ¡
 Stornoreserve.maadrÿStornoreserve.maadrÿSRBetrag%
 StornoreserveEU.maadrÿÿ0(ÿ(Stornoreserve.maadrÿeuro1%,"999999999.00"))
 AuszahlAB.maadrÿAuszahlAB.maadrÿbetr%
 AuszahlEUAB.maadrÿÿ0(ÿ(AuszahlAB.maadrÿeuro1%,"999999999.00"))
 AuszProvABGes.maadrÿAuszProvABGes.maadrÿbetr%
 AuszProvABGesEU.maadrÿÿ0(ÿ(AuszProvABGes.maadrÿeuro1%,"999999999.00"))
 ÿ½ Workstation.maadr = Workstation%
 ÿ½ QWoNo.maadr = STR$ (Workstation%,"000000") + STR$ (codema.maadr,"000000")
 RecStatus.maadrÿ"c"
 ÿÌÿ™"maadr"
 ÿïÿYÿ™"MAADR"

 ÿ½ *****************************************************************************************************
 ÿ½ Zentralberechnung des Kontostandes
 zusatz%ÿ0
 ÿƒZentrKTO(ma%,datumz%,betr%,SRBetrag%,codew%,euro1%,waehr1$,PSpAll$,PSpAllSeit%,PROVSpEig$,PSpESeit%,eigen%,zusatz%,0)
 ÿ½ ***************************************************************************************************** 
 Betrag.buchung1ÿbetr%
 

 ÿ¡mwstprovjn.vproduktÿ"j"ÿmwstprov.vproduktÿ0ÿp
mwstprov%ÿmwstprov.vprodukt
ÿ½ CALL Fehler( STR$ (mwstprov%,"999.00"), STR$ (betr%,"999.00"))
ÿ¡Mwstpflicht.maadrÿ"j"ÿp
ÿ¡mwstprovbn.gekondÿ"n"ÿp
ÿ½ Netto
nettoeu%ÿbetr%
NettoEu.buchung1ÿbetr%
mwstbetrag%ÿ(betr%ÿmwstprov%)ÿ100
mwstbetrag$ÿÿ(mwstbetrag%,"9999999.00")
mwstbetrag%ÿÿ0(mwstbetrag$)
Betrag.buchung1ÿnettoeu%ÿmwstbetrag%
betrag%ÿBetrag.buchung1
BetragEu.buchung1ÿbetrag%

ÿ^
ÿ½ brutto
Betrag.buchung1ÿbetr%
BetragEu.buchung1ÿbetr%
nettobetrag%ÿ(betr%ÿ100)ÿ(mwstprov%ÿ100)
nettobetrag$ÿÿ(nettobetrag%,"9999999.00")
nettobetrag%ÿÿ0(nettobetrag$)
mwstbetrag%ÿbetr%ÿnettobetrag%
NettoEu.buchung1ÿnettobetrag%
ÿ½ mwstbetrag% = Betrag.buchung - NettoEu.buchung
ÿ’ÿ¡
MWSTProz.buchung1ÿmwstprov%
MWSTBetragEu.buchung1ÿmwstbetrag%
ÿ^
Betrag.buchung1ÿbetr%
BetragEu.buchung1ÿbetr%
NettoEu.buchung1ÿbetr%
MWSTProz.buchung1ÿ0
MWSTBetragEu.buchung1ÿ0
ÿ’ÿ¡
 ÿ^
Betrag.buchung1ÿbetr%
BetragEu.buchung1ÿbetr%
NettoEu.buchung1ÿbetr%
MWSTProz.buchung1ÿ0
MWSTBetragEu.buchung1ÿ0
 ÿ’ÿ¡
 codemagr.buchung1ÿCodemagr.maadr
 CodeAGDir.buchung1ÿCodeagdir.maadr
 Kostenstelle.buchung1ÿKostenstelle.maadr
 DebitorKto.buchung1ÿDebitorkto.maadr
 KreditorKto.buchung1ÿKreditorkto.maadr
 

 Gesamtbetrag.buchung1ÿbetr%
 Bewertungssumme.buchung1ÿBewertung.zeingan1
 ProvBasiswert.buchung1ÿBewertung.zeingan1
 ÿ¡betrag.buchung1ÿ0ÿp
Volumen.buchung1ÿVolumen.KVERTRAG
 ÿ^
Volumen.buchung1ÿVolumen.KVERTRAGÿÿ1
 ÿ’ÿ¡
 
 Kndigung.buchung1ÿKndigung.KVERTRAG
 VS_Beginn.buchung1ÿVS_Beginn.KVERTRAG
 Bewertung2.buchung1ÿBewertKV.zeingan1
 CodeKU.buchung1ÿCodeKU.KVERTRAG
 vtagentur.buchung1ÿGvtagentur$
 vtcodema.buchung1ÿGvtcodema%
 umrechnung.buchung1ÿeuro1%
 
 vsumme.buchung1ÿvsumme.kvertrag
 vsummeEU.buchung1ÿÿ0(ÿ(vsumme.kvertragÿumrechnung.buchung1,"999999999.00"))
 BeitragBrut.buchung1ÿBeitrag.kvertrag
 BeitragNet.buchung1ÿNettoBeitrag.kvertrag
 BeitragBrutEu.buchung1ÿÿ0(ÿ(Beitrag.kvertragÿumrechnung.buchung1,"999999999.00"))
 BeitragNetEu.buchung1ÿÿ0(ÿ(NettoBeitrag.kvertragÿumrechnung.buchung1,"999999999.00"))
 zw.buchung1ÿzw.kvertrag
 mwst.buchung1ÿmwst.kvertrag
 VS_Beginn.buchung1ÿVS_Beginn.kvertrag
 ÿ¡zw.buchung1ÿ0ÿp
JahresBBrut.buchung1ÿBeitragBrut.buchung1ÿzw.buchung1
JahresBNet.buchung1ÿBeitragNet.buchung1ÿzw.buchung1
JahresBBrutEu.buchung1ÿÿ0(ÿ(JahresBBrut.buchung1ÿumrechnung.buchung1,"999999999.00"))
JahresBNetEu.buchung1ÿÿ0(ÿ(JahresBNet.buchung1ÿumrechnung.buchung1,"999999999.00"))
 ÿ^
JahresBBrut.buchung1ÿBeitragBrut.buchung1
JahresBNet.buchung1ÿBeitragNet.buchung1
JahresBBrutEu.buchung1ÿÿ0(ÿ(JahresBBrut.buchung1ÿumrechnung.buchung1,"999999999.00"))
JahresBNetEu.buchung1ÿÿ0(ÿ(JahresBNet.buchung1ÿumrechnung.buchung1,"999999999.00"))
 ÿ’ÿ¡
 
 APJN.buchung1ÿAPjn.gekond
 CourtJN.buchung1ÿCourtageJN.gekond
 SRjn.buchung1ÿSRJN.gekond
 PflegeJN.buchung1ÿPflegeJN.gekond
 APProzente.buchung1ÿAP.gekond
 CourtProzente.buchung1ÿCourtage.gekond
 PflegProzente.buchung1ÿPflegeProvi.gekond
 SRProzente.buchung1ÿsr.gekond
VSVjn.buchung1ÿVSVjn$
VSVProz.buchung1ÿvsvs%
DynamikPjn.buchung1ÿDynamikPjn.gekond
DynamikProz.buchung1ÿDynamikProz.gekond
Betreujn.buchung1ÿBetreujn.gekond
BetreuProz.buchung1ÿBetreuProz.gekond




 codew.buchung1ÿcodew%
 waehrung.buchung1ÿwaehr1$
 ÿÉÿ¥CodeVA.kvertragÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 Sparte.buchung1ÿSparte.SPARTEN
 ÿÉÿ¥CodeKU.KVERTRAGÿ™GAdrDat$ÿ£CodeKU.GAdrDat$
 Nachname.buchung1ÿNachname.GAdrDat$
 Vorname.buchung1ÿVorname.GAdrDat$
 ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
 Gesellschaft.buchung1ÿGesellschaft.GEADR
 Provision.buchung1ÿ"j"
 ÿ¡sr%ÿ0ÿp
SRgezahlt.buchung1ÿ"j"
SR.buchung1ÿ0
 ÿ^
ÿ½ 060497
ÿ¡Haftung%ÿÿ1ÿp
SRAuszahlung.buchung1ÿ0
SR.buchung1ÿSRBetrag%
ÿ^
SRAuszahlung.buchung1ÿHaftung%
SR.buchung1ÿSRBetrag%
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ CALL QuickStore("Buchung1")
 agentur.buchung1ÿÿ+(ÿH(nachname.maadr)ÿ", "ÿÿH(vorname.maadr)ÿ", "ÿÿH(Agenturnr.maadr)ÿ" , Stufe:"ÿÿ(stufe.maadr,"000"),100)
 QuickCode.BUCHUNG1ÿÿ(CodeMA.BUCHUNG1,"000000")ÿÿ(Datum.BUCHUNG1,"yyyymm0d")
 Workstation.Buchung1ÿWorkstation%
 QWoNo.Buchung1ÿÿ(Workstation%,"000000")ÿÿ(CodeBu.Buchung1,"000000")
 RecStatus.Buchung1ÿ"c"
 ÿƒBU1DMEuro(umrechnung.buchung1)
 buday.buchung1ÿÿ3(Datum.buchung1)
 QCodeMAVT.buchung1ÿÿ(codema.buchung1,"000000")ÿÿ(codevt.buchung1,"000000")
timestamp$ÿÿ(ÿQ,"yymmdd")ÿÿ(ÿ9(ÿR)ÿ100ÿÿ:(ÿR),"0000")
timestamp%ÿÿ0(timestamp$)
Timestamp.buchung1ÿtimestamp%
	ÿ¡gebuchtjn.buchung1ÿ1ÿpgebuchtjn.buchung1ÿ0
	gebuchtJNDat.buchung1ÿÿ(gebuchtjn.buchung1,"0")ÿÿ(datum.buchung1,"yyyymm0d")
	gebuchtJNMADat.buchung1ÿÿ(gebuchtjn.buchung1,"0")ÿÿ(Codema.buchung1,"000000")ÿÿ(datum.buchung1,"yyyymm0d")
	CodeEingGE.BUCHUNG1ÿCodeEingGE.kvertrag
	EingereichtBei.BUCHUNG1ÿEingereichtBei.kvertrag
 ÿÌÿ™"Buchung1"
end2006011501: 
 ÿïÿYÿ™"Buchung1"
 ÿßÿe
 
 ÿ’ÿÿ


 
ÿÿSpezProvisF(remark$,ma%,VertrVonMa1%,provi%,sr%,Haftung%,datumz%,f„lligkeit%,euro1%,codew%,waehr1$,zein%)
 ÿ½ CALL Fehler("SpezProvisF","")
 cfile$ÿÿ™
 ÿ™"kvertrag"
 _lfdnr%ÿlfdnr.KVERTRAG
 ÿÉÿ¥_lfdnr%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿÉÿ¥ma%ÿ™"maadr"ÿ£CodeMA.MAADR
 ÿÉÿ¥codeva.kvertragÿ™"sparten"ÿ£codeva.sparten

 codevp%ÿcodevp.kvertrag
 ÿÉÿ`ÿ™"VPRODUKT"ÿ£codevp.vprodukt
 ÿÉÿ¥codevp%ÿ™"VPRODUKT"ÿ£codevp.vprodukt


 ÿ½ *********************************** F”rderkonditionen ************************************************
 ÿ¡ÿJ(ma%,voncodema.foerkond)ÿGFoerdVerr%ÿÿ1ÿFoerdAufSpez.stammÿ"j"ÿp
ÿ½ CALL Fehler(nachname.maadr,"F”rderkond!!!!")
ffile$ÿÿ™
ÿ™"foerkond"
ÿ£voncodema.foerkond
ÿÉÿ`ÿ™"foerkond"ÿ£voncodema.foerkond
ÿÉÿ¥ma%ÿ™"foerkond"ÿ£voncodema.foerkond
proz%ÿ0
pausch%ÿ0
ÿ½ CALL Fehler("GFdate$: " + GFdate$,"")
ÿ¡GFdate$ÿ""ÿp
gfdate%ÿÿ1(GFDate$)
ÿ¡Antragsdatum.KVERTRAGÿ
gfdate%ÿp
ProviAb1%ÿVS_Beginn.KVERTRAG
ÿ^
ProviAb1%ÿAntragsdatum.KVERTRAG
ÿ’ÿ¡
ÿ^
ÿ¡Gvueb$ÿ"TRUE"ÿp
ProviAb1%ÿAntragsdatum.KVERTRAG
ÿ^
ProviAb1%ÿVS_Beginn.KVERTRAG
ÿ’ÿ¡
ÿ’ÿ¡
ÿØÿOÿB("foerkond")ÿvoncodema.foerkondÿma%
ÿ½ jetzt Buchung erzeugen
ok%ÿ0
ÿ¡BWvon.foerkondÿ0ÿp
ÿ¡BWBis.foerkondÿ0ÿp
	ÿ½ Datumseinschr„nkung fr BWVon und BWBis
	ÿ¡ProviAb1%ÿBWvon.foerkondÿProviAb1%ÿ	BWBis.foerkondÿpok%ÿÿ1
ÿ^
	ÿ½ Datumseinschr„nkung fr BWvon
	ÿ¡ProviAb1%ÿBWvon.foerkondÿpok%ÿÿ1
ÿ’ÿ¡
ÿ^
ÿ¡BWBis.foerkondÿ0ÿp
	ÿ½ Datumseinschr„nkung fr BWBis
	ÿ¡ProviAb1%ÿ	BWBis.foerkondÿpok%ÿÿ1
ÿ^
	ÿ½ keine Datumseinschr„nkung
	ok%ÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡VvonCodema.foerkondÿ0ÿp
ÿ¡VvonCodema.foerkondÿCodema.kvertragÿpok%ÿ0
ÿ’ÿ¡
ÿ¡ok%ÿÿ1ÿp
ÿ½ Aufruf der Weiterverarbeitung
ÿ¡prozente.foerkondÿ0ÿp
	proz%ÿproz%ÿprozente.foerkond
ÿ^
	pausch%ÿpausch%ÿpauschale.foerkond
ÿ’ÿ¡
mma%ÿcodema.foerkond
prozent%ÿprozente.foerkond
pauschal%ÿpauschale.foerkond
ÿ½ Aufruf fr den der F”P bekommt
ppp%ÿprovi%ÿvertrprov%
srnull%ÿsr%
ÿ½ CALL Fehler("Test","F™P auf Spezi " + STR$ (ppp%,",9999999.00"))
ÿ¡ppp%ÿ0ÿsr%ÿ0ÿpÿƒRegProvFoerd(remark$,ma%,mma%,ppp%,srnull%,Haftung%,datumz%,f„lligkeit%,euro1%,codew%,waehr1$,zein%,remark2$,prozent%,pauschal%)
ÿ½ jetzt negativen Buchungssatz erzeugen fr den, dem die F”P abgezogen wird
ppp%ÿ(provi%ÿvertrprov%)ÿÿ1
srnull%ÿsr%
pauschal%ÿpauschal%ÿÿ1
ÿ¡ppp%ÿ0ÿsr%ÿ0ÿpÿƒRegProvFoerd(remark$,mma%,ma%,ppp%,srnull%,Haftung%,datumz%,f„lligkeit%,euro1%,codew%,waehr1$,zein%,remark2$,prozent%,pauschal%)
ÿ’ÿ¡
ÿÉÿ±ÿ™"foerkond"ÿ£voncodema.foerkond
ÿÙ
ÿ½ VS_Beginn.KVERTRAG
ÿ™ffile$
 ÿ’ÿ¡
 ÿ½ ******************************************  Ende F”rderkonditionen ************************************************* 


 ÿ½ -- bereits gezahlte Provisionen verallgemeinern
 
 ÿ™"buchung1"
 ÿ
 CodeBU.buchung1ÿÿI("buchung1",1)
 codeaz.buchung1ÿcodeaz.zeingan1
 Datum.buchung1ÿdatumz%
 f„lligkeit.buchung1ÿf„lligkeit%
 Ausgabeauf.buchung1ÿausgabeauf.zeingan1
 CodeVT.buchung1ÿlfdnr.kvertrag
 ÿ½ Kondart abfragen
 kondart%ÿkondart.zeingan1
 ÿ¡Kndigung.MAADRÿ	datumz%ÿNachfolger.MAADRÿ0ÿp
ÿÉÿækondart%
ÿæ0,3,4
ÿ½ AP
ÿ¡Kuenap.maadrÿ"j"ÿp
ÿ½ AP wir weitergezahlt
CodeMA.buchung1ÿma%
ma1%ÿma%
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿæ1
ÿ½ Courtage
ÿ¡KuenCourt1.maadrÿ"j"ÿp
ÿ½ die erste courtage soll noch gezahlt werden
ÿ¡KuenCourt1.kvertragÿ"j"ÿp
	ÿ½ KuenCourt1.kvertrag = "j"
	CodeMA.buchung1ÿma%
	ma1%ÿma%
	Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
	CodeMA.buchung1ÿNachfolger.MAADR
	ma1%ÿNachfolger.MAADR
	Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ^
ÿ¡KuenCourtAlle.maadrÿ"j"ÿp
	CodeMA.buchung1ÿma%
	ma1%ÿma%
	Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
	CodeMA.buchung1ÿNachfolger.MAADR
	ma1%ÿNachfolger.MAADR
	Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿ¡
ÿæ2,5
ÿ½ Pflege
ÿ¡KuenPflege.maadrÿ"j"ÿp
CodeMA.buchung1ÿma%
ma1%ÿma%
Buchungstext.buchung1ÿÿ+(remark$,70)
ÿ^
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
ÿ’ÿ¡
ÿ’ÿÉ
 ÿ^
CodeMA.buchung1ÿma%
ma1%ÿma%
Buchungstext.buchung1ÿÿ+(remark$,70)
 ÿ’ÿ¡
 ÿ¡dmeinh%ÿ0ÿpeinheit%ÿprovi%ÿdmeinh%
 ÿ¡EinheitAusGeko.stammÿ
1ÿp
 ÿ^
einheit%ÿeinheiten.kvertrag
 ÿ’ÿ¡
 ÿ¡GFPB%ÿÿ1ÿp
einheit%ÿGEinhEinmSpez%
GEinhEinmSpez%ÿ0
 ÿ’ÿ¡

 ÿ¡haftung%ÿ0ÿsr%ÿ0ÿp
ÿ¡provi%ÿ0ÿp
SRBetrag%ÿ((provi%ÿvertrprov%)ÿ100)ÿsr%
ÿ^
ÿ¡SRRck.stammÿ"j"ÿp
ÿ¡StornoVerrech.maadrÿ"j"ÿp
	SRBetrag%ÿ((provi%ÿvertrprov%)ÿ100)ÿsr%
ÿ^
	SRBetrag%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ^
SRBetrag%ÿ0
 ÿ’ÿ¡
 ÿÉÿ¥ma1%ÿáÿ™"maadr"ÿ£codema.maadr
 Stornoreserve.maadrÿStornoreserve.maadrÿSRBetrag%
 StornoreserveEU.maadrÿÿ0(ÿ(Stornoreserve.maadrÿeuro1%,"999999999.00"))


 betr%ÿprovi%ÿvertrprov%ÿSRBetrag%
 einheitkv%ÿ0
 ÿ¡GBVF$ÿ"TRUE"ÿp
ÿ¡EinheitSach.stammÿ"j"ÿp
ÿ¡SparteIstSach.spartenÿ1ÿp
ÿ¡ma1%ÿvtcodema%ÿp
	ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
ÿ’ÿ¡
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%ÿÿ1
einheitkv%ÿeinheit%ÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
	ÿ¡EinheitAusGeko.stammÿ
1ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
	ÿ’ÿ¡
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
ÿ’ÿ¡
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%ÿÿ1
einheitkv%ÿeinheit%ÿÿ1
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
	ÿ¡FirmaEinhTab.stammÿ"j"ÿPrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
ÿ¡GFPB%ÿÿ1ÿp
ÿ½ CALL Fehler("Spezialprovi fr GFPB% Einheiten nicht bercksichtigen","")
ÿ’ÿ¡
	ÿ^
ÿ¡EinheitAusGeko.stammÿ
1ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
ÿ’ÿ¡
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%ÿÿ1
einheitkv%ÿeinheit%ÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡ma1%ÿvtcodema%ÿp
ÿ¡GBVF$ÿ"TRUE"ÿp
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿp
	EigEinheiten.maadrÿEigEinheiten.maadrÿeinheit%
	einheitkv%ÿeinheit%
	EinheitGes.maadrÿEinheitGes.maadrÿeinheitkv%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
	ÿ¡EinheitAusGeko.stammÿ0ÿp
EigEinheiten.maadrÿEigEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
EinheitGes.maadrÿEinheitGes.maadrÿeinheitkv%
	ÿ’ÿ¡
ÿ^
	ÿ¡EinheitAusGeko.stammÿ0ÿp
EigEinheiten.maadrÿEigEinheiten.maadrÿeinheit%ÿÿ1
einheitkv%ÿeinheit%
EinheitGes.maadrÿEinheitGes.maadrÿeinheitkv%
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ^
sEinheitGes.maadrÿsEinheitGes.maadrÿeinheitkv%
 ÿ’ÿ¡
 ÿ½ gesvol% = GesVolumen.maadr
 ÿ½ eigvol% = EigVolumen.maadr
 vertrprov%ÿ0
 ÿ½ SRBetrag% = 0
 betr%ÿprovi%ÿvertrprov%ÿSRBetrag%
 ÿ½ ****************************AUSZAHLUNGSSPERRE**********************************
 eigen%ÿ0
 PSpAll$ÿPROVSperreAll.maadr
 PSpAllSeit%ÿPSperreAllSeit.maadr
 PROVSpEig$ÿPROVSperreEig.maadr
 PSpESeit%ÿPSperreESeit.maadr
 
 ÿ¡ma1%ÿvtcodema%ÿp
eigen%ÿ1
 ÿ’ÿ¡
 ÿ¡PspAll$ÿ"j"ÿp
ÿ¡PSpAllSeit%ÿ	datumz%ÿp
ÿ½ IF ma1% = 529 THEN CALL Fehler("TRIEBSCH","")
AuszahlSperKo.maadrÿAuszahlSperKo.maadrÿbetr%
AuszahlSperKoEU.maadrÿÿ0(ÿ(AuszahlSperKo.maadrÿeuro1%,"999999999.00"))
ÿ’ÿ¡
 ÿ^
ÿ¡eigen%ÿ1ÿPROVSpEig$ÿ"j"ÿp
ÿ¡PSpESeit%ÿ	datumz%ÿp
AuszahlSperKo.maadrÿAuszahlSperKo.maadrÿbetr%
AuszahlSperKoEU.maadrÿÿ0(ÿ(AuszahlSperKo.maadrÿeuro1%,"999999999.00"))
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ ****************************AUSZAHLUNGSSPERRE Ende**********************************    
 ÿ½ CALL Fehler("ges:" + STR$ (gesvol%,"99999"),"Eig:" + STR$ (eigvol%,"99999"))
 
 ÿ¡betr%ÿ0ÿp
GesVolumen.maadrÿGesVolumen.maadrÿVolumen.KVERTRAG
ÿ¡ma1%ÿvtcodema%ÿp
EigVolumen.maadrÿEigVolumen.maadrÿVolumen.KVERTRAG
ÿ’ÿ¡
 ÿ^
GesVolumen.maadrÿGesVolumen.maadrÿ(Volumen.KVERTRAGÿÿ1)
ÿ¡ma1%ÿvtcodema%ÿp
EigVolumen.maadrÿEigVolumen.maadrÿ(Volumen.KVERTRAGÿÿ1)
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ gesvol% = GesVolumen.maadr
 ÿ½ eigvol% = EigVolumen.maadr
 AuszahlAB.maadrÿAuszahlAB.maadrÿbetr%
 AuszahlEUAB.maadrÿÿ0(ÿ(AuszahlAB.maadrÿeuro1%,"999999999.00"))
 AuszProvABGes.maadrÿAuszProvABGes.maadrÿbetr%
 AuszProvABGesEU.maadrÿÿ0(ÿ(AuszProvABGes.maadrÿeuro1%,"999999999.00"))
 ÿ½ Workstation.maadr = Workstation%
 ÿ½ QWoNo.maadr = STR$ (Workstation%,"000000") + STR$ (codema.maadr,"000000")
 RecStatus.maadrÿ"c"
 ÿÌÿ™"maadr"
 ÿïÿYÿ™"MAADR"
 ÿ½ *****************************************************************************************************
 ÿ½ Zentralberechnung des Kontostandes
 zusatz%ÿ0
 ÿƒZentrKTO(ma%,datumz%,betr%,SRBetrag%,codew%,euro1%,waehr1$,PSpAll$,PSpAllSeit%,PROVSpEig$,PSpESeit%,eigen%,zusatz%,einheitkv%)
 ÿ½ ***************************************************************************************************** 
 ÿ½ CALL Fehler("nach ZentrKTO","")
 axxyy%ÿprovi%ÿvertrprov%ÿSRBetrag%
 Betrag.buchung1ÿprovi%ÿvertrprov%ÿSRBetrag%
 
 Gesamtbetrag.buchung1ÿprovi%
 Bewertungssumme.buchung1ÿBewertung.zeingan1
 ProvBasiswert.buchung1ÿBewertung.zeingan1
 ÿ¡betrag.buchung1ÿ0ÿp
Volumen.buchung1ÿVolumen.KVERTRAG
 ÿ^
Volumen.buchung1ÿVolumen.KVERTRAGÿÿ1
 ÿ’ÿ¡
 
 Kndigung.buchung1ÿKndigung.KVERTRAG
 VS_Beginn.buchung1ÿVS_Beginn.KVERTRAG
 Bewertung2.buchung1ÿBewertKV.zeingan1
 CodeKU.buchung1ÿCodeKU.KVERTRAG
 vtagentur.buchung1ÿGvtagentur$
 vtcodema.buchung1ÿGvtcodema%
 umrechnung.buchung1ÿeuro1%

 vsumme.buchung1ÿvsumme.kvertrag
 vsummeEU.buchung1ÿÿ0(ÿ(vsumme.kvertragÿumrechnung.buchung1,"999999999.00"))
 BeitragBrut.buchung1ÿBeitrag.kvertrag
 BeitragNet.buchung1ÿNettoBeitrag.kvertrag
 BeitragBrutEu.buchung1ÿÿ0(ÿ(Beitrag.kvertragÿumrechnung.buchung1,"999999999.00"))
 BeitragNetEu.buchung1ÿÿ0(ÿ(NettoBeitrag.kvertragÿumrechnung.buchung1,"999999999.00"))
 zw.buchung1ÿzw.kvertrag
 mwst.buchung1ÿmwst.kvertrag
 VS_Beginn.buchung1ÿVS_Beginn.kvertrag
 ÿ¡zw.buchung1ÿ0ÿp
JahresBBrut.buchung1ÿBeitragBrut.buchung1ÿzw.buchung1
JahresBNet.buchung1ÿBeitragNet.buchung1ÿzw.buchung1
JahresBBrutEu.buchung1ÿÿ0(ÿ(JahresBBrut.buchung1ÿumrechnung.buchung1,"999999999.00"))
JahresBNetEu.buchung1ÿÿ0(ÿ(JahresBNet.buchung1ÿumrechnung.buchung1,"999999999.00"))
 ÿ^
JahresBBrut.buchung1ÿBeitragBrut.buchung1
JahresBNet.buchung1ÿBeitragNet.buchung1
JahresBBrutEu.buchung1ÿÿ0(ÿ(JahresBBrut.buchung1ÿumrechnung.buchung1,"999999999.00"))
JahresBNetEu.buchung1ÿÿ0(ÿ(JahresBNet.buchung1ÿumrechnung.buchung1,"999999999.00"))
 ÿ’ÿ¡

 APJN.buchung1ÿAPjn.gekond
 CourtJN.buchung1ÿCourtageJN.gekond
 SRjn.buchung1ÿSRJN.gekond
 PflegeJN.buchung1ÿPflegeJN.gekond
 APProzente.buchung1ÿAP.gekond
 CourtProzente.buchung1ÿCourtage.gekond
 PflegProzente.buchung1ÿPflegeProvi.gekond
 SRProzente.buchung1ÿsr.gekond
 codew.buchung1ÿcodew%
 waehrung.buchung1ÿwaehr1$

VSVjn.buchung1ÿVSVjn$
VSVProz.buchung1ÿvsvs%
DynamikPjn.buchung1ÿDynamikPjn.gekond
DynamikProz.buchung1ÿDynamikProz.gekond
Betreujn.buchung1ÿBetreujn.gekond
BetreuProz.buchung1ÿBetreuProz.gekond
 

 ÿ¡GBVF$ÿ"TRUE"ÿp
ÿ¡EinheitSach.stammÿ"j"ÿp
ÿ¡SparteIstSach.spartenÿ1ÿp
ÿ¡ma1%ÿvtcodema%ÿp
	ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchung1ÿeinheit%
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheit%
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheit%ÿÿ1
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
	ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchung1ÿeinheit%
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheit%
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheit%ÿÿ1
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
	ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchung1ÿeinheit%
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheit%
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheit%ÿÿ1
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿÉÿ¥CodeVA.kvertragÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 Sparte.buchung1ÿSparte.SPARTEN
 ÿÉÿ¥CodeKU.KVERTRAGÿ™GAdrDat$ÿ£CodeKU.GAdrDat$
 Nachname.buchung1ÿNachname.GAdrDat$
 Vorname.buchung1ÿVorname.GAdrDat$
 ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
 Gesellschaft.buchung1ÿÿ+(Gesellschaft.GEADR,30)
 Provision.buchung1ÿ"j"
 ÿ¡sr%ÿ0ÿp
SRgezahlt.buchung1ÿ"j"
SR.buchung1ÿ0
 ÿ^
ÿ½ 060497
ÿ¡Haftung%ÿÿ1ÿp
SRAuszahlung.buchung1ÿ0
SR.buchung1ÿSRBetrag%
ÿ^
SRAuszahlung.buchung1ÿHaftung%
SR.buchung1ÿSRBetrag%
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ CALL QuickStore("Buchung1")
 agentur.buchung1ÿÿ+(ÿH(nachname.maadr)ÿ", "ÿÿH(vorname.maadr)ÿ", "ÿÿH(Agenturnr.maadr)ÿ" , Stufe:"ÿÿ(stufe.maadr,"000"),100)
 QuickCode.BUCHUNG1ÿÿ(CodeMA.BUCHUNG1,"000000")ÿÿ(Datum.BUCHUNG1,"yyyymm0d")
 Workstation.Buchung1ÿWorkstation%
 QWoNo.Buchung1ÿÿ(Workstation%,"000000")ÿÿ(CodeBu.Buchung1,"000000")
 RecStatus.Buchung1ÿ"c"
 ÿƒBU1DMEuro(umrechnung.buchung1)
 buday.buchung1ÿÿ3(Datum.buchung1)
 QCodeMAVT.buchung1ÿÿ(codema.buchung1,"000000")ÿÿ(codevt.buchung1,"000000")
timestamp$ÿÿ(ÿQ,"yymmdd")ÿÿ(ÿ9(ÿR)ÿ100ÿÿ:(ÿR),"0000")
timestamp%ÿÿ0(timestamp$)
Timestamp.buchung1ÿtimestamp%
	ÿ¡gebuchtjn.buchung1ÿ1ÿpgebuchtjn.buchung1ÿ0
	gebuchtJNDat.buchung1ÿÿ(gebuchtjn.buchung1,"0")ÿÿ(datum.buchung1,"yyyymm0d")
	gebuchtJNMADat.buchung1ÿÿ(gebuchtjn.buchung1,"0")ÿÿ(Codema.buchung1,"000000")ÿÿ(datum.buchung1,"yyyymm0d")
	CodeEingGE.BUCHUNG1ÿCodeEingGE.kvertrag
	EingereichtBei.BUCHUNG1ÿEingereichtBei.kvertrag
 ÿÌÿ™"Buchung1"
 ÿïÿYÿ™"Buchung1"
 ÿßÿe
 ÿ’ÿÿ
 
 


ÿÿSpezProvisFF(remark$,ma%,VertrVonMa1%,provi%,sr%,Haftung%,datumz%,f„lligkeit%,euro1%,codew%,waehr1$,zein%,vonma%)
ÿ½ CALL Fehler("SpezProvisFF","")
 cfile$ÿÿ™
 ÿ™"kvertrag"
 _lfdnr%ÿlfdnr.KVERTRAG
 ÿÉÿ¥_lfdnr%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿÉÿ¥vonma%ÿ™"maadr"ÿ£CodeMA.MAADR
 ÿÉÿ¥codeva.kvertragÿ™"sparten"ÿ£codeva.sparten
 namvon$ÿNachname.maadrÿ", "ÿVorname.maadr

 ÿÉÿ¥ma%ÿ™"maadr"ÿ£CodeMA.MAADR
 naman$ÿNachname.maadrÿ", "ÿVorname.maadr


 codevp%ÿcodevp.kvertrag
 ÿÉÿ`ÿ™"VPRODUKT"ÿ£codevp.vprodukt
 ÿÉÿ¥codevp%ÿ™"VPRODUKT"ÿ£codevp.vprodukt

 ÿ½ -- bereits gezahlte Provisionen verallgemeinern
 


 ÿ™"buchung1"
 ÿÿ™"buchung1"
 CodeBU.buchung1ÿÿI("buchung1",1)
 codeaz.buchung1ÿcodeaz.zeingan1
 Datum.buchung1ÿdatumz%
 f„lligkeit.buchung1ÿf„lligkeit%
 Ausgabeauf.buchung1ÿausgabeauf.zeingan1
 CodeVT.buchung1ÿlfdnr.kvertrag
 ÿ¡Kndigung.MAADRÿ	datumz%ÿNachfolger.MAADRÿ0ÿp
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
 ÿ^
CodeMA.buchung1ÿma%
ma1%ÿma%
Buchungstext.buchung1ÿÿ+(remark$,100)
 ÿ’ÿ¡
 Buchungstext.buchung1ÿÿ+(Buchungstext.buchung1ÿ"erh.von:"ÿnamvon$,100)
 ÿ¡dmeinh%ÿ0ÿpeinheit%ÿprovi%ÿdmeinh%
 
 ÿ¡haftung%ÿ0ÿsr%ÿ0ÿp
ÿ¡provi%ÿ0ÿp
SRBetrag%ÿ((provi%ÿvertrprov%)ÿ100)ÿsr%
ÿ^
ÿ¡SRRck.stammÿ"j"ÿp
ÿ¡StornoVerrech.maadrÿ"j"ÿp
	SRBetrag%ÿ((provi%ÿvertrprov%)ÿ100)ÿsr%
ÿ^
	SRBetrag%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ^
SRBetrag%ÿ0
 ÿ’ÿ¡
 ÿÉÿ¥ma1%ÿáÿ™"maadr"ÿ£codema.maadr
 Stornoreserve.maadrÿStornoreserve.maadrÿSRBetrag%
 StornoreserveEU.maadrÿÿ0(ÿ(Stornoreserve.maadrÿeuro1%,"999999999.00"))




 
 betr%ÿprovi%ÿvertrprov%ÿSRBetrag%
 einheitkv%ÿ0
 ÿ¡GBVF$ÿ"TRUE"ÿp
ÿ¡EinheitSach.stammÿ"j"ÿp
ÿ¡SparteIstSach.spartenÿ1ÿp
ÿ¡ma1%ÿvtcodema%ÿp
	ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertrag
einheitkv%ÿeinheiten.kvertrag
ÿ’ÿ¡
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertragÿÿ1
einheitkv%ÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
	ÿ¡EinheitAusGeko.stammÿ
1ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
	ÿ’ÿ¡
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertrag
einheitkv%ÿeinheiten.kvertrag
ÿ’ÿ¡
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertragÿÿ1
einheitkv%ÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
	ÿ¡EinheitAusGeko.stammÿ
1ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
	ÿ’ÿ¡
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertrag
einheitkv%ÿeinheiten.kvertrag
ÿ’ÿ¡
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertragÿÿ1
einheitkv%ÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡ma1%ÿvtcodema%ÿp
ÿ¡GBVF$ÿ"TRUE"ÿp
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿp
	EigEinheiten.maadrÿEigEinheiten.maadrÿeinheit%
	einheitkv%ÿeinheit%
	EinheitGes.maadrÿEinheitGes.maadrÿeinheitkv%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
	ÿ¡EinheitAusGeko.stammÿ0ÿp
EigEinheiten.maadrÿEigEinheiten.maadrÿeinheiten.kvertrag
einheitkv%ÿeinheiten.kvertrag
EinheitGes.maadrÿEinheitGes.maadrÿeinheitkv%
	ÿ’ÿ¡
ÿ^
	ÿ¡EinheitAusGeko.stammÿ0ÿp
EigEinheiten.maadrÿEigEinheiten.maadrÿeinheiten.kvertragÿÿ1
einheitkv%ÿeinheiten.kvertragÿÿ1
EinheitGes.maadrÿEinheitGes.maadrÿeinheitkv%
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ^
sEinheitGes.maadrÿsEinheitGes.maadrÿeinheitkv%
 ÿ’ÿ¡
 ÿ½ gesvol% = GesVolumen.maadr
 ÿ½ eigvol% = EigVolumen.maadr
 vertrprov%ÿ0
 ÿ½ SRBetrag% = 0
 
 betr%ÿprovi%ÿvertrprov%ÿSRBetrag%
 ÿ½ ****************************AUSZAHLUNGSSPERRE**********************************
 eigen%ÿ0
 PSpAll$ÿPROVSperreAll.maadr
 PSpAllSeit%ÿPSperreAllSeit.maadr
 PROVSpEig$ÿPROVSperreEig.maadr
 PSpESeit%ÿPSperreESeit.maadr
 
 ÿ¡ma1%ÿvtcodema%ÿp
eigen%ÿ1
 ÿ’ÿ¡
 ÿ¡PspAll$ÿ"j"ÿp
ÿ¡PSpAllSeit%ÿ	datumz%ÿp
ÿ½ IF ma1% = 529 THEN CALL Fehler("TRIEBSCH","")
AuszahlSperKo.maadrÿAuszahlSperKo.maadrÿbetr%
AuszahlSperKoEU.maadrÿÿ0(ÿ(AuszahlSperKo.maadrÿeuro1%,"999999999.00"))
ÿ’ÿ¡
 ÿ^
ÿ¡eigen%ÿ1ÿPROVSpEig$ÿ"j"ÿp
ÿ¡PSpESeit%ÿ	datumz%ÿp
AuszahlSperKo.maadrÿAuszahlSperKo.maadrÿbetr%
AuszahlSperKoEU.maadrÿÿ0(ÿ(AuszahlSperKo.maadrÿeuro1%,"999999999.00"))
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ ****************************AUSZAHLUNGSSPERRE Ende**********************************    
 ÿ½ CALL Fehler("ges:" + STR$ (gesvol%,"99999"),"Eig:" + STR$ (eigvol%,"99999"))
 
 ÿ¡betr%ÿ0ÿp
GesVolumen.maadrÿGesVolumen.maadrÿVolumen.KVERTRAG
ÿ¡ma1%ÿvtcodema%ÿp
EigVolumen.maadrÿEigVolumen.maadrÿVolumen.KVERTRAG
ÿ’ÿ¡
 ÿ^
GesVolumen.maadrÿGesVolumen.maadrÿ(Volumen.KVERTRAGÿÿ1)
ÿ¡ma1%ÿvtcodema%ÿp
EigVolumen.maadrÿEigVolumen.maadrÿ(Volumen.KVERTRAGÿÿ1)
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ gesvol% = GesVolumen.maadr
 ÿ½ eigvol% = EigVolumen.maadr
 AuszahlAB.maadrÿAuszahlAB.maadrÿbetr%
 AuszahlEUAB.maadrÿÿ0(ÿ(AuszahlAB.maadrÿeuro1%,"999999999.00"))
 AuszProvABGes.maadrÿAuszProvABGes.maadrÿbetr%
 AuszProvABGesEU.maadrÿÿ0(ÿ(AuszProvABGes.maadrÿeuro1%,"999999999.00"))
 ÿ½ Workstation.maadr = Workstation%
 ÿ½ QWoNo.maadr = STR$ (Workstation%,"000000") + STR$ (codema.maadr,"000000")
 RecStatus.maadrÿ"c"
 ÿÌÿ™"maadr"
 ÿïÿYÿ™"MAADR"
 ÿ½ *****************************************************************************************************
 ÿ½ Zentralberechnung des Kontostandes
 zusatz%ÿ0
 ÿƒZentrKTO(ma%,datumz%,betr%,SRBetrag%,codew%,euro1%,waehr1$,PSpAll$,PSpAllSeit%,PROVSpEig$,PSpESeit%,eigen%,zusatz%,einheitkv%)
 ÿ½ ***************************************************************************************************** 
 Betrag.buchung1ÿprovi%ÿvertrprov%ÿSRBetrag%
 
 Gesamtbetrag.buchung1ÿprovi%
 Bewertungssumme.buchung1ÿBewertung.zeingan1
 ProvBasiswert.buchung1ÿBewertung.zeingan1
 ÿ¡betrag.buchung1ÿ0ÿp
Volumen.buchung1ÿVolumen.KVERTRAG
 ÿ^
Volumen.buchung1ÿVolumen.KVERTRAGÿÿ1
 ÿ’ÿ¡
 
 Kndigung.buchung1ÿKndigung.KVERTRAG
 VS_Beginn.buchung1ÿVS_Beginn.KVERTRAG
 Bewertung2.buchung1ÿBewertKV.zeingan1
 CodeKU.buchung1ÿCodeKU.KVERTRAG
 vtagentur.buchung1ÿGvtagentur$
 vtcodema.buchung1ÿGvtcodema%
 umrechnung.buchung1ÿeuro1%
 
 vsumme.buchung1ÿvsumme.kvertrag
 vsummeEU.buchung1ÿÿ0(ÿ(vsumme.kvertragÿumrechnung.buchung1,"999999999.00"))
 BeitragBrut.buchung1ÿBeitrag.kvertrag
 BeitragNet.buchung1ÿNettoBeitrag.kvertrag
 BeitragBrutEu.buchung1ÿÿ0(ÿ(Beitrag.kvertragÿumrechnung.buchung1,"999999999.00"))
 BeitragNetEu.buchung1ÿÿ0(ÿ(NettoBeitrag.kvertragÿumrechnung.buchung1,"999999999.00"))
 zw.buchung1ÿzw.kvertrag
 mwst.buchung1ÿmwst.kvertrag
 VS_Beginn.buchung1ÿVS_Beginn.kvertrag
 ÿ¡zw.buchung1ÿ0ÿp
JahresBBrut.buchung1ÿBeitragBrut.buchung1ÿzw.buchung1
JahresBNet.buchung1ÿBeitragNet.buchung1ÿzw.buchung1
JahresBBrutEu.buchung1ÿÿ0(ÿ(JahresBBrut.buchung1ÿumrechnung.buchung1,"999999999.00"))
JahresBNetEu.buchung1ÿÿ0(ÿ(JahresBNet.buchung1ÿumrechnung.buchung1,"999999999.00"))
 ÿ^
JahresBBrut.buchung1ÿBeitragBrut.buchung1
JahresBNet.buchung1ÿBeitragNet.buchung1
JahresBBrutEu.buchung1ÿÿ0(ÿ(JahresBBrut.buchung1ÿumrechnung.buchung1,"999999999.00"))
JahresBNetEu.buchung1ÿÿ0(ÿ(JahresBNet.buchung1ÿumrechnung.buchung1,"999999999.00"))
 ÿ’ÿ¡
 
 APJN.buchung1ÿAPjn.gekond
 CourtJN.buchung1ÿCourtageJN.gekond
 SRjn.buchung1ÿSRJN.gekond
 PflegeJN.buchung1ÿPflegeJN.gekond
 APProzente.buchung1ÿAP.gekond
 CourtProzente.buchung1ÿCourtage.gekond
 PflegProzente.buchung1ÿPflegeProvi.gekond
 SRProzente.buchung1ÿsr.gekond
 codew.buchung1ÿcodew%
 waehrung.buchung1ÿwaehr1$

VSVjn.buchung1ÿVSVjn$
VSVproz.buchung1ÿvsvs%
DynamikPjn.buchung1ÿDynamikPjn.gekond
DynamikProz.buchung1ÿDynamikProz.gekond
Betreujn.buchung1ÿBetreujn.gekond
BetreuProz.buchung1ÿBetreuProz.gekond



 
 ÿ¡GBVF$ÿ"TRUE"ÿp
ÿ¡EinheitSach.stammÿ"j"ÿp
ÿ¡SparteIstSach.spartenÿ1ÿp
ÿ¡ma1%ÿvtcodema%ÿp
	ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchung1ÿeinheit%
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertrag
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
	ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchung1ÿeinheit%
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertrag
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertragÿÿ1
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
	ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchung1ÿeinheit%
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertrag
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertragÿÿ1
	ÿ’ÿ¡
ÿ’ÿ¡

ÿ’ÿ¡
 ÿ’ÿ¡
 ÿÉÿ¥CodeVA.kvertragÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 Sparte.buchung1ÿSparte.SPARTEN
 ÿÉÿ¥CodeKU.KVERTRAGÿ™GAdrDat$ÿ£CodeKU.GAdrDat$
 Nachname.buchung1ÿNachname.GAdrDat$
 Vorname.buchung1ÿVorname.GAdrDat$
 ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
 Gesellschaft.buchung1ÿGesellschaft.GEADR
 Provision.buchung1ÿ"j"
 ÿ¡sr%ÿ0ÿp
SRgezahlt.buchung1ÿ"j"
SR.buchung1ÿ0
 ÿ^
ÿ½ 060497
ÿ¡Haftung%ÿÿ1ÿp
SRAuszahlung.buchung1ÿ0
SR.buchung1ÿSRBetrag%
ÿ^
SRAuszahlung.buchung1ÿHaftung%
SR.buchung1ÿSRBetrag%
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ CALL QuickStore("Buchung1")
 agentur.buchung1ÿÿ+(ÿH(nachname.maadr)ÿ", "ÿÿH(vorname.maadr)ÿ", "ÿÿH(Agenturnr.maadr)ÿ" , Stufe:"ÿÿ(stufe.maadr,"000"),100)
 QuickCode.BUCHUNG1ÿÿ(CodeMA.BUCHUNG1,"000000")ÿÿ(Datum.BUCHUNG1,"yyyymm0d")
 Workstation.Buchung1ÿWorkstation%
 QWoNo.Buchung1ÿÿ(Workstation%,"000000")ÿÿ(CodeBu.Buchung1,"000000")
 RecStatus.Buchung1ÿ"c"
 ÿƒBU1DMEuro(umrechnung.buchung1)
 buday.buchung1ÿÿ3(Datum.buchung1)
 QCodeMAVT.buchung1ÿÿ(codema.buchung1,"000000")ÿÿ(codevt.buchung1,"000000")
 timestamp$ÿÿ(ÿQ,"yymmdd")ÿÿ(ÿ9(ÿR)ÿ100ÿÿ:(ÿR),"0000")
 timestamp%ÿÿ0(timestamp$)
 timestamp.buchung1ÿtimestamp%
	ÿ¡gebuchtjn.buchung1ÿ1ÿpgebuchtjn.buchung1ÿ0
	gebuchtJNDat.buchung1ÿÿ(gebuchtjn.buchung1,"0")ÿÿ(datum.buchung1,"yyyymm0d")
	gebuchtJNMADat.buchung1ÿÿ(gebuchtjn.buchung1,"0")ÿÿ(Codema.buchung1,"000000")ÿÿ(datum.buchung1,"yyyymm0d")
	CodeEingGE.BUCHUNG1ÿCodeEingGE.kvertrag
	EingereichtBei.BUCHUNG1ÿEingereichtBei.kvertrag
 ÿÌÿ™"Buchung1"
 ÿïÿYÿ™"Buchung1"



 ÿ½ ***********************  und jetzt das ganze fr die Agentur, die das Geld abgezogen bekommt ********************
 ÿÉÿ¥vonma%ÿ™"maadr"ÿ£CodeMA.MAADR
 ÿ™"buchung1"
 ÿÿ™"buchung1"
 CodeBU.buchung1ÿÿI("buchung1",1)
 codeaz.buchung1ÿcodeaz.zeingan1
 Datum.buchung1ÿdatumz%
 f„lligkeit.buchung1ÿf„lligkeit%
 Ausgabeauf.buchung1ÿausgabeauf.zeingan1
 CodeVT.buchung1ÿlfdnr.kvertrag
 ÿ½ CALL Fehler(remark$,"444")
 ÿ¡Kndigung.MAADRÿ	datumz%ÿNachfolger.MAADRÿ0ÿp
CodeMA.buchung1ÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
Buchungstext.buchung1ÿÿ+(remark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)",70)
 ÿ^
CodeMA.buchung1ÿvonma%
ma1%ÿvonma%
Buchungstext.buchung1ÿÿ+(remark$,100)
 ÿ’ÿ¡
 
 Buchungstext.buchung1ÿÿ+(Buchungstext.buchung1ÿ"gez.an:"ÿnaman$,100)
 butext$ÿBuchungstext.buchung1
 ÿ½ CALL Fehler(butext$,"")
 ÿ¡dmeinh%ÿ0ÿpeinheit%ÿprovi%ÿdmeinh%
 ÿ¡haftung%ÿ0ÿsr%ÿ0ÿp
ÿ¡provi%ÿ0ÿSRRck.stammÿ"j"ÿp
SRBetrag%ÿ((provi%ÿvertrprov%)ÿ100)ÿsr%
ÿ’ÿ¡
 ÿ^
SRBetrag%ÿ0
 ÿ’ÿ¡
 ÿÉÿ¥ma1%ÿáÿ™"maadr"ÿ£codema.maadr
 Stornoreserve.maadrÿStornoreserve.maadrÿSRBetrag%
 StornoreserveEU.maadrÿÿ0(ÿ(Stornoreserve.maadrÿeuro1%,"999999999.00"))

 betr%ÿprovi%ÿÿ1
 einheitkv%ÿ0
 ÿ¡GBVF$ÿ"TRUE"ÿp
ÿ¡EinheitSach.stammÿ"j"ÿp
ÿ¡SparteIstSach.spartenÿ1ÿp
ÿ¡ma1%ÿvtcodema%ÿp
	ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertrag
einheitkv%ÿeinheiten.kvertrag
ÿ’ÿ¡
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertragÿÿ1
einheitkv%ÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
	ÿ¡EinheitAusGeko.stammÿ
1ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
	ÿ’ÿ¡
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertrag
einheitkv%ÿeinheiten.kvertrag
ÿ’ÿ¡
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertragÿÿ1
einheitkv%ÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
	ÿ¡EinheitAusGeko.stammÿ
1ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheit%
einheitkv%ÿeinheit%
	ÿ’ÿ¡
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertrag
einheitkv%ÿeinheiten.kvertrag
ÿ’ÿ¡
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿp
Einheiten.maadrÿEinheiten.maadrÿeinheiten.kvertragÿÿ1
einheitkv%ÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡ma1%ÿvtcodema%ÿp
ÿ¡GBVF$ÿ"TRUE"ÿp
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿp
	EigEinheiten.maadrÿEigEinheiten.maadrÿeinheit%
	einheitkv%ÿeinheit%
	EinheitGes.maadrÿEinheitGes.maadrÿeinheitkv%
ÿ’ÿ¡
ÿ¡betr%ÿ0ÿp
	ÿ¡EinheitAusGeko.stammÿ0ÿp
EigEinheiten.maadrÿEigEinheiten.maadrÿeinheiten.kvertrag
einheitkv%ÿeinheiten.kvertrag
EinheitGes.maadrÿEinheitGes.maadrÿeinheitkv%
	ÿ’ÿ¡
ÿ^
	ÿ¡EinheitAusGeko.stammÿ0ÿp
EigEinheiten.maadrÿEigEinheiten.maadrÿeinheiten.kvertragÿÿ1
einheitkv%ÿeinheiten.kvertragÿÿ1
EinheitGes.maadrÿEinheitGes.maadrÿeinheitkv%
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ^
sEinheitGes.maadrÿsEinheitGes.maadrÿeinheitkv%
 ÿ’ÿ¡
 ÿ½ gesvol% = GesVolumen.maadr
 ÿ½ eigvol% = EigVolumen.maadr
 vertrprov%ÿ0
 ÿ½ SRBetrag% = 0
 ÿ½ betr% = provi% - vertrprov% - SRBetrag%
 betr%ÿprovi%ÿÿ1
 ÿ½ ****************************AUSZAHLUNGSSPERRE**********************************
 eigen%ÿ0
 PSpAll$ÿPROVSperreAll.maadr
 PSpAllSeit%ÿPSperreAllSeit.maadr
 PROVSpEig$ÿPROVSperreEig.maadr
 PSpESeit%ÿPSperreESeit.maadr
 
 ÿ¡ma1%ÿvtcodema%ÿp
eigen%ÿ1
 ÿ’ÿ¡
 ÿ¡PspAll$ÿ"j"ÿp
ÿ¡PSpAllSeit%ÿ	datumz%ÿp
ÿ½ IF ma1% = 529 THEN CALL Fehler("TRIEBSCH","")
AuszahlSperKo.maadrÿAuszahlSperKo.maadrÿbetr%
AuszahlSperKoEU.maadrÿÿ0(ÿ(AuszahlSperKo.maadrÿeuro1%,"999999999.00"))
ÿ’ÿ¡
 ÿ^
ÿ¡eigen%ÿ1ÿPROVSpEig$ÿ"j"ÿp
ÿ¡PSpESeit%ÿ	datumz%ÿp
AuszahlSperKo.maadrÿAuszahlSperKo.maadrÿbetr%
AuszahlSperKoEU.maadrÿÿ0(ÿ(AuszahlSperKo.maadrÿeuro1%,"999999999.00"))
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ ****************************AUSZAHLUNGSSPERRE Ende**********************************    
 ÿ½ CALL Fehler("ges:" + STR$ (gesvol%,"99999"),"Eig:" + STR$ (eigvol%,"99999"))
 
 ÿ½ IF betr% > 0 THEN 
ÿ½ GesVolumen.maadr = GesVolumen.maadr + Volumen.KVERTRAG
ÿ½ IF ma1% = vtcodema% THEN 
ÿ½ EigVolumen.maadr = EigVolumen.maadr + Volumen.KVERTRAG
ÿ½ END IF 
 ÿ½ ELSE 
ÿ½ GesVolumen.maadr = GesVolumen.maadr + (Volumen.KVERTRAG * - 1)
ÿ½ IF ma1% = vtcodema% THEN 
ÿ½ EigVolumen.maadr = EigVolumen.maadr + (Volumen.KVERTRAG * - 1)
ÿ½ END IF 
 ÿ½ END IF 
 ÿ½ gesvol% = GesVolumen.maadr
 ÿ½ eigvol% = EigVolumen.maadr
 AuszahlAB.maadrÿAuszahlAB.maadrÿbetr%
 AuszahlEUAB.maadrÿÿ0(ÿ(AuszahlAB.maadrÿeuro1%,"999999999.00"))
 AuszProvABGes.maadrÿAuszProvABGes.maadrÿbetr%
 AuszProvABGesEU.maadrÿÿ0(ÿ(AuszProvABGes.maadrÿeuro1%,"999999999.00"))
 ÿ½ Workstation.maadr = Workstation%
 ÿ½ QWoNo.maadr = STR$ (Workstation%,"000000") + STR$ (codema.maadr,"000000")
 RecStatus.maadrÿ"c"
 ÿÌÿ™"maadr"
 ÿïÿYÿ™"MAADR"
 
 ÿ½ *****************************************************************************************************
 ÿ½ Zentralberechnung des Kontostandes
 zusatz%ÿ0
 ÿƒZentrKTO(ma%,datumz%,betr%,0,codew%,euro1%,waehr1$,PSpAll$,PSpAllSeit%,PROVSpEig$,PSpESeit%,eigen%,zusatz%,einheitkv%)
 ÿ½ ***************************************************************************************************** 
 ÿ½ Betrag.buchung1 = provi% - vertrprov% - SRBetrag%
 Betrag.buchung1ÿbetr%
 Gesamtbetrag.buchung1ÿbetr%
 Bewertungssumme.buchung1ÿBewertung.zeingan1
 ProvBasiswert.buchung1ÿBewertung.zeingan1
 ÿ¡betrag.buchung1ÿ0ÿp
Volumen.buchung1ÿVolumen.KVERTRAG
 ÿ^
Volumen.buchung1ÿVolumen.KVERTRAGÿÿ1
 ÿ’ÿ¡
 
 Kndigung.buchung1ÿKndigung.KVERTRAG
 VS_Beginn.buchung1ÿVS_Beginn.KVERTRAG
 Bewertung2.buchung1ÿBewertKV.zeingan1
 CodeKU.buchung1ÿCodeKU.KVERTRAG
 vtagentur.buchung1ÿGvtagentur$
 vtcodema.buchung1ÿGvtcodema%
 umrechnung.buchung1ÿeuro1%
 
 vsumme.buchung1ÿvsumme.kvertrag
 vsummeEU.buchung1ÿÿ0(ÿ(vsumme.kvertragÿumrechnung.buchung1,"999999999.00"))
 BeitragBrut.buchung1ÿBeitrag.kvertrag
 BeitragNet.buchung1ÿNettoBeitrag.kvertrag
 BeitragBrutEu.buchung1ÿÿ0(ÿ(Beitrag.kvertragÿumrechnung.buchung1,"999999999.00"))
 BeitragNetEu.buchung1ÿÿ0(ÿ(NettoBeitrag.kvertragÿumrechnung.buchung1,"999999999.00"))
 zw.buchung1ÿzw.kvertrag
 mwst.buchung1ÿmwst.kvertrag
 VS_Beginn.buchung1ÿVS_Beginn.kvertrag
 ÿ¡zw.buchung1ÿ0ÿp
JahresBBrut.buchung1ÿBeitragBrut.buchung1ÿzw.buchung1
JahresBNet.buchung1ÿBeitragNet.buchung1ÿzw.buchung1
JahresBBrutEu.buchung1ÿÿ0(ÿ(JahresBBrut.buchung1ÿumrechnung.buchung1,"999999999.00"))
JahresBNetEu.buchung1ÿÿ0(ÿ(JahresBNet.buchung1ÿumrechnung.buchung1,"999999999.00"))
 ÿ^
JahresBBrut.buchung1ÿBeitragBrut.buchung1
JahresBNet.buchung1ÿBeitragNet.buchung1
JahresBBrutEu.buchung1ÿÿ0(ÿ(JahresBBrut.buchung1ÿumrechnung.buchung1,"999999999.00"))
JahresBNetEu.buchung1ÿÿ0(ÿ(JahresBNet.buchung1ÿumrechnung.buchung1,"999999999.00"))
 ÿ’ÿ¡
 
 APJN.buchung1ÿAPjn.gekond
 CourtJN.buchung1ÿCourtageJN.gekond
 SRjn.buchung1ÿSRJN.gekond
 PflegeJN.buchung1ÿPflegeJN.gekond
 APProzente.buchung1ÿAP.gekond
 CourtProzente.buchung1ÿCourtage.gekond
 PflegProzente.buchung1ÿPflegeProvi.gekond
 SRProzente.buchung1ÿ0
 codew.buchung1ÿcodew%
 waehrung.buchung1ÿwaehr1$


VSVjn.buchung1ÿVSVjn$
VSVProz.buchung1ÿvsvs%
DynamikPjn.buchung1ÿDynamikPjn.gekond
DynamikProz.buchung1ÿDynamikProz.gekond
Betreujn.buchung1ÿBetreujn.gekond
BetreuProz.buchung1ÿBetreuProz.gekond

 ÿ¡GBVF$ÿ"TRUE"ÿp
ÿ¡EinheitSach.stammÿ"j"ÿp
ÿ¡SparteIstSach.spartenÿ1ÿp
ÿ¡ma1%ÿvtcodema%ÿp
	ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchung1ÿeinheit%
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertrag
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
	ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchung1ÿeinheit%
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertrag
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertragÿÿ1
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡EinhNichtBuchJN.zeingan1ÿ"j"ÿp
	ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchung1ÿeinheit%
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertrag
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchung1ÿeinheiten.kvertragÿÿ1
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿÉÿ¥CodeVA.kvertragÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 Sparte.buchung1ÿSparte.SPARTEN
 ÿÉÿ¥CodeKU.KVERTRAGÿ™GAdrDat$ÿ£CodeKU.GAdrDat$
 Nachname.buchung1ÿNachname.GAdrDat$
 Vorname.buchung1ÿVorname.GAdrDat$
 ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
 Gesellschaft.buchung1ÿGesellschaft.GEADR
 Provision.buchung1ÿ"j"
 sr%ÿ0
 ÿ¡sr%ÿ0ÿp
SRgezahlt.buchung1ÿ"j"
SR.buchung1ÿ0
 ÿ^
ÿ½ 060497
ÿ¡Haftung%ÿÿ1ÿp
SRAuszahlung.buchung1ÿ0
SR.buchung1ÿSRBetrag%
ÿ^
SRAuszahlung.buchung1ÿHaftung%
SR.buchung1ÿSRBetrag%
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ½ CALL QuickStore("Buchung1")
 agentur.buchung1ÿÿ+(ÿH(nachname.maadr)ÿ", "ÿÿH(vorname.maadr)ÿ", "ÿÿH(Agenturnr.maadr)ÿ" , Stufe:"ÿÿ(stufe.maadr,"000"),100)
 QuickCode.BUCHUNG1ÿÿ(CodeMA.BUCHUNG1,"000000")ÿÿ(Datum.BUCHUNG1,"yyyymm0d")
 Workstation.Buchung1ÿWorkstation%
 QWoNo.Buchung1ÿÿ(Workstation%,"000000")ÿÿ(CodeBu.Buchung1,"000000")
 RecStatus.Buchung1ÿ"c"
 ÿƒBU1DMEuro(umrechnung.buchung1)
 buday.buchung1ÿÿ3(Datum.buchung1)
 QCodeMAVT.buchung1ÿÿ(codema.buchung1,"000000")ÿÿ(codevt.buchung1,"000000")
timestamp$ÿÿ(ÿQ,"yymmdd")ÿÿ(ÿ9(ÿR)ÿ100ÿÿ:(ÿR),"0000")
timestamp%ÿÿ0(timestamp$)
Timestamp.buchung1ÿtimestamp%
	ÿ¡gebuchtjn.buchung1ÿ1ÿpgebuchtjn.buchung1ÿ0
	gebuchtJNDat.buchung1ÿÿ(gebuchtjn.buchung1,"0")ÿÿ(datum.buchung1,"yyyymm0d")
	gebuchtJNMADat.buchung1ÿÿ(gebuchtjn.buchung1,"0")ÿÿ(Codema.buchung1,"000000")ÿÿ(datum.buchung1,"yyyymm0d")
	CodeEingGE.BUCHUNG1ÿCodeEingGE.kvertrag
	EingereichtBei.BUCHUNG1ÿEingereichtBei.kvertrag
 ÿÌÿ™"Buchung1"
 ÿïÿYÿ™"Buchung1"
 
 ÿ½ *****************************************************************************************************************


 ÿßÿe
 ÿ’ÿÿ
 




 ' Korrekturbuchung-RealCASH
 ' =======================================================================
 ' 27.10.93  - wahlweise Eingabe des Rechnungsbeginns

ÿÿBUKORREKZE()
 ÿ¡disabled%("BUCHUNG6")ÿpÿ’ÿÿ
 ÿ½ supervis im exclusiv-modus ”ffnen, um herauszufinden, ob noch jemand im Programm eingeloggt ist
 ÿ¡ÿ´("supervis")ÿpÿ†ÿ™"supervis"
 ÿƒDFile(4,"supervis"ÿ_fpw$)

 Anschluss%ÿ1
 ÿÂ"Die Korrekturbuchung l”scht alle Buchungen und setzt","die Vertragsdatei zurck! Fortfahren?",135,req%
 
 ÿ¡req%ÿ1ÿp
CalcDate$ÿReadConfig$("PROVIS","KorrekturAb")
ÿ¡CalcDate$ÿ"leer"ÿpCalcDate$ÿ""
ÿ½ CREATE DIALOG "ANSCHLUSS",0,0,191,92,"Buchungskorrektur","MS Sans Serif",8
ÿ½ ADD DIALOG "ANSCHLUSS",4,0,0,191,68,0,""
ÿ½ ADD DIALOG "ANSCHLUSS",9,9,12,21,23,2
ÿ½ ADD DIALOG "ANSCHLUSS",5,38,12,144,20,0,"Bitte geben Sie ein, ab welchem Stichtag die Provisionen berechnet werden sollen:"
ÿ½ ADD DIALOG "ANSCHLUSS",5,38,42,33,10,0,"Stich&tag:"
ÿ½ ADD DIALOG "ANSCHLUSS",6,73,41,51,11,0,0,CalcDate$,20
ÿ½ ADD DIALOG "ANSCHLUSS",1,34,72,55,14,1,"&OK",1,1
ÿ½ ADD DIALOG "ANSCHLUSS",1,92,72,55,14,0,"&Abbrechen",0,0
ÿ½ DIALOG "ANSCHLUSS",req%
ÿ½ REMOVE DIALOG "ANSCHLUSS"
req%ÿ1
CalcDate$ÿÿ(ÿQ,"0d.mm.yyyy")
ÿ¡req%ÿ1ÿp
ÿ¡DateOK%(CalcDate$)ÿp
ÿƒCreateLog()
ÿßÿe
ÿƒServer("LOADMESSAGE","")
ÿƒServer("MESSAGE","Bitte warten... Alle Provisionsbuchungen werden aus der Buchungsdatei gel”scht. (Dieser Vorgang kann bei gr”áeren Datenbest„nden einige Zeit in Anspruch nehmen.)")
ÿƒDFile(3,"buchung1"ÿ_fpw$)
'CREATE FILE MEMORY "buch" FROM FILE "buchung1"
'CLOSE FILE "buchung1"
'CREATE FILE MEMORY "buchung1" FROM FILE "buch"
'CLOSE FILE "buch"
ÿƒDFile(3,"zeingan1"ÿ_fpw$)
'CREATE FILE MEMORY "zei" FROM FILE "zeingan1"
'CLOSE FILE "zeingan1"
'CREATE FILE MEMORY "zeingan1" FROM FILE "zei"
'CLOSE FILE "zei"
ÿƒDFile(3,"gekond"ÿ_fpw$)
ÿƒDFile(3,"maadr"ÿ_fpw$)
'CREATE FILE MEMORY "ma" FROM FILE "maadr"
'CLOSE FILE "maadr"
'CREATE FILE MEMORY "maadr" FROM FILE "ma"
'CLOSE FILE "ma"
ÿƒDFile(3,"maadrgru"ÿ_fpw$)
ÿƒDFile(3,"kvertrag"ÿ_fpw$)
'CREATE FILE MEMORY "kv" FROM FILE "kvertrag"
'CLOSE FILE "kvertrag"
'CREATE FILE MEMORY "kvertrag" FROM FILE "kv"
'CLOSE FILE "kv"
ÿƒDFile(3,"vkond"ÿ_fpw$)
ÿƒDFile(3,"spezkond"ÿ_fpw$)
ÿƒDFile(3,"kvfael"ÿ_fpw$)
ÿ™"kvfael"
ÿÍgezProv.kvfaelÿ0:gezProvEU.kvfaelÿ0:gezProvAnz.kvfaelÿ0:StornoBetrag.kvfaelÿ0:StornoBetrEU.kvfaelÿ0:
StornoDat.kvfaelÿ0:gez_Abschluá.kvfaelÿ"n":gezahltam.kvfaelÿ0:erledigt.kvfaelÿ"n":TgezProvAnz.kvfaelÿ0:autokuend.kvfaelÿ"n"
ÿ’ÿÍ
ÿ†ÿ™"kvfael"
ÿƒDFile(3,"kvfael"ÿ_fpw$)
ÿ™"kvfael"
'CREATE FILE MEMORY "vk" FROM FILE "vkond"
'CLOSE FILE "vkond"
'CREATE FILE MEMORY "vkond" FROM FILE "vk"
'CLOSE FILE "vk"
ÿƒWriteConfig("PROVIS","KorrekturAb",CalcDate$)
ÿÊÿË"Buchungsdatei wird gel”scht..."
ÿ™"KVERTRAG"
ÿ½ SELECT FIRST FILE "KVERTRAG" INDEX ProviAB.KVERTRAG
startprovi%ÿProviAB.KVERTRAG
ÿ½ 220897 REMOVE FROM FILE "buchung1" WHERE Provision.buchung1 LIKE "j"
ÿ¡ÿJ(_ppath$ÿ"but1.sbf")ÿpÿ(_ppath$ÿ"but1.*")
ÿÊÿiÿŸ"",0,0
ÿÉCodeBU.buchung1,CodeMA.buchung1,Datum.buchung1,Krzel.buchung1,Betrag.buchung1,SR.buchung1,SRAuszahlung.buchung1,
buchungstext.buchung1,Provision.buchung1,CodeVT.buchung1,SRgezahlt.buchung1,TimeStamp.buchung1,Nachname.buchung1,
Vorname.buchung1,VS_Beginn.buchung1,Sparte.buchung1,Kndigung.buchung1,Gesellschaft.buchung1,Bewertungssumme.buchung1,
CodeKU.buchung1,Volumen.buchung1,Gesamtbetrag.buchung1,Sperre.buchung1,gezahlt.buchung1,gezahlt_am.buchung1,QuickCode.buchung1,
Mahnung.buchung1,Einheiten.buchung1,VTAgentur.buchung1,F„lligkeit.buchung1,vtcodema.buchung1,
umrechnung.buchung1,codew.buchung1,waehrung.buchung1,waehrungBezeich.buchung1,
GesamtbetragEU.buchung1,BetragEU.buchung1,SREU.buchung1,BewertungssumEU.buchung1,gezahltEU.buchung1,Ausgabeauf.buchung1,codeaz.buchung1
ÿĞProvision.buchung1ÿ"j"
ÿµÿÁÿqÿ™_ppath$ÿ"BUT1"
ÿ’ÿÉ
ÿ¾ÿaÿ™"buchung1"
ÿ™"but1"
ÿ£codebu
ÿÉÿ`
ÿØÿOÿB("but1")
	ÿßÿe
	ÿ™"buchung1"
	ÿÿ™"buchung1"
	codebu.buchung1ÿÿI("buchung1",1)
	codema.buchung1ÿcodema.but1
	datum.buchung1ÿdatum.but1
	krzel.buchung1ÿkrzel.but1
	betrag.buchung1ÿbetrag.but1
	sr.buchung1ÿsr.but1
	srauszahlung.buchung1ÿsrauszahlung.but1
	buchungstext.buchung1ÿbuchungstext.but1
	provision.buchung1ÿprovision.but1
	codevt.buchung1ÿcodevt.but1
	SRgezahlt.buchung1ÿsrgezahlt.but1
	Nachname.buchung1ÿnachname.but1
	vorname.buchung1ÿvorname.but1
	VS_Beginn.buchung1ÿVS_Beginn.but1
	Sparte.buchung1ÿsparte.but1
	Kndigung.buchung1ÿKndigung.but1
	Gesellschaft.buchung1ÿGesellschaft.but1
	Bewertungssumme.buchung1ÿBewertungssumme.but1
	Codeku.buchung1ÿcodeku.but1
	Volumen.buchung1ÿVolumen.but1
	Gesamtbetrag.buchung1ÿGesamtbetrag.but1
	Sperre.buchung1ÿsperre.but1
	gezahlt.buchung1ÿgezahlt.but1
	gezahlt_am.buchung1ÿgezahlt_am.but1
	Mahnung.buchung1ÿmahnung.but1
	Einheiten.buchung1ÿeinheiten.but1
	vtagentur.buchung1ÿvtagentur.but1
	vtcodema.buchung1ÿvtcodema.but1
	F„lligkeit.buchung1ÿF„lligkeit.but1
	umrechnung.buchung1ÿumrechnung.but1
	codew.buchung1ÿcodew.but1
	waehrung.buchung1ÿwaehrung.but1
	waehrungBezeich.buchung1ÿwaehrungBezeich.but1
	GesamtbetragEU.buchung1ÿGesamtbetragEU.but1
	BetragEU.buchung1ÿBetragEU.but1
	SREU.buchung1ÿSREU.but1
	BewertungssumEU.buchung1ÿBewertungssumEU.but1
	gezahltEU.buchung1ÿgezahltEU.but1
	Ausgabeauf.buchung1ÿAusgabeauf.but1
	Codeaz.buchung1ÿCodeaz.but1
	ÿƒQuickStore("buchung1")
	ÿ™"but1"
	ÿÉÿ±ÿ™"but1"
ÿÙ
ÿ†ÿ™"but1"
ÿƒServer("MESSAGE","Bitte warten..."ÿÿ(13)ÿÿ(10)ÿ"Die Zahlungseingangsdatei wird zurckgesetzt.")
ÿ™"zeingan1"
ÿ£codevt.zeingan1
ÿÉÿ`
ÿ¾ÿaÿ™"Zeingan1"ÿĞcodevt.zeingan1ÿ
1
ÿ£codeaz.zeingan1
ÿÉÿ`
ÿÍgebuchtJN.zeingan1ÿ"N":gebuchtJNT.zeingan1ÿ"N"
ÿ’ÿÍ
ÿ†ÿ™"zeingan1"
ÿƒDFile(3,"zeingan1"ÿ_fpw$)
ÿ™"zeingan1"
ÿ£codevt.zeingan1
ÿ½ ** CALL Server("MESSAGE","Bitte warten..." + CHR$ (10) + CHR$ (13) + "Zahlungseingang wird gel”scht.")
ÿ½ ** REMOVE FROM FILE "zeingan1"
ÿƒServer("MESSAGE","Bitte warten..."ÿÿ(13)ÿÿ(10)ÿ"Die Vertragsdatei wird zurckgesetzt.")
ÿÊÿË"Vertragsdatei wird zurckgesetzt..."
ÿ½ 271097
ÿ™"KVERTRAG"
ÿÍletzteProvi ÿ0:gez_Abschluá.KVERTRAGÿ"":gez_Pauschale.KVERTRAGÿ""
TZRate.KVERTRAGÿ0:letztePflege.KVERTRAGÿ0:Pool.KVERTRAGÿ0:Mahnung.KVERTRAGÿ"n"
ÿ’ÿÍ
ÿ†ÿ™"kvertrag"
ÿƒDFile(3,"kvertrag"ÿ_fpw$)
ÿ™"spezkond"
ÿÍeinmaligerfolgt.spezkondÿ"n":EinmDatum.spezkondÿ0
ÿ’ÿÍ
ÿ†ÿ™"spezkond"
ÿƒDFile(3,"spezkond"ÿ_fpw$)
ÿ™"VKOND"
ÿÍSTORNOResGezJN.vkondÿ""
ÿ’ÿÍ
ÿ†ÿ™"vkond"
ÿƒDFile(3,"vkond"ÿ_fpw$)
ÿ½ 060497
ÿ™"MAADR"
ÿ£codema.maadr
ÿÍAuszahlAB.maadrÿ(erfAuszahlAB.maadrÿÿ1)ÿzusAuszahl.maadr:AuszahlEUAB.maadrÿ(erfAuszahlEUAB.maadrÿÿ1)ÿzusAuszahlEU.maadr
ÿ’ÿÍ
ÿÍStornoreserve.maadrÿ0:Einheiten.maadrÿ0:EigEinheiten.maadrÿ0:GesVolumen.maadrÿ0:EigVolumen.maadrÿ0:AuszahlSperKo.maadrÿ0:AuszahlSperKoEU.maadrÿ0:StornoreserveEU.maadrÿ0
ÿ’ÿÍ
ÿ†ÿ™"maadr"
ÿƒDFile(3,"maadr"ÿ_fpw$)
ÿ½ 220697
ÿ™"buchung1"
ÿ£codema.buchung1
ÿÉÿ`
ÿØÿOÿB("buchung1")
	ÿ¡Buchungstext.buchung1ÿ"Storno*"ÿBetrag ÿ
0ÿp
ÿÉÿ¥codema.buchung1ÿáÿ™"maadr"ÿ£codema.maadr
Stornoreserve.maadrÿStornoreserve.maadrÿsr.buchung1
StornoreserveEU.maadrÿÿ0(ÿ(Stornoreserve.maadrÿumrechnung.buchung1,"999999999.00"))
Einheiten.maadrÿEinheiten.maadrÿEinheiten.buchung1
ÿ½ Workstation.maadr = Workstation%
ÿ½ QWoNo.maadr = STR$ (Workstation%,"000000") + STR$ (codema.maadr,"000000")
RecStatus.maadrÿ"c"
ÿÌÿ™"maadr"
ÿïÿYÿ™"maadr"
ÿïÿ™"maadr"
	ÿ’ÿ¡
	ÿ™"buchung1"
	ÿÉÿ±
ÿÙ
ÿ™"Aumskto"
ÿ£codema
ÿÍkonto01 ÿ0:konto02 ÿ0:konto03 ÿ0:konto04 ÿ0:konto05 ÿ0:konto06 ÿ0:konto07 ÿ0:konto08 ÿ0:konto09 ÿ0:konto10 ÿ0:konto11 ÿ0:konto12 ÿ0:kontoGes ÿ0
konto01EU ÿ0:konto02eu ÿ0:konto03eu ÿ0:konto04eu ÿ0:konto05eu ÿ0:konto06eu ÿ0:konto07eu ÿ0:konto08eu ÿ0:konto09eu ÿ0:konto10eu ÿ0:konto11eu ÿ0:konto12eu ÿ0:kontoGeseu ÿ0
storno01 ÿ0:storno02 ÿ0:storno03 ÿ0:storno04 ÿ0:storno05 ÿ0:storno06 ÿ0:storno07 ÿ0:storno08 ÿ0:storno09 ÿ0:storno10 ÿ0:storno11 ÿ0:storno12 ÿ0:stornoGes ÿ0
storno01eu ÿ0:storno02eu ÿ0:storno03eu ÿ0:storno04eu ÿ0:storno05eu ÿ0:storno06eu ÿ0:storno07eu ÿ0:storno08eu ÿ0:storno09eu ÿ0:storno10eu ÿ0:storno11eu ÿ0:storno12eu ÿ0:stornoGeseu ÿ0
skonto01 ÿ0:skonto02 ÿ0:skonto03 ÿ0:skonto04 ÿ0:skonto05 ÿ0:skonto06 ÿ0:skonto07 ÿ0:skonto08 ÿ0:skonto09 ÿ0:skonto10 ÿ0:skonto11 ÿ0:skonto12 ÿ0:skontoGes ÿ0
skonto01EU ÿ0:skonto02eu ÿ0:skonto03eu ÿ0:skonto04eu ÿ0:skonto05eu ÿ0:skonto06eu ÿ0:skonto07eu ÿ0:skonto08eu ÿ0:skonto09eu ÿ0:skonto10eu ÿ0:skonto11eu ÿ0:skonto12eu ÿ0:skontoGeseu ÿ0
ekonto01 ÿ0:ekonto02 ÿ0:ekonto03 ÿ0:ekonto04 ÿ0:ekonto05 ÿ0:ekonto06 ÿ0:ekonto07 ÿ0:ekonto08 ÿ0:ekonto09 ÿ0:ekonto10 ÿ0:ekonto11 ÿ0:ekonto12 ÿ0:ekontoGes ÿ0
ekonto01EU ÿ0:ekonto02eu ÿ0:ekonto03eu ÿ0:ekonto04eu ÿ0:ekonto05eu ÿ0:ekonto06eu ÿ0:ekonto07eu ÿ0:ekonto08eu ÿ0:ekonto09eu ÿ0:ekonto10eu ÿ0:ekonto11eu ÿ0:ekonto12eu ÿ0:ekontoGeseu ÿ0
dkonto01 ÿ0:dkonto02 ÿ0:dkonto03 ÿ0:dkonto04 ÿ0:dkonto05 ÿ0:dkonto06 ÿ0:dkonto07 ÿ0:dkonto08 ÿ0:dkonto09 ÿ0:dkonto10 ÿ0:dkonto11 ÿ0:dkonto12 ÿ0:dkontoGes ÿ0
dkonto01EU ÿ0:dkonto02eu ÿ0:dkonto03eu ÿ0:dkonto04eu ÿ0:dkonto05eu ÿ0:dkonto06eu ÿ0:dkonto07eu ÿ0:dkonto08eu ÿ0:dkonto09eu ÿ0:dkonto10eu ÿ0:dkonto11eu ÿ0:dkonto12eu ÿ0:dkontoGeseu ÿ0
ÿ’ÿÍ
ÿ†ÿ™"aumskto"
ÿƒDFile(3,"aumskto"ÿ_fpw$)
ÿ½ CALL Fehler("","")
ÿ™"Kvertrag"
ÿƒBUKOZEPrep1()
ÿƒServer("UNLOADMESSAGE","")
ÿƒWriteLog(">>Korrekturbuchung ab Stichtag "ÿCalcDate$)
ÿ½ SET TODAY StartDatum$
cmonat%ÿÿ5(CalcDate$)
cjahr%ÿÿ6(CalcDate$)
ctag%ÿÿ3(CalcDate$)
ÿ½ Vertr„ge bis zum heutigen Tag hochrechnen
ÿ½ 150697 ctag% = DAY ( TODAY )
ÿ½ 030697 WHILE DAYS (CalcDate$) < TODAY 
ÿ½ WHILE DAYS (CalcDate$) < TODAY 
 
	ÿƒPROVBUZEIN()
 
 
	ÿ½ cmonat% = cmonat% + 1
	ÿ½ IF cmonat% = 13 THEN 
ÿ½ cmonat% = 1
ÿ½ cjahr% = cjahr% + 1
	ÿ½ END IF 
	ÿ½ CalcDate$ = STR$ (ctag%,"00") + "." + STR$ (cmonat%,"00") + "." + STR$ (cjahr%,"0000")
ÿ½ WEND 
ÿßÿ³
ÿÊÿÿx
ÿÊÿË"Bereit"
ÿƒCloseLog()
ÿ^
ÿƒFehler("Falsches Datumsformat!","Das Datum muá in der Form 'tt.mm.jj' eingegeben werden.")
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 Anschluss%ÿ0
 ÿ½ supervis war exclusiv-modus ”ffnen, um herauszufinden, ob noch jemand im Programm eingeloggt ist
 ÿ½ jetzt wieder fr alle ”ffnen
 ÿ¡ÿ´("supervis")ÿpÿ†ÿ™"supervis"
 ÿƒDFile(2,"supervis"ÿ_fpw$)
 ÿ’ÿÿ
 
 ' Vorbereitung der Buchungskorrektur
 ' Aufbau der Vertragspools fr Zahlungseingangskontrolle
 ' =======================================================================

ÿÿBUKOZEPrep1()
 PROVBU$ÿ"TRUE"
 ÿ¡ÿA("zeingan1")ÿ
1ÿpÿ’ÿÿ
 ÿßÿe
 ÿÊÿË"Aufbau der Eingangskonten..."
 ÿƒServer("MESSAGE","Bitte warten...Die Eingangskonten werden neu aufgebaut.")
 ÿ™"zeingan1"
 ÿ£CodeVT.zeingan1
 ÿÉÿ`
 ÿÉÿ¥CodeVT.zeingan1ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 lv%ÿ0
 ÿØÿOÿB("zeingan1")
ÿ¡CodeVT.zeingan1ÿlv%ÿp
ÿÊÿË"Aufbau der Eingangskonten...(Vertrag "ÿVS_NR.KVERTRAGÿ")"
ÿ¡lv%ÿ0ÿpÿƒQuickStore("KVERTRAG")
ÿÉÿ¥CodeVT.zeingan1ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
lv%ÿCodeVT.zeingan1
ÿ’ÿ¡
 
Pool%ÿ(Pool.KVERTRAGÿBetrag.zeingan1)ÿ100
pool1$ÿÿ(pool%,"999999999999")
poolges%ÿ(ÿ0(pool1$))ÿ100
pool.kvertragÿpoolges%
ÿÉÿ±ÿ™"zeingan1"ÿ£CodeVT.zeingan1
 ÿÙ
 ÿƒQuickStore("KVERTRAG")
 PROVBU$ÿ"False"
 ÿßÿ³
 ÿ’ÿÿ
 
 ' Zahlung von Stornoreserven
 ' =======================================================================
 
ÿÿSRZahlungZein()
 ÿßÿe
 ÿ¡cdate%ÿ0ÿpcdate%ÿÿQ
 ÿ™"buchung1"
 ÿ£CodeBU.buchung1
 fmax%ÿÿA("buchung1")
 lp%ÿ0
 cp%ÿ0
 fcount%ÿ0
 ÿÉÿ`
 ÿØÿOÿB("buchung1")
fcount%ÿfcount%ÿ1
cp%ÿÿ(100ÿfmax%ÿfcount%)
ÿ¡lp%ÿcp%ÿp
lp%ÿcp%
ÿÊÿË"Auszahlung Stornoreserve: "ÿÿH(ÿ(lp%,"999"))ÿ"%"
ÿ’ÿ¡
ÿ½ 060497
ÿ¡SRgezahlt.buchung1ÿ"j"ÿSRAuszahlung.buchung1ÿ
cdate%ÿSRAuszahlung.buchung1ÿ0ÿp
_cubu%ÿCodeBU.buchung1
_CodeMA%ÿCodeMA.buchung1
_CodeVT%ÿCodeVT.buchung1
_SR%ÿSR.buchung1
umrechnung%ÿumrechnung.buchung1
codew%ÿcodew.buchung1
waehrung$ÿwaehrung.buchung1

Agentur$ÿAgentur.buchung1
betr%ÿSR.BUCHUNG1ÿÿ1
euro1%ÿumrechnung.buchung1
waehr1$ÿwaehrung.buchung1

ÿÉÿ¥_cubu%ÿáÿ™"buchung1"ÿ£CodeBU.buchung1
SRGezahlt.buchung1ÿ"j"
ÿƒQuickStore("buchung1")
ÿÉÿ¥_Codema%ÿáÿ™"maadr"ÿ£codema.maadr
ÿ½ 060497
Stornoreserve.maadrÿStornoreserve.maadrÿ_SR%
StornoreserveEU.maadrÿÿ0(ÿ(Stornoreserve.maadrÿumrechnung.buchung1,"999999999.00"))
ÿ½ Workstation.maadr = Workstation%
ÿ½ QWoNo.maadr = STR$ (Workstation%,"000000") + STR$ (codema.maadr,"000000")
RecStatus.maadrÿ"c"

abst%ÿStornoreserve.maadr
absteu%ÿStornoreserveEU.maadr
 
ÿ½ ****************************AUSZAHLUNGSSPERRE**********************************
eigen%ÿ0
PSpAll$ÿPROVSperreAll.maadr
PSpAllSeit%ÿPSperreAllSeit.maadr
PROVSpEig$ÿPROVSperreEig.maadr
PSpESeit%ÿPSperreESeit.maadr
ÿ½ CALL Fehler("","")
eigen%ÿ1
ÿ¡PspAll$ÿ"j"ÿp
ÿ¡PSpAllSeit%ÿ	cdate%ÿp
	ÿ½ IF ma1% = 529 THEN CALL Fehler("TRIEBSCH","")
	AuszahlSperKo.maadrÿAuszahlSperKo.maadrÿ_SR%
	AuszahlSperKoEU.maadrÿÿ0(ÿ(AuszahlSperKo.maadrÿeuro1%,"999999999.00"))
ÿ’ÿ¡
ÿ^
ÿ¡eigen%ÿ1ÿPROVSpEig$ÿ"j"ÿp
	ÿ¡PSpESeit%ÿ	cdate%ÿp
AuszahlSperKo.maadrÿAuszahlSperKo.maadrÿ_SR%
AuszahlSperKoEU.maadrÿÿ0(ÿ(AuszahlSperKo.maadrÿeuro1%,"999999999.00"))
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ ****************************AUSZAHLUNGSSPERRE Ende**********************************  
AuszahlAB.maadrÿAuszahlAB.maadrÿ_SR%
AuszahlEUAB.maadrÿÿ0(ÿ(AuszahlAB.maadrÿeuro1%,"999999999.00"))
AuszProvABGes.maadrÿAuszProvABGes.maadrÿ_SR%
AuszProvABGesEU.maadrÿÿ0(ÿ(AuszProvABGes.maadrÿeuro1%,"999999999.00"))
ÿ½ Workstation.maadr = Workstation%
ÿ½ QWoNo.maadr = STR$ (Workstation%,"000000") + STR$ (codema.maadr,"000000")
RecStatus.maadrÿ"c"
ÿÌÿ™"maadr"
ÿïÿYÿ™"maadr"
ÿ½ *****************************************************************************************************
ÿ½ Zentralberechnung des Kontostandes
zusatz%ÿ0
ÿƒZentrKTO(_CodeMA%,cdate%,_SR%,betr%,codew%,euro1%,waehr1$,PSpAll$,PSpAllSeit%,PROVSpEig$,PSpESeit%,eigen%,zusatz%,0)
ÿ½ *****************************************************************************************************  
 



ÿ½ STORE FILE "maadr"
ÿÉÿ¥_CodeVT%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿÿ™"buchung1"
CodeBU.buchung1ÿÿI("buchung1",1)
Datum.buchung1ÿcdate%
CodeVT.buchung1ÿ_CodeVT%
CodeMA.buchung1ÿ_CodeMA%
SR.buchung1ÿ0ÿ_SR%
Betrag.buchung1ÿ_SR%
Buchungstext.buchung1ÿ"SR-Auszahlung "ÿVS_Nr.KVERTRAG
Bewertungssumme.buchung1ÿBewertungssumme.KVERTRAG
BewertungssumEU.buchung1ÿÿ0(ÿ(Bewertungssumme.KVERTRAGÿumrechnung%,"999999999.00"))
Kndigung.buchung1ÿKndigung.KVERTRAG
VS_Beginn.buchung1ÿVS_Beginn.KVERTRAG
Agentur.buchung1ÿAgentur$
umrechnung.buchung1ÿumrechnung%
codew.buchung1ÿcodew%
waehrung.buchung1ÿwaehrung$
CodeKU.BUCHUNG1ÿCodeKU.KVERTRAG
SReu.BUCHUNG1ÿÿ0(ÿ(sr.buchung1ÿumrechnung%,"999999999.00"))
BetragEu.BUCHUNG1ÿÿ0(ÿ(betrag.buchung1ÿumrechnung%,"999999999.00"))

vsumme.buchung1ÿvsumme.kvertrag
vsummeEU.buchung1ÿÿ0(ÿ(vsumme.kvertragÿumrechnung.buchung1,"999999999.00"))
BeitragBrut.buchung1ÿBeitrag.kvertrag
BeitragNet.buchung1ÿNettoBeitrag.kvertrag
BeitragBrutEu.buchung1ÿÿ0(ÿ(Beitrag.kvertragÿumrechnung.buchung1,"999999999.00"))
BeitragNetEu.buchung1ÿÿ0(ÿ(NettoBeitrag.kvertragÿumrechnung.buchung1,"999999999.00"))
zw.buchung1ÿzw.kvertrag
mwst.buchung1ÿmwst.kvertrag
ÿ¡zw.buchung1ÿ0ÿp
JahresBBrut.buchung1ÿBeitragBrut.buchung1ÿzw.buchung1
JahresBNet.buchung1ÿBeitragNet.buchung1ÿzw.buchung1
JahresBBrutEu.buchung1ÿÿ0(ÿ(JahresBBrut.buchung1ÿumrechnung.buchung1,"999999999.00"))
JahresBNetEu.buchung1ÿÿ0(ÿ(JahresBNet.buchung1ÿumrechnung.buchung1,"999999999.00"))
ÿ^
JahresBBrut.buchung1ÿBeitragBrut.buchung1
JahresBNet.buchung1ÿBeitragNet.buchung1
JahresBBrutEu.buchung1ÿÿ0(ÿ(JahresBBrut.buchung1ÿumrechnung.buchung1,"999999999.00"))
JahresBNetEu.buchung1ÿÿ0(ÿ(JahresBNet.buchung1ÿumrechnung.buchung1,"999999999.00"))
ÿ’ÿ¡



ÿ½ umrechnung.buchung1=umrechnung.kvertrag
CodeKU.buchung1ÿCodeKU.KVERTRAG
ÿÉÿ¥CodeVA.kvertragÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
Sparte.buchung1ÿSparte.SPARTEN
ÿÉÿ¥CodeKU.KVERTRAGÿ™GAdrDat$ÿ£CodeKU.GAdrDat$
Nachname.buchung1ÿNachname.GAdrDat$
Vorname.buchung1ÿVorname.GAdrDat$
ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
Gesellschaft.buchung1ÿGesellschaft.GEADR
SRgezahlt.buchung1ÿ"j"
Provision.buchung1ÿ"j"
ÿ½ SR.buchung1 = 0 - _SR%
ÿƒQuickStore("buchung1")
ÿÉÿ¥_cubu%ÿ™"buchung1"ÿ£CodeBU.buchung1
ÿ’ÿ¡
ÿÉÿ±ÿ™"buchung1"ÿ£CodeBU.buchung1
 ÿÙ
 ÿßÿ³
 ÿ’ÿÿ
 



 ÿ½ ****************************************************************************************
 ÿ½ *         Erzeugen einer Vertragsprovisionsvorschlagsbersicht                         *
 ÿ½ ****************************************************************************************
 
ÿÿProvCheck()
 codevtab%ÿ0
 ÿ¡disabled%("BUCHUNG6")ÿpÿ’ÿÿ
 ÿƒDFile(3,"buchung"ÿ_fpw$)
 ÿƒDFile(3,"buchmon"ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"maadrgru"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(3,"vkond"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\"ÿGADRDat$ÿ_fpw$)
 ÿ¡anschluss%ÿ0ÿp
CalcDate$ÿÿ(ÿQ,"0d.mm.yyyy")
ÿ‰ÿñ"STICHTAG",0,0,222,114,"Buchungsdatum","MS Sans Serif",8
ÿ|ÿñ"STICHTAG",4,0,0,222,91,0,""
ÿ|ÿñ"STICHTAG",9,6,9,23,24,2
ÿ|ÿñ"STICHTAG",5,31,15,183,10,0,"Bitte geben Sie an, fr welches Buchungsdatum"
ÿ|ÿñ"STICHTAG",5,31,25,183,10,0,"die Provisionsberechnung durchgefhrt werden soll:"
ÿ|ÿñ"STICHTAG",5,32,40,182,10,0,"(ohne nderung des Datums oder Weglassen"
ÿ|ÿñ"STICHTAG",5,31,50,182,10,0,"der Datumsangabe, wird das heutige Datum verwendet)"
ÿ|ÿñ"STICHTAG",6,94,72,42,12,0,0,CalcDate$,10
ÿ|ÿñ"STICHTAG",5,30,74,58,10,0,"Buchungsdatum:"
ÿ|ÿñ"STICHTAG",1,52,94,54,14,1,"&OK",1,1
ÿ|ÿñ"STICHTAG",1,109,94,54,14,0,"&Abbrechen",0,0
ÿñ"STICHTAG",req%
ÿ¾ÿñ"STICHTAG"
ÿ¡req%ÿ1ÿp
ÿ¡DateOK%(CalcDate$)ÿp
ok%ÿ1
ÿ¡codevtab%ÿ0ÿpÿƒWriteConfig("PROVIS","letzteProvisionsrechnung",CalcDate$)
ÿ^
ok%ÿ0
ÿƒFehler("Falsche Datumsangabe!","Bitte geben Sie das Datum in der Form 'tt.mm.jjjj' ein.")
ÿ’ÿ¡
ÿ^
ok%ÿ0
ÿweab28119901
ÿ’ÿ¡
 ÿ^
ok%ÿ1
 ÿ’ÿ¡
 ÿ¡ok%ÿ1ÿp
cdate%ÿÿ1(CalcDate$)
minimize$ÿReadINI$("PROVIS","minimize")
ÿ¡anschluss%ÿ0ÿp
ÿ¡minimize$ÿ"TRUE"ÿp
ÿÂ"PROVIS wird in den Hintergrund geschaltet!","Sie k”nnen w„hrend der Berechung andere Programme starten.",0
ÿÊÿÿÚ
ÿ’ÿ¡
ÿƒCreateLog()
ÿ’ÿ¡
 
ÿƒWriteLog("")
ÿƒWriteLog("=================================")
ÿƒWriteLog("Provisionsabrechnung vom "ÿÿ(cdate%,"0d.mm.yyyy"))
ÿƒWriteLog("=================================")
ÿƒWriteLog("")
ÿßÿe
ÿ™"kvertrag"
ÿ£ProviAb.kvertrag
ÿÉÿ`
ÿ¡codevtab%ÿ0ÿp
ÿ£lfdnr.kvertrag
ÿÉÿ¥codevtab%ÿáÿ™"Kvertrag"ÿ£lfdnr.kvertrag
ÿ’ÿ¡
_p1%ÿÿA("kvertrag")
_pd$ÿ"0"
_pd%ÿÿ1
_p2%ÿ0
ÿ¡codevtab%ÿ0ÿpÿØÿOÿB("kvertrag")ÿ(ProviAb.KVERTRAGÿ	cdate%ÿBewertCalcDat.kvertragÿ	cdate%)
ÿ¡codevtab%ÿ0ÿpÿØÿOÿB("kvertrag")ÿ(ProviAb.KVERTRAGÿ	cdate%ÿBewertCalcDat.kvertragÿ	cdate%)ÿlfdnr.kvertragÿcodevtab%
 
ÿ½ -----------------------------------------
ÿ½ -- Prozentbalken und Header aktualisieren
ÿ½ -----------------------------------------
 
ÿÊÿË"Bearbeite Vertrag "ÿÿH(ÿ(_p2%,"999999"))ÿ" von "ÿÿH(ÿ(_p1%,"999999"))ÿ"  "ÿvs_NR.kvertrag
_pc%ÿÿ (100ÿ_p1%ÿ_p2%,0)
ÿ¡_pd%ÿ_pc%ÿp
_pd%ÿ_pc%
ÿ¡ÿåsys(11)ÿ36ÿÿåsys(12)ÿ36ÿp
	ÿ¡anschluss%ÿ0ÿp
ÿÊÿŸÿ(_pd%,"999")ÿ"%"
	ÿ^
ÿÊÿŸÿ(_pd%,"999")ÿ"% "ÿÿH(ÿ(ÿ5(cdate%),"00"))ÿ"/"ÿÿ-(ÿ(ÿ6(cdate%),"9999"),4)
	ÿ’ÿ¡
ÿ^
	ÿ¡anschluss%ÿ0ÿp
ÿÊÿŸtitle$ÿ" - Provisionsberechung: "ÿÿ(_pd%,"999")ÿ"% erledigt"
	ÿ^
ÿÊÿŸtitle$ÿ" - Provisionsberechung: "ÿÿ(_pd%,"999")ÿ"% "ÿÿH(ÿ(ÿ5(cdate%),"00"))ÿ"/"ÿÿ-(ÿ(ÿ6(cdate%),"9999"),4)
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ½ --------------------------------------
ÿ½ -- CheckUp fr Vertragsprovisionierung
ÿ½ --------------------------------------
 
ok%ÿ1
ÿ½ 030697
ÿ¡codeko.kvertragÿ
1ÿp
ok%ÿ0
ÿ^
ÿ½ CALL Fehler(Test",date$(cdate%,"0d.mm.yyyy")
ÿ½ 190298
ÿ¡ÿ1(Kndigung.KVERTRAG)ÿ1ÿÿ1(Kndigung.KVERTRAG)ÿ
cdate%ÿp
	ok%ÿ0
	ÿ½ 210597
	ÿ¡TatsKuenDat.kvertragÿKndigung.KVERTRAGÿpok%ÿ1
	ÿ¡TatsKuenDat.kvertragÿ
cdate%ÿpok%ÿ0
	ÿ¡_debug%ÿ1ÿpÿƒWriteLog("## Kndigung: "ÿÿ(lfdnr.KVERTRAG,"000000")ÿ", "ÿÿ(Kndigung.KVERTRAG,"0d.mm.yyyy"))
ÿ’ÿ¡
ÿ¡Storno.KVERTRAGÿ0ÿÿ1(Kndigung.KVERTRAG)ÿ
cdate%ÿp
	ok%ÿ0
	ÿ½ 190398
	ÿ¡TatsKuenDat.kvertragÿKndigung.KVERTRAGÿpok%ÿ1
	ÿ¡TatsKuenDat.kvertragÿ
cdate%ÿpok%ÿ0
ÿ’ÿ¡

ÿ¡ÿ1(ProviAb.KVERTRAG)ÿ
1ÿp
	ok%ÿ0
ÿ’ÿ¡
ÿ¡ÿ1(VS_Beginn.KVERTRAG)ÿ
1ÿp
	ok%ÿ0
ÿ’ÿ¡
ÿ¡ÿ1(ProviAb.KVERTRAG)ÿcdate%ÿp
	ok%ÿ0
ÿ’ÿ¡
ÿ¡cdate%ÿÿ1(letzteProvi.KVERTRAG)ÿ
27ÿp
	ok%ÿ0
	ÿ¡_debug%ÿ1ÿpÿƒWriteLog("## Zeitsperre: "ÿÿ(letzteProvi.KVERTRAG,"0d.mm.yyyy"))
ÿ’ÿ¡
ÿ¡CodeMA.KVERTRAGÿ
1ÿp
	ÿƒWriteLog("!dem Vertrag wurde keine Agentur zugeordnet")
	ÿƒAddLogInfo()
	ok%ÿ0
ÿ’ÿ¡
ÿ¡CodeGE.KVERTRAGÿ
1ÿp
	ÿƒWriteLog("!dem Vertrag wurde keine Gesellschaft zugeordnet")
	ÿƒAddLogInfo()
	ok%ÿ0
ÿ’ÿ¡
ÿ¡CodeVA.KVERTRAGÿ
1ÿp
	ÿƒWriteLog("!dem Vertrag wurde keine Sparte zugeordnet")
	ÿƒAddLogInfo()
	ok%ÿ0
ÿ’ÿ¡
ÿ¡CodeKO.KVERTRAGÿ0ÿÿ1(ProviAb.KVERTRAG)ÿcdate%ÿp
	ÿƒWriteLog("!der erwartete Eintrag in VKOND konnte nicht gefunden werden")
	ÿƒAddLogInfo()
	ok%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ ------------------------
ÿ½ -- Aufruf der Berechnung
ÿ½ ------------------------
 
ÿ¡ok%ÿ1ÿp
ÿ½ CALL Fehler("Provision soll berechnet werden","")
gezPflege%ÿ0
gezPauschale%ÿ0
gezAbschluá%ÿ0
gezStornoRes%ÿ0
ÿƒPROVCHECK2()
ÿ’ÿ¡
ÿ¡codevtab%ÿ0ÿpÿÉÿ±ÿ™"KVERTRAG"ÿ£ProviAb.kvertrag
ÿ¡codevtab%ÿ0ÿpÿÉÿ±ÿ™"KVERTRAG"ÿ£lfdnr.kvertrag
_p2%ÿ_p2%ÿ1
ÿÙ
 ÿƒCloseLog()
 ÿ’ÿÿ
 
 
 
 
 ÿ½ *********************************************************
 ÿ½ Test der gefundenen Vertr„ge, ob gezahlt werden muá
 ÿ½ *********************************************************
ÿÿPROVCHECK2()
 cfile$ÿÿ™
 ok%ÿ1
 ÿ½ **DEBUG ProviAb-Check
 
 ÿ¡ProviAb.KVERTRAGÿcdate%ÿp
ÿƒWriteLog("## Aufruf PROVISION2 mit ProviAb > cdate%")
ÿ½ REQUEST "ProviAb > cdate%"
 ÿ’ÿ¡
 bwbezug$ÿReadConfig$("PROVIS","Bewertungszeitraum")
 ÿ¡bwbezug$ÿ"leer"ÿbwbezug$ÿ"Provisionierungsbeginn"ÿp
BWStart%ÿÿ1(ProviAb.KVERTRAG)
 ÿ^
BWStart%ÿÿ1(VS_Beginn.KVERTRAG)
 ÿ’ÿ¡
 Laufzeit%ÿÿ ((cdate%ÿBWStart%)ÿ30,0)
 LaufzeitPro%ÿÿ ((cdate%ÿÿ1(ProviAb.KVERTRAG))ÿ30,0)
 
 ÿ½ **DEBUG Laufzeit in LOG schreiben
 ÿ¡_debug%ÿ1ÿpÿƒWriteLog("## Laufzeit: "ÿÿ(lfdnr.KVERTRAG,"000000")ÿ" - "ÿÿ(Laufzeit%,"9999")ÿ" Monate")
 cuvt%ÿlfdnr.KVERTRAG
 codema%ÿCodeMA.kvertrag
 codege%ÿCodeGE.kvertrag
 codeva%ÿCodeVA.kvertrag
 koab%ÿCodeKO.KVERTRAG
 ÿÉÿ`ÿ™"maadr"ÿ£codema.maadr
 ÿÉÿ¥codema%ÿ™"maadr"ÿ£codema.maadr
 Gvtagentur$ÿNachname.maadrÿ","ÿvorname.maadr
 Gvtcodema%ÿcodema.maadr
 ÿ¡ÿOÿJ(koab%,codevk.VKOND)ÿp
ÿƒWriteLog("  kein Eintrag in Datei VKOND-gefunden!")
ÿƒAddLogInfo()
ok%ÿ0
 ÿ^
ÿÉÿ¥koab%ÿáÿ™"VKOND"ÿ£CodeVK.VKOND
 ÿ’ÿ¡
 vertrprov%ÿ0
 vsumAP%ÿ0
 vsumC%ÿ0
 vsumPP%ÿ0
 vsumPausch%ÿ0
 vertrsr%ÿ0
 ÿØok%ÿ1
ÿÉÿ¥CodeKO.VKONDÿ™"GEKOND"ÿ£lfdnr.GEKOND
ÿ¡ÿOÿC("GEKOND")ÿp
ÿƒWriteLog("  die angegebene Kondition ist nicht enthalten!")
ÿƒWriteLog("  SUPPORT: die in VKOND angegebene Kondition fehlt in GEKOND!")
ÿƒAddLogInfo()
ok%ÿ0
ÿ’ÿ¡
ÿ¡ok%ÿ1ÿp
vtagentur$ÿGvtagentur$
vtcodema%ÿGVTcodema%
codema%ÿCodeMA.GEKOND
ÿ½ 150697
dmeinh%ÿdmeinheit.gekond
ÿ½ --------------------
ÿ½ -- Abschluáprovision
ÿ½ --------------------
 
ÿ¡APjn.gekondÿ"j"ÿp
ÿ¡gez_Abschluá.kvertragÿ"j"ÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿAP.gekond)
 
	ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung.gekondÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
Haftung%ÿÿ1(VS_Beginn.kvertrag)ÿ(Haftung.gekondÿ30)
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
	ÿ^
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿ0
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
	ÿ’ÿ¡
	a ÿ"A"
	ÿ¡a ÿ"A"ÿp
ÿƒCheckProvis("AP: "ÿVS_Nr.KVERTRAG,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag)
ok%ÿ0
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ½ ------------------
ÿ½ -- Pflegeprovision
ÿ½ ------------------
ÿ½ 13.10.94  - keine Berechung der Stornoreserve
pflege%ÿ0
ÿ¡PflegeJN.gekondÿ"j"ÿp
ÿ¡Laufzeit%ÿPflegezeit.gekondÿp
	_day%ÿÿ3(letztePflege.KVERTRAG)
	_month%ÿÿ5(letztePflege.KVERTRAG)
	_year%ÿÿ6(letztePflege.KVERTRAG)
 
	ÿ¡_year%ÿ
1980ÿp
_year%ÿ1980
_day%ÿ1
_month%ÿ1
	ÿ’ÿ¡

ÿ½ 060597 Neu Pflegeprovis nach Zahlweisen
PflegeGez$ÿ"j"
ÿ¡PflegeNachZahlw ÿ"n"ÿp
ÿ½ -- abh„ngig von Zahlungsweise im Vertrag --
ÿÉÿæZW.KVERTRAG
ÿæ1
_year%ÿ_year%ÿ1
ÿæ2
_month%ÿ_month%ÿ6
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
ÿæ4
_month%ÿ_month%ÿ3
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
ÿæ6
_month%ÿ_month%ÿ2
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
ÿæ12
_month%ÿ_month%ÿ1
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
ÿæ0
_year%ÿ2100
ÿ’ÿÉ
nextpfl%ÿÿ1(ÿ(_day%,"00")ÿ"."ÿÿ(_month%,"00")ÿ"."ÿÿ(_year%,"9999"))
ÿ½ 060597 kl„ren wozu ?
ÿ¡ZW.KVERTRAGÿ0ÿletzteProvi.KVERTRAGÿ
1ÿp
ÿ½ 150597
ÿ½ prov% = (((Beitrag.KVERTRAG * ZW.KVERTRAG) / 100) * PflegeProvi.gekond)
prov%ÿ(((Beitrag.KVERTRAG)ÿ100)ÿPflegeProvi.gekond)
PflegeGez$ÿ"j"
pflege%ÿ1
sr%ÿ0
Haftung%ÿ0
ÿ^
ÿ¡nextpfl%ÿ	cdate%ÿp
ÿ½ 150597
ÿ½ prov% = (((Beitrag.KVERTRAG * ZW.KVERTRAG) / 100) * PflegeProvi.gekond)
prov%ÿ(((Beitrag.KVERTRAG)ÿ100)ÿPflegeProvi.gekond)
PflegeGez$ÿ"j"
pflege%ÿ1
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ½ -- Abh„ngig von Zahlweise in GEKOND --
_month%ÿ_month%ÿPflegeZW.GEKOND
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
nextpfl%ÿÿ1(ÿ(_day%,"00")ÿ"."ÿÿ(_month%,"00")ÿ"."ÿÿ(_year%,"9999"))
ÿ¡nextpfl%ÿ	cdate%ÿp
prov%ÿ(((Beitrag.KVERTRAGÿZW.KVERTRAG)ÿ100)ÿPflegeProvi.gekond)
PflegeGez$ÿ"j"
pflege%ÿ1
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ 030697 IF PflegeGez$ = "j" THEN CALL RegProvis("Pflege: " + VS_Nr.kvertrag,codema%,prov%,sr%,Haftung%)
ÿ¡PflegeGez$ÿ"j"ÿp
ÿƒCheckProvis("Pflege: "ÿVS_Nr.kvertrag,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag)
ok%ÿ0
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ½ 140497 Courtage nicht rechnen, wenn CourtageEinstell angekreuzt wurde und eine Pflegeprov. gezahlt wurde 
ÿ½ 270497 IF pflege% = 1 AND CourtEinstellen.gekond = "j" THEN GOTO Pflege1404971 
ÿ½ 200597
 
ÿ¡pflege%ÿ1ÿletztePflege.kvertragÿ0ÿpÿwCheckPrv261199
 
ÿ½ -----------
ÿ½ -- Courtage
ÿ½ -----------
 
ÿ¡CourtageJN.gekondÿ"j"ÿp
_day%ÿÿ3(letzteProvi.KVERTRAG)
_month%ÿÿ5(letzteProvi.KVERTRAG)
_year%ÿÿ6(letzteProvi.KVERTRAG)
ÿ¡_year%ÿ
1980ÿp
	_year%ÿ1980
	_day%ÿ1
	_month%ÿ1
ÿ’ÿ¡
CourtGez$ÿ"n"
ÿ¡CourtageZWjn.gekondÿ"n"ÿp
	ÿ½ -- abh„ngig von Zahlungsweise im Vertrag --
	ÿÉÿæZW.KVERTRAG
	ÿæ1
_year%ÿ_year%ÿ1
	ÿæ2
_month%ÿ_month%ÿ6
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
	ÿæ4
_month%ÿ_month%ÿ3
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
	ÿæ6
_month%ÿ_month%ÿ2
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
	ÿæ12
_month%ÿ_month%ÿ1
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
	ÿæ0
_year%ÿ2100
	ÿ’ÿÉ
	nextprovi%ÿÿ1(ÿ(_day%,"00")ÿ"."ÿÿ(_month%,"00")ÿ"."ÿÿ(_year%,"9999"))
	ÿ¡ZW.KVERTRAGÿ0ÿletzteProvi.KVERTRAGÿ
1ÿp
ÿ¡CourtNachBeitr$ÿ"TRUE"ÿp
prov%ÿ((Beitrag.KVERTRAGÿ100)ÿCourtage.gekond)
ÿ^
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿCourtage.gekond)
ÿ’ÿ¡
CourtGez$ÿ"j"
	ÿ^
ÿ¡nextprovi%ÿ	cdate%ÿp
ÿ¡CourtNachBeitr$ÿ"TRUE"ÿp
prov%ÿ((Beitrag.KVERTRAGÿ100)ÿCourtage.gekond)
ÿ^
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿCourtage.gekond)
ÿ’ÿ¡
CourtGez$ÿ"j"
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ^
	ÿ½ -- Abh„ngig von Zahlweise in GEKOND --
	_month%ÿ_month%ÿCourtageZW.GEKOND
	ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
	ÿ’ÿ¡
	nextprovi%ÿÿ1(ÿ(_day%,"00")ÿ"."ÿÿ(_month%,"00")ÿ"."ÿÿ(_year%,"9999"))
	ÿ¡nextprovi%ÿ	cdate%ÿp
ÿ¡CourtNachBeitr$ÿ"TRUE"ÿp
prov%ÿ((Beitrag.KVERTRAGÿ100)ÿCourtage.gekond)
ÿ^
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿCourtage.gekond)
ÿ’ÿ¡
CourtGez$ÿ"j"
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ 060497
ÿ½ 200597
ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung.gekondÿStornoResGezJN.vkondÿ"j"ÿp
	StornoResGezJN$ÿ""
	sr%ÿsr.gekond
	ÿ¡sr%ÿ0ÿp
codevk%ÿcodevk.vkond
Haftung%ÿÿ1(ProviAb.kvertrag)ÿ(Haftung.gekondÿ30)
StornoResGezJN$ÿ"x"
	ÿ’ÿ¡
ÿ^
	ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿ0
	ÿ^
sr%ÿ0
Haftung%ÿ0
	ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ¡StornoResGezJN$ÿ"x"ÿp
	StornoResGezJN.vkondÿ"j"
	codevk%ÿcodevk.vkond
	Workstation.vkondÿWorkstation%
	QWoNo.vkondÿÿ(Workstation%,"000000")ÿÿ(codevk.vkond,"000000")
	RecStatus.vkondÿ"c"
	ÿÌÿ™"Vkond"
	ÿÉÿ¥codevk%ÿ™"VKOND"ÿ£CodeVK.VKOND
	StornoResGezJN$ÿ""
ÿ’ÿ¡
ÿ½ 220697
a ÿ"A"
ÿ¡a ÿ"A"ÿp
	ÿ¡a ÿ"A"ÿp
ÿƒCheckProvis("Courtage: "ÿVS_Nr.kvertrag,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag)
ok%ÿ0
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 
 
CheckPrv261199: 
 

 
 

ÿ½ ----------------
ÿ½ -- Vertragsdauer
ÿ½ ----------------
 
ÿ¡VDjn.gekondÿ"j"ÿp
ÿ¡gez_Abschluá.kvertragÿ"j"ÿp
	ÿÉÿæVS_Dauer.KVERTRAG
	ÿæVD1Dauer.gekond
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿVD1AP.gekond)
sr%ÿVD1SR.gekond
Haftung%ÿVD1HZ.GEKOND
	ÿæVD2Dauer.gekond
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿVD2AP.gekond)
sr%ÿVD2SR.gekond
Haftung%ÿVD2HZ.GEKOND
	ÿæVD3Dauer.gekond
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿVD3AP.gekond)
sr%ÿVD3SR.gekond
Haftung%ÿVD3HZ.GEKOND
	ÿæVD4Dauer.gekond
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿVD4AP.gekond)
sr%ÿVD4SR.gekond
Haftung%ÿVD4HZ.GEKOND
	ÿæVD5Dauer.gekond
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿVD5AP.gekond)
sr%ÿVD5SR.gekond
Haftung%ÿVD5HZ.GEKOND
	ÿ’ÿÉ
	ÿ¡sr%ÿ0ÿp
Haftung%ÿ(Haftung%ÿ30)ÿÿ1(VS_beginn.kvertrag)
	ÿ^
Haftung%ÿ0
	ÿ’ÿ¡
	a ÿ"A"
	ÿ¡a ÿ"A"ÿp
ÿƒCheckProvis("VD: "ÿVS_Nr.kvertrag,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag)
ok%ÿ0
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡

ÿ½ -----------------------------------
ÿ½ -- Teilzahlung/Ratenzahlung
ÿ½ -- z.Z. auf Ratenzahlung umgestellt
ÿ½ -----------------------------------
 
ÿ¡TZjn.gekondÿ"j"ÿp
ÿ¡TZRate.KVERTRAGÿ1ÿ1ÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ0.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD1.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ1.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD2.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ2.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD3.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ3.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD4.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ4.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD5.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ5.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD6.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ6.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD7.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ7.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD8.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ8.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD9.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ9.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD10.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ10.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD11.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ11.gekond)
ÿ’ÿ¡
ÿ¡prov%ÿ0ÿp
	ÿ½ 060497
	ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung.gekondÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿpHaftung%ÿÿ1(VS_Beginn.kvertragÿ(Haftung.gekondÿ30))
	ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿ0
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ½ IF sr% <> 0 THEN 
ÿ½ Haftung% = DAYS (VS_Beginn.kvertrag + (Haftung.gekond * 30))
	ÿ½ ELSE 
ÿ½ Haftung% = 0
	ÿ½ END IF
	a ÿ"A"
	ÿ¡a ÿ"A"ÿp
ÿƒCheckProvis("TZ ("ÿÿH(ÿ(TZRate.KVERTRAGÿ1,"999"))ÿ". Zahlung): "ÿVS_Nr.kvertrag,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag)
ok%ÿ0
	ÿ’ÿ¡
ÿ^
	ÿƒWriteLog("!Konditionen fr Ratenzahlung/Teilzahlung unvollst„ndig")
	ÿƒWriteLog("    >> Rate: "ÿÿH(ÿ(TZRate.KVERTRAGÿ1,"999")))
	ÿƒWriteLog("    >> bei Abschluá:"ÿÿH(ÿ(TZ0.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD1.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ1.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD2.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ2.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD3.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ3.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD4.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ4.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD5.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ5.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD6.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ6.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD7.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ7.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD8.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ8.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD9.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ9.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD10.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ10.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD11.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ11.gekond,",999999.00")))
	ÿƒAddLogInfo()
ÿ’ÿ¡
 
ÿ’ÿ¡
 
ÿ½ ------------
ÿ½ -- Pauschale
ÿ½ ------------
 
ÿ¡PauschaleJN.gekondÿ"j"ÿp
ÿ¡gez_Pauschale.kvertragÿ"j"ÿp
	prov%ÿPauschale.gekond
	ÿ½ 060497
	ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung.gekondÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿpHaftung%ÿÿ1(VS_Beginn.kvertrag)ÿ(Haftung.gekondÿ30)
	ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿ0
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ½ IF sr% <> 0 THEN 
ÿ½ Haftung% = DAYS (VS_Beginn.kvertrag) + (Haftung.gekond * 30)
	ÿ½ ELSE 
ÿ½ Haftung% = 0
	ÿ½ END IF
	a ÿ"A"
	ÿ¡a ÿ"A"ÿp
ÿƒCheckProvis("Pauschale: "ÿVS_Nr.kvertrag,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag)
ok%ÿ0
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ’ÿ¡
 
ÿ¡n„chsteKond.VKONDÿ0ÿp
ok%ÿ0
ÿ^
ÿ¡ok%ÿ0ÿp
ÿÉÿ¥n„chsteKond.VKONDÿáÿ™"VKOND"ÿ£CodeVK.VKOND
ÿ’ÿ¡
ÿ’ÿ¡
 
 ÿÙ
eab28119901: 
 ÿ’ÿÿ
 
 
 
 
 ÿ½ ===================================================================================
 ÿ½ =   Aufnahme der zur Berechnung freigegebenen Datens„tze in eine gesonderte Datei =
 ÿ½ ===================================================================================
 
ÿÿCheckProvis(remark$,ma%,provi%,sr%,Haftung%,euro1%,codew%,waehr1$)
 cfile$ÿÿ™
 ÿ™"kvertrag"
 _lfdnr%ÿlfdnr.KVERTRAG
 ÿÉÿ¥_lfdnr%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿÉÿ¥ma%ÿ™"maadr"ÿ£CodeMA.MAADR
 ÿÉÿ¥codeva.kvertragÿ™"sparten"ÿ£codeva.sparten
 ÿ½ -- bereits gezahlte Provisionen verallgemeinern
 ÿ¡remark$ÿ"Abschl*"ÿremark$ÿ"AP*"ÿremark$ÿ"*Abschl*"ÿp
vertrprov%ÿvsumAP%
 ÿ^ÿ¡remark$ÿ"Courta*"ÿp
vertrprov%ÿvsumC%
 ÿ^ÿ¡remark$ÿ"Pflege*"ÿp
vertrprov%ÿvsumPP%
 ÿ^ÿ¡remark$ÿ"Pauschal*"ÿp
vertrprov%ÿvsumPausch%
 ÿ^ÿ¡remark$ÿ"VD*"ÿp
vertrprov%ÿvsumAP%
 ÿ’ÿ¡
 
 ÿ½ -- Bearbeitung bei letzter Agentur in der Struktur
 ÿ¡(CodeMA.maadrÿvorg„nger.maadr)ÿ(Vorg„nger.MAADRÿ
1)ÿp
ÿ½ letzteProvi.kvertrag = cdate%
ÿ¡remark$ÿ"TZ (*"ÿp
TZRate.KVERTRAGÿTZRate.KVERTRAGÿ1
ÿ’ÿ¡
 ÿ’ÿ¡
 
 ÿ½ -- Einmalzahlungen/Berechnungen Stornoreserve registrieren --
 ÿ¡remark$ÿ"Abschlu*"ÿremark$ÿ"VD*"ÿremark$ÿ"*Abschl*"ÿremark$ÿ"AP*"ÿpgezAbschluá%ÿ1
 ÿ¡remark$ÿ"Pflege*"ÿpgezPflege%ÿ1
 ÿ¡remark$ÿ"Pauschal*"ÿpgezPauschale%ÿ1

 
 ÿßÿe
 ÿ™"buchmon"
 ÿ
 CodeBU.buchmonÿÿI("buchmon",1)
 Datum.buchmonÿcdate%
 F„lligkeit.buchmonÿcdate%
 CodeVT.buchmonÿlfdnr.kvertrag
 ÿ¡Kndigung.MAADRÿ	cdate%ÿNachfolger.MAADRÿ0ÿp
CodeMA.buchmonÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
Buchungstext.buchmonÿremark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)"
 ÿ^
CodeMA.buchmonÿma%
ma1%ÿma%
Buchungstext.buchmonÿremark$
 ÿ’ÿ¡
 ÿ¡dmeinh%ÿ0ÿpeinheit%ÿprovi%ÿdmeinh%
 SRBetrag%ÿ((provi%ÿvertrprov%)ÿ100)ÿsr%
 Betrag.buchmonÿprovi%ÿvertrprov%ÿSRBetrag%

 Gesamtbetrag.BUCHmonÿprovi%
 Bewertungssumme.BUCHmonÿBewertungssumme.KVERTRAG
 Volumen.BUCHmonÿVolumen.KVERTRAG
 Kndigung.BUCHmonÿKndigung.KVERTRAG
 VS_Beginn.BUCHmonÿVS_Beginn.KVERTRAG
 CodeKU.BUCHmonÿCodeKU.KVERTRAG
 vtagentur.buchmonÿGvtagentur$
 vtcodema.buchungÿGvtcodema%
ÿ¡EinheitSach.stammÿ"j"ÿp
ÿ¡SparteIstSach.spartenÿ1ÿp
ÿ¡ma1%ÿvtcodema%ÿp
	ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchmonÿeinheit%
	ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchmonÿeinheiten.kvertrag
ÿ’ÿ¡
ÿ^
	ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchmonÿeinheit%
	ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchmonÿeinheiten.kvertrag
ÿ’ÿ¡
ÿ^
	ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchmonÿeinheit%
	ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchmonÿeinheiten.kvertrag
ÿ’ÿ¡
 ÿÉÿ¥CodeVA.kvertragÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 Sparte.BUCHmonÿSparte.SPARTEN
 ÿÉÿ¥CodeKU.KVERTRAGÿ™GAdrDat$ÿ£CodeKU.GAdrDat$
 Nachname.BUCHmonÿNachname.GAdrDat$
 Vorname.BUCHmonÿVorname.GAdrDat$
 umrechnung.buchmonÿeuro1%
 codew.buchmonÿcodew%
 waehrung.buchmonÿwaehr1$
 ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
 Gesellschaft.BUCHmonÿGesellschaft.GEADR
 Provision.buchmonÿ"j"
 ÿ¡sr%ÿ0ÿp
SRgezahlt.buchmonÿ"j"
SR.buchmonÿ0
 ÿ^
ÿ½ 060497
ÿ¡Haftung%ÿÿ1ÿp
SRAuszahlung.buchmonÿ0
SR.buchmonÿSRBetrag%
ÿ^
SRAuszahlung.buchmonÿHaftung%
SR.buchmonÿSRBetrag%
ÿ’ÿ¡
 ÿ’ÿ¡
 
 ÿ½ -- Zahlungseingang prfen --
 ÿ½ 070897
 ÿ¡check.KVERTRAGÿ"j"ÿp
ÿ½ CALL Fehler("Check auf Pool","")
_lfdnr%ÿlfdnr.KVERTRAG
ÿÉÿ¥_lfdnr%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
pool%ÿ(Pool.KVERTRAGÿBetrag.BUCHUNG)ÿ100
pool1$ÿÿ(pool%,"999999999999")
poolges%ÿ(ÿ0(pool1$))ÿ100
ÿ½ pool.kvertrag = poolges%
ÿ¡Pool.KVERTRAGÿ
0ÿp
ÿ½ Mahnung.KVERTRAG = "j"
Mahnung.BUCHmonÿ"j"
ÿƒWriteLog("  fehlender Zahlungseingang von Gesellschaft")
ÿƒAddLogInfo()
ÿ’ÿ¡
ÿ½ CALL QuickStore("KVERTRAG")
 ÿ’ÿ¡
 ausgew„hlt.buchmonÿ"j"
 zero.buchmonÿ0
 codebumon.buchmonÿÿ(datum.buchmon,"0dmmyyyy")ÿÿ(codebu.buchmon,"000000")
 letzteProvi.buchmonÿletzteProvi.kvertrag
 ÿƒQuickStore("buchmon")
 
 ÿ½ -- Aufsummierung der einzelnen Provisionsarten
 ÿ½    fr Differenzberechnung
 ÿ¡remark$ÿ"Abschl*"ÿremark$ÿ"*Abschl*"ÿremark$ÿ"AP*"ÿp
vsumAP%ÿprovi%
 ÿ^ÿ¡remark$ÿ"Courta*"ÿp
vsumC%ÿprovi%
 ÿ^ÿ¡remark$ÿ"Pflege*"ÿp
vsumPP%ÿprovi%
 ÿ^ÿ¡remark$ÿ"Pauschal*"ÿp
vsumPausch%ÿprovi%
 ÿ^ÿ¡remark$ÿ"VD*"ÿp
vsumAP%ÿprovi%
 ÿ^
vertrprov%ÿprovi%
 ÿ’ÿ¡

 ÿ’ÿÿ
 
 
 ÿ½ **************************************************************************************
 ÿ½ *          Abgleich der Vertragsvorschlagsliste zur Provisionsabrechnung             *
 ÿ½ **************************************************************************************
 
ÿÿCheckAbgl()
 ÿ¡disabled%("EINGANG")ÿpÿ’ÿÿ
ÿ¡disabled%("BUCHUNG6")ÿpÿ’ÿÿ
 ÿƒDFile(3,"buchung"ÿ_fpw$)
 ÿƒDFile(3,"buchmon"ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"maadrgru"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(3,"vkond"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\"ÿGADRDat$ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\"ÿGTelDat$ÿ_fpw$)
 ÿßÿe
 ÿ™"buchmon"
 ÿ£codebu.buchmon
 ÿÉÿĞÿ™"buchmon"
 ÿÉÿ`
 _formend%ÿ0
 kumask$ÿ"BUCHMON"
 ÿØ_formend%ÿ0
ÿ³ÿ_ÿwErrorHandler
ÿ¡ÿ>(ÿœ)ÿkumASK$ÿp
ÿÊÿŸtitle$ÿ" - Vorschlagsliste"
ÿ´ÿœGPrjForm$ÿkumASK$
ÿÊf ÿSuperbase.Form
lGesellschaft$ÿ""
lAgentur$ÿ""
lSparte$ÿ""
lKunde$ÿ""
lAussenstand$ÿ""
ÿƒBUCHKIntro()
ÿƒMNBUCHK()
ÿ½ CALL KuKtoSuch()
ÿÊÿË"Vorschlagsliste"
ÿ’ÿ¡
ÿ¬ÿ³
ÿßÿ³
ZEINsub%ÿ0
ÿ¡ÿA("BUCHMON")ÿ0ÿpÿƒBUCHKUpdate()
ÿƒClearKBDBuffer()
ÿœ
f.suchen.visibleÿÿ1
f.suchen.enabledÿÿ1
f.uebersicht.enabledÿÿ1
f.abbruch.visibleÿ0
f.abbruch.enabledÿ0

ÿ¡ZEINsub%ÿ99ÿpÿÏÿ¥ÿÿ¬ÿÿß
ÿ½ ** Tastaturabfrage
ÿk$
ÿÉÿæÿ.(k$)
ÿæCrsLeft%,PgUp%
ÿƒPSelectPrev()
ÿæCrsRight%,PgDn%
ÿƒPSelectNext()
ÿ’ÿÉ
ÿ¡k$ÿÿ(27)ÿp_formend%ÿ1
ÿÉÿæZEINsub%
 
ÿæ5
codebu%ÿcodebu.buchmon
cuvt%ÿcodevt.buchmon
ÿœ2
ÿÉÿœÿ¥codebu%ÿ™"buchmon"ÿ£codebu.buchmon
ÿœ
ÿæ6
ÿœ1
ÿÉÿœÿ¥0ÿ™"buchmon"ÿ£zero.buchmon
ÿœ
ÿæ7
ÿÉÿĞÿ™"buchmon"
ÿÉÿœÿ¥0ÿ™"buchmon"ÿ£zero.buchmon
such$ÿ"kein Filter gesetzt"
ÿœ
ÿæ8
	codebu%ÿcodebu.buchmon
	su$ÿsuch$
	vt%ÿcodevt.buchmon
	cuvt%ÿcodevt.buchmon
	filt$ÿÿĞ
	ÿÉÿĞÿ™"buchmon"
	ÿÉÿ`ÿ™"kvertrag"ÿ£lfdnr.kvertrag
	ÿÉÿ¥vt%ÿ™"Kvertrag"ÿ£lfdnr.kvertrag
	
	
	knr%ÿCodeku.kvertrag
	ÿÉÿ¥knr%ÿ™GAdrDat$ÿ£codeku.GAdrDat$
	ÿ™"kvertrag"
	ÿƒKVERTRAG()
	_formend%ÿ0
	ÿ™"buchmon"
	ÿ´ÿœGPrjForm$ÿkumask$
	ÿÊf ÿSuperbase.Form
	
	ÿ™"buchmon"
	bef$ÿ"select where "ÿfilt$
	ÿ–bef$
	such$ÿsu$
	
	ÿÊÿË"Vorschlagsliste"
	ÿœ1
	ÿÉÿœÿ¥codebu%ÿ™"buchmon"ÿ£codebu.buchmon
	ÿœ
	ÿƒBUCHKIntro()
	ÿƒMNBUCHK()
ÿæ9
	su$ÿsuch$
	kumask$ÿ"BUCHMON"
	ÿ´ÿœGPrjForm$ÿkumASK$
	such$ÿsu$
	ÿÊf ÿSuperbase.Form
	ÿƒBUCHKIntro()
	ÿƒMNBUCHK()
ÿæ10
	kumask$ÿ"BUCHMON1"
	su$ÿsuch$
	ÿ´ÿœGPrjForm$ÿkumASK$
	ÿÊf ÿSuperbase.Form
	such$ÿsu$
	ÿƒBUCHKIntro()
	ÿƒMNBUCHK()
ÿæ11
	su$ÿsuch$
	kumask$ÿ"BUCHMON2"
	ÿ´ÿœGPrjForm$ÿkumASK$
	ÿÊf ÿSuperbase.Form
	such$ÿsu$
	ÿƒBUCHKIntro()
	ÿƒMNBUCHK()
ÿæ13
ÿ½ Provisionsabrechnung
ÿ™"buchmon"
ÿ£ausgew„hlt.buchmon
ÿÉÿĞÿ™"buchmon"
ÿÉÿ`
ÿÉÿĞausgew„hlt.buchmonÿ"j"
ÿÉÿ`
ÿØÿOÿB("buchmon")
	CalcDate$ÿÿ(Datum.buchmon,"0d.mm.yyyy")
	anschluss%ÿ0
	codevt%ÿcodevt.buchmon
	ÿƒPROVBUCHUNG(codevt%)
	ÿÉÿ±ÿ™"buchmon"
ÿÙ
ÿÉÿĞÿ™"buchmon"
ÿÉÿ`
ÿÂ"Provisionsberechnung ist abgeschlossen!"
ÿ½ CALL CloseLog()
 ÿ’ÿÉ
ÿ¬ÿ³
 ÿÙ
 ÿÉÿĞÿ™"BUCHMON"
 _formend%ÿ0
 
 ÿ’ÿÿ
 


 ' ***********************************************************************
 ' Vorausberechnung alle Vertr„ge
 ' =======================================================================
 ' 06.12.2000 
 ' vorart%=0 Berechnung fr alle,=1 nur fr Firma
 
ÿÿVorausber(vorart%)
 ÿ¡disabled%("BUCHUNG6")ÿpÿ’ÿÿ
 Anschluss%ÿ1
 ÿ½ REQUEST "Die Korrekturbuchung l”scht alle Buchungen des Vertrages und setzt","den Vertrag zurck! Fortfahren?",135,req%
 req%ÿ1
 ÿ¡req%ÿ1ÿp
opt%ÿ1
twer%ÿÿ0(ÿ+(ÿ(ÿQ,"0d.mm.yyyy"),2))
ÿ¡twer%ÿ27ÿptwer%ÿ27
tmon$ÿÿ+(ÿ(ÿQ,"mmyyyy0d"),2)
tjah$ÿÿ+(ÿ(ÿQ,"yyyymm0d"),4)
CalcDate$ÿÿ(twer%,"00")ÿ"."ÿtmon$ÿ"."ÿtjah$
ÿ¡CalcDateTo$ÿ""ÿpCalcDateTo$ÿCalcDate$
CalcDateOld$ÿ""
vor3001200101: 
ÿ¡CalcDateOld$ÿ""ÿp
CalcDate$ÿCalcDateOld$
ÿ’ÿ¡
opt%ÿ1
ÿ‰ÿñ"ANSCHLUSS",0,0,291,132,"Vorausberechnung","MS Sans Serif",8
ÿ|ÿñ"ANSCHLUSS",4,0,32,291,68,0,""
ÿ|ÿñ"ANSCHLUSS",9,9,12,21,23,2

ÿ|ÿñ"ANSCHLUSS",3,38,9,153,10,0,"Listen drucken",1,opt%
ÿ|ÿñ"ANSCHLUSS",3,38,19,155,10,0,"Berechnung durchfhren",2,opt%

ÿ|ÿñ"ANSCHLUSS",5,38,42,244,25,0,"Bitte geben Sie Ihren Provisionsberechnungs/Druck-Stichtag ein und bis wann sie vorausberechnet/gedruckt werden soll:"
ÿ|ÿñ"ANSCHLUSS",5,130,75,65,10,0,"Berechnung bis:"
ÿ|ÿñ"ANSCHLUSS",6,190,74,51,11,0,0,CalcDateTO$,20
ÿ|ÿñ"ANSCHLUSS",5,38,75,33,10,0,"Stich&tag:"
ÿ|ÿñ"ANSCHLUSS",6,73,74,51,11,0,0,CalcDate$,20
ÿ|ÿñ"ANSCHLUSS",1,74,110,55,14,1,"&OK",1,1
ÿ|ÿñ"ANSCHLUSS",1,132,110,55,14,0,"&Abbrechen",0,0
ÿñ"ANSCHLUSS",req%
ÿ¾ÿñ"ANSCHLUSS"
ÿ¡req%ÿ
1ÿpÿ’ÿÿ
CalcDateOld$ÿCalcDate$
ÿ¡opt%ÿ1ÿp
ÿÂ"Haben alle anderen User das Programm beendet?","",135,req%
ÿ^
req%ÿ1
ÿ’ÿ¡
ÿ¡req%ÿ1ÿp
ÿƒFehler("Es mssen alle User das Programm verlassen haben, um die Vorausberechnung durchfhren zu k”nnen!","")
ÿ’ÿÿ
ÿ’ÿ¡
ÿ¡opt%ÿ1ÿp
ÿÂ"M”chten Sie wirklich die Vorausberechnung durchfhren lassen?","",135,req%
ÿ^
req%ÿ1
ÿ’ÿ¡
ÿ¡req%ÿ1ÿp
ÿ¡DateOK%(CalcDate$)ÿDateOK%(CalcDateTo$)ÿp
TestDate%ÿÿ1(CalcDate$)
twer%ÿÿ0(ÿ+(ÿ(TestDate%,"0d.mm.yyyy"),2))
ÿ¡twer%ÿ27ÿptwer%ÿ27
tmon$ÿÿ+(ÿ(TestDate%,"mmyyyy0d"),2)
tjah$ÿÿ+(ÿ(TestDate%,"yyyymm0d"),4)
CalcDate$ÿÿ(twer%,"00")ÿ"."ÿtmon$ÿ"."ÿtjah$
TestDate%ÿÿ1(CalcDateTo$)
twer%ÿÿ0(ÿ+(ÿ(TestDate%,"0d.mm.yyyy"),2))
ÿ¡twer%ÿ27ÿptwer%ÿ27
tmon$ÿÿ+(ÿ(TestDate%,"mmyyyy0d"),2)
tjah$ÿÿ+(ÿ(TestDate%,"yyyymm0d"),4)
CalcDateTo$ÿÿ(twer%,"00")ÿ"."ÿtmon$ÿ"."ÿtjah$
ÿ¡CalcDateTo$ÿCalcDate$ÿp
ÿƒFehler("Datum fr Berechnung von und fr Berechnung bis sind gleich!","Bitte korrigieren!")
ÿwvor3001200101
ÿ’ÿ¡
ÿ¡opt%ÿ1ÿpÿwvorendber16010101
ÿƒCreateLog()
ÿßÿe
ÿƒServer("LOADMESSAGE","")
ÿƒServer("MESSAGE","Bitte warten... ")
ÿƒDFile(3,"buchung"ÿ_fpw$)
ÿƒDFile(3,"kvertrag"ÿ_fpw$)
ÿƒDFile(3,"ZEINGANG"ÿ_fpw$)
ÿƒDFile(3,"gekond"ÿ_fpw$)
ÿƒDFile(3,"maadr"ÿ_fpw$)
ÿƒDFile(3,"maadrgru"ÿ_fpw$)
ÿƒDFile(3,"kvertrag"ÿ_fpw$)
ÿƒDFile(3,"vkond"ÿ_fpw$)
ÿƒDFile(3,"statist3"ÿ_fpw$)
ÿƒDFile(3,"statist4"ÿ_fpw$)
ÿ™"KVERTRAG"
ÿ¡ÿ´("KVTMP")ÿpÿ†ÿ™"KVTMP"
ÿ¡ÿJ(_ppath$ÿ"KVTMP.sbf")ÿp
	ÿ_ppath$ÿ"KVTMP.*"
ÿ’ÿ¡
ÿßÿe
ÿƒServer("MESSAGE","Bitte warten..."ÿÿ(13)ÿÿ(10)ÿ"Die Vertragsdatei fr Vorausberechnungen wird erzeugt.")
ÿÊÿË"Kopiere Datei KVERTRAG zu KVTMP"
ÿ‰ÿ™"KVTMP"ÿaÿ™"KVERTRAG"
ÿ™"KVTMP"
ÿƒServer("MESSAGE","Bitte warten..."ÿÿ(13)ÿÿ(10)ÿ"Die Vertragsdatei wird zurckgesetzt.")
ÿÊÿË"Vertragsdatei wird zurckgesetzt..."
ÿ™"KVTMP"
ÿÍBewertcalcDaV ÿ0:letzteProviV ÿletzteProvi:gez_AbschluV.KVTMPÿgez_Abschluá:gez_PauschalV.KVTMPÿgez_Pauschale
TZRateV.KVTMPÿTZRate:letztePflegV.KVTMPÿletztePflege:PoolV.KVTMPÿPool.KVTMP:MahnungV.KVTMPÿMahnung
ÿ’ÿÍ
ÿ†ÿ™"kvtmp"
ÿƒDFile(3,"kvtmp"ÿ_fpw$)
ÿ¡ÿ´("VKOTMP")ÿpÿ†ÿ™"VKOTMP"
ÿ¡ÿJ(_ppath$ÿ"VKOTMP.sbf")ÿp
	ÿ_ppath$ÿ"VKOTMP.*"
ÿ’ÿ¡
ÿƒServer("MESSAGE","Bitte warten..."ÿÿ(13)ÿÿ(10)ÿ"Die Konditionsdatei fr Vorausberechnungen wird erzeugt.")
ÿÊÿË"Kopiere Datei VKOND zu VKOTMP"
ÿ‰ÿ™"VKOTMP"ÿaÿ™"VKOND"
ÿƒServer("MESSAGE","Bitte warten..."ÿÿ(13)ÿÿ(10)ÿ"Die Konditionsdatei wird zurckgesetzt.")
ÿ™"VKOTMP"
ÿÊÿË"VKOTMP wird zurckgesetzt..."
ÿÍSTORNOResGezJV.VKOTMPÿ""
ÿ’ÿÍ
ÿ½ 060497
ÿƒServer("MESSAGE","Bitte warten..."ÿÿ(13)ÿÿ(10)ÿ"Die Mitarbeiterdatei wird zurckgesetzt.")
ÿ™"MAADR"
ÿÊÿË"Mitarbeiterdatei wird zurckgesetzt..."
ÿ£codema.maadr
ÿÍStornoreservV.maadrÿ0:EinheitenV.maadrÿ0:EigEinheitenV.maadrÿ0:GesVolumenV.maadrÿ0:EigVolumenV.maadrÿ0
ÿ’ÿÍ
ÿ†ÿ™"maadr"
ÿƒDFile(3,"maadr"ÿ_fpw$)
ÿ½ CALL BUKOPrepEinz(codevt%)
ÿ½ SET TODAY StartDatum$
cmonat%ÿÿ5(CalcDate$)
cjahr%ÿÿ6(CalcDate$)
ctag%ÿÿ3(CalcDate$)
ÿ½ Vertr„ge bis zum heutigen Tag hochrechnen
ÿ½ 150697 ctag% = DAY ( TODAY )
ÿ¡ÿ´("BUCHVOR")ÿpÿ†ÿ™"BUCHVOR"
ÿ¡ÿJ(_ppath$ÿ"Buchvor.sbf")ÿp
	ÿ_ppath$ÿ"Buchvor.*"
ÿ’ÿ¡
ÿƒServer("MESSAGE","Bitte warten..."ÿÿ(13)ÿÿ(10)ÿ"Die Buchungsdatei fr Vorausberechnungen wird erzeugt.")
ÿÊÿË"Kopiere Datei BUCHUNG zu BUCHVOR"
ÿ‰ÿ™"BUCHVOR"ÿaÿ™"BUCHUNG"
ÿ™"BUCHVOR"
ÿ·"BUCHVOR;paris;paris;paris"
ÿ£Codebu.buchvor
ÿÉÿb
ÿØCodeBU.BuchvorÿÿI("BUCHvor",1)
ÿÙ
ÿÊÿË"L”schen der Inhalte von STATIST3 und STATIST4"
ÿ¾ÿaÿ™"statist3"
ÿÀÿ™"statist3"ÿq"statist3"
ÿ¾ÿaÿ™"statist4"
ÿÀÿ™"statist4"ÿq"statist4"
ÿƒServer("UNLOADMESSAGE","")
ÿƒWriteLog(">>Vorausberechnung ab Stichtag "ÿCalcDate$)
CalcDateOrig$ÿCalcDate$
ÿØÿ1(CalcDate$)ÿ
ÿ1(CalcDateTo$)ÿ1
	ÿ½ CALL Fehler(CalcDate$,CalcDateTo$)
	ÿƒPROVVoraus(vorart%)
	cmonat%ÿcmonat%ÿ1
	ÿ¡cmonat%ÿ13ÿp
cmonat%ÿ1
cjahr%ÿcjahr%ÿ1
	ÿ’ÿ¡
	CalcDate$ÿÿ(ctag%,"00")ÿ"."ÿÿ(cmonat%,"00")ÿ"."ÿÿ(cjahr%,"0000")
ÿÙ
ÿßÿ³
ÿÊÿÿx
ÿÊÿË"Bereit"
ÿƒCloseLog()
ÿßÿe
ÿ¡vorart%ÿ0ÿpÿwvor3001200101
'*******************************************************************************************************
ÿ½    Fllen der Statistikdatei "statist3" unter zu Hilfenahme der "statist4"
'*******************************************************************************************************
ÿÊÿË"Rcksetzen des VAnzahlVor-Feldes in der Gesellschaftsdatei"
ÿ™"geadr"
ÿÍVAnzahlVor.geadrÿ0
ÿ’ÿÍ

ÿÊÿË"Rcksetzen des VAnzahlVor-Feldes in der Spartendatei"
ÿ™"sparten"
ÿÍVAnzahlVor.spartenÿ0
ÿ’ÿÍ
ÿÊÿË"Rcksetzen des VAnzahlVor-Feldes in der Produktdatei"
ÿ™"vprodukt"
ÿÍVAnzahlVor.vproduktÿ0
ÿ’ÿÍ
ÿ™"kvtmp"
ÿ£lfdnr.kvtmp
ÿ™"Buchvor"
ÿ£datum.buchvor
ÿÉÿ`
ÿÉÿ¥CalcDateOrig$ÿ™"buchvor"ÿ£datum.buchvor
aa%ÿÿA("buchvor")
i%ÿ0
ÿØÿOÿB("buchvor")
	i%ÿi%ÿ1
	ÿÊÿËÿ(i%,"999999")ÿ" Datens„tze von "ÿÿ(aa%,"999999")ÿ" verarbeitet
	ÿÉÿ`ÿ™"kvtmp"ÿ£lfdnr.kvtmp
	ÿÉÿ¥codevt.buchvorÿ™"kvtmp"ÿ£lfdnr.kvtmp
	gesp$ÿÿ(codege.kvtmp,"000000")ÿÿ(codeva.kvtmp,"000000")
	' Vertrag bei der Gesellschaft hochz„hlen
	ÿ¡ÿOÿJ(codevt.buchvor,codevt.statist4)ÿcodevt.buchvorÿ0ÿp
ÿ½ wenn noch nicht existiert, dan wurde der Vertrag noch nicht hochgez„hlt
ÿÿ™"statist4"
codevt.statist4ÿcodevt.buchvor
ÿÌÿ™"statist4"
ÿïÿYÿ™"statist4"
ÿ™"GEADR"
ÿ£codege.geadr
ÿÉÿ`
ÿÉÿ¥codege.kvtmpÿáÿ™"geadr"ÿ£codege.geadr
VAnzahlVor.geadrÿVAnzahlVor.geadrÿ1
sbewertung.geadrÿsbewertung.geadrÿbewertungssumme.kvtmp
sbewertungEU.geadrÿÿ0(ÿ(sbewertung.geadrÿumrechnung.kvtmp,"999999999.00"))
SVSumme.geadrÿSVSumme.geadrÿVSumme.kvtmp
SVSummeEU.geadrÿÿ0(ÿ(SVSumme.geadrÿumrechnung.kvtmp,"999999999.00"))
SBeitragBRU.geadrÿSBeitragBRU.geadrÿJahresBBrut.buchvor
SBeitragBRUEU.geadrÿÿ0(ÿ(SBeitragBRU.geadrÿumrechnung.kvtmp,"999999999.00"))
SBeitragNET.geadrÿSBeitragNET.geadrÿJahresBNet.buchvor
SBeitragNETEU.geadrÿÿ0(ÿ(SBeitragNET.geadrÿumrechnung.kvtmp,"999999999.00"))
ÿÌÿ™"geadr"
ÿïÿYÿ™"geadr"

ÿ™"sparten"
ÿ£codeva.sparten
ÿÉÿ`
ÿÉÿ¥codeva.kvtmpÿáÿ™"sparten"ÿ£codeva.sparten
VAnzahlVor.spartenÿVAnzahlVor.spartenÿ1
sbewertung.spartenÿsbewertung.spartenÿbewertungssumme.kvtmp
sbewertungEU.spartenÿÿ0(ÿ(sbewertung.spartenÿumrechnung.kvtmp,"999999999.00"))
SVSumme.spartenÿSVSumme.spartenÿVSumme.kvtmp
SVSummeEU.spartenÿÿ0(ÿ(SVSumme.spartenÿumrechnung.kvtmp,"999999999.00"))
SBeitragBRU.spartenÿSBeitragBRU.spartenÿJahresBBrut.buchvor
SBeitragBRUEU.spartenÿÿ0(ÿ(SBeitragBRU.spartenÿumrechnung.kvtmp,"999999999.00"))
SBeitragNET.spartenÿSBeitragNET.spartenÿJahresBNet.buchvor
SBeitragNETEU.spartenÿÿ0(ÿ(SBeitragNET.spartenÿumrechnung.kvtmp,"999999999.00"))
ÿÌÿ™"sparten"
ÿïÿYÿ™"sparten"

ÿ™"vprodukt"
ÿ£codeva.vprodukt
ÿÉÿ`
ÿÉÿ¥gesp$ÿáÿ™"vprodukt"ÿ£QcodeGEVA.vprodukt
VAnzahlVor.vproduktÿVAnzahlVor.vproduktÿ1
sbewertung.vproduktÿsbewertung.vproduktÿbewertungssumme.kvtmp
sbewertungEU.vproduktÿÿ0(ÿ(sbewertung.vproduktÿumrechnung.kvtmp,"999999999.00"))
SVSumme.vproduktÿSVSumme.vproduktÿVSumme.kvtmp
SVSummeEU.vproduktÿÿ0(ÿ(SVSumme.vproduktÿumrechnung.kvtmp,"999999999.00"))
SBeitragBRU.vproduktÿSBeitragBRU.vproduktÿJahresBBrut.buchvor
SBeitragBRUEU.vproduktÿÿ0(ÿ(SBeitragBRU.vproduktÿumrechnung.kvtmp,"999999999.00"))
SBeitragNET.vproduktÿSBeitragNET.vproduktÿJahresBNet.buchvor
SBeitragNETEU.vproduktÿÿ0(ÿ(SBeitragNET.vproduktÿumrechnung.kvtmp,"999999999.00"))
ÿÌÿ™"vprodukt"
ÿïÿYÿ™"vprodukt"
	ÿ’ÿ¡
	ÿ™"buchvor"
	'jetzt Fllen der Datei statist3
	dtest$ÿÿ+(ÿ(datum.buchvor,"yyyymm0d"),6)
	dsuch$ÿgesp$ÿdtest$
	ÿÉÿ`ÿ™"geadr"ÿ£codege.geadr
	ÿÉÿ¥codege.kvtmpÿáÿ™"geadr"ÿ£codege.geadr
	svolumen.geadrÿsvolumen.geadrÿVolumen.kvtmp
	svolumenEU.geadrÿÿ0(ÿ(svolumen.geadrÿumrechnung.kvtmp,"999999999.00"))
	sprovision.geadrÿsprovision.geadrÿbetrag.buchvor
	sprovisionEU.geadrÿÿ0(ÿ(sprovision.geadrÿumrechnung.kvtmp,"999999999.00"))
	ÿÌÿ™"geadr"
	ÿïÿYÿ™"geadr"
	ÿÉÿ`ÿ™"Sparten"ÿ£codeva.sparten
	ÿÉÿ¥codeva.kvtmpÿáÿ™"Sparten"ÿ£codeva.sparten
	svolumen.Spartenÿsvolumen.SpartenÿVolumen.kvtmp
	svolumenEU.Spartenÿÿ0(ÿ(svolumen.Spartenÿumrechnung.kvtmp,"999999999.00"))
	sprovision.Spartenÿsprovision.Spartenÿbetrag.buchvor
	sprovisionEU.Spartenÿÿ0(ÿ(sprovision.Spartenÿumrechnung.kvtmp,"999999999.00"))
	ÿÌÿ™"Sparten"
	ÿïÿYÿ™"Sparten"
	ÿÉÿ`ÿ™"vprodukt"ÿ£QcodeGEVA.vprodukt
	ÿÉÿ¥gesp$ÿáÿ™"vprodukt"ÿ£QcodeGEVA.vprodukt
	svolumen.vproduktÿsvolumen.vproduktÿVolumen.kvtmp
	svolumenEU.vproduktÿÿ0(ÿ(svolumen.vproduktÿumrechnung.kvtmp,"999999999.00"))
	sprovision.vproduktÿsprovision.vproduktÿbetrag.buchvor
	sprovisionEU.vproduktÿÿ0(ÿ(sprovision.vproduktÿumrechnung.kvtmp,"999999999.00"))
	ÿÌÿ™"vprodukt"
	ÿïÿYÿ™"vprodukt"
	ÿ¡ÿOÿJ(dsuch$,QCodeGEVAJM.statist3)ÿp
ÿÿ™"statist3"
codege.statist3ÿcodege.kvtmp
codeva.statist3ÿcodeva.kvtmp
JahrMonat.statist3ÿÿ0(dtest$)
Gesellschaft.statist3ÿgesellschaft.geadr
Sparte.statist3ÿSparte.sparten
QCodeGes.statist3ÿgesellschaft.geadrÿSparte.sparten
QCodeGEVA.statist3ÿÿ(codege.kvtmp,"000000")ÿÿ(codeva.kvtmp,"000000")
QCodeGEVAJM.statist3ÿÿ(codege.kvtmp,"000000")ÿÿ(codeva.kvtmp,"000000")ÿdtest$
sbewertung.statist3ÿbewertungssumme.kvtmp
sbewertungEU.statist3ÿÿ0(ÿ(bewertungssumme.kvtmpÿumrechnung.kvtmp,"999999999.00"))
SVSumme.statist3ÿVSumme.kvtmp
SVSummeEU.statist3ÿÿ0(ÿ(VSumme.kvtmpÿumrechnung.kvtmp,"999999999.00"))
SBeitragBRU.statist3ÿJahresBBrut.buchvor
SBeitragBRUEU.statist3ÿÿ0(ÿ(JahresBBrut.buchvorÿumrechnung.kvtmp,"999999999.00"))
SBeitragNET.statist3ÿJahresBNet.buchvor
SBeitragNETEU.statist3ÿÿ0(ÿ(JahresBNet.buchvorÿumrechnung.kvtmp,"999999999.00"))
ÿÌÿ™"statist3"
ÿïÿYÿ™"statist3"
	ÿ’ÿ¡
	ÿ™"statist3"
	ÿ£QCodeGEVAJM.statist3
	ÿÉÿ`
	ÿÉÿ¥dsuch$ÿáÿ™"statist3"ÿ£QCodeGEVAJM.statist3
	svolumen.statist3ÿsvolumen.statist3ÿVolumen.kvtmp
	svolumenEU.statist3ÿÿ0(ÿ(svolumen.statist3ÿumrechnung.kvtmp,"999999999.00"))
	sprovision.statist3ÿsprovision.statist3ÿbetrag.buchvor
	sprovisionEU.statist3ÿÿ0(ÿ(sprovision.statist3ÿumrechnung.kvtmp,"999999999.00"))
	ÿÌÿ™"statist3"
	ÿïÿYÿ™"statist3"
	ÿ™"buchvor"
	ÿÉÿ±ÿ™"buchvor"ÿ£datum.buchvor
ÿÙ
ÿßÿ³
ÿwvor3001200101
vorendber16010101: 

	ÿƒDFile(3,"statist3"ÿ_fpw$)
	ÿƒDFile(3,"statist4"ÿ_fpw$)
	ÿ¡ÿJ(_netpath$ÿ"\PROVIS\buchvor.sbf")ÿp
ÿƒDFile(3,"buchvor"ÿ_fpw$)
	ÿ^
ÿƒFehler("ACHTUNG Sie haben noch keine Vorausberecnung durchgefhrt!","Bitte fhren Sie erst eine Vorausberechnung durch!")
ÿwvor3001200101
	ÿ’ÿ¡
	ÿƒDFile(3,"geadr"ÿ_fpw$)
	ÿƒDFile(3,"sparten"ÿ_fpw$)
	ÿƒDFile(3,"vprodukt"ÿ_fpw$)
ÿ¡vorart%ÿ0ÿp
	ÿƒVorausList()
ÿ^
	ÿÂ"M”chten Sie die Vorausberechnung fr einen bestimmten ","Mitarbeiters angezeigt bekommen ?",130,req31%
	ÿ¡req31%ÿ1ÿp
'ein bestimmter Mitarbeiter
ma%ÿGetCodeMA%(cuma%,Workstation%)
ÿ¡ma%ÿ0ÿp
ÿÉÿ¥ma%ÿ™"maadr"ÿ£codema.maadr
ÿƒVORPROV(ma%,CalcDate$,CalcDateTo$)
ÿ^
ÿÂ"kein Mitarbeiter ausgew„hlt!"
ÿwvorend3001200102
ÿ’ÿ¡
	ÿ^
'alle Mitarbeiter
ÿƒVORPROV(0,CalcDate$,CalcDateTo$)
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿƒFehler("Falsches Datumsformat!","Das Datum muá in der Form 'tt.mm.jjjj' eingegeben werden.")
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
vorend3001200102: 
 Anschluss%ÿ0
 ÿ’ÿÿ
 
ÿÿVORPROV(ma%,von$,bis$)
 ÿÉÿĞÿ™"MAADR"
 ÿÉÿĞÿ™"BUCHVOR"

 ÿƒPRep("VORPROV")
 ÿÁÿ³Betrag.BUCHVORÿU"SSumAgentur%",SR.BUCHVORÿU"SSumStorno%",BetnGezahlt%ÿU"SSumNBez%",BetnDiff%ÿU"SGesSum%"
 ÿ}ÿÁ
ÿÊÿÁÿí"F_REPORT"
ÿ¶ÿÁÿí
 ÿ’ÿÁ
 ÿ¡ma%ÿ0ÿp
Header$ÿ"Vorausberechnung Vermittler "ÿnachname.maadrÿ" Agnr.: "ÿAgenturnr.maadrÿ" in "ÿWaehrung.stamm
 ÿ^
Header$ÿ"Vorausberechnung alle Vermittler"ÿ" in "ÿWaehrung.stamm
 ÿ’ÿ¡
 ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (bis "ÿÿ(ÿQ,"0d.mm.yyyy")ÿ")"
 ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (ab "ÿvon$ÿ")"
 ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (vom "ÿvon$ÿ" bis "ÿbis$ÿ")"
 ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (Gesamtbersicht)"
 ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
 ÿ’ÿŸ
 
 ÿCodeMA.MAADR,Betrag.BUCHVORÿU"SumAgentur%",SR.BUCHVORÿU"SumStorno%",BetnGezahlt%ÿU"SumNBez%",BetnDiff%ÿU"GesSum%",Einheiten.BUCHVORÿU"SumEinh%"
 ÿ€ÿCodeMA.MAADR
ÿÊÿÁÿí"H_CodeMA.MAA002"
ÿ¶ÿÁÿí
 ÿ’ÿ
 
 ÿ}ÿCodeMA.MAADR
ÿÊÿÁÿí"F_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ‘ÿÁ
 ÿ’ÿ
 
 ÿDatum.BUCHVOR
 ÿ€ÿDatum.BUCHVOR
ÿÊÿÁÿí"H_Datum.BUCH003"
ÿ¶ÿÁÿí
 ÿ’ÿ
 
 ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
 ÿ’ÿÉ
 
 ÿÊÿiÿe
 ÿÊÿiÿáÿe
 vondat%ÿÿ1(von$)
 bisdat%ÿÿ1(bis$)
 ÿßÿe
 ÿ³ÿ_ÿwendrepvor30012001
 ÿ¡ma%ÿ0ÿp
ÿÉ;
ÿĞCodeMA.MAADRÿCodeMA.BUCHVORÿCodeMA.MAADRÿma%ÿDatum.BUCHVORÿvondat%)ÿDatum.BUCHVORÿ	bisdat%
ÿµÿÁnachname.maadr,Datum.BUCHVOR,kunde$
ÿqÿ~
ÿ’ÿÉ
 ÿ^
ÿÉ;
ÿĞCodeMA.MAADRÿCodeMA.BUCHVORÿDatum.BUCHVORÿvondat%ÿDatum.BUCHVORÿ	bisdat%
ÿµÿÁnachname.maadr,Datum.BUCHVOR,kunde$
ÿqÿ~
ÿ’ÿÉ
 ÿ’ÿ¡
endrepvor30012001: 
 ÿ³ÿ_ÿwErrorHandler
 ÿ’ÿÿ

 
ÿÿPROVVoraus(vorart%)
 ÿ¡disabled%("BUCHUNG6")ÿpÿ’ÿÿ
 ÿƒDFile(3,"buchung"ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"maadrgru"ÿ_fpw$)
 ÿƒDFile(3,"KVTMP"ÿ_fpw$)
 ÿƒDFile(3,"VKOTMP"ÿ_fpw$)
 ÿƒDFile(3,"vprodukt"ÿ_fpw$)
 ÿƒDFile(3,"spezkond"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\"ÿGADRDat$ÿ_fpw$)
 ÿ¡anschluss%ÿ0ÿPRVCHECKLISTE$ÿ"TRUE"ÿp
CalcDate$ÿÿ(ÿQ,"0d.mm.yyyy")
ÿ‰ÿñ"STICHTAG",0,0,222,114,"Buchungsdatum","MS Sans Serif",8
ÿ|ÿñ"STICHTAG",4,0,0,222,91,0,""
ÿ|ÿñ"STICHTAG",9,6,9,23,24,2
ÿ|ÿñ"STICHTAG",5,31,15,183,10,0,"Bitte geben Sie an, zu welchem Buchungsdatum"
ÿ|ÿñ"STICHTAG",5,31,25,183,10,0,"die Provisionsberechnung durchgefhrt werden soll:"
ÿ|ÿñ"STICHTAG",5,32,40,182,10,0,"(ohne nderung des Datums oder Weglassen"
ÿ|ÿñ"STICHTAG",5,31,50,182,10,0,"der Datumsangabe, wird das angezeigte Datum verwendet)"
ÿ|ÿñ"STICHTAG",6,94,72,42,12,0,0,CalcDate$,10
ÿ|ÿñ"STICHTAG",5,30,74,58,10,0,"Buchungsdatum:"
ÿ|ÿñ"STICHTAG",1,52,94,54,14,1,"&OK",1,1
ÿ|ÿñ"STICHTAG",1,109,94,54,14,0,"&Abbrechen",0,0
ÿñ"STICHTAG",req%
ÿ¾ÿñ"STICHTAG"
ÿ¡req%ÿ1ÿp
ÿ¡DateOK%(CalcDate$)ÿp
ok%ÿ1
ÿ¡codevtab%ÿ0ÿpÿƒWriteConfig("PROVIS","letzteProvisionsrechnung",CalcDate$)
ÿ^
ok%ÿ0
ÿƒFehler("Falsche Datumsangabe!","Bitte geben Sie das Datum in der Form 'tt.mm.jjjj' ein.")
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ^
ok%ÿ1
 ÿ’ÿ¡
 ÿ¡ok%ÿ1ÿp
cdate%ÿÿ1(CalcDate$)
minimize$ÿReadINI$("PROVIS","minimize")
ÿ¡anschluss%ÿ0ÿp
ÿ¡minimize$ÿ"TRUE"ÿp
ÿÂ"PROVIS wird in den Hintergrund geschaltet!","Sie k”nnen w„hrend der Berechung andere Programme starten.",0
ÿÊÿÿÚ
ÿ’ÿ¡
ÿƒCreateLog()
ÿ’ÿ¡
 
ÿƒWriteLog("")
ÿƒWriteLog("=================================")
ÿƒWriteLog("Provisionsabrechnung vom "ÿÿ(cdate%,"0d.mm.yyyy"))
ÿƒWriteLog("=================================")
ÿƒWriteLog("")
ÿßÿe
ÿ™"KVTMP"
ÿ£ProviAb.KVTMP
ÿÉÿ`
ÿ¡codevtab%ÿ0ÿp
ÿ£lfdnr.KVTMP
ÿÉÿ¥codevtab%ÿáÿ™"KVTMP"ÿ£lfdnr.KVTMP
ÿ^
ÿÉÿ¥"01.01.1800"ÿ™"KVTMP"ÿ£ProviAb.KVTMP
ÿ’ÿ¡
_p1%ÿÿA("KVTMP")
_pd$ÿ"0"
_pd%ÿÿ1
_p2%ÿ0
ÿ½ CALL Fehler("Vorausberechnung","")
ÿØÿOÿB("KVTMP")ÿ(ProviAb.KVTMPÿ	cdate%ÿBewertEinmDat.KVTMPÿ	cdate%)

 
ÿ½ -----------------------------------------
ÿ½ -- Prozentbalken und Header aktualisieren
ÿ½ -----------------------------------------
 
ÿÊÿË"Bearbeite Vertrag "ÿÿH(ÿ(_p2%,"999999"))ÿ" von "ÿÿH(ÿ(_p1%,"999999"))ÿ"  "ÿvs_NR.kvtmp
_pc%ÿÿ (100ÿ_p1%ÿ_p2%,0)
ÿ¡_pd%ÿ_pc%ÿp
_pd%ÿ_pc%
ÿ¡ÿåsys(11)ÿ36ÿÿåsys(12)ÿ36ÿp
	ÿ¡anschluss%ÿ0ÿp
ÿÊÿŸÿ(_pd%,"999")ÿ"%"
	ÿ^
ÿÊÿŸÿ(_pd%,"999")ÿ"% "ÿÿH(ÿ(ÿ5(cdate%),"00"))ÿ"/"ÿÿ-(ÿ(ÿ6(cdate%),"9999"),4)
	ÿ’ÿ¡
ÿ^
	ÿ¡anschluss%ÿ0ÿp
ÿÊÿŸtitle$ÿ" - Provisionsberechung: "ÿÿ(_pd%,"999")ÿ"% erledigt"
	ÿ^
ÿÊÿŸtitle$ÿ" - Provisionsberechung: "ÿÿ(_pd%,"999")ÿ"% "ÿÿH(ÿ(ÿ5(cdate%),"00"))ÿ"/"ÿÿ-(ÿ(ÿ6(cdate%),"9999"),4)
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ½ --------------------------------------
ÿ½ -- CheckUp fr Vertragsprovisionierung
ÿ½ --------------------------------------
ÿ¡vs_nr.KVTMPÿ"705-1821826-01"ÿp
ÿ½ CALL Fehler(vs_nr.KVTMP,"")
ÿ’ÿ¡
ok%ÿ1
ÿ½ 030697
ÿ¡codeko.KVTMPÿ
1ÿp
ok%ÿ0
ÿ^
ÿ½ CALL Fehler(Test",date$(cdate%,"0d.mm.yyyy")
ÿ½ 190298
ÿ¡ÿ1(Kndigung.KVTMP)ÿ1ÿÿ1(Kndigung.KVTMP)ÿ
cdate%ÿp
	ok%ÿ0
	ÿ½ 210597
	ÿ¡TatsKuenDat.KVTMPÿKndigung.KVTMPÿpok%ÿ1
	ÿ¡TatsKuenDat.KVTMPÿ
cdate%ÿpok%ÿ0
	ÿ¡_debug%ÿ1ÿpÿƒWriteLog("## Kndigung: "ÿÿ(lfdnr.KVTMP,"000000")ÿ", "ÿÿ(Kndigung.KVTMP,"0d.mm.yyyy"))
ÿ’ÿ¡
ÿ¡Storno.KVTMPÿ0ÿÿ1(Kndigung.KVTMP)ÿ
cdate%ÿp
	ok%ÿ0
	ÿ½ 190398
	ÿ¡TatsKuenDat.KVTMPÿKndigung.KVTMPÿpok%ÿ1
	ÿ¡TatsKuenDat.KVTMPÿ
cdate%ÿpok%ÿ0
ÿ’ÿ¡

ÿ¡ÿ1(ProviAb.KVTMP)ÿ
1ÿp
	ok%ÿ0
ÿ’ÿ¡
ÿ¡ÿ1(VS_Beginn.KVTMP)ÿ
1ÿp
	ok%ÿ0
ÿ’ÿ¡
ÿ¡ÿ1(ProviAb.KVTMP)ÿcdate%ÿp
	ÿ¡BewertEinmDat.KVTMPÿ
1ÿp
ok%ÿ0
	ÿ^
ÿ¡BewertEinmDat.KVTMPÿcdate%ÿp
ok%ÿ0
ÿ^
ÿ¡BewertCalcDat.KVTMPÿ0ÿp
ok%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡cdate%ÿÿ1(letzteProviV.KVTMP)ÿ
27ÿp
	ok%ÿ0
	ÿƒWriteLog("## Zeitsperre: "ÿÿ(letzteProviV.KVTMP,"0d.mm.yyyy")ÿ" mind. 27 Tage Differenz zwischen letzter und neuer PROV.ABRECHNUNG")
ÿ’ÿ¡
ÿ¡CodeMA.KVTMPÿ
1ÿp
	ÿƒWriteLog("!dem Vertrag wurde keine Agentur zugeordnet")
	ÿƒAddLogInfo()
	ok%ÿ0
ÿ’ÿ¡
ÿ¡CodeGE.KVTMPÿ
1ÿp
	ÿƒWriteLog("!dem Vertrag wurde keine Gesellschaft zugeordnet")
	ÿƒAddLogInfo()
	ok%ÿ0
ÿ’ÿ¡
ÿ¡CodeVA.KVTMPÿ
1ÿp
	ÿƒWriteLog("!dem Vertrag wurde keine Sparte zugeordnet")
	ÿƒAddLogInfo()
	ok%ÿ0
ÿ’ÿ¡
ÿ¡CodeKO.KVTMPÿ0ÿÿ1(ProviAb.KVTMP)ÿcdate%ÿp
	ÿƒWriteLog("!der erwartete Eintrag in VKOTMP konnte nicht gefunden werden")
	ÿƒAddLogInfo()
	ok%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ ------------------------
ÿ½ -- Aufruf der Berechnung
ÿ½ ------------------------
 
ÿ¡ok%ÿ1ÿp
ÿ½ CALL Fehler("Provision soll berechnet werden", DATE$ (cdate%,"0d.mm.yyyy"))
ÿ½ CALL Fehler("Berechnung bis", DATE$ (cdate%,"0d.mm.yyyy"))
gezPflege%ÿ0
gezPauschale%ÿ0
gezAbschluá%ÿ0
gezStornoRes%ÿ0
ÿƒPROVVoraus2(vorart%)
ÿ’ÿ¡
ÿÉÿ±ÿ™"KVTMP"ÿ£ProviAb.KVTMP
_p2%ÿ_p2%ÿ1
ÿÙ
ÿ¡ReadConfig$("PROVIS","SkipStorno")ÿ"TRUE"ÿp
ÿ½ 
ÿ^
ÿƒSRZahlungVor()
ÿ’ÿ¡
ÿ¡anschluss%ÿ0ÿp
ÿßÿ³
ÿÊÿÿx
ÿÊÿŸtitle$ÿ" - Buchung"
ÿÊÿË"Provisionsabrechnung beendet"
ÿ¡PRVCHECKLISTE$ÿ"TRUE"ÿpÿƒCloseLog()
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ’ÿÿ
 
 
 
ÿÿPROVVoraus2(vorart%)
 cfile$ÿÿ™
 ok%ÿ1
 ÿ½ **DEBUG ProviAb-Check
 
 ÿ¡ProviAb.KVTMPÿcdate%ÿp
ÿƒWriteLog("## Aufruf PROVISION2 mit ProviAb > cdate%")
ÿ½ REQUEST "ProviAb > cdate%"
 ÿ’ÿ¡
 bwbezug$ÿReadConfig$("PROVIS","Bewertungszeitraum")
 ÿ¡bwbezug$ÿ"leer"ÿbwbezug$ÿ"Provisionierungsbeginn"ÿp
BWStart%ÿÿ1(ProviAb.KVTMP)
 ÿ^
BWStart%ÿÿ1(VS_Beginn.KVTMP)
 ÿ’ÿ¡
 Laufzeit%ÿÿ ((cdate%ÿBWStart%)ÿ30,0)
 LaufzeitPro%ÿÿ ((cdate%ÿÿ1(ProviAb.KVTMP))ÿ30,0)
 
 ÿ½ **DEBUG Laufzeit in LOG schreiben
 ÿ¡_debug%ÿ1ÿpÿƒWriteLog("## Laufzeit: "ÿÿ(lfdnr.KVTMP,"000000")ÿ" - "ÿÿ(Laufzeit%,"9999")ÿ" Monate")
 cuvt%ÿlfdnr.KVTMP
 codema%ÿCodeMA.KVTMP
 codege%ÿCodeGE.KVTMP
 codeva%ÿCodeVA.KVTMP
 koab%ÿCodeKO.KVTMP
 ÿÉÿ`ÿ™"maadr"ÿ£codema.maadr
 ÿÉÿ¥codema%ÿ™"maadr"ÿ£codema.maadr
 vtagentur$ÿNachname.maadrÿ","ÿvorname.maadr
 vtcodem%ÿcodema.KVTMP
 Gvtagentur$ÿvtagentur$
 GVTcodema%ÿvtcodema%
 ÿßÿe
 ÿ¡ÿOÿJ(koab%,codevk.VKOTMP)ÿp
ÿƒWriteLog("  kein Eintrag in Datei VKOTMP-gefunden!")
ÿƒAddLogInfo()
ok%ÿ0
 ÿ^
ÿÉÿ¥koab%ÿáÿ™"VKOTMP"ÿ£CodeVK.VKOTMP
 ÿ’ÿ¡
 ÿ¡vorart%ÿ1ÿp
weitermachen%ÿ1
ÿÉÿ`ÿ™"VKOTMP"ÿ£CodeVK.VKOTMP
ÿÉÿ¥koab%ÿ™"VKOTMP"ÿ£CodeVK.VKOTMP
ÿØÿOÿB("VKOTMP")ÿweitermachen%ÿ1
ÿ¡n„chsteKond.VKOTMPÿ0ÿp
weitermachen%ÿ0
ÿ^
ÿÉÿ¥n„chsteKond.VKOTMPÿ™"VKOTMP"ÿ£CodeVK.VKOTMP
ÿ’ÿ¡
ÿÙ
ÿÉÿ¥CodeKO.VKOTMPÿ™"GEKOND"ÿ£lfdnr.GEKOND
ÿÉÿ`ÿ™"GEKOND"ÿ£lfdnr.GEKOND
ÿ½ jetzt wurde die Kondition der Firma(1.Agentur) gefunden  
 ÿ’ÿ¡
 vertrprov%ÿ0
 vsumAP%ÿ0
 vsumC%ÿ0
 vsumPP%ÿ0
 vsumPausch%ÿ0
 vertrsr%ÿ0
 ÿØok%ÿ1
ÿßÿe
ÿÉÿ¥CodeKO.VKOTMPÿ™"GEKOND"ÿ£lfdnr.GEKOND
ÿ¡ÿOÿC("GEKOND")ÿp
ÿƒWriteLog("  die angegebene Kondition ist nicht enthalten!")
ÿƒWriteLog("  SUPPORT: die in VKOTMP angegebene Kondition fehlt in GEKOND!")
ÿƒAddLogInfo()
ok%ÿ0
ÿ’ÿ¡
ÿ¡ok%ÿ1ÿp
vtagentur$ÿGvtagentur$
vtcodem%ÿGvtcodema%
codema%ÿCodeMA.GEKOND
haftvertrag%ÿSRHaftung.KVTMP
ÿ½ 150697
dmeinh%ÿdmeinheit.gekond
ÿ½ --------------------
ÿ½ -- Abschluáprovision
ÿ½ --------------------
 
ÿ¡APjn.gekondÿ"j"ÿp
ÿ¡gez_Abschluá.KVTMPÿ"j"ÿp
	prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿAP.gekond)
	ÿ¡haftvertrag%ÿ0ÿp
ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
haftvertrag%ÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
Haftung%ÿÿ1(VS_Beginn.KVTMP)ÿ(haftvertrag%ÿ30)
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿ0
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ^
ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung.gekondÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
Haftung%ÿÿ1(VS_Beginn.KVTMP)ÿ(Haftung.gekondÿ30)
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
ÿ^
ÿ½ unbegrenzte Haftung ohne Auszahlung
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿÿ1
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ¡prov%ÿ0ÿsr%ÿ0ÿpÿƒRegProvisVor("AP: "ÿVS_Nr.KVTMP,codema%,prov%,sr%,Haftung%,umrechnung.KVTMP,codew.KVTMP,waehrung.KVTMP)
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ½ ------------------
ÿ½ -- Pflegeprovision
ÿ½ ------------------
ÿ½ 13.10.94  - keine Berechung der Stornoreserve
pflege%ÿ0
ÿ¡PflegeJN.gekondÿ"j"ÿp
ÿ¡Laufzeit%ÿPflegezeit.gekondÿp
	_day%ÿÿ3(letztePflege.KVTMP)
	_month%ÿÿ5(letztePflege.KVTMP)
	_year%ÿÿ6(letztePflege.KVTMP)
	ÿ¡_year%ÿ
1980ÿp
_year%ÿ1980
_day%ÿ1
_month%ÿ1
	ÿ’ÿ¡
	ÿ½ 060597
	ÿ½ _month% = _month% + PflegeZW.GEKOND
	ÿ½ IF _month% > 12 THEN 
ÿ½ _year% = _year% + 1
ÿ½ _month% = _month% - 12
	ÿ½ END IF 
	ÿ½ 060597
	ÿ½ nextpfl% = DAYS ( STR$ (_day%,"00") + "." + STR$ (_month%,"00") + "." + STR$ (_year%,"9999"))
	ÿ½ IF nextpfl% <= cdate% THEN 
ÿ½ prov% = (((Beitrag.KVTMP * ZW.KVTMP) / 100) * PflegeProvi.gekond)
ÿ½ pflege% = 1
ÿ½ sr% = 0
ÿ½ Haftung% = 0
 
ÿ½ „lter als 060597 IF SRjn = "j" AND Laufzeit% < Haftung THEN 
ÿ½   sr% = sr.gekond
ÿ½ ELSE 
ÿ½   sr% = 0
ÿ½ END IF 
ÿ½ IF sr% <> 0 THEN 
ÿ½   Haftung% = DAYS (VS_Beginn.KVTMP) + (Haftung.gekond * 30)
ÿ½ ELSE 
ÿ½   Haftung% = 0
ÿ½ END IF 
 
 
 ÿ½ CREATE DIALOG "PROT",0,0,244,154,title$,"MS Sans Serif",8
 ÿ½ ADD DIALOG "PROT",1,62,134,55,15,1,"&Ja",1,1
 ÿ½ DIALOG "PROT",req%
 ÿ½ REMOVE DIALOG "PROT"
 
 
 
 
ÿ½ 060597 Neu Pflegeprovis nach Zahlweisen
PflegeGez$ÿ"n"
ÿ¡PflegeNachZahlw ÿ"n"ÿp
ÿ½ -- abh„ngig von Zahlungsweise im Vertrag --
ÿÉÿæZW.KVTMP
ÿæ1
_year%ÿ_year%ÿ1
ÿæ2
_month%ÿ_month%ÿ6
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
ÿæ4
_month%ÿ_month%ÿ3
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
ÿæ12
_month%ÿ_month%ÿ1
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
ÿæ0
_year%ÿ2100
ÿ’ÿÉ
nextpfl%ÿÿ1(ÿ(_day%,"00")ÿ"."ÿÿ(_month%,"00")ÿ"."ÿÿ(_year%,"9999"))
ÿ½ 060597 kl„ren wozu ?
ÿ¡ZW.KVTMPÿ0ÿletzteProviV.KVTMPÿ
1ÿp
ÿ½ 150597
ÿ½ prov% = (((Beitrag.KVTMP * ZW.KVTMP) / 100) * PflegeProvi.gekond)
prov%ÿ(((Beitrag.KVTMP)ÿ100)ÿPflegeProvi.gekond)
PflegeGez$ÿ"j"
pflege%ÿ1
sr%ÿ0
Haftung%ÿ0
ÿ^
ÿ¡nextpfl%ÿ	cdate%ÿp
ÿ½ 150597
ÿ½ prov% = (((Beitrag.KVTMP * ZW.KVTMP) / 100) * PflegeProvi.gekond)
prov%ÿ(((Beitrag.KVTMP)ÿ100)ÿPflegeProvi.gekond)
PflegeGez$ÿ"j"
pflege%ÿ1
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ½ -- Abh„ngig von Zahlweise in GEKOND --
_month%ÿ_month%ÿPflegeZW.GEKOND
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
nextpfl%ÿÿ1(ÿ(_day%,"00")ÿ"."ÿÿ(_month%,"00")ÿ"."ÿÿ(_year%,"9999"))
ÿ¡nextpfl%ÿ	cdate%ÿp
prov%ÿ(((Beitrag.KVTMPÿZW.KVTMP)ÿ100)ÿPflegeProvi.gekond)
PflegeGez$ÿ"j"
pflege%ÿ1
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ 030697 IF PflegeGez$ = "j" THEN CALL RegProvisVor("Pflege: " + VS_Nr.KVTMP,codema%,prov%,sr%,Haftung%)
ÿ¡PflegeGez$ÿ"j"ÿprov%ÿ0ÿpÿƒRegProvisVor("Pflege: "ÿVS_Nr.KVTMP,codema%,prov%,sr%,Haftung%,umrechnung.KVTMP,codew.KVTMP,waehrung.KVTMP)
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ½ 140497 Courtage nicht rechnen, wenn CourtageEinstell angekreuzt wurde und eine Pflegeprov. gezahlt wurde 
ÿ½ 270497 IF pflege% = 1 AND CourtEinstellen.gekond = "j" THEN GOTO Pflege1404971 
ÿ½ 200597
 
ÿ¡pflege%ÿ1ÿletztePflege.KVTMPÿ0ÿpÿwPflege0612001v
 
ÿ½ -----------
ÿ½ -- Courtage
ÿ½ -----------
 
ÿ¡CourtageJN.gekondÿ"j"ÿp

ÿ¡BewertEinmDat.KVTMPÿ0ÿBewertCalcDat.KVTMPÿ
1ÿpÿwBewEinmDat061200v
_day%ÿÿ3(letzteProviV.KVTMP)
_month%ÿÿ5(letzteProviV.KVTMP)
_year%ÿÿ6(letzteProviV.KVTMP)
ÿ¡_year%ÿ
1980ÿp
	_year%ÿ1980
	_day%ÿ1
	_month%ÿ1
ÿ’ÿ¡
CourtGez$ÿ"n"
ÿ¡CourtageZWjn.gekondÿ"n"ÿp
	ÿ½ -- abh„ngig von Zahlungsweise im Vertrag --
	ÿÉÿæZW.KVTMP
	ÿæ1
_year%ÿ_year%ÿ1
	ÿæ2
_month%ÿ_month%ÿ6
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
	ÿæ4
_month%ÿ_month%ÿ3
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
	ÿæ12
_month%ÿ_month%ÿ1
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
	ÿæ0
_year%ÿ2100
	ÿ’ÿÉ
	nextprovi%ÿÿ1(ÿ(_day%,"00")ÿ"."ÿÿ(_month%,"00")ÿ"."ÿÿ(_year%,"9999"))
	ÿ¡ZW.KVTMPÿ0ÿletzteProviV.KVTMPÿ
1ÿp
ÿ¡CourtNachBeitr$ÿ"TRUE"ÿp
prov%ÿ((Beitrag.KVTMPÿ100)ÿCourtage.gekond)
ÿ^
prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿCourtage.gekond)
ÿ’ÿ¡
CourtGez$ÿ"j"
	ÿ^
ÿ¡nextprovi%ÿ	cdate%ÿp
ÿ½ CALL Fehler("Courtage","")
ÿ¡CourtNachBeitr$ÿ"TRUE"ÿp
prov%ÿ((Beitrag.KVTMPÿ100)ÿCourtage.gekond)
ÿ^
testma%ÿcodema.gekond
testcou%ÿCourtage.gekond
testbw%ÿBewertungssumme.KVTMP
prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿCourtage.gekond)
ÿ’ÿ¡
CourtGez$ÿ"j"
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ^
	ÿ½ -- Abh„ngig von Zahlweise in GEKOND --
	_month%ÿ_month%ÿCourtageZW.GEKOND
	ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
	ÿ’ÿ¡
	nextprovi%ÿÿ1(ÿ(_day%,"00")ÿ"."ÿÿ(_month%,"00")ÿ"."ÿÿ(_year%,"9999"))
	ÿ¡nextprovi%ÿ	cdate%ÿp
ÿ¡CourtNachBeitr$ÿ"TRUE"ÿp
prov%ÿ((Beitrag.KVTMPÿ100)ÿCourtage.gekond)
ÿ^
prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿCourtage.gekond)
ÿ’ÿ¡
CourtGez$ÿ"j"
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ 060497
ÿ½ 200597
ÿ¡haftvertrag%ÿ0ÿp
	ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftvertrag%ÿStornoResGezJN.VKOTMPÿ"j"ÿStornoResGezJV.VKOTMPÿ"j"ÿp
StornoResGezJN$ÿ""
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
codevk%ÿcodevk.VKOTMP
Haftung%ÿÿ1(ProviAb.KVTMP)ÿ(Haftvertrag%ÿ30)
StornoResGezJN$ÿ"x"
ÿ’ÿ¡
	ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿÿ1
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ^
	ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung.gekondÿStornoResGezJN.VKOTMPÿ"j"ÿStornoResGezJV.VKOTMPÿ"j"ÿp
StornoResGezJN$ÿ""
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
codevk%ÿcodevk.VKOTMP
Haftung%ÿÿ1(ProviAb.KVTMP)ÿ(Haftung.gekondÿ30)
StornoResGezJN$ÿ"x"
ÿ’ÿ¡
	ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿÿ1
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡StornoResGezJN$ÿ"x"ÿp
	StornoResGezJV.VKOTMPÿ"j"
	codevk%ÿcodevk.VKOTMP
	Workstation.VKOTMPÿWorkstation%
	QWoNo.VKOTMPÿÿ(Workstation%,"000000")ÿÿ(codevk.VKOTMP,"000000")
	RecStatus.VKOTMPÿ"c"
	ÿÌÿ™"VKOTMP"
	ÿÉÿ¥codevk%ÿ™"VKOTMP"ÿ£CodeVK.VKOTMP
	StornoResGezJN$ÿ""
ÿ’ÿ¡
ÿ½ 220697
ÿ¡CourtGez$ÿ"j"ÿp
	ÿ¡sr%ÿ0ÿprov%ÿ0ÿp
ÿƒRegProvisVor("Courtage: "ÿVS_Nr.KVTMP,codema%,prov%,sr%,Haftung%,umrechnung.KVTMP,codew.KVTMP,waehrung.KVTMP)
	ÿ’ÿ¡
ÿ’ÿ¡
ÿwCourt061200vend 
BewEinmDat061200v: 
prov%ÿ((BewertEinm.KVTMPÿ100)ÿCourtage.gekond)
CourtGez$ÿ"j"
ÿ¡haftvertrag%ÿ0ÿp
	ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
haftvertrag%ÿStornoResGezJN.VKOTMPÿ"j"ÿStornoResGezJV.VKOTMPÿ"j"ÿp
StornoResGezJN$ÿ""
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
codevk%ÿcodevk.VKOTMP
Haftung%ÿÿ1(ProviAb.KVTMP)ÿ(haftvertrag%ÿ30)
StornoResGezJN$ÿ"x"
ÿ’ÿ¡
	ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿ0
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ^
	ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung.gekondÿStornoResGezJN.VKOTMPÿ"j"ÿStornoResGezJV.VKOTMPÿ"j"ÿp
StornoResGezJN$ÿ""
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
codevk%ÿcodevk.VKOTMP
Haftung%ÿÿ1(ProviAb.KVTMP)ÿ(Haftung.gekondÿ30)
StornoResGezJN$ÿ"x"
ÿ’ÿ¡
	ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿ0
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡StornoResGezJN$ÿ"x"ÿp
	StornoResGezJV.VKOTMPÿ"j"
	codevk%ÿcodevk.VKOTMP
	Workstation.VKOTMPÿWorkstation%
	QWoNo.VKOTMPÿÿ(Workstation%,"000000")ÿÿ(codevk.VKOTMP,"000000")
	RecStatus.VKOTMPÿ"c"
	ÿÌÿ™"VKOTMP"
	ÿÉÿ¥codevk%ÿ™"VKOTMP"ÿ£CodeVK.VKOTMP
	StornoResGezJN$ÿ""
ÿ’ÿ¡
ÿ½ 220697
ÿ¡CourtGez$ÿ"j"ÿp
	ÿ¡sr%ÿ0ÿprov%ÿ0ÿp
ÿƒRegProvisVor("Courtage: "ÿVS_Nr.KVTMP,codema%,prov%,sr%,Haftung%,umrechnung.KVTMP,codew.KVTMP,waehrung.KVTMP)
	ÿ’ÿ¡
ÿ’ÿ¡
Court061200vend: 
ÿ’ÿ¡
 
 
Pflege0612001v: 
 

 
 

ÿ½ ----------------
ÿ½ -- Vertragsdauer
ÿ½ ----------------
 
ÿ¡VDjn.gekondÿ"j"ÿp
ÿ¡gez_Abschluá.KVTMPÿ"j"ÿp
	ÿÉÿæVS_Dauer.KVTMP
	ÿæVD1Dauer.gekond
prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿVD1AP.gekond)
sr%ÿVD1SR.gekond
Haftung%ÿVD1HZ.GEKOND
	ÿæVD2Dauer.gekond
prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿVD2AP.gekond)
sr%ÿVD2SR.gekond
Haftung%ÿVD2HZ.GEKOND
	ÿæVD3Dauer.gekond
prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿVD3AP.gekond)
sr%ÿVD3SR.gekond
Haftung%ÿVD3HZ.GEKOND
	ÿæVD4Dauer.gekond
prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿVD4AP.gekond)
sr%ÿVD4SR.gekond
Haftung%ÿVD4HZ.GEKOND
	ÿæVD5Dauer.gekond
prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿVD5AP.gekond)
sr%ÿVD5SR.gekond
Haftung%ÿVD5HZ.GEKOND
	ÿ’ÿÉ
	ÿ¡sr%ÿ0ÿp
ÿ¡haftvertrag%ÿ0ÿp
Haftung%ÿ(haftvertrag%ÿ30)ÿÿ1(VS_beginn.KVTMP)
ÿ^
Haftung%ÿ(Haftung%ÿ30)ÿÿ1(VS_beginn.KVTMP)
ÿ’ÿ¡
	ÿ^
Haftung%ÿ0
	ÿ’ÿ¡
	ÿƒRegProvisVor("VD: "ÿVS_Nr.KVTMP,codema%,prov%,sr%,Haftung%,umrechnung.KVTMP,codew.KVTMP,waehrung.KVTMP)
ÿ’ÿ¡
ÿ’ÿ¡

ÿ½ -----------------------------------
ÿ½ -- Teilzahlung/Ratenzahlung
ÿ½ -- z.Z. auf Ratenzahlung umgestellt
ÿ½ -----------------------------------
 
ÿ¡TZjn.gekondÿ"j"ÿp
ÿ¡TZRate.KVTMPÿ1ÿ1ÿp
	prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿTZ0.gekond)
ÿ’ÿ¡
ÿ¡TZRateV.KVTMPÿ1ÿTZD1.gekondÿp
	prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿTZ1.gekond)
ÿ’ÿ¡
ÿ¡TZRateV.KVTMPÿ1ÿTZD2.gekondÿp
	prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿTZ2.gekond)
ÿ’ÿ¡
ÿ¡TZRateV.KVTMPÿ1ÿTZD3.gekondÿp
	prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿTZ3.gekond)
ÿ’ÿ¡
ÿ¡TZRateV.KVTMPÿ1ÿTZD4.gekondÿp
	prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿTZ4.gekond)
ÿ’ÿ¡
ÿ¡TZRateV.KVTMPÿ1ÿTZD5.gekondÿp
	prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿTZ5.gekond)
ÿ’ÿ¡
ÿ¡TZRateV.KVTMPÿ1ÿTZD6.gekondÿp
	prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿTZ6.gekond)
ÿ’ÿ¡
ÿ¡TZRateV.KVTMPÿ1ÿTZD7.gekondÿp
	prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿTZ7.gekond)
ÿ’ÿ¡
ÿ¡TZRateV.KVTMPÿ1ÿTZD8.gekondÿp
	prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿTZ8.gekond)
ÿ’ÿ¡
ÿ¡TZRateV.KVTMPÿ1ÿTZD9.gekondÿp
	prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿTZ9.gekond)
ÿ’ÿ¡
ÿ¡TZRateV.KVTMPÿ1ÿTZD10.gekondÿp
	prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿTZ10.gekond)
ÿ’ÿ¡
ÿ¡TZRateV.KVTMPÿ1ÿTZD11.gekondÿp
	prov%ÿ((Bewertungssumme.KVTMPÿ100)ÿTZ11.gekond)
ÿ’ÿ¡
ÿ¡prov%ÿ0ÿp
	ÿ½ 060497
	ÿ¡haftvertrag%ÿ0ÿp
ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
haftvertrag%ÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
Haftung%ÿÿ1(VS_Beginn.KVTMPÿ(haftvertrag%ÿ30))
ÿ’ÿ¡
ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿÿ1
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ^
ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung.gekondÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
Haftung%ÿÿ1(VS_Beginn.KVTMPÿ(Haftung.gekondÿ30))
ÿ’ÿ¡
ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿÿ1
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ½ IF sr% <> 0 THEN 
ÿ½ Haftung% = DAYS (VS_Beginn.KVTMP + (Haftung.gekond * 30))
	ÿ½ ELSE 
ÿ½ Haftung% = 0
	ÿ½ END IF 
	ÿƒRegProvisVor("TZ ("ÿÿH(ÿ(TZRate.KVTMPÿ1,"999"))ÿ". Zahlung): "ÿVS_Nr.KVTMP,codema%,prov%,sr%,Haftung%,umrechnung.KVTMP,codew.KVTMP,waehrung.KVTMP)
ÿ^
	ÿƒWriteLog("!Konditionen fr Ratenzahlung/Teilzahlung unvollst„ndig")
	ÿƒWriteLog("    >> Rate: "ÿÿH(ÿ(TZRate.KVTMPÿ1,"999")))
	ÿƒWriteLog("    >> bei Abschluá:"ÿÿH(ÿ(TZ0.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD1.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ1.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD2.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ2.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD3.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ3.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD4.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ4.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD5.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ5.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD6.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ6.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD7.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ7.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD8.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ8.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD9.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ9.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD10.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ10.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD11.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ11.gekond,",999999.00")))
	ÿƒAddLogInfo()
ÿ’ÿ¡
 
ÿ’ÿ¡
 
ÿ½ ------------
ÿ½ -- Pauschale
ÿ½ ------------
 
ÿ¡PauschaleJN.gekondÿ"j"ÿp
ÿ¡gez_Pauschale.KVTMPÿ"j"ÿp
	prov%ÿPauschale.gekond
	ÿ½ 060497
	ÿ¡SRjn.gekondÿ"j"ÿLaufzeit%ÿ
Haftung.gekondÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
ÿ¡haftvertrag%ÿ0ÿp
Haftung%ÿÿ1(VS_Beginn.KVTMP)ÿ(Haftvertrag%ÿ30)
ÿ^
Haftung%ÿÿ1(VS_Beginn.KVTMP)ÿ(Haftung.gekondÿ30)
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ^
ÿ¡Haftung.gekondÿÿ1ÿp
sr%ÿsr.gekond
Haftung%ÿÿ1
ÿ^
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
	ÿ’ÿ¡
	ÿ½ IF sr% <> 0 THEN 
ÿ½ Haftung% = DAYS (VS_Beginn.KVTMP) + (Haftung.gekond * 30)
	ÿ½ ELSE 
ÿ½ Haftung% = 0
	ÿ½ END IF 
	ÿƒRegProvisVor("Pauschale: "ÿVS_Nr.KVTMP,codema%,prov%,sr%,Haftung%,umrechnung.KVTMP,codew.KVTMP,waehrung.KVTMP)
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ’ÿ¡
 
ÿ¡n„chsteKond.VKOTMPÿ0ÿp
ok%ÿ0
ÿ^
ÿÉÿ¥n„chsteKond.VKOTMPÿáÿ™"VKOTMP"ÿ£CodeVK.VKOTMP
ÿ’ÿ¡
 
 ÿÙ
 ÿ’ÿÿ
 
 
 
 
ÿÿRegProvisVor(remark$,ma%,provi%,sr%,Haftung%,euro1%,codew%,waehr1$)
 cfile$ÿÿ™
 ÿ™"KVTMP"
 _lfdnr%ÿlfdnr.KVTMP
 ÿÉÿ¥_lfdnr%ÿáÿ™"KVTMP"ÿ£lfdnr.KVTMP
 ÿÉÿ¥ma%ÿ™"maadr"ÿ£CodeMA.MAADR
 ÿÉÿ¥codeva.kvertragÿ™"sparten"ÿ£codeva.sparten

 codevp%ÿcodevp.kvertrag
 ÿÉÿ`ÿ™"VPRODUKT"ÿ£codevp.vprodukt
 ÿÉÿ¥codevp%ÿ™"VPRODUKT"ÿ£codevp.vprodukt

 ÿ½ -- bereits gezahlte Provisionen verallgemeinern
 ÿ½ IF remark$ LIKE "Abschlu*" THEN 
ÿ½ vertrprov% = vsumAP%
 ÿ½ ELSE IF remark$ LIKE "Courta*" THEN 
ÿ½ vertrprov% = vsumC%
 ÿ½ ELSE IF remark$ LIKE "Pflege*" THEN 
ÿ½ vertrprov% = vsumPP%
 ÿ½ ELSE IF remark$ LIKE "Pauschal*" THEN 
ÿ½ vertrprov% = vsumPausch%
 ÿ½ ELSE IF remark$ LIKE "VD*" THEN 
ÿ½ vertrprov% = vsumAP%
 ÿ½ END IF 
 bewerteimz%ÿ0
 ÿ¡BewertEinmDat.KVTMPÿ0ÿBewertCalcDaV.KVTMPÿ
1ÿp
bewerteimz%ÿ1
 ÿ’ÿ¡
 ÿ½ -- Bearbeitung bei letzter Agentur in der Struktur
 ÿ¡(CodeMA.maadrÿvorg„nger.maadr)ÿ(Vorg„nger.MAADRÿ
1)ÿp

ÿ¡bewerteimz%ÿ1ÿp
BewertCalcDaV.KVTMPÿcdate%
ÿ^
letzteProviV.KVTMPÿcdate%
ÿ’ÿ¡
ÿ¡remark$ÿ"TZ (*"ÿp
TZRateV.KVTMPÿTZRateV.KVTMPÿ1
ÿ’ÿ¡
 ÿ’ÿ¡
 
 ÿ½  CALL FldAdd("BewertCalcDaV","DAT;0d.mm.yyyy",0)
 ÿ½  CALL FldAdd("letzteProviV","DAT;0d.mm.yyyy",0)
 ÿ½  CALL FldAdd("TZRateV","NMI;999.",0)
 ÿ½  CALL FldAdd("gez_AbschluV","TXT;1",0)
 ÿ½  CALL FldAdd("gez_PauschalV","TXT;1",0)
 ÿ½  CALL FldAdd("letztePflegV","DAT;0d.mm.yyyy",0)
 
 ÿ½ -- Einmalzahlungen/Berechnungen Stornoreserve registrieren --
 ÿ¡remark$ÿ"Abschlu*"ÿremark$ÿ"*Abschl*"ÿremark$ÿ"AP*"ÿremark$ÿ"VD*"ÿpgezAbschluá%ÿ1
 ÿ¡remark$ÿ"Pflege*"ÿpgezPflege%ÿ1
 ÿ¡remark$ÿ"Pauschal*"ÿpgezPauschale%ÿ1
 ÿ¡CodeMA.MAADRÿVorg„nger.MAADRÿVorg„nger.MAADRÿ
1ÿp
ÿ¡gezAbschluá%ÿ1ÿpgez_AbschluV.KVTMPÿ"j"
ÿ¡gezPflege%ÿ1ÿpletztePflegV.KVTMPÿcdate%
ÿ¡gezPauschale%ÿ1ÿpgez_PauschalV.KVTMPÿ"j"
 ÿ’ÿ¡

 ÿ½ CALL QuickStore("KVTMP")
 ÿÌÿ™"KVTMP"
 ÿïÿY
 ÿßÿe
 ÿ™"buchvor"
 ÿ
 CodeBU.buchvorÿÿI("buchvor",1)
 Datum.buchvorÿcdate%
 ÿ½ CALL Fehler ( DATE$ (cdate%,"0d.mm.yyyy"),"")
 F„lligkeit.buchvorÿcdate%
 CodeVT.buchvorÿlfdnr.KVTMP
 ÿ¡Kndigung.MAADRÿ	cdate%ÿNachfolger.MAADRÿ0ÿp
CodeMA.buchvorÿNachfolger.MAADR
ma1%ÿNachfolger.MAADR
buchungstext.buchvorÿremark$ÿ" (Umbuchvor von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)"
 ÿ^
CodeMA.buchvorÿma%
ma1%ÿma%
ÿ¡bewerteimz%ÿ1ÿp
buchungstext.buchvorÿremark$ÿ"- Erst.Zahl."
ÿ^
buchungstext.buchvorÿremark$
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡dmeinh%ÿ0ÿpeinheit%ÿprovi%ÿdmeinh%
 SRBetrag%ÿ((provi%ÿvertrprov%)ÿ100)ÿsr%
 '******************************************************************************************************   
 ' Eintrag der Einheiten und Volumen beim Mitarbeiter
 '******************************************************************************************************   

ÿÉÿ¥ma1%ÿáÿ™"maadr"ÿ£codema.maadr
StornoreservV.maadrÿStornoreservV.maadrÿSRBetrag%

betr%ÿprovi%ÿvertrprov%ÿSRBetrag%
ÿ¡EinheitSach.stammÿ"j"ÿp
ÿ¡SparteIstSach.spartenÿ1ÿp
ÿ¡ma1%ÿvtcodema%ÿp
	ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheitenV.maadrÿEinheitenV.maadrÿeinheit%
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheitenV.maadrÿEinheitenV.maadrÿeinheiten.kvertrag
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheitenV.maadrÿEinheitenV.maadrÿeinheiten.kvertragÿÿ1
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
	ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheitenV.maadrÿEinheitenV.maadrÿeinheit%
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheitenV.maadrÿEinheitenV.maadrÿeinheiten.kvertrag
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheitenV.maadrÿEinheitenV.maadrÿeinheiten.kvertragÿÿ1
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
	ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheitenV.maadrÿEinheitenV.maadrÿeinheit%
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheitenV.maadrÿEinheitenV.maadrÿeinheiten.kvertrag
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheitenV.maadrÿEinheitenV.maadrÿeinheiten.kvertragÿÿ1
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡ma1%ÿvtcodema%ÿp
ÿ¡EinheitAusGeko.stammÿ
1ÿpEigEinheitenV.maadrÿEigEinheitenV.maadrÿeinheit%
ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEigEinheitenV.maadrÿEigEinheitenV.maadrÿeinheiten.kvertrag
ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEigEinheitenV.maadrÿEigEinheitenV.maadrÿeinheiten.kvertragÿÿ1
ÿ’ÿ¡
ÿ’ÿ¡
betr%ÿprovi%ÿvertrprov%ÿSRBetrag%
ÿ¡betr%ÿ0ÿp
GesVolumenV.maadrÿGesVolumenV.maadrÿVolumen.KVTMP
ÿ¡ma1%ÿvtcodema%ÿp
EigVolumenV.maadrÿEigVolumenV.maadrÿVolumen.KVTMP
ÿ’ÿ¡
ÿ^
GesVolumenV.maadrÿGesVolumenV.maadrÿ(Volumen.KVTMPÿÿ1)
ÿ¡ma1%ÿvtcodema%ÿp
EigVolumenV.maadrÿEigVolumenV.maadrÿ(Volumen.KVTMPÿÿ1)
ÿ’ÿ¡
ÿ’ÿ¡
ÿÌÿ™"maadr"
 '******************************************************************************************************   
 betr%ÿprovi%ÿvertrprov%ÿSRBetrag%
 Betrag.buchvorÿprovi%ÿvertrprov%ÿSRBetrag%
 Gesamtbetrag.buchvorÿprovi%
 ÿ¡bewerteimz%ÿ1ÿp
Bewertungssumme.buchvorÿBewertEinm.KVTMP
 ÿ^
Bewertungssumme.buchvorÿBewertungssumme.KVTMP
 ÿ’ÿ¡
 
 umrechnung.buchvorÿeuro1%
 BetragEU.buchvorÿÿ0(ÿ(betrag.buchvorÿeuro1%,"999999999.00"))
 vsumme.buchvorÿvsumme.KVTMP
 vsummeEU.buchvorÿÿ0(ÿ(vsumme.KVTMPÿumrechnung.buchvor,"999999999.00"))
 BeitragBrut.buchvorÿBeitrag.KVTMP
 BeitragNet.buchvorÿNettoBeitrag.KVTMP
 BeitragBrutEu.buchvorÿÿ0(ÿ(Beitrag.KVTMPÿumrechnung.buchvor,"999999999.00"))
 BeitragNetEu.buchvorÿÿ0(ÿ(NettoBeitrag.KVTMPÿumrechnung.buchvor,"999999999.00"))
 zw.buchvorÿzw.KVTMP
 mwst.buchvorÿmwst.KVTMP
 VS_Beginn.buchvorÿVS_Beginn.KVTMP
 ÿ¡zw.buchvorÿ0ÿp
JahresBBrut.buchvorÿBeitragBrut.buchvorÿzw.buchvor
JahresBNet.buchvorÿBeitragNet.buchvorÿzw.buchvor
JahresBBrutEu.buchvorÿÿ0(ÿ(JahresBBrut.buchvorÿumrechnung.buchvor,"999999999.00"))
JahresBNetEu.buchvorÿÿ0(ÿ(JahresBNet.buchvorÿumrechnung.buchvor,"999999999.00"))
 ÿ^
JahresBBrut.buchvorÿBeitragBrut.buchvor
JahresBNet.buchvorÿBeitragNet.buchvor
JahresBBrutEu.buchvorÿÿ0(ÿ(JahresBBrut.buchvorÿumrechnung.buchvor,"999999999.00"))
JahresBNetEu.buchvorÿÿ0(ÿ(JahresBNet.buchvorÿumrechnung.buchvor,"999999999.00"))
 ÿ’ÿ¡
 Volumen.buchvorÿVolumen.KVTMP
 Bewertung2.buchvorÿBewertungssumme.KVTMP
 APJN.buchvorÿAPjn.gekond
 CourtJN.buchvorÿCourtageJN.gekond
 SRjn.buchvorÿSRJN.gekond
 PflegeJN.buchvorÿPflegeJN.gekond
 APProzente.buchvorÿAP.gekond
 CourtProzente.buchvorÿCourtage.gekond
 PflegProzente.buchvorÿPflegeProvi.gekond
 SRProzente.buchvorÿsr.gekond
 ProvBasiswert.buchvorÿBewertungssumme.buchvor
 Kndigung.buchvorÿKndigung.KVTMP
 VS_Beginn.buchvorÿVS_Beginn.KVTMP
 CodeKU.buchvorÿCodeKU.KVTMP
 vtagentur.buchvorÿGvtagentur$
 vtcodema.buchvorÿGvtcodema%

ÿ¡EinheitSach.stammÿ"j"ÿp
ÿ¡SparteIstSach.spartenÿ1ÿp
ÿ¡ma1%ÿvtcodema%ÿp
	ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchvorÿeinheit%
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchvorÿeinheiten.kvertrag
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchvorÿeinheiten.kvertragÿÿ1
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
	ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchvorÿeinheit%
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchvorÿeinheiten.kvertrag
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchvorÿeinheiten.kvertragÿÿ1
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
	ÿ¡EinheitAusGeko.stammÿ
1ÿpEinheiten.buchvorÿeinheit%
	ÿ¡betr%ÿ0ÿp
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchvorÿeinheiten.kvertrag
	ÿ^
ÿ¡EinheitAusGeko.stammÿ0ÿpEinheiten.buchvorÿeinheiten.kvertragÿÿ1
	ÿ’ÿ¡
ÿ’ÿ¡

 ÿÉÿ¥CodeVA.KVTMPÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 Sparte.buchvorÿSparte.SPARTEN
 ÿÉÿ¥CodeKU.KVTMPÿ™GAdrDat$ÿ£CodeKU.GAdrDat$
 Nachname.buchvorÿNachname.GAdrDat$
 Vorname.buchvorÿVorname.GAdrDat$
 
 Bewertung2Eu.buchvorÿÿ0(ÿ(Bewertung2.buchvorÿeuro1%,"999999999.00"))
 codew.buchvorÿcodew%
 waehrung.buchvorÿwaehr1$
 ÿÉÿ¥CodeGE.KVTMPÿ™"GEADR"ÿ£CodeGE.GEADR
 Gesellschaft.buchvorÿGesellschaft.GEADR
 Provision.buchvorÿ"j"
 ÿ¡PRVCHECKLISTE$ÿ"TRUE"ÿp
codebumon.buchvorÿcodebumon.buchmon
 ÿ’ÿ¡
 ÿ¡sr%ÿ0ÿp
SRgezahlt.buchvorÿ"j"
SR.buchvorÿ0
 ÿ^
ÿ½ 060497
ÿ¡Haftung%ÿÿ1ÿp
SRAuszahlung.buchvorÿ0
SR.buchvorÿSRBetrag%
ÿ^
SRAuszahlung.buchvorÿHaftung%
SR.buchvorÿSRBetrag%
ÿ’ÿ¡
 ÿ’ÿ¡
 
 ÿ½ -- Zahlungseingang prfen --
 ÿ½ 070897
 ÿwprvor160101001
 ÿ¡check.KVTMPÿ"j"ÿp
ÿ½ CALL Fehler("Check auf Pool","")
_lfdnr%ÿlfdnr.KVTMP
ÿÉÿ¥_lfdnr%ÿáÿ™"KVTMP"ÿ£lfdnr.KVTMP
pool%ÿ(PoolV.KVTMPÿBetrag.buchvor)ÿ100
pool1$ÿÿ(pool%,"999999999999")
poolges%ÿ(ÿ0(pool1$))ÿ100
poolV.KVTMPÿpoolges%
ÿ¡PoolV.KVTMPÿ
0ÿp
MahnungV.KVTMPÿ"j"
Mahnung.buchvorÿ"j"
ÿƒWriteLog("  fehlender Zahlungseingang von Gesellschaft")
ÿƒAddLogInfo()
ÿ’ÿ¡
ÿƒQuickStore("KVTMP")
 ÿ’ÿ¡
prvor160101001: 
 ÿƒQuickStore("buchvor")
 
 ÿ½ -- Aufsummierung der einzelnen Provisionsarten
 ÿ½    fr Differenzberechnung
 ÿ¡remark$ÿ"Abschlu*"ÿremark$ÿ"*Abschl*"ÿremark$ÿ"AP*"ÿp
vsumAP%ÿprovi%
 ÿ^ÿ¡remark$ÿ"Courta*"ÿp
vsumC%ÿprovi%
 ÿ^ÿ¡remark$ÿ"Pflege*"ÿp
vsumPP%ÿprovi%
 ÿ^ÿ¡remark$ÿ"Pauschal*"ÿp
vsumPausch%ÿprovi%
 ÿ^ÿ¡remark$ÿ"VD*"ÿp
vsumAP%ÿprovi%
 ÿ^
vertrprov%ÿprovi%
 ÿ’ÿ¡
 vertrprov%ÿprovi%
 ÿ’ÿÿ



 ' Zahlung von Stornoreserven - bei Vorausberechnungen
 ' =======================================================================
 
ÿÿSRZahlungVor()
 ÿßÿe
 ÿ¡cdate%ÿ0ÿpcdate%ÿÿQ
 ÿ™"buchvor"
 ÿ£CodeBU.buchvor
 fmax%ÿÿA("buchvor")
 lp%ÿ0
 cp%ÿ0
 fcount%ÿ0
 ÿÉÿ`
 ÿØÿOÿB("buchvor")
fcount%ÿfcount%ÿ1
cp%ÿÿ(100ÿfmax%ÿfcount%)
ÿ¡lp%ÿcp%ÿp
lp%ÿcp%
ÿÊÿË"Auszahlung Stornoreserve: "ÿÿH(ÿ(lp%,"999"))ÿ"%"
ÿ’ÿ¡
ÿ½ 060497
ÿ¡SRgezahlt.buchvorÿ"j"ÿSRAuszahlung.buchvorÿ
cdate%ÿSRAuszahlung.buchvorÿ0ÿp
_cubu%ÿCodeBU.buchvor
_CodeMA%ÿCodeMA.buchvor
_CodeVT%ÿCodeVT.buchvor
_SR%ÿSR.buchvor
ÿÉÿ¥_cubu%ÿáÿ™"buchvor"ÿ£CodeBU.buchvor
SRGezahlt.buchvorÿ"j"
ÿƒQuickStore("buchvor")
ÿÉÿ¥_Codema%ÿáÿ™"maadr"ÿ£codema.maadr
ÿ½ 060497
Stornoreserve.maadrÿStornoreserve.maadrÿ_SR%
StornoreserveEU.maadrÿÿ0(ÿ(Stornoreserve.maadrÿumrechnung.buchvor,"999999999.00"))
ÿ½ Workstation.maadr = Workstation%
ÿ½ QWoNo.maadr = STR$ (Workstation%,"000000") + STR$ (codema.maadr,"000000")
RecStatus.maadrÿ"c"
ÿÌÿ™"maadr"
ÿÉÿ¥_CodeVT%ÿ™"KVTMP"ÿ£lfdnr.KVTMP
ÿÿ™"buchvor"
CodeBU.buchvorÿÿI("buchvor",1)
Datum.buchvorÿcdate%
CodeVT.buchvorÿ_CodeVT%
CodeMA.buchvorÿ_CodeMA%
SR.buchvorÿ0ÿ_SR%
Betrag.buchvorÿ_SR%
buchungstext.buchvorÿ"SR-Auszahlung "ÿVS_Nr.KVTMP
Bewertungssumme.buchvorÿBewertungssumme.KVTMP
Kndigung.buchvorÿKndigung.KVTMP
VS_Beginn.buchvorÿVS_Beginn.KVTMP
umrechnung.buchvorÿumrechnung.KVTMP
codew.buchvorÿcodew.KVTMP
waehrung.buchvorÿwaehrung.KVTMP
CodeKU.buchvorÿCodeKU.KVTMP
ÿÉÿ¥CodeVA.KVTMPÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
Sparte.buchvorÿSparte.SPARTEN
ÿÉÿ¥CodeKU.KVTMPÿ™GAdrDat$ÿ£CodeKU.GAdrDat$
Nachname.buchvorÿNachname.GAdrDat$
Vorname.buchvorÿVorname.GAdrDat$
ÿÉÿ¥CodeGE.KVTMPÿ™"GEADR"ÿ£CodeGE.GEADR
Gesellschaft.buchvorÿGesellschaft.GEADR
SRgezahlt.buchvorÿ"j"
Provision.buchvorÿ"j"
SR.buchvorÿ0ÿ_SR%
ÿƒQuickStore("buchvor")
ÿÉÿ¥_cubu%ÿ™"buchvor"ÿ£CodeBU.buchvor
ÿ’ÿ¡
ÿÉÿ±ÿ™"buchvor"ÿ£CodeBU.buchvor
 ÿÙ
 ÿßÿ³
 ÿ’ÿÿ

 
 ' Listen fr die Vorausberechnung
ÿÿVorausList()
 ok%ÿ1
ÿ×dlg ÿUDialog
ÿ×control ÿUDialogControl
opt%ÿ0
opt1%ÿ0
VorausList0310200101: 
Superbase.Dialogs.Add("Dialogname")
ÿÊdlg ÿSuperbase.Dialogs.Dialogname
dlg.Move(0,0,222,143)
dlg.Captionÿ"Berichtsausgabe"
dlg.FontNameÿ"MS Sans Serif"
dlg.FontSizeÿ8
 
ÿÊcontrol ÿdlg.Add("DialogFrame1","DialogFrame")
control.Move(2,8,219,66)
control.Captionÿ" W„hlen Sie eine Berichtsart"
 
ÿÊcontrol ÿdlg.Add("DialogOptionButton1","DialogOptionButton")
control.Move(6,20,169,10)
control.Captionÿ"erwartete Ums„tze sortiert nach Gesellschaften"
control.Bind("opt%")
control.ValueOnÿ0
 
ÿÊcontrol ÿdlg.Add("DialogOptionButton2","DialogOptionButton")
control.Move(6,32,214,9)
control.Captionÿ"erwartete Ums„tze sortiert nach Gesellschaften/Sparten"
control.Bind("opt%")
control.ValueOnÿ1
 
ÿÊcontrol ÿdlg.Add("DialogOptionButton3","DialogOptionButton")
control.Move(6,44,200,10)
control.Captionÿ"erwartete Ums„tze sortiert nach Sparten"
control.Bind("opt%")
control.ValueOnÿ2
 
 
ÿÊcontrol ÿdlg.Add("DialogOptionButton4","DialogOptionButton")
control.Move(6,56,200,10)
control.Captionÿ"erwartete Ums„tze sortiert nach Produkten"
control.Bind("opt%")
control.ValueOnÿ3


ÿÊcontrol ÿdlg.Add("DialogFrame2","DialogFrame")
control.Move(2,80,219,40)
control.Captionÿ" Ausgabeziel: "

ÿÊcontrol ÿdlg.Add("DialogOptionButton5","DialogOptionButton")
control.Move(6,92,200,10)
control.Captionÿ"Ausgabe auf den Bildschirm"
control.Bind("opt1%")
control.ValueOnÿ0

ÿÊcontrol ÿdlg.Add("DialogOptionButton6","DialogOptionButton")
control.Move(6,104,200,10)
control.Captionÿ"Ausgabe auf den Drucker"
control.Bind("opt1%")
control.ValueOnÿ1

ÿÊcontrol ÿdlg.Add("DialogCommandButton1","DialogCommandButton")
control.Move(59,125,43,16)
control.Defaultÿ1
control.Captionÿ"OK"
control.ReturnValueÿ1
 
ÿÊcontrol ÿdlg.Add("DialogCommandButton2","DialogCommandButton")
control.Move(105,125,42,16)
control.Captionÿ"Abbruch"
control.ReturnValueÿ0
 
ÿñ"Dialogname",req%
ÿ¾ÿñ"Dialogname"
ÿ¡req%ÿ0ÿpÿ’ÿÿ
 ÿ_netpath$ÿ"\PROVIS"
 ÿ½ DIRECTORY "G:\ztest\PROVIS"
 ÿ½  
 
 ÿ¡opt%ÿ0ÿp
ÿ¡opt1%ÿ0ÿp
ÿÊÿiÿŸ"Umsatzvorausberechnung fr Gesellschaften",1,1
ÿÉÿòGesellschaft.GEADR,&|10VAnzahlVor.GEADRÿU"Anzahl"ÿô;SBewertung.GEADR,SBewertungEU.GEADR,SVolumen.GEADR,SVolumenEU.GEADR,
SBeitragBRU.GEADR,SBeitragBRUEU.GEADR,SBeitragNET.GEADR,SBeitragNETEU.GEADR,SVSumme.GEADR,SVSummeEU.GEADR,SProvision.GEADR,
SProvisionEU.GEADR
ÿÁÿl(VAnzahlVor.GEADR),ÿl(SBewertung.GEADR),ÿl(SBewertungEU.GEADR),ÿl(SVolumen.GEADR),ÿl(SVolumenEU.GEADR),
ÿl(SBeitragBRU.GEADR),ÿl(SBeitragBRUEU.GEADR),ÿl(SBeitragNET.GEADR),ÿl(SBeitragNETEU.GEADR),ÿl(SVSumme.GEADR),
ÿl(SVSummeEU.GEADR),ÿl(SProvision.GEADR),ÿl(SProvisionEU.GEADR)
ÿµÿÁGesellschaft.GEADR
ÿqÿÿ
ÿ’ÿÉ
ÿ’ÿ¡
ÿ¡opt1%ÿ1ÿp
ÿÊÿiÿŸ"Umsatzvorausberechnung fr Gesellschaften",1,1
ÿÉÿòGesellschaft.GEADR,&|10VAnzahlVor.GEADRÿU"Anzahl"ÿô;SBewertung.GEADR,SBewertungEU.GEADR,SVolumen.GEADR,SVolumenEU.GEADR,
SBeitragBRU.GEADR,SBeitragBRUEU.GEADR,SBeitragNET.GEADR,SBeitragNETEU.GEADR,SVSumme.GEADR,SVSummeEU.GEADR,SProvision.GEADR,
SProvisionEU.GEADR
ÿÁÿl(VAnzahlVor.GEADR),ÿl(SBewertung.GEADR),ÿl(SBewertungEU.GEADR),ÿl(SVolumen.GEADR),ÿl(SVolumenEU.GEADR),
ÿl(SBeitragBRU.GEADR),ÿl(SBeitragBRUEU.GEADR),ÿl(SBeitragNET.GEADR),ÿl(SBeitragNETEU.GEADR),ÿl(SVSumme.GEADR),
ÿl(SVSummeEU.GEADR),ÿl(SProvision.GEADR),ÿl(SProvisionEU.GEADR)
ÿµÿÁGesellschaft.GEADR
ÿqÿh
ÿ’ÿÉ
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡opt%ÿ1ÿp
ÿ¡opt1%ÿ0ÿp
ÿÊÿiÿŸ"erwartete Ums„tze sortiert nach Gesellschaften/Sparten",1,1
ÿÉÿò&20Gesellschaft.STATIST3ÿô;&20Sparte.STATIST3ÿô;&[10JahrMonat.STATIST3,&|15SBewertung.STATIST3ÿU"Summe BW"
ÿô;&|15SBewertungEU.STATIST3ÿU"Summe BWEU"ÿô;&|15SVolumen.STATIST3ÿô;&|15SVolumenEU.STATIST3ÿô;&15SBeitragBRU.STATIST3
ÿô;&15SBeitragBRUEU.STATIST3ÿô;&15SBeitragNET.STATIST3ÿô;&15SBeitragNETEU.STATIST3ÿô;&15SVSumme.STATIST3
ÿô;&15SVSummeEU.STATIST3ÿô;&15SProvision.STATIST3ÿô;&15SProvisionEU.STATIST3ÿô
ÿÁÿl(SBeitragBRU.STATIST3),ÿl(SBeitragBRUEU.STATIST3),ÿl(SBeitragNET.STATIST3),ÿl(SBeitragNETEU.STATIST3),ÿl(SVSumme.STATIST3),
ÿl(SVSummeEU.STATIST3),ÿl(SProvision.STATIST3),ÿl(SProvisionEU.STATIST3)ÿGesellschaft.STATIST3,ÿl(SBeitragBRU.STATIST3),
ÿl(SBeitragBRUEU.STATIST3),ÿl(SBeitragNET.STATIST3),ÿl(SBeitragNETEU.STATIST3),ÿl(SVSumme.STATIST3),ÿl(SVSummeEU.STATIST3),
ÿl(SProvision.STATIST3),ÿl(SProvisionEU.STATIST3)
ÿµÿÁGesellschaft.STATIST3,Sparte.STATIST3,JahrMonat.STATIST3
ÿqÿÿ
ÿ’ÿÉ
ÿ’ÿ¡
ÿ¡opt1%ÿ1ÿp
ÿÊÿiÿŸ"erwartete Ums„tze sortiert nach Gesellschaften/Sparten",1,1
ÿÉÿò&20Gesellschaft.STATIST3ÿô;&20Sparte.STATIST3ÿô;&[10JahrMonat.STATIST3,&|15SBewertung.STATIST3ÿU"Summe BW"
ÿô;&|15SBewertungEU.STATIST3ÿU"Summe BWEU"ÿô;&|15SVolumen.STATIST3ÿô;&|15SVolumenEU.STATIST3ÿô;&15SBeitragBRU.STATIST3
ÿô;&15SBeitragBRUEU.STATIST3ÿô;&15SBeitragNET.STATIST3ÿô;&15SBeitragNETEU.STATIST3ÿô;&15SVSumme.STATIST3
ÿô;&15SVSummeEU.STATIST3ÿô;&15SProvision.STATIST3ÿô;&15SProvisionEU.STATIST3ÿô
ÿÁÿl(SBeitragBRU.STATIST3),ÿl(SBeitragBRUEU.STATIST3),ÿl(SBeitragNET.STATIST3),ÿl(SBeitragNETEU.STATIST3),ÿl(SVSumme.STATIST3),
ÿl(SVSummeEU.STATIST3),ÿl(SProvision.STATIST3),ÿl(SProvisionEU.STATIST3)ÿGesellschaft.STATIST3,ÿl(SBeitragBRU.STATIST3),
ÿl(SBeitragBRUEU.STATIST3),ÿl(SBeitragNET.STATIST3),ÿl(SBeitragNETEU.STATIST3),ÿl(SVSumme.STATIST3),ÿl(SVSummeEU.STATIST3),
ÿl(SProvision.STATIST3),ÿl(SProvisionEU.STATIST3)
ÿµÿÁGesellschaft.STATIST3,Sparte.STATIST3,JahrMonat.STATIST3
ÿqÿh
ÿ’ÿÉ
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡opt%ÿ2ÿp
ÿ¡opt1%ÿ0ÿp
ÿÊÿiÿŸ"Umsatzvorausberechnung fr Sparten",1,1
ÿÉ&20Sparte.SPARTENÿô;&|6VAnzahlVor.SPARTENÿU"Anzahl"ÿô;SBewertung.SPARTEN,SBewertungEU.SPARTEN,SVolumen.SPARTEN,
SVolumenEU.SPARTEN,SBeitragBRU.SPARTEN,SBeitragBRUEU.SPARTEN,SBeitragNET.SPARTEN,SBeitragNETEU.SPARTEN,SVSumme.SPARTEN,
SVSummeEU.SPARTEN,SProvision.SPARTEN,SProvisionEU.SPARTEN
ÿÁÿl(VAnzahlVor.SPARTEN),ÿl(SBewertung.SPARTEN),ÿl(SBewertungEU.SPARTEN),ÿl(SVolumen.SPARTEN),ÿl(SVolumenEU.SPARTEN),
ÿl(SBeitragBRU.SPARTEN),ÿl(SBeitragBRUEU.SPARTEN),ÿl(SBeitragNET.SPARTEN),ÿl(SBeitragNETEU.SPARTEN),ÿl(SVSumme.SPARTEN),
ÿl(SVSummeEU.SPARTEN),ÿl(SProvision.SPARTEN),ÿl(SProvisionEU.SPARTEN)
ÿµÿÁSparte.SPARTEN
ÿqÿÿ
ÿ’ÿÉ
ÿ’ÿ¡
ÿ¡opt1%ÿ1ÿp
ÿÊÿiÿŸ"Umsatzvorausberechnung fr Sparten",1,1
ÿÉ&20Sparte.SPARTENÿô;&|6VAnzahlVor.SPARTENÿU"Anzahl"ÿô;SBewertung.SPARTEN,SBewertungEU.SPARTEN,SVolumen.SPARTEN,
SVolumenEU.SPARTEN,SBeitragBRU.SPARTEN,SBeitragBRUEU.SPARTEN,SBeitragNET.SPARTEN,SBeitragNETEU.SPARTEN,SVSumme.SPARTEN,
SVSummeEU.SPARTEN,SProvision.SPARTEN,SProvisionEU.SPARTEN
ÿÁÿl(VAnzahlVor.SPARTEN),ÿl(SBewertung.SPARTEN),ÿl(SBewertungEU.SPARTEN),ÿl(SVolumen.SPARTEN),ÿl(SVolumenEU.SPARTEN),
ÿl(SBeitragBRU.SPARTEN),ÿl(SBeitragBRUEU.SPARTEN),ÿl(SBeitragNET.SPARTEN),ÿl(SBeitragNETEU.SPARTEN),ÿl(SVSumme.SPARTEN),
ÿl(SVSummeEU.SPARTEN),ÿl(SProvision.SPARTEN),ÿl(SProvisionEU.SPARTEN)
ÿµÿÁSparte.SPARTEN
ÿqÿh
ÿ’ÿÉ
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡opt%ÿ3ÿp
ÿ¡opt1%ÿ0ÿp
ÿÊÿiÿŸ"šbersicht der Vorausberechnungen fr Produkte",1,1
ÿÉ&40GesSpa.VPRODUKTÿU"Gesellschaft/Sparte"ÿô;&|10VAnzahlVor.VPRODUKTÿU"Anzahl"ÿô;SBewertung.VPRODUKTÿô;SBewertungEU.VPRODUKT
ÿô;SVolumen.VPRODUKTÿô;SVolumenEU.VPRODUKTÿô;SBeitragBRU.VPRODUKTÿô;SBeitragBRUEU.VPRODUKTÿô;SBeitragNET.VPRODUKT
ÿô;SBeitragNETEU.VPRODUKTÿô;SVSumme.VPRODUKTÿô;SVSummeEU.VPRODUKTÿô;SProvision.VPRODUKTÿô;SProvisionEU.VPRODUKTÿô
ÿÁÿl(VAnzahlVor.VPRODUKT),ÿl(SBewertung.VPRODUKT),ÿl(SBewertungEU.VPRODUKT),ÿl(SVolumen.VPRODUKT),ÿl(SVolumenEU.VPRODUKT),
ÿl(SBeitragBRU.VPRODUKT),ÿl(SBeitragBRUEU.VPRODUKT),ÿl(SBeitragNET.VPRODUKT),ÿl(SBeitragNETEU.VPRODUKT),ÿl(SVSumme.VPRODUKT),
ÿl(SVSummeEU.VPRODUKT),ÿl(SProvision.VPRODUKT),ÿl(SProvisionEU.VPRODUKT)
ÿµÿÁGesSpa.VPRODUKT
ÿqÿÿ
ÿ’ÿÉ
ÿ’ÿ¡
ÿ¡opt1%ÿ1ÿp
ÿÊÿiÿŸ"šbersicht der Vorausberechnungen fr Produkte",1,1
ÿÉ&40GesSpa.VPRODUKTÿU"Gesellschaft/Sparte"ÿô;&|10VAnzahlVor.VPRODUKTÿU"Anzahl"ÿô;SBewertung.VPRODUKTÿô;SBewertungEU.VPRODUKT
ÿô;SVolumen.VPRODUKTÿô;SVolumenEU.VPRODUKTÿô;SBeitragBRU.VPRODUKTÿô;SBeitragBRUEU.VPRODUKTÿô;SBeitragNET.VPRODUKT
ÿô;SBeitragNETEU.VPRODUKTÿô;SVSumme.VPRODUKTÿô;SVSummeEU.VPRODUKTÿô;SProvision.VPRODUKTÿô;SProvisionEU.VPRODUKTÿô
ÿÁÿl(VAnzahlVor.VPRODUKT),ÿl(SBewertung.VPRODUKT),ÿl(SBewertungEU.VPRODUKT),ÿl(SVolumen.VPRODUKT),ÿl(SVolumenEU.VPRODUKT),
ÿl(SBeitragBRU.VPRODUKT),ÿl(SBeitragBRUEU.VPRODUKT),ÿl(SBeitragNET.VPRODUKT),ÿl(SBeitragNETEU.VPRODUKT),ÿl(SVSumme.VPRODUKT),
ÿl(SVSummeEU.VPRODUKT),ÿl(SProvision.VPRODUKT),ÿl(SProvisionEU.VPRODUKT)
ÿµÿÁGesSpa.VPRODUKT
ÿqÿh
ÿ’ÿÉ
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿwVorausList0310200101
 ÿ’ÿÿ


 '*******************************************************************************************************************
 '*                        E N D E    V O R A U S B E R E C H N U N G                                               *
 '*******************************************************************************************************************
 


 '*******************************************************************************************************************
 '*                                   SUMMENLISTE PRODUKTION                                                        *
 '*******************************************************************************************************************

ÿÿSummAlleAgent()
 ÿ¡PrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
dat$ÿ"BUCHUNG"
 ÿ^
dat$ÿ"BUCHUNG1"
 ÿ’ÿ¡
 ÿƒDFile(3,dat$ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"maadrgru"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\"ÿGADRDat$ÿ_fpw$)
 ÿ¡disabled%("PROVISIONSLISTE")ÿpÿ’ÿÿ
 ÿƒDFile(3,"summe1"ÿ_fpw$)
ÿ×dlg1 ÿUDialog
ÿ×control ÿUDialogControl 
 alle$ÿ"TRUE"
 ÿ¡gasp%ÿp
ÿ¡workstation%ÿ0ÿp
ÿÂ"M”chten sie die letzte erzeugte Summenliste erneut ausgeben?","",130,req0%
ÿ^
req0%ÿ0
ÿ’ÿ¡
 ÿ^
ÿÂ"M”chten sie die letzte erzeugte Summenliste erneut ausgeben?","",130,req0%
 ÿ’ÿ¡
 ÿ¡req0%ÿ1ÿpÿwsu260120001
 ÿ½ REQUEST "Summenliste fr eine einzelne Agentur (Button JA)?","Summenliste fr alle Agenturen (Button NEIN)?",130,req%
 opt%ÿ1
 
Superbase.Dialogs.Add("Dialogname")
ÿÊdlg1 ÿSuperbase.Dialogs.Dialogname
dlg1.Move(0,0,150,73)
dlg1.Captionÿ"Art der Summenliste"
dlg1.FontNameÿ"MS Sans Serif"
dlg1.FontSizeÿ8
 
ÿÊcontrol ÿdlg1.Add("DialogFrame1","DialogFrame")
control.Move(2,8,147,44)
control.Captionÿ" W„hlen Sie eine Option "
 
ÿÊcontrol ÿdlg1.Add("DialogOptionButton1","DialogOptionButton")
control.Move(6,20,141,10)
control.Captionÿ"Summenliste fr eine einzelne Agentur"
control.Bind("opt%")
control.ValueOnÿ1
	ÿÊcontrol ÿdlg1.Add("DialogOptionButton2","DialogOptionButton")
	control.Move(6,32,141,9)
	control.Captionÿ"Summenliste fr alle Agenturen"
	control.Bind("opt%")
	control.ValueOnÿ2
 
 
 
ÿÊcontrol ÿdlg1.Add("DialogCommandButton1","DialogCommandButton")
control.Move(49,54,43,16)
control.Defaultÿ1
control.Captionÿ"OK"
control.ReturnValueÿ1
 
ÿñ"Dialogname",req%
ÿ¾ÿñ"Dialogname"
ÿ¡opt%ÿ1ÿp
req%ÿ1
ÿ^
req%ÿ0
ÿ’ÿ¡
 ÿ¡req%ÿ1ÿpalle$ÿ""
 ÿ¾ÿaÿ™"summe1"
 ÿßÿe
 ÿÊÿË"Ausgabe wird vorbereitet..."
 allProv$ÿ"n"
 ÿ‰ÿñ"Konto1",0,0,221,165,title$,"MS Sans Serif",8
 ÿ|ÿñ"Konto1",9,6,7,24,22,2
 ÿ|ÿñ"Konto1",5,34,8,170,9,0,"Provisionsliste:"
 ÿ|ÿñ"Konto1",4,34,14,176,5,0,""
 ÿ|ÿñ"Konto1",5,34,22,175,16,0,"Bitte geben Sie ein, fr welchen Buchungszeitraum Sie eine šbersicht wnschen."
 ÿ|ÿñ"Konto1",5,34,40,175,32,0,"Wenn Sie keine Angaben zum Buchungszeitraum eintragen, werden alle Provisionen bzw. die Provisionen des vorgegebenen Zeitraumes aufgelistet."
 ÿ|ÿñ"Konto1",5,34,80,12,8,0,"von"
 ÿ|ÿñ"Konto1",6,53,79,45,11,0,0,von$,10
 ÿ|ÿñ"Konto1",5,102,80,12,8,0,"bis"
 ÿ|ÿñ"Konto1",6,116,79,45,11,0,0,bis$,10
 ÿ½ ADD DIALOG "Konto1",2,34,97,148,11,0,"alle berechneten Provisionen einbeziehen","j","n",allProv$
 ÿ½ ADD DIALOG "Konto1",5,44,108,167,25,0,"(es werden auch die Provisionen angezeigt, die wegen fehlender Zahlungsbeitr„ge in der Mahnlist sind)"
 ÿ|ÿñ"Konto1",1,50,144,55,15,1,"&Weiter",1,1
 ÿ|ÿñ"Konto1",1,110,144,55,15,0,"&Abbruch",0,0
 ÿñ"Konto1",req%
 ÿ¾ÿñ"Konto1"
 ÿßÿe
 
 ÿ¡req%ÿ1ÿp
ÿßÿe
ÿ¡von$ÿ""ÿpvondat$ÿ"1.1.1980"ÿ^vondat$ÿvon$
ÿ¡bis$ÿ""ÿpbisdat$ÿÿ(ÿQ,"0d.mm.yyyy")ÿ^bisdat$ÿbis$
ÿ™"maadr"
ÿ£codema.maadr
ÿ×VCodeMA%(ÿA("MAADR"))
ÿ×VAgentur$(ÿA("MAADR"))
ÿÉÿ`
ÿ¡alle$ÿ""ÿp
codema%ÿ0
codema%ÿGetCodeMA%(0,Workstation%)
ÿ¡codema%ÿ0ÿp
ÿÉÿ`ÿ™"maadr"ÿ£codema.maadr
ÿÉÿ¥codema%ÿ™"maadr"ÿ£codema.maadr
VCodeMA%(0)ÿcodema%
VAgentur$(0)ÿNachname.maadrÿ", "ÿVorname.maadrÿ", "ÿAgenturnr.maadr
ÿ^
ÿƒFehler("Es wurde keine Agentur ausgew„hlt!","")
ÿ’ÿÿ
ÿ’ÿ¡
ÿ’ÿ¡
i%ÿ0
ÿØÿOÿB("maadr")ÿalle$ÿ"TRUE"
ÿ¡klotz$ÿ"TRUE"ÿp
ÿ¡ÿ+(nachname.maadr,3)ÿ"***"ÿp
	ÿ¡gasp%ÿworkstation%ÿ0ÿp
ÿ¡workstation.maadrÿworkstation%ÿp
VCodeMA%(i%)ÿcodema.maadr
VAgentur$(i%)ÿNachname.maadrÿ", "ÿVorname.maadrÿ", "ÿAgenturnr.maadr
i%ÿi%ÿ1
ÿ’ÿ¡
	ÿ^
VCodeMA%(i%)ÿcodema.maadr
VAgentur$(i%)ÿNachname.maadrÿ", "ÿVorname.maadrÿ", "ÿAgenturnr.maadr
i%ÿi%ÿ1
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡gasp%ÿworkstation%ÿ0ÿp
	ÿ¡workstation.maadrÿworkstation%ÿp
VCodeMA%(i%)ÿcodema.maadr
VAgentur$(i%)ÿNachname.maadrÿ", "ÿVorname.maadrÿ", "ÿAgenturnr.maadr
i%ÿi%ÿ1
	ÿ’ÿ¡
ÿ^
	VCodeMA%(i%)ÿcodema.maadr
	VAgentur$(i%)ÿNachname.maadrÿ", "ÿVorname.maadrÿ", "ÿAgenturnr.maadr
	i%ÿi%ÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿÉÿ±ÿ™"maadr"ÿ£codema.maadr
ÿÙ
ÿ™dat$
ÿ½ INDEX VTCodema.dat$
ÿ£Codema.dat$
ÿÉÿ`
 
ÿ½ Eigengesch„ft
ÿ›j%ÿ0ÿqi%ÿ1
codema%ÿVCodeMA%(j%)
ÿ½ IF codema% = 189 THEN CALL Fehler("F","")
ÿÊÿË"Bearbeite Agentur "ÿVAgentur$(j%)
ÿ™dat$
ÿÉÿ`ÿ™dat$
ÿ½ SELECT KEY codema% FILE dat$ INDEX vtcodema.dat$
ÿÉÿ¥codema%ÿ™dat$ÿ£codema.dat$
buanz%ÿ0
zusatzanz%ÿ0
SummeEinh%ÿ0
SummeFEinh%ÿ0
SummeDM%ÿ0
SummeEu%ÿ0
SummeSREU%ÿ0
SummeSR%ÿ0
SummeBewert%ÿ0
SummeVolumen%ÿ0
 
SummeFDM%ÿ0
SummeFEu%ÿ0
SummeFSREU%ÿ0
SummeFSR%ÿ0
SummeFBewert%ÿ0
SummeFVolumen%ÿ0
 
SummeZusatz%ÿ0
ÿ½ WHILE NOT EOF (dat$) AND vtcodema.dat$ = codema%
ÿØÿOÿB(dat$)ÿcodema.dat$ÿcodema%
ÿÊÿË"Bearbeite Agentur "ÿVAgentur$(j%)ÿ" Buchungssatz: "ÿÿ(buanz%,",99999999.")
ÿ¡codema.dat$ÿcodema%ÿdatum.dat$ÿvondat$ÿdatum.dat$ÿ	bisdat$ÿp
	buanz%ÿbuanz%ÿ1
	ÿ¡codevt.dat$ÿ
1ÿp
zusatzanz%ÿzusatzanz%ÿ1
SummeZusatz%ÿSummeZusatz%ÿBetrag.dat$
	ÿ’ÿ¡
	
	ÿ¡vtcodema.dat$ÿcodema%ÿp
SummeDM%ÿSummeDM%ÿBetrag.dat$
SummeEinh%ÿSummeEinh%ÿeinheiten.dat$
SummeSR%ÿSummeSR%ÿsr.dat$
SummeBewert%ÿSummeBewert%ÿBewertungssumme.dat$
SummeVolumen%ÿSummeVolumen%ÿVolumen.dat$
SummeEu%ÿSummeEu%ÿBetragEu.dat$
SummeSREU%ÿSummeSREu%ÿSREU.dat$
	ÿ^
ÿ¡codevt.dat$ÿ0ÿp
SummeFDM%ÿSummeFDM%ÿBetrag.dat$
SummeFEinh%ÿSummeFEinh%ÿeinheiten.dat$
SummeFSR%ÿSummeSR%ÿsr.dat$
SummeFBewert%ÿSummeBewert%ÿBewertungssumme.dat$
SummeFVolumen%ÿSummeVolumen%ÿVolumen.dat$
SummeFEu%ÿSummeEu%ÿBetragEu.dat$
SummeFSREU%ÿSummeSREu%ÿSREU.dat$
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿÉÿ±ÿ™dat$
ÿÙ
ÿ™"Summe1"
ÿ
datum.summe1ÿÿQ
codesu.summe1ÿÿI("Summe1",1)
codema.summe1ÿcodema%
vtAgentur.summe1ÿVAgentur$(j%)
SummeDM.summe1ÿSummeDM%
SummeEinh.summe1ÿSummeEinh%
SummeSR.summe1ÿSummeSR%
SummeBewert.summe1ÿSummeBewert%
SummeVolumen.summe1ÿSummeVolumen%
SummeEu.summe1ÿSummeEu%
SummeSREu.summe1ÿSummeSREU%
 
SummeFDM.summe1ÿSummeFDM%
SummeFEinh.summe1ÿSummeFEinh%
SummeFSR.summe1ÿSummeFSR%
SummeFBewert.summe1ÿSummeFBewert%
SummeFVolumen.summe1ÿSummeFVolumen%
SummeFEu.summe1ÿSummeFEu%
SummeFSREu.summe1ÿSummeFSREU%
 
SummeZus.summe1ÿSummeZusatz%
AnzZus.summe1ÿzusatzanz%
AnzBu.summe1ÿbuanz%
von.summe1ÿvondat$
bis.summe1ÿbisdat$
ÿÌÿ™"Summe1"
 
ÿ±j%
 
su260120001: 
ÿ½ REQUEST "Summenliste Einheiten drucken(Button JA)?","Summenliste mit allen Angaben drucken (Button NEIN)?",130,req1%
opt%ÿ1
Superbase.Dialogs.Add("Dialogname")
ÿÊdlg1 ÿSuperbase.Dialogs.Dialogname
dlg1.Move(0,0,150,73)
dlg1.Captionÿ"Art der Summenliste"
dlg1.FontNameÿ"MS Sans Serif"
dlg1.FontSizeÿ8
 
ÿÊcontrol ÿdlg1.Add("DialogFrame1","DialogFrame")
control.Move(2,8,147,44)
control.Captionÿ" W„hlen Sie eine Option "
 
ÿÊcontrol ÿdlg1.Add("DialogOptionButton1","DialogOptionButton")
control.Move(6,20,141,10)
control.Captionÿ"Summenliste Einheiten drucken"
control.Bind("opt%")
control.ValueOnÿ1
 
ÿÊcontrol ÿdlg1.Add("DialogOptionButton2","DialogOptionButton")
control.Move(6,32,141,9)
control.Captionÿ"Summenliste mit allen Angaben drucken"
control.Bind("opt%")
control.ValueOnÿ2
 
 
 
ÿÊcontrol ÿdlg1.Add("DialogCommandButton1","DialogCommandButton")
control.Move(49,54,43,16)
control.Defaultÿ1
control.Captionÿ"OK"
control.ReturnValueÿ1
 
ÿñ"Dialogname",req%
ÿ¾ÿñ"Dialogname"
ÿ¡opt%ÿ1ÿp
req1%ÿ1
ÿ^
req1%ÿ0
ÿ’ÿ¡



ÿ¡req1%ÿ1ÿp
ÿƒPRep("SUMME1")
ÿ€ÿÁ
ÿÊÿÁÿí"H_REPORT"
ÿ¶ÿÁÿí
ÿ’ÿÁ
vondat1$ÿvondat$
bisdat1$ÿbisdat$
ÿ}ÿÁ
ÿÊÿÁÿí"F_REPORT"
ÿ¶ÿÁÿí
ÿ’ÿÁ
 
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
 
ÿš1
ÿÊÿÁÿí"F_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿš
 
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿ³ÿ_ÿwErrorHandler
ÿÊÿiÿe
ÿÊÿiÿáÿe
ÿÊÿ`ÿíÿŸÿe
ÿÉ;
ÿĞcodema.summe1ÿ0
ÿµÿÁSummeEinh.SUMME1ÿ[
ÿqÿ~
ÿ^
ÿƒPRep("SUMME2")
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
vondat1$ÿvondat$
von%ÿÿ1(vondat1$)
bisdat1$ÿbisdat$
bis%ÿÿ1(bisdat$)
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿ³ÿ_ÿwendsu1100920031
ÿÊÿiÿe
ÿÊÿiÿáÿe
ÿÉ;
ÿĞcodema.summe1ÿ0
ÿµÿÁVTAgentur.SUMME1
ÿqÿ~
ÿ’ÿ¡
 
 ÿ’ÿ¡
endsu1100920031: 
 ÿ³ÿ_ÿwErrorHandler
 ÿßÿ³
 ÿ’ÿÿ



 '*******************************************************************************************************************
 '*                                   Einheiten-LISTE PRODUKTION                                                    *
 '*******************************************************************************************************************
 
ÿÿSummEinhAgent()
 ÿ¡PrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
dat$ÿ"KVERTRAG"
 ÿ^
dat$ÿ"KVERTRAG"
 ÿ’ÿ¡
 ÿƒDFile(3,dat$ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"maadrgru"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\"ÿGADRDat$ÿ_fpw$)
 ÿ¡disabled%("PROVISIONSLISTE")ÿpÿ’ÿÿ
 ÿƒDFile(3,"summe1"ÿ_fpw$)
ÿ×dlg1 ÿUDialog
ÿ×control ÿUDialogControl 
 alle$ÿ"TRUE"
 ÿ¡gasp%ÿ0ÿp
ÿ¡workstation%ÿ0ÿp
ÿÂ"M”chten sie die letzte erzeugte Liste erneut ausgeben?","",130,req0%
ÿ^
req0%ÿ0
ÿ’ÿ¡
 ÿ^
ÿ¡GASP%ÿÿ1ÿworkstation%ÿ0ÿp
req0%ÿ0
ÿ^
ÿÂ"M”chten sie die letzte erzeugte Liste erneut ausgeben?","",130,req0%
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡req0%ÿ1ÿpÿwsu190920021
 ÿ½ REQUEST "Liste fr eine einzelne Agentur (Button JA)?","Liste fr alle Agenturen (Button NEIN)?",130,req%
 
opt%ÿ1
Superbase.Dialogs.Add("Dialogname")
ÿÊdlg1 ÿSuperbase.Dialogs.Dialogname
dlg1.Move(0,0,150,73)
dlg1.Captionÿ"Einheitenliste"
dlg1.FontNameÿ"MS Sans Serif"
dlg1.FontSizeÿ8
 
ÿÊcontrol ÿdlg1.Add("DialogFrame1","DialogFrame")
control.Move(2,8,147,44)
control.Captionÿ" W„hlen Sie eine Option "
 
ÿÊcontrol ÿdlg1.Add("DialogOptionButton1","DialogOptionButton")
control.Move(6,20,141,10)
control.Captionÿ"Liste fr eine einzelne Agentur"
control.Bind("opt%")
control.ValueOnÿ1
 
ÿÊcontrol ÿdlg1.Add("DialogOptionButton2","DialogOptionButton")
control.Move(6,32,141,9)
control.Captionÿ"Liste fr alle Agenturen"
control.Bind("opt%")
control.ValueOnÿ2
 
 
 
ÿÊcontrol ÿdlg1.Add("DialogCommandButton1","DialogCommandButton")
control.Move(49,54,43,16)
control.Defaultÿ1
control.Captionÿ"OK"
control.ReturnValueÿ1
 
ÿñ"Dialogname",req%
ÿ¾ÿñ"Dialogname"
ÿ¡opt%ÿ1ÿp
req%ÿ1
ÿ^
req%ÿ0
ÿ’ÿ¡

 ÿ¡req%ÿ1ÿpalle$ÿ""
 ÿ¾ÿaÿ™"summe1"
 ÿßÿe
 ÿÊÿË"Ausgabe wird vorbereitet..."
 allProv$ÿ"n"
 opt1%ÿ1
 pab$ÿ"n"
 ÿ‰ÿñ"Konto1",0,0,241,185,title$,"MS Sans Serif",8
 ÿ|ÿñ"Konto1",9,6,7,24,22,2
 ÿ|ÿñ"Konto1",5,34,8,170,9,0,"Eigen-Einheitenliste:"
 ÿ|ÿñ"Konto1",4,34,14,176,5,0,""
 ÿ|ÿñ"Konto1",5,34,22,175,16,0,"Bitte geben Sie ein, fr welchen Antrags-Zeitraum Sie eine šbersicht wnschen."
 ÿ|ÿñ"Konto1",5,34,40,175,32,0,"es werden die Vertr„ge des xy-Zeitraums bercksichtigt, die zum Ende des xy-Zeitraums noch nicht storniert waren"
 ÿ|ÿñ"Konto1",5,34,80,12,8,0,"von"
 ÿ|ÿñ"Konto1",6,53,79,45,11,0,0,von$,10
 ÿ|ÿñ"Konto1",5,102,80,12,8,0,"bis"
 ÿ|ÿñ"Konto1",6,116,79,45,11,0,0,bis$,10
 ÿ½ ADD DIALOG "Konto1",2,34,97,148,11,0,"alle berechneten Provisionen einbeziehen","j","n",allProv$
 ÿ½ ADD DIALOG "Konto1",5,44,108,167,25,0,"(es werden auch die Provisionen angezeigt, die wegen fehlender Zahlungsbeitr„ge in der Mahnlist sind)"
 ÿ|ÿñ"Konto1",4,4,99,210,38,0,"xy-Zeitraum"
 ÿ|ÿñ"Konto1",3,6,109,150,12,0,"alle bis heute nicht gekndigten Vertr„ge",1,opt1%
 ÿ|ÿñ"Konto1",3,6,119,200,12,0,"alle bis Antrags-Zeitraum Ende nicht gekndigten Vertr„ge",2,opt1%
 ÿ½ ADD DIALOG "Konto1",3,6,131,200,12,0,"NUR Vertr„ge, die an die Provisionsabrechnung bergeben wurden",2,opt%
 ÿ|ÿñ"Konto1",2,6,141,230,11,0,"NUR Vertr„ge, die an die Provisionsabrechnung bergeben wurden","j","n",pab$
 
 ÿ|ÿñ"Konto1",1,50,164,55,15,1,"&Weiter",1,1
 ÿ|ÿñ"Konto1",1,110,164,55,15,0,"&Abbruch",0,0
 ÿñ"Konto1",req%
 ÿ¾ÿñ"Konto1"
 ÿßÿe
 
 ÿ¡req%ÿ1ÿp
ÿßÿe
ÿ¡von$ÿ""ÿpvondat$ÿ"1.1.1980"ÿ^vondat$ÿvon$
ÿ¡bis$ÿ""ÿpbisdat$ÿÿ(ÿQ,"0d.mm.yyyy")ÿ^bisdat$ÿbis$
ÿ™"maadr"
ÿ£codema.maadr
ÿ×VCodeMA%(ÿA("MAADR"))
ÿ×VAgentur$(ÿA("MAADR"))
ÿÉÿ`
ÿ¡alle$ÿ""ÿp
codema%ÿ0
codema%ÿGetCodeMA%(0,Workstation%)
ÿ¡codema%ÿ0ÿp
ÿÉÿ¥codema%ÿ™"maadr"ÿ£codema.maadr
VCodeMA%(0)ÿcodema%
VAgentur$(0)ÿNachname.maadrÿ", "ÿVorname.maadrÿ", "ÿAgenturnr.maadr
ÿ^
ÿƒFehler("Es wurde keine Agentur ausgew„hlt!","")
ÿ’ÿÿ
ÿ’ÿ¡
ÿ’ÿ¡
i%ÿ0
ÿØÿOÿB("maadr")ÿalle$ÿ"TRUE"
ÿ¡klotz$ÿ"TRUE"ÿp
ÿ¡ÿ+(nachname.maadr,3)ÿ"***"ÿp
	ÿ¡gasp%ÿworkstation%ÿ0ÿp
ÿ¡workstation.maadrÿworkstation%ÿp
VCodeMA%(i%)ÿcodema.maadr
VAgentur$(i%)ÿNachname.maadrÿ", "ÿVorname.maadrÿ", "ÿAgenturnr.maadr
i%ÿi%ÿ1
ÿ’ÿ¡
	ÿ^
VCodeMA%(i%)ÿcodema.maadr
VAgentur$(i%)ÿNachname.maadrÿ", "ÿVorname.maadrÿ", "ÿAgenturnr.maadr
i%ÿi%ÿ1
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ¡gasp%ÿworkstation%ÿ0ÿp
	ÿ¡workstation.maadrÿworkstation%ÿp
VCodeMA%(i%)ÿcodema.maadr
VAgentur$(i%)ÿNachname.maadrÿ", "ÿVorname.maadrÿ", "ÿAgenturnr.maadr
i%ÿi%ÿ1
	ÿ’ÿ¡
ÿ^
	VCodeMA%(i%)ÿcodema.maadr
	VAgentur$(i%)ÿNachname.maadrÿ", "ÿVorname.maadrÿ", "ÿAgenturnr.maadr
	i%ÿi%ÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿÉÿ±ÿ™"maadr"ÿ£codema.maadr
ÿÙ
ÿ™dat$
ÿ½ INDEX VTCodema.dat$
ÿ£Codema.dat$
ÿÉÿ`
 
ÿ½ Eigengesch„ft
ÿ›j%ÿ0ÿqi%ÿ1
codema%ÿVCodeMA%(j%)
ÿ½ IF codema% = 189 THEN CALL Fehler("F","")
ÿÊÿË"Bearbeite Agentur "ÿVAgentur$(j%)
ÿ™dat$
ÿÉÿ`ÿ™dat$
ÿ½ SELECT KEY codema% FILE dat$ INDEX vtcodema.dat$
ÿÉÿ¥codema%ÿ™dat$ÿ£codema.dat$
buanz%ÿ0
zusatzanz%ÿ0
SummeEinh%ÿ0
SummeFEinh%ÿ0
SummeDM%ÿ0
SummeEu%ÿ0
SummeSREU%ÿ0
SummeSR%ÿ0
SummeBewert%ÿ0
SummeVolumen%ÿ0
 
SummeFDM%ÿ0
SummeFEu%ÿ0
SummeFSREU%ÿ0
SummeFSR%ÿ0
SummeFBewert%ÿ0
SummeFVolumen%ÿ0
 
SummeZusatz%ÿ0
ÿ½ WHILE NOT EOF (dat$) AND vtcodema.dat$ = codema%
dat$ÿ"KVERTRAG"
ÿ£Antragsdatum.kvertrag
ÿÉÿ`ÿ™"KVERTRAG"ÿ£Antragsdatum.kvertrag
ÿÉÿ¥vondat$ÿ™"KVERTRAG"ÿ£Antragsdatum.kvertrag
ÿ½ WHILE NOT EOF (dat$) AND codema.dat$ = codema% AND Antragsdatum.dat$ >= vondat$ AND Antragsdatum.dat$ <= bisdat$
ÿØÿOÿB(dat$)ÿAntragsdatum.dat$ÿvondat$ÿAntragsdatum.dat$ÿ	bisdat$
ÿÊÿË"Bearbeite Agentur "ÿVAgentur$(j%)ÿ" Datensatz: "ÿÿ(buanz%,",99999999.")
ÿ¡codema.dat$ÿcodema%ÿp
	ÿ½ IF vtcodema.dat$ = codema% THEN 
	ÿ¡codema.dat$ÿcodema%ÿp

ok%ÿ0

ÿ¡opt1%ÿ1ÿp
ÿ¡Kndigung.kvertragÿ0ÿKndigung.kvertragÿÿQÿpok%ÿÿ1

ÿ^
ÿ¡Kndigung.kvertragÿ0ÿKndigung.kvertragÿbisdat$ÿpok%ÿÿ1

ÿ’ÿ¡

ÿ¡pab$ÿ"j"ÿp
ÿ¡Proviab.KVERTRAGÿ0ÿp
ok%ÿÿ1
ÿ^
ok%ÿ0
ÿ’ÿ¡

ÿ’ÿ¡

ÿ¡Altvertrag.kvertragÿ"j"ÿpok%ÿ0

ÿ¡Fremdvertrag.kvertragÿ"j"ÿpok%ÿ0

ÿ¡CodeVStatus.kvertragÿ15ÿCodeVStatus.kvertragÿ16ÿCodeVStatus.kvertragÿ20ÿpok%ÿ0

ÿ¡ok%ÿÿ1ÿp
buanz%ÿbuanz%ÿ1
ÿ½ SummeDM% = SummeDM% + Beitrag.dat$
ÿÉÿæzw.kvertrag
ÿæ0
zw$ÿ"Zahlweise: Einmalig"
SummeDM%ÿSummeDM%ÿBeitrag.kvertrag
ÿæ1
zw$ÿ"Zahlweise: J„hrlich"
SummeDM%ÿSummeDM%ÿBeitrag.kvertrag
ÿæ4
zw$ÿ"Zahlweise: Viertelj„hrlich"
SummeDM%ÿSummeDM%ÿ4ÿBeitrag.kvertrag
ÿæ2
zw$ÿ"Zahlweise: Halbj„hrlich"
SummeDM%ÿSummeDM%ÿ2ÿBeitrag.kvertrag
ÿæ6
zw$ÿ"Zahlweise: 2monatlich"
SummeDM%ÿSummeDM%ÿ6ÿBeitrag.kvertrag
ÿæ12
zw$ÿ"Zahlweise: Monatlich"
SummeDM%ÿSummeDM%ÿ12ÿBeitrag.kvertrag
ÿ’ÿÉ
SummeEinh%ÿSummeEinh%ÿeinheiten.dat$
ÿ½ SummeSR% = SummeSR% + sr.dat$
SummeBewert%ÿSummeBewert%ÿBewertungssumme.dat$
SummeVolumen%ÿSummeVolumen%ÿVolumen.dat$
ÿ½ SummeEu% = SummeEu% + BetragEu.dat$
ÿ½ SummeSREU% = SummeSREu% + SREU.dat$

ÿ’ÿ¡
	ÿ^
ÿ½ SummeFDM% = SummeFDM% + Beitrag.dat$
ÿ½ SummeFEinh% = SummeFEinh% + einheiten.dat$
ÿ½ SummeFSR% = SummeSR% + sr.dat$
ÿ½ SummeFBewert% = SummeBewert% + Bewertungssumme.dat$
ÿ½ SummeFVolumen% = SummeVolumen% + Volumen.dat$
ÿ½ SummeFEu% = SummeEu% + BetragEu.dat$
ÿ½ SummeFSREU% = SummeSREu% + SREU.dat$
	ÿ’ÿ¡
ÿ’ÿ¡
ÿÉÿ±ÿ™"KVERTRAG"ÿ£Antragsdatum.kvertrag
ÿÙ
ÿ™"Summe1"
ÿ
datum.summe1ÿÿQ
codesu.summe1ÿÿI("Summe1",1)
codema.summe1ÿcodema%
vtAgentur.summe1ÿVAgentur$(j%)
SummeDM.summe1ÿSummeDM%
SummeEinh.summe1ÿSummeEinh%
SummeSR.summe1ÿSummeSR%
SummeBewert.summe1ÿSummeBewert%
SummeVolumen.summe1ÿSummeVolumen%
SummeEu.summe1ÿSummeEu%
SummeSREu.summe1ÿSummeSREU%
 
SummeFDM.summe1ÿSummeFDM%
SummeFEinh.summe1ÿSummeFEinh%
SummeFSR.summe1ÿSummeFSR%
SummeFBewert.summe1ÿSummeFBewert%
SummeFVolumen.summe1ÿSummeFVolumen%
SummeFEu.summe1ÿSummeFEu%
SummeFSREu.summe1ÿSummeFSREU%
 
SummeZus.summe1ÿSummeZusatz%
AnzZus.summe1ÿzusatzanz%
AnzBu.summe1ÿbuanz%
von.summe1ÿvondat$
bis.summe1ÿbisdat$
ÿÌÿ™"Summe1"
 
ÿ±j%
 
su190920021: 
ÿ½ REQUEST "Summenliste Eigen-Einheiten drucken(Button JA)?","Summenliste mit allen Angaben drucken (Button NEIN)?",130,req1%
opt%ÿ1
Superbase.Dialogs.Add("Dialogname")
ÿÊdlg1 ÿSuperbase.Dialogs.Dialogname
dlg1.Move(0,0,150,73)
dlg1.Captionÿ"Eigeneinheitenliste"
dlg1.FontNameÿ"MS Sans Serif"
dlg1.FontSizeÿ8
 
ÿÊcontrol ÿdlg1.Add("DialogFrame1","DialogFrame")
control.Move(2,8,147,44)
control.Captionÿ" W„hlen Sie eine Option "
 
ÿÊcontrol ÿdlg1.Add("DialogOptionButton1","DialogOptionButton")
control.Move(6,20,141,10)
control.Captionÿ"Summenliste Eigen-Einheiten drucken"
control.Bind("opt%")
control.ValueOnÿ1
 
ÿÊcontrol ÿdlg1.Add("DialogOptionButton2","DialogOptionButton")
control.Move(6,32,141,9)
control.Captionÿ"Summenliste mit allen Angaben drucken"
control.Bind("opt%")
control.ValueOnÿ2
 
 
 
ÿÊcontrol ÿdlg1.Add("DialogCommandButton1","DialogCommandButton")
control.Move(49,54,43,16)
control.Defaultÿ1
control.Captionÿ"OK"
control.ReturnValueÿ1
 
ÿñ"Dialogname",req%
ÿ¾ÿñ"Dialogname"
ÿ¡opt%ÿ1ÿp
req1%ÿ1
ÿ^
req1%ÿ0
ÿ’ÿ¡

ÿ¡req1%ÿ1ÿp
ÿƒPRep("SUMME1E")
ÿÁÿ³SummeEinh.SUMME1ÿU"sumeinh%",SummeBewert.SUMME1ÿU"sumbew%",SummeDM.SUMME1ÿU"sumbeitr%",AnzBu.SUMME1ÿU"sumanz%"
ÿ€ÿÁ
ÿÊÿÁÿí"H_REPORT"
ÿ¶ÿÁÿí
ÿ’ÿÁ
vondat1$ÿvondat$
bisdat1$ÿbisdat$
ÿ}ÿÁ
ÿÊÿÁÿí"F_REPORT"
ÿ¶ÿÁÿí
ÿ’ÿÁ
 
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
 
ÿš1
ÿÊÿÁÿí"F_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿš
 
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿ³ÿ_ÿwErrorHandler
ÿÊÿiÿe
ÿÊÿiÿáÿe
ÿÊÿ`ÿíÿŸÿe
ÿÉ;
ÿĞcodema.summe1ÿ0
ÿµÿÁSummeEinh.SUMME1ÿ[
ÿqÿ~
ÿ^
ÿƒPRep("SUMME2E")
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
vondat1$ÿvondat$
bisdat1$ÿbisdat$
ÿVTAgentur.SUMME1
ÿ}ÿVTAgentur.SUMME1
ÿÊÿÁÿí"F_VTAgentur.002"
ÿ¶ÿÁÿí
ÿ’ÿ
 
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿ³ÿ_ÿwErrorHandler
ÿÊÿiÿe
ÿÊÿiÿáÿe
ÿÉ;
ÿĞcodema.summe1ÿ0
ÿµÿÁVTAgentur.SUMME1
ÿqÿ~
ÿ’ÿ¡
 
 ÿ’ÿ¡
 ÿßÿ³
 ÿ’ÿÿ

 













ÿÿSpezPflege(Laufzeit%,GBeitrag%,provsp%)
ÿ¡Laufzeit%ÿPflegezeit.gekondÿp
	_day%ÿÿ3(letztePflege.KVERTRAG)
	_month%ÿÿ5(letztePflege.KVERTRAG)
	_year%ÿÿ6(letztePflege.KVERTRAG)
	ÿ¡_year%ÿ
1980ÿp
_year%ÿ1980
_day%ÿ1
_month%ÿ1
	ÿ’ÿ¡
 
ÿ½ 060597 Neu Pflegeprovis nach Zahlweisen
PflegeGez$ÿ"n"
ÿ¡PflegeNachZahlw.gekondÿ"n"ÿp
ÿ½ -- abh„ngig von Zahlungsweise im Vertrag --
ÿÉÿæZW.KVERTRAG
ÿæ1
_year%ÿ_year%ÿ1
ÿæ2
_month%ÿ_month%ÿ6
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
ÿæ4
_month%ÿ_month%ÿ3
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
ÿæ6
_month%ÿ_month%ÿ2
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
ÿæ12
_month%ÿ_month%ÿ1
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
ÿæ0
_year%ÿ2100
ÿ’ÿÉ
nextpfl%ÿÿ1(ÿ(_day%,"00")ÿ"."ÿÿ(_month%,"00")ÿ"."ÿÿ(_year%,"9999"))
ÿ½ 060597 kl„ren wozu ?
ÿ¡ZW.KVERTRAGÿ0ÿletzteProvi.KVERTRAGÿ
1ÿp
ÿ½ 150597
ÿ½ prov% = (((Beitrag.KVERTRAG * ZW.KVERTRAG) / 100) * PflegeProvi.gekond)
provsp%ÿ(((GBeitrag%)ÿ100)ÿProzente.spezkond)
PflegeGez$ÿ"j"
pflege%ÿ1
sr%ÿ0
Haftung%ÿ0
ÿ^
ÿ¡nextpfl%ÿ	cdate%ÿp
ÿ½ 150597
ÿ½ prov% = (((Beitrag.KVERTRAG * ZW.KVERTRAG) / 100) * PflegeProvi.gekond)
provsp%ÿ(((GBeitrag%)ÿ100)ÿProzente.spezkond)
PflegeGez$ÿ"j"
pflege%ÿ1
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ^
ÿ½ -- Abh„ngig von Zahlweise in GEKOND --
_month%ÿ_month%ÿPflegeZW.GEKOND
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
nextpfl%ÿÿ1(ÿ(_day%,"00")ÿ"."ÿÿ(_month%,"00")ÿ"."ÿÿ(_year%,"9999"))
ÿ¡nextpfl%ÿ	cdate%ÿp
provsp%ÿ(((GBeitrag%ÿZW.KVERTRAG)ÿ100)ÿProzente.spezkond))
PflegeGez$ÿ"j"
pflege%ÿ1
sr%ÿ0
Haftung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
ÿ½ 030697 IF PflegeGez$ = "j" THEN CALL RegProvis("Pflege: " + VS_Nr.kvertrag,codema%,prov%,sr%,Haftung%)
ÿ½ IF PflegeGez$ = "j" AND prov% <> 0 THEN CALL RegProvis("Pflege: " + VS_Nr.kvertrag,codema%,prov%,sr%,Haftung%,umrechnung.kvertrag,codew.kvertrag,waehrung.kvertrag)
	ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿÿ




 ÿ½ ************ AFSK-HandStornierung *********************
ÿÿAFSKHandStor(codevt%)
ÿÉÿ`ÿ™"KVFAEL"ÿ£codevt.kvfael
 
ÿÉÿ¥codevt%ÿáÿ™"KVFAEL"ÿ£codevt.kvfael
ÿÉÿ`ÿ™"MAADR"ÿ£codema.maadr
ÿÉÿ¥codema.kvertragÿ™"MAADR"ÿ£codema.maadr
GVTAgentur$ÿNachname.maadrÿ","ÿvorname.maadr
GVTCodema%ÿcodema.maadr
ÿ‰ÿñ"LOGIN",0,0,193,79,"Stornotext","MS Sans Serif",8
ÿ|ÿñ"LOGIN",4,0,0,193,58,0,""
ÿ|ÿñ"LOGIN",9,5,11,20,22,2
ÿ|ÿñ"LOGIN",5,33,11,139,9,0,"Bitte geben Sie hier "
ÿ|ÿñ"LOGIN",5,33,20,68,10,0,"den Stornotext ein."
ÿ|ÿñ"LOGIN",5,33,31,82,12,0,"Text: Storno wegen..."
ÿ|ÿñ"LOGIN",6,33,41,149,11,0,0,txt$,15
ÿ|ÿñ"LOGIN",1,38,61,50,15,1,"&OK",1,1
ÿ½ ADD DIALOG "LOGIN",1,89,61,50,15,0,"&Abbruch",0,0
ÿñ"LOGIN",req%
ÿ¾ÿñÿt
ÿ¡gez_Abschluá.kvfaelÿ"j"ÿp
ÿ½ es wurde Provision gezahlt
ÿ½ CALL Fehler("zu wenig gezahlter Beitrag","")

ÿÉÿ`ÿ™"buchung1"ÿ£codevt.buchung1
ÿÉÿ¥codevt.kvfaelÿ™"buchung1"ÿ£codevt.buchung1
ÿ½ 12112001
ÿ½ also beim rckbuchen máte zuerst die VMProv mit negativem Wert der Fa. 
ÿ½ gutgeschrieben werden und es máte der erste Minusbetrag auf pos Betrag 
ÿ½ gesetzt werden
ÿ½ dann die Buchungen der MA einsammeln und mit negativem Vorzeichen dazu 
ÿ½ Buchungssatz erstellen und in kvfael -> TgezProvAnz=0
ÿ½ 
ÿÉÿ`ÿ™"buchung1"ÿ£codebu.buchung1
ÿÉÿ¥codebu.kvfaelÿ™"buchung1"ÿ£codebu.buchung1
ÿ½ ma%=Firma
ma%ÿcodema.buchung1
ÿ×gez%(100,2)
ÿÉÿ`ÿ™"buchung1"ÿ£codevt.buchung1
ÿÉÿ¥codevt.kvfaelÿ™"buchung1"ÿ£codevt.buchung1
remark$ÿ"Storno wegen "ÿtxt$
i1211%ÿ0
ÿØÿOÿB("buchung1")ÿcodevt.buchung1ÿcodevt.kvfael
ÿ¡codema.buchung1ÿma%ÿp
gez%(i1211%,0)ÿcodema.buchung1
gez%(i1211%,1)ÿbetrag.buchung1
i1211%ÿi1211%ÿ1
ÿ’ÿ¡
ÿÉÿ±ÿ™"buchung1"ÿ£codevt.buchung1
ÿÙ
ÿÉÿ`ÿ™"buchung1"ÿ£codevt.buchung1
ÿÉÿ¥codevt.kvfaelÿ™"buchung1"ÿ£codevt.buchung1
ÿ½ CALL Fehler("Analyse auf zu stornierende Zahlungen wegen fehlendem Zahlungseingang!","")
ÿØÿOÿB("buchung1")ÿcodevt.buchung1ÿcodevt.kvfael
ÿ¡codema.buchung1ÿma%ÿerstz%ÿ0ÿp
ÿ¡buchungstext.buchung1ÿ"Erstz*"ÿbuchungstext.buchung1ÿ"*Erstz*"ÿp
provi%ÿvmprov.kvfael
sr%ÿ0
Haftung%ÿ0
datumz%ÿÿQ
f„lligkeit%ÿ0
euro1%ÿumrechnung.kvertrag
waehr1$ÿwaehrung.kvertrag
zein%ÿ0
remark2$ÿ""
gez_Abschluá.kvfaelÿ"n"
codebu.buchung1ÿ0
erledigt.kvfaelÿ"n"
abserledigt.kvfaelÿ"n"
TgezProvAnz.kvfaelÿ0
autokuend.kvfaelÿ"j"
ÿÌÿ™"KVFAEL"
ÿïÿYÿ™"KVFAEL"
ÿ½ remark$ = "Courtage " + VS_nr.kvertrag + " Storno"
remark$ÿ"Storno wegen "ÿtxt$
vertrprov%ÿ0
vsumC%ÿ0
vsumA%ÿ0
vsumPP%ÿ0
ÿƒStoRegProv(remark$,ma%,provi%,sr%,Haftung%,datumz%,f„lligkeit%,euro1%,codew%,waehr1$,zein%,remark2$)
erstz%ÿerstz%ÿ1
ÿ^
ÿ’ÿ¡
ÿ’ÿ¡
ÿÉÿ±ÿ™"buchung1"ÿ£codevt.buchung1
ÿÙ
ÿ¡i1211%ÿ0ÿp
ÿ½ remark$ = "Courtage " + VS_nr.kvertrag + " Storno"
remark$ÿ"Storno wegen "ÿtxt$
ÿ›i%ÿ0ÿqi1211%ÿ1
provi%ÿgez%(i%,1)ÿÿ1
ma%ÿgez%(i%,0)
sr%ÿ0
Haftung%ÿ0
datumz%ÿÿQ
f„lligkeit%ÿ0
euro1%ÿumrechnung.kvertrag
waehr1$ÿwaehrung.kvertrag
zein%ÿ0
remark2$ÿ""
vertrprov%ÿ0
vsumC%ÿ0
vsumA%ÿ0
vsumPP%ÿ0
ÿƒStoRegProv(remark$,ma%,provi%,sr%,Haftung%,datumz%,f„lligkeit%,euro1%,codew%,waehr1$,zein%,remark2$)
ÿ±i%
ÿ’ÿ¡
ÿ’ÿ¡
ÿƒFehler("Storno beendet!","")
 ÿ’ÿÿ


ÿÿVorschuss()
GAdrDat$ÿ"ADRESSEN"
GConDat$ÿ"CONNECT"
GTelDat$ÿ"TELEFON"
GAkquiDat$ÿ"AKQUISE"
GDokDat$ÿ"DOKUMENT"
GADRStat$ÿ"ADRSTAT"
 
 
 
 ÿ¡PrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
ÿ¡ÿOÿ´("buchung1")ÿpÿƒDFile(3,"Buchung1"ÿ_fpw$)
ÿÉÿĞÿ™"Buchung1"
 ÿ^
ÿ¡ÿOÿ´("buchung")ÿpÿƒDFile(3,"Buchung"ÿ_fpw$)
ÿÉÿĞÿ™"Buchung"
 ÿ’ÿ¡
 ÿƒDFile(3,"fs24imp"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adrstat"ÿ_fpw$)
 ÿÉÿĞÿ™"adrstat"
 ÿƒDFile(2,"OFFICE\adrgrup"ÿ_fpw$)
 ÿÉÿĞÿ™"adrgrup"
 ÿƒDFile(3,"Kgeadr"ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿÉÿĞÿ™"Sparten"
 ÿƒDFile(3,"geadr"ÿ_fpw$):ÿƒDFile(3,"geadr2"ÿ_fpw$)
 ÿÉÿĞÿ™"geadr"
 ÿƒDFile(3,"tarif"ÿ_fpw$)
 ÿÉÿĞÿ™"tarif"
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿÉÿĞÿ™"maadr"
 ÿƒDFile(3,"maadrgru"ÿ_fpw$)
 ÿƒDFile(3,"mavorg"ÿ_fpw$)
 ÿÉÿĞÿ™"maadrgru"
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿÉÿĞÿ™"kvertrag"
 ÿƒDFile(3,"vprodukt"ÿ_fpw$)
 ÿÉÿĞÿ™"vprodukt"
 ÿƒDFile(3,"tarif"ÿ_fpw$)
 ÿÉÿĞÿ™"tarif"
 ÿƒDFile(3,"vorgang"ÿ_fpw$)
 ÿÉÿĞÿ™"vorgang"
 ÿƒDFile(3,"vkond"ÿ_fpw$)
 ÿÉÿĞÿ™"vkond"
 ÿƒDFile(3,"formular"ÿ_fpw$)
 ÿÉÿĞÿ™"formular"
 ÿƒDFile(3,"spgruppe"ÿ_fpw$)
 ÿÉÿĞÿ™"spgruppe"
 ÿƒDFile(3,"agdir"ÿ_fpw$)
 
 ÿƒDFile(3,"KVEXEXP"ÿ_fpw$)
 ÿƒDFile(3,"ZEINGAN1"ÿ_fpw$)
 
 ÿƒDFile(2,"OFFICE\"ÿGADRDat$ÿ_fpw$)
 ÿÉÿĞÿ™GAdrDat$
 ÿƒDFile(2,"OFFICE\"ÿGAkquiDat$ÿ_fpw$)
 ÿÉÿĞÿ™GAkquiDat$
 ÿƒDFile(2,"OFFICE\aktionen"ÿ_fpw$)
 ÿÉÿĞÿ™"aktionen"
 ÿƒDFile(2,"OFFICE\"ÿGTelDat$ÿ_fpw$)
 ÿÉÿĞÿ™GTelDat$
 ÿƒDFile(2,"OFFICE\"ÿGDokDat$ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\"ÿGConDat$ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\banken"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\tvorlage"ÿ_fpw$)
 
anf220620041: 
ÿ‰ÿñ"STICHTAG",0,0,222,114,"Buchungsdatum","MS Sans Serif",8
ÿ|ÿñ"STICHTAG",4,0,0,222,91,0,""
ÿ|ÿñ"STICHTAG",9,6,9,23,24,2
ÿ|ÿñ"STICHTAG",5,31,15,183,10,0,"Bitte geben Sie an, bis zu welchem Datum"
ÿ|ÿñ"STICHTAG",5,31,25,183,10,0,"die Vorschsse verarbeitet werden sollen:"
ÿ|ÿñ"STICHTAG",6,94,72,42,12,0,0,CalcDate$,10
ÿ|ÿñ"STICHTAG",5,30,74,58,10,0,"Vorschussdatum:"
ÿ|ÿñ"STICHTAG",1,52,94,54,14,1,"&OK",1,1
ÿ|ÿñ"STICHTAG",1,109,94,54,14,0,"&Abbrechen",0,0
ÿñ"STICHTAG",req%
ÿ¾ÿñ"STICHTAG"
ÿ¡req%ÿ1ÿpÿwend220620041
ÿ¡DateOK%(CalcDate$)ÿp
calcdate%ÿÿ1(CalcDate$)
mm$ÿÿ+(ÿ(caldate%,"mmyyyydd"),2)
ÿ^
ÿƒFehler("Datum ist ungltig!","")
ÿwanf220620041
ÿ’ÿ¡
 ÿ™"buchung1"
 ÿ£QuickCode.buchung1
 ÿ™"maadr"
 ÿ£vorschujn.maadr
 ÿÉÿ`ÿ™"maadr"ÿ£vorschujn.maadr
 ÿÉÿ¥1ÿ™"maadr"ÿ£vorschujn.maadr
 ÿØÿOÿB("maadr")ÿvorschujn.maadrÿ1
ma1%ÿcodema.maadr
ÿ¡ma1%ÿ200782ÿp
ÿ½ CALL Fehler(nachname.maadr,agenturnr.maadr)
ÿ’ÿ¡
ÿ¡vorschuvon.maadrÿ0ÿp
ÿ¡vorschuvon.maadrÿÿ1(calcdate$)ÿpÿwnextma220620041
ÿ’ÿ¡
ÿ¡vorschubis.maadrÿ0ÿp
ÿ¡vorschubis.maadrÿ
ÿ1(calcdate$)ÿpÿwnextma220620041
ÿ’ÿ¡
ÿ¡PROVSperreEig.maadrÿ"j"ÿpÿwnextma220620041
codema%ÿcodema.maadr
qcode$ÿÿ(codema.maadr,"000000")ÿÿ+(ÿ(calcdate%,"yyyymmdd"),6)ÿ"00"
qcode1$ÿÿ(codema.maadr,"000000")ÿÿ+(ÿ(calcdate%,"yyyymmdd"),6)
ÿÉÿ`ÿ™"buchung1"ÿ£QuickCode.buchung1
ÿÉÿ¥qcode$ÿ™"buchung1"ÿ£QuickCode.buchung1
summe%ÿ0
kzvsu%ÿ1
ÿ½ berechnen, ob der MA mit seiner Provision nicht eine Obergrenze berschreitet
ÿØÿOÿB("Buchung1")ÿÿ+(QuickCode.buchung1,12)ÿqcode1$
ÿ¡vorschujn.buchung1ÿ1ÿProvision.buchung1ÿ"j"ÿp
ÿ½ nur die Datens„tze bercksichtigen, die tats„chlich eine Provision enthalten
summe%ÿsumme%ÿbetrag.buchung1ÿvsv.buchung1
ÿ’ÿ¡
ÿ¡summe%ÿVorschuMax.maadrÿp
kzvsu%ÿ0
ÿÉÿbÿ™"buchung1"ÿ£QuickCode.buchung1
ÿ’ÿ¡
ÿÉÿ±ÿ™"buchung1"ÿ£QuickCode.buchung1
ÿÙ
ÿ¡kzvsu%ÿ1ÿp
ÿ½ MA bekommt weniger als xy Grenze an Provision, jetzt testen ob er vorschuáf„hige 
ÿ½ Vertr„ge hat
moeglvorschu%ÿVorschuMax.maadrÿsumme%
ÿ™"kvertrag"
ÿ£codema.kvertrag
ÿÉÿ`ÿáÿ™"kvertrag"
ÿÉÿ¥codema%ÿáÿ™"kvertrag"ÿ£codema.kvertrag
ok%ÿÿ1
ÿØÿOÿB("KVERTRAG")ÿcodema.kvertragÿcodema%ÿok%ÿÿ1
ÿ½ festellen, ob es vorschuáf„hige Vertr„ge gibt, 
ÿ¡kzv.kvertragÿ"j"ÿfs24vors.kvertragÿ0ÿp
	ÿ½ jetzt kann theoretisch beliehen werden,wenn zu dem Vertrag
	ÿ½ noch keine Buchung existiert
	ÿ¡ÿOÿJ(lfdnr.kvertrag,codevt.zeingan1)ÿp
weitermach%ÿ1
	ÿ^
weitermach%ÿ0
	ÿ’ÿ¡
	ÿ¡ÿOÿJ(lfdnr.kvertrag,codevt.buchung1)ÿweitermach%ÿ1ÿp
ÿ½ CALL Fehler("Da ist was","")
pvor%ÿ(fs24maklprov.kvertragÿvorschuproz.maadr)ÿ100
ÿ¡pvor%ÿmoeglvorschu%ÿp
pvor%ÿmoeglvorschu%
ok%ÿ0
ÿ^
moeglvorschu%ÿmoeglvorschu%ÿpvor%
ÿ’ÿ¡
fs24vors.kvertragÿpvor%
fs24Datvors.kvertragÿÿQ
ÿÌÿ™"KVERTRAG"
ÿÉÿ`ÿ™"sparten"ÿ£codeva.sparten
ÿÉÿ¥codeva.kvertragÿ™"sparten"ÿ£codeva.sparten
ÿÉÿ`ÿ™"Adressen"ÿ£codeku.adressen
ÿÉÿ¥codeku.kvertragÿ™"Adressen"ÿ£codeku.adressen
ÿÉÿ`ÿ™"GEADR"ÿ£codege.geadr
ÿÉÿ¥codege.kvertragÿ™"GEADR"ÿ£codege.geadr
ÿ½ Erzeugung Vorschuss-Buchung
ÿÉÿ`ÿ™"ADRESSEN"ÿ£codeku.adressen
ÿÉÿ¥codeku.kvertragÿ™"ADRESSEN"ÿ£codeku.adressen
ÿÿ™"Buchung1"
CodeBU.buchung1ÿÿI("buchung1",1)
Sparte.buchung1ÿSparte.SPARTEN
ÿ¡ÿH(fs24Satz_ID2.kvertrag)ÿ""ÿp
FS24Satz_ID.buchung1ÿFS24Satz_ID2.kvertrag
ÿ^
FS24Satz_ID.buchung1ÿFS24Satz_ID.kvertrag
ÿ’ÿ¡
F„lligkeit.buchung1ÿÿQ
Nachname.buchung1ÿNachname.Adressen
Vorname.buchung1ÿVorname.Adressen
Gesellschaft.buchung1ÿGesellschaft.GEADR
vs_Beginn.buchung1ÿvs_beginn.kvertrag
Provision.buchung1ÿ""
codeku.buchung1ÿcodeku.kvertrag
CodeMA.buchung1ÿma1%
codevt.buchung1ÿlfdnr.kvertrag
Buchungstext.buchung1ÿ"Vorschuss: "ÿVS_NR.kvertrag
VTAgentur.buchung1ÿÿ+(Nachname.maadrÿ","ÿvorname.maadr,100)
Datum.buchung1ÿÿQ
sbetr%ÿpvor%
Betrag.buchung1ÿpvor%
VTCodema.buchung1ÿma1%
Codew.buchung1ÿ3
umrechnung.buchung1ÿ1
waehrung.buchung1ÿ"EUR"
BetragEU.buchung1ÿÿ0(ÿ(Betrag.buchung1ÿumrechnung.buchung1,"99999999.00"))
vtagentur.buchung1ÿÿ+(ÿH(nachname.maadr)ÿ", "ÿÿH(vorname.maadr)ÿ", "ÿÿH(Agenturnr.maadr)ÿ" , Stufe:"ÿÿ(stufe.maadr,"000"),100)
agentur.buchung1ÿÿ+(ÿH(nachname.maadr)ÿ", "ÿÿH(vorname.maadr)ÿ", "ÿÿH(Agenturnr.maadr)ÿ" , Stufe:"ÿÿ(stufe.maadr,"000"),100)
QuickCode.BUCHUNG1ÿÿ(CodeMA.BUCHUNG1,"000000")ÿÿ(Datum.BUCHUNG1,"yyyymm0d")
QCodeMAPROD.buchung1ÿÿ(CodeMA.buchung1,"000000")ÿVSNRPack$(Gesellschaft.buchung1)ÿVSNRPack$(Sparte.buchung1)
Workstation.Buchung1ÿWorkstation%
QWoNo.Buchung1ÿÿ(Workstation%,"000000")ÿÿ(CodeBu.Buchung1,"000000")
RecStatus.Buchung1ÿ"c"
ÿƒBU1DMEuro(umrechnung.buchung1)
buday.buchung1ÿÿ3(Datum.buchung1)
vorschujn.buchung1ÿ1
QCodeMAVT.buchung1ÿÿ(codema.buchung1,"000000")ÿÿ(codevt.buchung1,"000000")
	ÿ¡gebuchtjn.buchung1ÿ1ÿpgebuchtjn.buchung1ÿ0
	gebuchtJNDat.buchung1ÿÿ(gebuchtjn.buchung1,"0")ÿÿ(datum.buchung1,"yyyymm0d")
	gebuchtJNMADat.buchung1ÿÿ(gebuchtjn.buchung1,"0")ÿÿ(Codema.buchung1,"000000")ÿÿ(datum.buchung1,"yyyymm0d")
ÿÌÿ™"Buchung1"
ÿ™"kvertrag"
ÿÉÿYÿá
FS24DatVors.kvertragÿÿQ
FS24Vors.kvertragÿpvor%
ÿÌÿ™"kvertrag"
ÿÉÿ¥ma1%ÿáÿ™"maadr"ÿ£codema.maadr
AuszahlAB.maadrÿAuszahlAB.maadrÿsbetr%
AuszahlEUAB.maadrÿÿ0(ÿ(AuszahlAB.maadrÿeuro1%,"999999999.00"))
zusAuszahl.maadrÿzusAuszahl.maadrÿsbetr%
zusAuszahlEU.maadrÿÿ0(ÿ(zusAuszahl.maadrÿeuro1%,"999999999.00"))
aktZusB.maadrÿaktZusB.maadrÿsbetr%
aktZusBEU.maadrÿÿ0(ÿ(aktZusB.maadrÿeuro1%,"999999999.00"))
ÿÌÿ™"maadr"
ÿïÿYÿ™"maadr"
ÿƒZentrKTO(ma1%,datumz%,sbetr%,0,3,1,"EUR",PSpAll$,PSpAllSeit%,PROVSpEig$,PSpESeit%,1,zusatz%,0)
 
	ÿ’ÿ¡
ÿ’ÿ¡
ÿÉÿ±ÿáÿ™"KVERTRAG"
ÿÙ
ÿ’ÿ¡
nextma220620041: 
ÿÉÿ±ÿ™"MAADR"ÿ£vorschujn.maadr
 ÿÙ
end220620041: 
 ÿ’ÿÿ
 
 
 
ÿÿVorschuss1()
GAdrDat$ÿ"ADRESSEN"
GConDat$ÿ"CONNECT"
GTelDat$ÿ"TELEFON"
GAkquiDat$ÿ"AKQUISE"
GDokDat$ÿ"DOKUMENT"
GADRStat$ÿ"ADRSTAT"
 
 
 
 ÿ¡PrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
ÿ¡ÿOÿ´("buchung1")ÿpÿƒDFile(3,"Buchung1"ÿ_fpw$)
ÿÉÿĞÿ™"Buchung1"
 ÿ^
ÿ¡ÿOÿ´("buchung")ÿpÿƒDFile(3,"Buchung"ÿ_fpw$)
ÿÉÿĞÿ™"Buchung"
 ÿ’ÿ¡
 ÿƒDFile(3,"fs24imp"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adrstat"ÿ_fpw$)
 ÿÉÿĞÿ™"adrstat"
 ÿƒDFile(2,"OFFICE\adrgrup"ÿ_fpw$)
 ÿÉÿĞÿ™"adrgrup"
 ÿƒDFile(3,"Kgeadr"ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿÉÿĞÿ™"Sparten"
 ÿƒDFile(3,"geadr"ÿ_fpw$):ÿƒDFile(3,"geadr2"ÿ_fpw$)
 ÿÉÿĞÿ™"geadr"
 ÿƒDFile(3,"tarif"ÿ_fpw$)
 ÿÉÿĞÿ™"tarif"
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿÉÿĞÿ™"maadr"
 ÿƒDFile(3,"maadrgru"ÿ_fpw$)
 ÿƒDFile(3,"mavorg"ÿ_fpw$)
 ÿÉÿĞÿ™"maadrgru"
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿÉÿĞÿ™"kvertrag"
 ÿƒDFile(3,"vprodukt"ÿ_fpw$)
 ÿÉÿĞÿ™"vprodukt"
 ÿƒDFile(3,"tarif"ÿ_fpw$)
 ÿÉÿĞÿ™"tarif"
 ÿƒDFile(3,"vorgang"ÿ_fpw$)
 ÿÉÿĞÿ™"vorgang"
 ÿƒDFile(3,"vkond"ÿ_fpw$)
 ÿÉÿĞÿ™"vkond"
 ÿƒDFile(3,"formular"ÿ_fpw$)
 ÿÉÿĞÿ™"formular"
 ÿƒDFile(3,"spgruppe"ÿ_fpw$)
 ÿÉÿĞÿ™"spgruppe"
 ÿƒDFile(3,"agdir"ÿ_fpw$)
 
 ÿƒDFile(3,"KVEXEXP"ÿ_fpw$)
 ÿƒDFile(3,"ZEINGAN1"ÿ_fpw$)
 
 ÿƒDFile(2,"OFFICE\"ÿGADRDat$ÿ_fpw$)
 ÿÉÿĞÿ™GAdrDat$
 ÿƒDFile(2,"OFFICE\"ÿGAkquiDat$ÿ_fpw$)
 ÿÉÿĞÿ™GAkquiDat$
 ÿƒDFile(2,"OFFICE\aktionen"ÿ_fpw$)
 ÿÉÿĞÿ™"aktionen"
 ÿƒDFile(2,"OFFICE\"ÿGTelDat$ÿ_fpw$)
 ÿÉÿĞÿ™GTelDat$
 ÿƒDFile(2,"OFFICE\"ÿGDokDat$ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\"ÿGConDat$ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\banken"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\tvorlage"ÿ_fpw$)
 
anf220620041: 
ÿ‰ÿñ"STICHTAG",0,0,222,114,"Buchungsdatum","MS Sans Serif",8
ÿ|ÿñ"STICHTAG",4,0,0,222,91,0,""
ÿ|ÿñ"STICHTAG",9,6,9,23,24,2
ÿ|ÿñ"STICHTAG",5,31,15,183,10,0,"Bitte geben Sie an, bis zu welchem Datum"
ÿ|ÿñ"STICHTAG",5,31,25,183,10,0,"die Vorschsse verarbeitet werden sollen:"
ÿ|ÿñ"STICHTAG",6,94,72,42,12,0,0,CalcDate$,10
ÿ|ÿñ"STICHTAG",5,30,74,58,10,0,"Vorschussdatum:"
ÿ|ÿñ"STICHTAG",1,52,94,54,14,1,"&OK",1,1
ÿ|ÿñ"STICHTAG",1,109,94,54,14,0,"&Abbrechen",0,0
ÿñ"STICHTAG",req%
ÿ¾ÿñ"STICHTAG"
ÿ¡req%ÿ1ÿpÿwend220620041
ÿ¡DateOK%(CalcDate$)ÿp
calcdate%ÿÿ1(CalcDate$)
mm$ÿÿ+(ÿ(caldate%,"mmyyyydd"),2)
ÿ^
ÿƒFehler("Datum ist ungltig!","")
ÿwanf220620041
ÿ’ÿ¡
 ÿ™"buchung1"
 ÿ£QuickCode.buchung1
 ÿ™"maadr"
 ÿ½ INDEX vorschujn.maadr
 ÿ£codema.maadr
 ÿ½ SELECT FIRST FILE "maadr" INDEX vorschujn.maadr
 ÿ½ SELECT KEY 1 FILE "maadr" INDEX vorschujn.maadr
 ÿ½ WHILE NOT EOF ("maadr") AND vorschujn.maadr = 1
 ÿÉÿ`ÿ™"maadr"ÿ£codema.maadr
 ÿØÿOÿB("maadr")
ma1%ÿcodema.maadr
kzvsu%ÿ1
ÿ½ CALL Fehler(nachname.maadr,agenturnr.maadr)
ÿ¡agenturnr.maadrÿ"1371"ÿp
ÿ½ CALL Fehler(nachname.maadr,agenturnr.maadr)
ÿ’ÿ¡
ÿ¡vorschuvon.maadrÿ0ÿp
ÿ¡vorschuvon.maadrÿÿ1(calcdate$)ÿpkzvsu%ÿ0
ÿ’ÿ¡
ÿ¡vorschubis.maadrÿ0ÿp
ÿ¡vorschubis.maadrÿ
ÿ1(calcdate$)ÿpkzvsu%ÿ0
ÿ’ÿ¡
ÿ¡PROVSperreEig.maadrÿ"j"ÿpÿwkzvsu%ÿ0
codema%ÿcodema.maadr
qcode$ÿÿ(codema.maadr,"000000")ÿÿ+(ÿ(calcdate%,"yyyymmdd"),6)ÿ"00"
qcode1$ÿÿ(codema.maadr,"000000")ÿÿ+(ÿ(calcdate%,"yyyymmdd"),6)
q1$ÿÿ+(ÿ(calcdate%,"yyyymmdd"),6)
ÿÉÿ`ÿ™"buchung1"ÿ£QuickCode.buchung1
ÿÉÿ¥qcode$ÿ™"buchung1"ÿ£QuickCode.buchung1
summe%ÿ0

ÿ½ berechnen, was der Mitarbeiter an Provision bekommt
ÿØÿOÿB("Buchung1")ÿÿ+(QuickCode.buchung1,12)ÿqcode1$
ÿ¡vorschujn.buchung1ÿ1ÿProvision.buchung1ÿ"j"ÿp
ÿ½ nur die Datens„tze bercksichtigen, die tats„chlich eine Provision enthalten
summe%ÿsumme%ÿbetrag.buchung1ÿvsv.buchung1
ÿ’ÿ¡
ÿÉÿ±ÿ™"buchung1"ÿ£QuickCode.buchung1
ÿÙ
 
ÿ½ jetzt testen ob er vorschuáf„hige Vertr„ge hat
Maklerprovsum%ÿ0
ÿ™"kvertrag"
ÿ£codema.kvertrag
ÿÉÿ`ÿáÿ™"kvertrag"
ÿÉÿ¥codema%ÿ™"kvertrag"ÿ£codema.kvertrag
ok%ÿÿ1
anzvertrvo%ÿ0
anzvertrges%ÿ0
ii%ÿ0
ÿØÿOÿB("KVERTRAG")ÿcodema.kvertragÿcodema%ÿok%ÿÿ1
anzvertrges%ÿanzvertrges%ÿ1
ÿ½ festellen, ob es vorschuáf„hige Vertr„ge gibt, 
ÿ½ aber die mssen Antrag oder lebend sein und
ÿ½ Antragsdatum in dem zu testenden Monat
ÿ¡lfdnr.kvertragÿ37803ÿp
	ÿ½ CALL Fehler("Vorschuss fr 37803","")
ÿ’ÿ¡
ÿ¡kzv.kvertragÿ"j"ÿp
	ÿ¡codevstatus.kvertragÿ1ÿcodevstatus.kvertragÿ12ÿp
antrag$ÿÿ+(ÿ(Antragsdatum.kvertrag,"yyyymmdd"),6)
ÿ¡antrag$ÿq1$ÿp
anzvertrvo%ÿanzvertrvo%ÿ1
weitermach%ÿ1
Maklerprovsum%ÿMaklerprovsum%ÿfs24maklprov.kvertrag
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿÊÿË"feststellen vorschuáf„higer Vertr„ge "ÿAgenturnr.maadrÿ" "ÿnachname.maadrÿ" "ÿÿ(anzvertrges%,",9999999")
ÿÉÿ±ÿ™"KVERTRAG"
ÿÙ
nextma220620041: 
ÿ½ MakProvSum.maadr = Maklerprovsum%
ÿ½ ProvSum.maadr = summe%
ÿ½ CALL Fehler("Maklerprovsum: " + STR$ (Maklerprovsum%,",99999999.00"),"Provisionssumme: " + STR$ (summe%,",99999999.00"))
ÿƒSpezStoreMA(Maklerprovsum%,summe%,calcdate%,anzvertrvo%,anzvertrges%,codema%,kzvsu%)
Maklerprovsum%ÿ0
summe%ÿ0
ÿÉÿ±ÿ™"MAADR"ÿ£vorschujn.maadr
 ÿÙ
 ÿƒFehler("Vorschussberechnung BEENDET!","")
end220620041: 
 ÿ’ÿÿ
 
 ÿ½ *************************************************************************************************
 ÿ½                        Kredite hochrechnen
 ÿ½ *************************************************************************************************

ÿÿKredit()
GAdrDat$ÿ"ADRESSEN"
GConDat$ÿ"CONNECT"
GTelDat$ÿ"TELEFON"
GAkquiDat$ÿ"AKQUISE"
GDokDat$ÿ"DOKUMENT"
GADRStat$ÿ"ADRSTAT"
 
 
 
 ÿ¡PrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
ÿ¡ÿOÿ´("buchung1")ÿpÿƒDFile(3,"Buchung1"ÿ_fpw$)
ÿÉÿĞÿ™"Buchung1"
 ÿ^
ÿ¡ÿOÿ´("buchung")ÿpÿƒDFile(3,"Buchung"ÿ_fpw$)
ÿÉÿĞÿ™"Buchung"
 ÿ’ÿ¡
 ÿ½ CALL DFile(3,"fs24imp" + _fpw$)
 ÿƒDFile(2,"OFFICE\adrstat"ÿ_fpw$)
 ÿÉÿĞÿ™"adrstat"
 ÿƒDFile(2,"OFFICE\adrgrup"ÿ_fpw$)
 ÿÉÿĞÿ™"adrgrup"
 ÿƒDFile(3,"Kgeadr"ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿÉÿĞÿ™"Sparten"
 ÿƒDFile(3,"geadr"ÿ_fpw$):ÿƒDFile(3,"geadr2"ÿ_fpw$)
 ÿÉÿĞÿ™"geadr"
 ÿƒDFile(3,"tarif"ÿ_fpw$)
 ÿÉÿĞÿ™"tarif"
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿÉÿĞÿ™"maadr"
 ÿƒDFile(3,"maadrgru"ÿ_fpw$)
 ÿƒDFile(3,"mavorg"ÿ_fpw$)
 ÿÉÿĞÿ™"maadrgru"
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿÉÿĞÿ™"kvertrag"
 ÿƒDFile(3,"vprodukt"ÿ_fpw$)
 ÿÉÿĞÿ™"vprodukt"
 ÿƒDFile(3,"tarif"ÿ_fpw$)
 ÿÉÿĞÿ™"tarif"
 ÿƒDFile(3,"vorgang"ÿ_fpw$)
 ÿÉÿĞÿ™"vorgang"
 ÿƒDFile(3,"vkond"ÿ_fpw$)
 ÿÉÿĞÿ™"vkond"
 ÿƒDFile(3,"formular"ÿ_fpw$)
 ÿÉÿĞÿ™"formular"
 ÿƒDFile(3,"spgruppe"ÿ_fpw$)
 ÿÉÿĞÿ™"spgruppe"
 ÿƒDFile(3,"agdir"ÿ_fpw$)
 
 ÿƒDFile(3,"KVEXEXP"ÿ_fpw$)
 ÿƒDFile(3,"ZEINGAN1"ÿ_fpw$)


 ÿƒDFile(3,"MAKREDIT"ÿ_fpw$)
 ÿƒDFile(3,"MAKREBUC"ÿ_fpw$)
 
 ÿƒDFile(2,"OFFICE\"ÿGADRDat$ÿ_fpw$)
 ÿÉÿĞÿ™GAdrDat$
 ÿƒDFile(2,"OFFICE\"ÿGAkquiDat$ÿ_fpw$)
 ÿÉÿĞÿ™GAkquiDat$
 ÿƒDFile(2,"OFFICE\aktionen"ÿ_fpw$)
 ÿÉÿĞÿ™"aktionen"
 ÿƒDFile(2,"OFFICE\"ÿGTelDat$ÿ_fpw$)
 ÿÉÿĞÿ™GTelDat$
 ÿƒDFile(2,"OFFICE\"ÿGDokDat$ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\"ÿGConDat$ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\banken"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\tvorlage"ÿ_fpw$)
 
anf260120051: 
ÿ‰ÿñ"STICHTAG",0,0,222,114,"Krediterzeugung bis zum","MS Sans Serif",8
ÿ|ÿñ"STICHTAG",4,0,0,222,91,0,""
ÿ|ÿñ"STICHTAG",9,6,9,23,24,2
ÿ|ÿñ"STICHTAG",5,31,15,183,10,0,"Bitte geben Sie an, mit welchem Datum"
ÿ|ÿñ"STICHTAG",5,31,25,183,10,0,"die Kredite/Raten Datens„tze erzeugt"
ÿ|ÿñ"STICHTAG",5,31,35,183,10,0,"werden sollen. Die Monatsangabe des Datums"
ÿ|ÿñ"STICHTAG",5,31,45,183,10,0,"bestimmt, fr welchen Monat die Daten"
ÿ|ÿñ"STICHTAG",5,31,55,183,10,0,"erzeugt werden"
ÿ|ÿñ"STICHTAG",6,94,72,42,12,0,0,CalcDate$,10
ÿ|ÿñ"STICHTAG",5,30,74,58,10,0,"Datum:"
ÿ|ÿñ"STICHTAG",1,52,94,54,14,1,"&OK",1,1
ÿ|ÿñ"STICHTAG",1,109,94,54,14,0,"&Abbrechen",0,0
ÿñ"STICHTAG",req%
ÿ¾ÿñ"STICHTAG"
ÿ¡req%ÿ1ÿpÿwen260120051
ÿ¡DateOK%(CalcDate$)ÿp
calcdate%ÿÿ1(CalcDate$)
mm$ÿÿ+(ÿ(calcdate%,"mmyyyydd"),2)
ÿ^
ÿƒFehler("Datum ist ungltig!","")
ÿwanf260120051
ÿ’ÿ¡

 ÿ™"makrebuc"
 ÿƒFehler("Es werden jetzt zun„chst mal die jenigen Krediteinzeldatens„tze rckgerechnet und gel”scht die noch nicht als gebucht gekennzeichnet wurden!","")
 ÿ™"maadr"
 ÿ½ INDEX vorschujn.maadr
 ÿ£codema.maadr
 ÿ½ SELECT FIRST FILE "maadr" INDEX vorschujn.maadr
 ÿ½ SELECT KEY 1 FILE "maadr" INDEX vorschujn.maadr
 ÿ½ WHILE NOT EOF ("maadr") AND vorschujn.maadr = 1
 ÿ™"makredit"
 ÿ£codema.makredit
 ÿ™"makrebuc"
 ÿ£codekre.makrebuc
 ÿÉÿ`ÿ™"maadr"ÿ£codema.maadr
 i%ÿ0

 ÿØÿOÿB("maadr")
ÿÊÿËagenturnr.maadrÿ" "ÿnachname.maadr
ma1%ÿcodema.maadr
ÿ¡ÿJ(ma1%,codema.makredit)ÿp
ÿÉÿ`ÿ™"makredit"ÿ£codema.makredit
ÿÉÿ¥ma1%ÿáÿ™"makredit"ÿ£codema.makredit
ÿØÿOÿB("makredit")ÿcodema.makreditÿma1%
_codekre%ÿcodekre.makredit
ÿ¡ÿJ(_codekre%,codekre.makrebuc)ÿp
	ÿÉÿ`ÿ™"makrebuc"ÿ£codekre.makrebuc
	ÿÉÿ¥_codekre%ÿáÿ™"makrebuc"ÿ£codekre.makrebuc
	ÿØÿOÿB("makrebuc")ÿcodekre.makrebucÿ_codekre%
i%ÿi%ÿ1
ÿ¡gebucht.makrebucÿ"J"ÿp
ÿÊÿËagenturnr.maadrÿ" "ÿnachname.maadrÿ" "ÿÿ(i%,"999999")
_codebuc%ÿcodebuc.makrebuc
ÿ¡art.makrebucÿ0ÿp
ÿ½ Erstzahlung
gezErstZahlung.makreditÿ"N"

bisjetztgezahlt.makreditÿbisjetztgezahlt.makreditÿErsteZahlung.makredit
nochausstehend.makreditÿnochausstehend.makreditÿErsteZahlung.makredit
gezahlterBetrag.makreditÿGezBetragOld.makredit
GezahltAm.makreditÿGezahltAmOld.makredit
ÿ’ÿ¡
ÿ¡art.makrebucÿ1ÿp
ÿ½ Rate
bisjetztgezahlt.makreditÿbisjetztgezahlt.makreditÿRate.makredit
ÿ¡RateOrKredit.makreditÿ1ÿpnochausstehend.makreditÿnochausstehend.makreditÿRate.makredit
gezahlterBetrag.makreditÿgezahlterBetrag.makreditÿRate.makredit
GezahltAm.makreditÿGezahltAmOld.makredit
gezahlterBetrag.makreditÿGezBetragOld.makredit
AnzahlRatengez.makreditÿAnzahlRatengez.makreditÿ1
ÿ¡RateOrKredit.makreditÿ1ÿpAnzahlRatenAust.makreditÿAnzahlRatenAust.makreditÿ1
ÿ’ÿ¡
ÿ¡art.makrebucÿ2ÿp
ÿ½ letzte Zahlung
gezletzZahlung.makreditÿ"N"
 
bisjetztgezahlt.makreditÿbisjetztgezahlt.makreditÿLetzteZahlung.makredit
nochausstehend.makreditÿnochausstehend.makreditÿLetzteZahlung.makredit
gezahlterBetrag.makreditÿgezahlterBetrag.makreditÿLetzteZahlung.makredit
GezahltAm.makreditÿGezahltAmOld.makredit
gezahlterBetrag.makreditÿGezBetragOld.makredit

ÿ’ÿ¡
ÿƒQuickStore("makredit")
ÿ’ÿ¡
ÿÉÿ±ÿáÿ™"makrebuc"ÿ£codekre.makrebuc
	ÿÙ
ÿ’ÿ¡
ÿÉÿ±ÿáÿ™"makredit"ÿ£codema.makredit
ÿÙ
ÿßÿe
ÿÊÿË"l”schen der nicht gebuchten Datens„tze"
ÿ¾ÿaÿ™"makrebuc"ÿĞgebucht.makrebucÿ"J"
ÿ’ÿ¡
ÿ™"maadr"
ÿÉÿ±ÿ™"maadr"ÿ£codema.maadr
 ÿÙ
 ÿÂ"Rcksetzen fertig!","",2
 ÿÂ"Erzeugen der Monatsdatens„tze der Kredite","",2
 ÿ™"makredit"
 ÿ£codema.makredit
 ÿ™"makrebuc"
 ÿ£codekre.makrebuc
 ÿÉÿ`ÿáÿ™"maadr"ÿ£codema.maadr
 i%ÿ0
 moja$ÿÿ+(ÿ(calcdate%,"yyyymm0d"),6)
 ÿØÿOÿB("maadr")
ÿÊÿËagenturnr.maadrÿ" "ÿnachname.maadr
ma1%ÿcodema.maadr
ÿ¡ÿJ(ma1%,codema.makredit)ÿp
ÿÉÿ`ÿ™"makredit"ÿ£codema.makredit
ÿÉÿ¥ma1%ÿáÿ™"makredit"ÿ£codema.makredit
kreditmon%ÿ0
kreditsum%ÿ0
ÿØÿOÿB("makredit")ÿcodema.makreditÿma1%
ÿƒFehler("1371",Sache.makredit)
ÿ¡agenturnr.maadrÿ"1371"ÿp
	ÿ½ CALL Fehler("1371",Sache.makredit)
ÿ’ÿ¡
kreditsum%ÿkreditsum%ÿKreditsumme.makredit
_codekre%ÿcodekre.makredit
ÿ½ IF EXISTS (_codekre%,codekre.makrebuc) THEN 
	ÿ½ SELECT FIRST FILE "makrebuc" INDEX codekre.makrebuc
	ÿ½ SELECT KEY _codekre% LOCK FILE "makrebuc" INDEX codekre.makrebuc
	ÿ½ WHILE NOT EOF ("makrebuc") AND codekre.makrebuc = _codekre%
ÿ½ IF gebucht.makrebuc <> "J" THEN 
ÿÊÿËagenturnr.maadrÿ" "ÿnachname.maadrÿ" "ÿÿ(i%,"999999")
ÿ½ _codebuc% = codebuc.makrebuc
mojaver$ÿÿ+(ÿ(ErstzahlungAm.makredit,"yyyymm0d"),6)
ÿ¡gezErstZahlung.makreditÿ"J"ÿmoja$ÿmojaver$ÿp
ÿ½ Erstzahlung
art%ÿ0
GezahltAmOld.makreditÿGezahltAm.makredit
GezahltAm.makreditÿcalcdate%
GezBetragOld.makreditÿgezahlterBetrag.makredit
gezahlterBetrag.makreditÿErsteZahlung.makredit
gezErstZahlung.makreditÿ"J"
 
bisjetztgezahlt.makreditÿbisjetztgezahlt.makreditÿErsteZahlung.makredit
ÿ½ nochausstehend.makredit = nochausstehend.makredit - ErsteZahlung.makredit
nochausstehend.makreditÿKreditsumme.makreditÿErsteZahlung.makredit
AnzahlRatenAust.makreditÿAnzahlMonate.makreditÿ1
gezahlterBetrag.makreditÿErsteZahlung.makredit
AnzahlRatengez.makreditÿ1
ÿƒQuickStore("makredit")

ÿÿ™"MAKreBuc"
ÿÊÿË"Datensatz neu angelegt..."
aa%ÿCopyRecord%("MAKREDIT","MAKREBUC")
CodeBUC.MAKreBucÿÿI("MAKreBUC",1)
_CodeBUC%ÿCodeBUC.MAKreBuc
art.makrebucÿart%
Codema.MAKreditÿcodema.makredit
gezahlterBetrag.makrebucÿErsteZahlung.makredit
GezahltAm.makrebucÿcalcdate%

ÿƒQuickStore ("makrebuc")
ÿ’ÿ¡
RatenBis%ÿRatenBis.makredit
RatenVom%ÿRatenVom.makredit
ÿ¡RatenBis.makreditÿ
1ÿpRatenBis%ÿÿ1("31.12.2999")
ÿ¡RatenVom.makreditÿ
1ÿpRatenVom%ÿÿ1("01.01.0001")
ÿ¡calcdate%ÿRatenVom%ÿcalcdate%ÿ	RatenBis%ÿp
ÿ½ Rate
art%ÿ1
GezahltAmOld.makreditÿGezahltAm.makredit
GezahltAm.makreditÿcalcdate%
GezBetragOld.makreditÿgezahlterBetrag.makredit
ÿ½ gezahlterBetrag.makredit = Rate.makredit

bisjetztg%ÿbisjetztgezahlt.makredit
bisjetztgezahlt.makreditÿbisjetztgezahlt.makreditÿRate.makredit
bisjetztg%ÿbisjetztgezahlt.makredit
ÿ¡Kreditsumme.makreditÿ0ÿRateOrKredit.makreditÿ1ÿp
ÿ¡nochausstehend.makreditÿ0ÿp
nochausstehend.makreditÿKreditsumme.makreditÿRate.makredit
AnzahlRatenAust.makreditÿAnzahlMonate.makredit
AnzahlRatengez.makreditÿ1
ÿ^
nochausstehend.makreditÿnochausstehend.makreditÿRate.makredit
AnzahlRatenAust.makreditÿAnzahlRatenAust.makreditÿ1
AnzahlRatengez.makreditÿAnzahlRatengez.makreditÿ1
ÿ’ÿ¡
ÿ^
AnzahlRatengez.makreditÿAnzahlRatengez.makreditÿ1
ÿ’ÿ¡
gezahlterBe%ÿgezahlterBetrag.makredit
gezahlterBetrag.makreditÿgezahlterBetrag.makreditÿRate.makredit
gezahlterBe%ÿgezahlterBetrag.makredit
GezahltAmOld.makreditÿGezahltAm.makredit
GezahltAm.makreditÿcalcdate%


ÿƒQuickStore("makredit")

ÿÿ™"MAKreBuc"
ÿÊÿË"Datensatz neu angelegt..."
aa%ÿCopyRecord%("MAKREDIT","MAKREBUC")
CodeBUC.MAKreBucÿÿI("MAKreBUC",1)
_CodeBUC%ÿCodeBUC.MAKreBuc
art.makrebucÿart%
Codema.MAKreditÿcodema.makredit
gezahlterBetrag.makrebucÿRate.makredit
GezahltAm.makrebucÿcalcdate%
ÿƒQuickStore ("makrebuc")
ÿ’ÿ¡

mojaver$ÿÿ+(ÿ(LetzteZahlungAm.makredit,"yyyymm0d"),6)
ÿ¡gezletzZahlung.makreditÿ"J"ÿmoja$ÿmojaver$ÿp
ÿ½ letzte Zahlung
art%ÿ2
GezahltAmOld.makreditÿGezahltAm.makredit
GezahltAm.makreditÿcalcdate%
GezBetragOld.makreditÿgezahlterBetrag.makredit
gezahlterBetrag.makreditÿLetzteZahlung.makredit

LetzteZahlungAm.makreditÿcalcdate%
gezletzZahlung.makreditÿ"J"
 
bisjetztgezahlt.makreditÿbisjetztgezahlt.makreditÿLetzteZahlung.makredit
nochausstehend.makreditÿnochausstehend.makreditÿLetzteZahlung.makredit
ÿƒQuickStore("makredit")

ÿÿ™"MAKreBuc"
ÿÊÿË"Datensatz neu angelegt..."
aa%ÿCopyRecord%("MAKREDIT","MAKREBUC")
CodeBUC.MAKreBucÿÿI("MAKreBUC",1)
_CodeBUC%ÿCodeBUC.MAKreBuc
art.makrebucÿart%
Codema.MAKreditÿcodema.makredit
gezahlterBetrag.makrebucÿLetzteZahlung.makredit
GezahltAm.makrebucÿcalcdate%
ÿƒQuickStore ("makrebuc")
ÿ’ÿ¡
kreditmon%ÿkreditmon%ÿgezahlterBetrag.makrebuc


 
ÿ½ END IF 
ÿ½ SELECT NEXT LOCK FILE "makrebuc" INDEX codekre.makrebuc
	ÿ½ WEND 
ÿ½ END IF 
ÿÉÿ±ÿáÿ™"makredit"ÿ£codema.makredit
ÿÙ
ÿ™"maadr"
ÿÉÿYÿá
KreditMon.maadrÿkreditmon%
KreditSum.maadrÿkreditsum%
ÿÌÿ™"maadr"
ÿßÿe
ÿ’ÿ¡
ÿ™"maadr"
ÿÉÿ±ÿáÿ™"maadr"ÿ£codema.maadr
 ÿÙ
 ÿƒFehler("Fertig mit Kreditvorausberechnung","")
en260120051: 
 ÿ’ÿÿ


ÿÿSichMaKredit()
 codekre%ÿcodekre.makredit
 ÿ¡ÿ("MAKREDIT")ÿÿ°("MAKREDIT")ÿpÿÌÿ™"MAKREDIT"
 ÿÉÿ`ÿ™"makredit"ÿ£codekre.makredit
 ÿÉÿ¥codekre%ÿáÿ™"makredit"ÿ£codekre.makredit
 fehl$ÿ""
 ÿ¡RateOrKredit.makreditÿ0ÿp
ÿ½ Raten
ÿ¡von.makreditÿ0ÿbis.makreditÿ0ÿAnzahlMonate.makreditÿ0ÿKreditsumme.makreditÿÿÿp
fehl$ÿ"Sie haben angegeben, daá es sich bei diesem Datensatz um <zu zahlende feste Rate> handelt, deshalb drfen die Felder im Abschnitt Kreditangaben (Laufzeit von, bis, Monate und Kredith”he) NICHT ausgefllt werden!"
fehl$ÿfehl$ÿÿ(13)ÿÿ(10)
ÿ’ÿ¡
ÿ¡ErsteZahlung.makreditÿ0ÿErstzahlungAm.makreditÿ0ÿLetzteZahlung.makreditÿ0ÿLetzteZahlungAm.makreditÿ0ÿp
fehl$ÿ"Sie haben angegeben, daá es sich bei diesem Datensatz um <zu zahlende feste Rate> handelt, deshalb drfen die Felder der Zeile <erste Zahlung> und <letzte Zahlung> nicht ausgefllt werden!"
fehl$ÿfehl$ÿÿ(13)ÿÿ(10)
ÿ’ÿ¡
ÿ¡Rate.makreditÿ0ÿRatenVom.makreditÿ0ÿp
fehl$ÿ"Sie haben angegeben, daá es sich bei diesem Datensatz um <zu zahlende feste Rate> handelt, deshalb mssen die Felder <Betrag der Raten> und <Start> ausgefllt werden!"
fehl$ÿfehl$ÿÿ(13)ÿÿ(10)
ÿ’ÿ¡
 ÿ^
ÿ½ Kredite
ÿ¡von.makreditÿ0ÿbis.makreditÿ0ÿAnzahlMonate.makreditÿ0ÿKreditsumme.makreditÿ0ÿp
fehl$ÿ"Sie haben angegeben, daá es sich bei diesem Datensatz um <abzuzahlender Kredit> handelt, deshalb mssen die Felder im Abschnitt Kreditangaben (Laufzeit von, bis, Monate und Kredith”he) ausgefllt werden!"
fehl$ÿfehl$ÿÿ(13)ÿÿ(10)
ÿ’ÿ¡
ÿ¡ErsteZahlung.makreditÿ0ÿp
ÿ¡ErstzahlungAm.makreditÿ0ÿp
fehl$ÿ"Sie haben angegeben, daá es sich bei diesem Datensatz um <abzuzahlender Kredit> handelt und das Feld <erste Zahlung> ausgefllt, deshalb mssen die Felder der Zeile <erste Zahlung> komplett ausgefllt werden!"
fehl$ÿfehl$ÿÿ(13)ÿÿ(10)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡LetzteZahlung.makreditÿ0ÿp
ÿ¡LetzteZahlungAm.makreditÿ0ÿp
fehl$ÿ"Sie haben angegeben, daá es sich bei diesem Datensatz um <abzuzahlender Kredit> handelt und das Feld <erste Zahlung> ausgefllt, deshalb mssen die Felder der Zeile <erste Zahlung> komplett ausgefllt werden!"
fehl$ÿfehl$ÿÿ(13)ÿÿ(10)
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡Rate.makreditÿ0ÿRatenVom.makreditÿ0ÿRatenBis.makreditÿ0ÿAnzahlRaten.makreditÿ0ÿp
fehl$ÿ"Sie haben angegeben, daá es sich bei diesem Datensatz um <abzuzahlender Kredit> handelt, deshalb mssen die Felder <Betrag der Raten>,<Start>,<Ende> und <Anzahl> ausgefllt werden!"
fehl$ÿfehl$ÿÿ(13)ÿÿ(10)
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡fehl$ÿ""ÿpÿƒFehler(fehl$,"")
 ÿ’ÿÿ


ÿÿSpezStoreMA(maksum%,provsum%,datum%,anzvertrvo%,anzvertrges%,ma%,kzvsu%)
 ÿ¡ÿOÿ´("BUMSATZ")ÿpÿƒDFile(3,"BUmsatz"ÿ_fpw$)
 ÿ¡ÿOÿ´("BUMSKTO")ÿpÿƒDFile(3,"BUmskto"ÿ_fpw$)
 codema%ÿma%
 codemanr%ÿma%
 CodeVstatus%ÿCodeVStatus.kvertrag
 monat$ÿÿ+(ÿ(datum%,"mm0dyyyy"),2)
 ÿ½ aktueller Monat, aber wir brauchen zur Sicherung der alten Zahlen
 ÿ½ den Vormonat
 monat%ÿÿ0(monat$)
 jahr$ÿÿ+(ÿ(datum%,"yyyymm0d"),4)
 jahr%ÿÿ0(jahr$)
 monatold%ÿmonat%
 jahrold%ÿjahr%
 ÿ¡monatold%ÿ01ÿp
ÿ½ Vormonat ist also Dezember des Vorjahres
monatold%ÿ12
jahrold%ÿjahrold%ÿ1
 ÿ^
monatold%ÿmonatold%ÿ1
 ÿ’ÿ¡
 MonatOld$ÿÿ(monatold%,"00")
 Jahrold$ÿÿ(Jahrold%,"0000")
 AbrMonatOld$ÿJahrold$ÿMonatold$
 abrmonatold%ÿÿ0(AbrMonatold$)
 AbrMonat$ÿJahr$ÿMonat$
 abrmonat%ÿÿ0(AbrMonat$)
 ÿ™"maadr"
 ÿ£codema.maadr
 ÿÉÿ`
 ÿÉÿ¥codema%ÿáÿ™"maadr"ÿ£codema.maadr
 qcodemajahr1$ÿÿ(codema.maadr,"000000")ÿÿ(jahr%,"0000")
 ÿ¡ÿOÿJ(qcodemajahr1$,qcodemajahr.bumsatz)ÿp
ÿ›i%ÿ2000ÿqjahr%
qcodemajahr$ÿÿ(codema.maadr,"000000")ÿÿ(i%,"0000")
i$ÿÿ(i%,"0000")
ÿ¡ÿOÿJ(qcodemajahr$,qcodemajahr.bumsatz)ÿp
ÿÿ™"BUMSATZ"
codema.BUMSATZÿcodema.maadr
Jahr.bumsatzÿÿ0(i$)
QCodemaJahr.BUMSATZÿqcodemajahr$
ÿÌÿ™"BUMSATZ"
ÿïÿYÿ™"BUMSATZ"
ÿ’ÿ¡
ÿ±i%
 ÿ’ÿ¡
 ÿ™"BUMSATZ"
 ÿÉÿ`ÿ™"BUMSATZ"ÿ£QCodemaJahr.BUMSATZ
 ÿÉÿ¥Qcodemajahr$ÿáÿ™"BUMSATZ"ÿ£QCodemaJahr.BUMSATZ
 ÿ½ jetzt die alten Werte in BUmsatz schreiben und die neuen Werte in maadr,
 ÿ½ aber eigentlich darf das nur sein, wenn der vorhergehende Monat definitiv abgeschlossen wurde
 ÿww0101051
 ÿ¡AbrMonat%ÿAbrMonat.maadrÿp
ÿ¡MonAbgeschlosse.maadrÿ0ÿp
ok%ÿÿ1
ÿ^
ÿ¡AbrMonat.maadrÿ0ÿpok%ÿÿ1
ÿ’ÿ¡
 ÿ^
ÿ¡AbrMonat%ÿAbrMonat.maadrÿp
ÿ¡MonAbgeschlosse.maadrÿ0ÿpok%ÿÿ1
ÿ’ÿ¡
 ÿ’ÿ¡
w0101051: 
 ok%ÿÿ1
 ÿ¡ok%ÿÿ1ÿp
ÿ™"maadr"
ÿÉÿYÿáÿ™"MAADR"
 
MakProvSum.maadrÿmaksum%
ProvSum.maadrÿProvSum%
AbrMonat.maadrÿAbrMonat%
ProvSumUberweis.maadrÿProvSum.maadr
Vorschangewiese.maadrÿ0
VorschVorschlag.maadrÿ0
ÿ½ jetzt noch irgendwie feststellen, was mit Vorschuss ist
ÿ¡VorschArt.maadrÿ2ÿkzvsu%ÿ1ÿp
ÿ½ allgemeiner Pauschalvorschuss
ÿ¡VorschAllg.maadrÿ0ÿp
ÿ¡Vorschubis.maadrÿ0ÿVorschubis.maadrÿdatum%ÿp
	VorschVorschlag.maadrÿVorschAllg.maadr
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ¡VorschArt.maadrÿ1ÿVorschuvon.maadrÿ0ÿVorschujn.maadrÿ1ÿkzvsu%ÿ1ÿp
ÿ½ 6Monatsregel
dstart%ÿVorschuvon.maadr
dmonat$ÿÿ+(ÿ(dstart%,"mm0dyyyy"),2)
dmonat%ÿÿ0(dmonat$)
djahr$ÿÿ+(ÿ(dstart%,"yyyymm0d"),4)
djahr%ÿÿ0(djahr$)
 
dges$ÿÿ+(ÿ(dstart%,"yyyymm0d"),6)
dges%ÿÿ0(dges$)
dtestmon%ÿdmonat%
dtestmon%ÿdtestmon%ÿ5
dtestj%ÿdjahr%
ÿ¡dtestmon%ÿ12ÿp
dtestj%ÿdtestj%ÿ1
dtestmon%ÿdtestmon%ÿ12
ÿ’ÿ¡
dtest$ÿÿ(dtestj%,"0000")ÿÿ(dtestmon%,"00")
dtest%ÿÿ0(dtest$)
ok%ÿ0
ÿ¡abrmonat%ÿdges%ÿabrmonat%ÿ	dtest%ÿp
ok%ÿÿ1
ÿ’ÿ¡
ÿ¡ok%ÿÿ1ÿp
dtestmon%ÿdmonat%
dtestj%ÿdjahr%
ÿ¡dges%ÿabrmonat%ÿp
	ÿ½ Anfangsmonat=akt.Abrechnungsmonat -> vmonat%=1
	vmonat%ÿ1
ÿ^
	vmonat%ÿ0
	ÿ›k%ÿ1ÿq5
vmonat%ÿvmonat%ÿ1
dtestmon%ÿdtestmon%ÿ1
ÿ¡dtestmon%ÿ12ÿp
dtestj%ÿdtestj%ÿ1
dtestmon%ÿdtestmon%ÿ12
ÿ’ÿ¡
dtest$ÿÿ(dtestj%,"0000")ÿÿ(dtestmon%,"00")
dtest%ÿÿ0(dtest$)
ÿ¡dtest%ÿabrmonat%ÿp
k%ÿ6
ÿ’ÿ¡
	ÿ±k%
ÿ’ÿ¡
ÿ¡vmonat%ÿ0ÿp
	ÿ½ jetzt die zum Monat geh”renden Grenzwerte fr die Vorschsse auslesen, dann testen ob die maksum% ber irgendwelche Grenzen liegt
	vorschg$ÿ"VorschG"ÿÿ(vmonat%,"0")ÿ".maadr"
	vorschw$ÿ"VorschW"ÿÿ(vmonat%,"0")ÿ".maadr"
 
	vorschgrm$ÿ"VorschGRM"ÿÿ(vmonat%,"0")ÿ".maadr"
	vorschrm$ÿ"VorschRM"ÿÿ(vmonat%,"0")ÿ".maadr"
 
	vorschgvd$ÿ"VorschGVD"ÿÿ(vmonat%,"0")ÿ".maadr"
	vorschvd$ÿ"VorschVD"ÿÿ(vmonat%,"0")ÿ".maadr"
 
	vorschg%ÿvorschg$$
	vorschw%ÿvorschw$$
 
	vorschgrm%ÿvorschgrm$$
	vorschrm%ÿvorschrm$$
 
	vorschgvd%ÿvorschgvd$$
	vorschvd%ÿvorschvd$$
	
	ÿ¡maksum%ÿvorschg%ÿp
VorschVorschlag.maadrÿvorschw%
	ÿ’ÿ¡
	ÿ¡maksum%ÿvorschgrm%ÿp
VorschVorschlag.maadrÿvorschrm%
	ÿ’ÿ¡
	ÿ¡maksum%ÿvorschgvd%ÿp
VorschVorschlag.maadrÿvorschvd%
	ÿ’ÿ¡
 
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 
 
ÿÌÿ™"maadr"
 ÿ’ÿ¡
 ÿ’ÿÿ
 
 
 
ÿÿFSMonAbschl()
 ÿ¡ÿOÿ´("BUMSATZ")ÿpÿƒDFile(3,"BUmsatz"ÿ_fpw$)
 ÿ¡ÿOÿ´("BUMSKTO")ÿpÿƒDFile(3,"BUmskto"ÿ_fpw$)
 ÿ™"maadr"
 ÿ£codema.maadr
 ÿÉÿ`ÿáÿ™"maadr"
 ÿØÿOÿB("maadr")
ma%ÿcodema.maadr
ÿƒFSMonAbschlMa(ma%)
ÿÉÿ±ÿáÿ™"maadr"ÿ£codema.maadr
 ÿÙ
 ÿ’ÿÿ
 
ÿÿFSMonAbschlMa(ma%)
 codema%ÿma%
 codemanr%ÿma%
 CodeVstatus%ÿCodeVStatus.kvertrag
 monat$ÿÿ+(ÿ(datum%,"mm0dyyyy"),2)
 ÿ½ aktueller Monat, aber wir brauchen zur Sicherung der alten Zahlen
 ÿ½ den Vormonat
 monat%ÿÿ0(monat$)
 jahr$ÿÿ+(ÿ(datum%,"yyyymm0d"),4)
 jahr%ÿÿ0(jahr$)
 monatold%ÿmonat%
 jahrold%ÿjahr%
 ÿ¡monatold%ÿ01ÿp
ÿ½ Vormonat ist also Dezember des Vorjahres
monatold%ÿ12
jahrold%ÿjahrold%ÿ1
 ÿ^
monatold%ÿmonatold%ÿ1
 ÿ’ÿ¡
 MonatOld$ÿÿ(monatold%,"00")
 Jahrold$ÿÿ(Jahrold%,"0000")
 AbrMonatOld$ÿJahrold$ÿMonatold$
 abrmonatold%ÿÿ0(AbrMonatold$)
 AbrMonat$ÿJahr$ÿMonat$
 abrmonat%ÿÿ0(AbrMonat$)
 ÿ™"maadr"
 ÿ£codema.maadr
 ÿÉÿ`
 ÿÉÿ¥codema%ÿáÿ™"maadr"ÿ£codema.maadr
 
 ÿ›i%ÿ2000ÿqjahr%
qcodemajahr$ÿÿ(codema.maadr,"000000")ÿÿ(jahr%,"0000")
jahr$ÿÿ(jahr%,"0000")
ÿ¡ÿOÿJ(qcodemajahr$,qcodemajahr.bumsatz)ÿp
ÿÿ™"BUMSATZ"
codema.BUMSATZÿcodema.maadr
Jahr.bumsatzÿÿ0(jahr$)
QCodemaJahr.BUMSATZÿqcodemajahr$
ÿÌÿ™"BUMSATZ"
ÿïÿYÿ™"BUMSATZ"
ÿ’ÿ¡
 ÿ±i%
 ÿ™"BUMSATZ"
 ÿÉÿ`ÿ™"BUMSATZ"ÿ£QCodemaJahr.BUMSATZ
 ÿÉÿ¥Qcodemajahr$ÿáÿ™"BUMSATZ"ÿ£QCodemaJahr.BUMSATZ
 ok%ÿ0
 ÿ¡mkz.maadrÿ0ÿp
ok%ÿÿ1
 ÿ^
 ÿ’ÿ¡
 
 
 ÿ’ÿÿ
 
 
ÿÿExpProvli()
GAdrDat$ÿ"ADRESSEN"
GConDat$ÿ"CONNECT"
GTelDat$ÿ"TELEFON"
GAkquiDat$ÿ"AKQUISE"
GDokDat$ÿ"DOKUMENT"
GADRStat$ÿ"ADRSTAT"
 
 
 
 ÿ¡PrvVerfahr$ÿ"ZAHLUNGSEINGANG"ÿp
ÿƒDFile(3,"Buchung1"ÿ_fpw$)
ÿÉÿĞÿ™"Buchung1"
budat$ÿ"Buchung1"
 ÿ^
ÿƒDFile(3,"Buchung"ÿ_fpw$)
ÿÉÿĞÿ™"Buchung"
budat$ÿ"Buchung"
 ÿ’ÿ¡
 ÿƒDFile(3,"fs24imp"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adrstat"ÿ_fpw$)
 ÿÉÿĞÿ™"adrstat"
 ÿƒDFile(2,"OFFICE\adrgrup"ÿ_fpw$)
 ÿÉÿĞÿ™"adrgrup"
 ÿƒDFile(3,"Kgeadr"ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿÉÿĞÿ™"Sparten"
 ÿƒDFile(3,"geadr"ÿ_fpw$):ÿƒDFile(3,"geadr2"ÿ_fpw$)
 ÿÉÿĞÿ™"geadr"
 ÿƒDFile(3,"tarif"ÿ_fpw$)
 ÿÉÿĞÿ™"tarif"
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿÉÿĞÿ™"maadr"
 ÿƒDFile(3,"maadrgru"ÿ_fpw$)
 ÿƒDFile(3,"mavorg"ÿ_fpw$)
 ÿÉÿĞÿ™"maadrgru"
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿÉÿĞÿ™"kvertrag"
 ÿƒDFile(3,"vprodukt"ÿ_fpw$)
 ÿÉÿĞÿ™"vprodukt"
 ÿƒDFile(3,"tarif"ÿ_fpw$)
 ÿÉÿĞÿ™"tarif"
 ÿƒDFile(3,"vorgang"ÿ_fpw$)
 ÿÉÿĞÿ™"vorgang"
 ÿƒDFile(3,"vkond"ÿ_fpw$)
 ÿÉÿĞÿ™"vkond"
 ÿƒDFile(3,"formular"ÿ_fpw$)
 ÿÉÿĞÿ™"formular"
 ÿƒDFile(3,"spgruppe"ÿ_fpw$)
 ÿÉÿĞÿ™"spgruppe"
 ÿƒDFile(3,"agdir"ÿ_fpw$)
 
 ÿƒDFile(3,"KVEXEXP"ÿ_fpw$)
 ÿƒDFile(3,"ZEINGAN1"ÿ_fpw$)
 ÿƒDFile(3,"BUCHXLS"ÿ_fpw$)
 
 ÿƒDFile(2,"OFFICE\"ÿGADRDat$ÿ_fpw$)
 ÿÉÿĞÿ™GAdrDat$
 ÿƒDFile(2,"OFFICE\"ÿGAkquiDat$ÿ_fpw$)
 ÿÉÿĞÿ™GAkquiDat$
 ÿƒDFile(2,"OFFICE\aktionen"ÿ_fpw$)
 ÿÉÿĞÿ™"aktionen"
 ÿƒDFile(2,"OFFICE\"ÿGTelDat$ÿ_fpw$)
 ÿÉÿĞÿ™GTelDat$
 ÿƒDFile(2,"OFFICE\"ÿGDokDat$ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\"ÿGConDat$ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\banken"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\tvorlage"ÿ_fpw$)
 
anf2306200410: 
 von$ÿ""
 bis$ÿÿQ
 allProv$ÿ"n"
 ÿ‰ÿñ"Konto1",0,0,221,165,title$,"MS Sans Serif",8
 ÿ|ÿñ"Konto1",9,6,7,24,22,2
 ÿ|ÿñ"Konto1",5,34,8,170,9,0,"Provisionsliste:"
 ÿ|ÿñ"Konto1",4,34,14,176,5,0,""
 ÿ|ÿñ"Konto1",5,34,22,175,16,0,"Bitte geben Sie ein, fr welchen Buchungszeitraum Sie eine šbersicht wnschen."
 ÿ|ÿñ"Konto1",5,34,40,175,32,0,"Wenn Sie keine Angaben zum Buchungszeitraum eintragen, werden alle Provisionen bzw. die Provisionen des vorgegebenen Zeitraumes aufgelistet."
 ÿ|ÿñ"Konto1",5,34,80,12,8,0,"von"
 ÿ|ÿñ"Konto1",6,53,79,45,11,0,0,von$,10
 ÿ|ÿñ"Konto1",5,102,80,12,8,0,"bis"
 ÿ|ÿñ"Konto1",6,116,79,45,11,0,0,bis$,10
 ÿ½ ADD DIALOG "Konto1",5,44,108,167,25,0,"(es werden auch die Provisionen angezeigt, die wegen fehlender Zahlungsbeitr„ge in der Mahnlist sind)"
 ÿ|ÿñ"Konto1",1,50,144,55,15,1,"&Weiter",1,1
 ÿ|ÿñ"Konto1",1,110,144,55,15,0,"&Abbruch",0,0
 ÿñ"Konto1",req%
 ÿ¾ÿñ"Konto1"
 ÿßÿ³
 ÿ¡req%ÿ1ÿpÿwend2306200410
ÿßÿe
ÿ¡von$ÿ""ÿpvondat$ÿ"01.01.1980"ÿ^vondat$ÿvon$
ÿ¡bis$ÿ""ÿpbisdat$ÿÿ(ÿQ)ÿ^bisdat$ÿbis$
 
 

ÿ¡DateOK%(vondat$)ÿp
von%ÿÿ1(von$)
ÿ^
ÿƒFehler("Datum ist ungltig!","")
ÿwanf2306200410
ÿ’ÿ¡
ÿ¡DateOK%(bisdat$)ÿp
bis%ÿÿ1(bisdat$)
ÿ^
ÿƒFehler("Datum ist ungltig!","")
ÿwanf2306200410
ÿ’ÿ¡
dpfad$ÿ_netpath$ÿ"0-Export"
ÿ³ÿ_ÿww280820061
ÿªÿdpfad$
w280820061: 
dpfad$ÿ_netpath$ÿ"0-Export\ProvAbr"
ÿ³ÿ_ÿww280820062
ÿªÿdpfad$
w280820062:
ÿ³ÿ_ÿwErrorHandler
dpfad$ÿ_netpath$ÿ"0-Export\ProvAbr\"ÿÿ(ÿQ,"yymm0d")
datnr$ÿÿ(ÿQ,"yymm0d")
i%ÿ0
ok%ÿ0
ÿØok%ÿ0
i%ÿi%ÿ1
ÿ¡i%ÿ99ÿp
	ÿ³ÿ_ÿwarb2306042
	ÿ¾ÿdpfad$ÿ"01"
arb2306042: 
	i%ÿ1
ÿ’ÿ¡
ÿ³ÿ_ÿwarb2306041
tpfad$ÿdpfad$ÿÿ(i%,"00")
ÿªÿdpfad$ÿÿ(i%,"00")
dpfad$ÿdpfad$ÿÿ(i%,"00")
ok%ÿÿ1
arb2306041: 
ÿ³ÿ_ÿwErrorHandler
ÿÙ
 
textdo1$ÿtpfad$
ÿ½ CALL Fehler("EXPORT " + nachname.maadr,textdo1$)
 ÿ™budat$
 ÿ£QuickCode.budat$
 ÿ™"maadr"
 ÿ£codema.maadr
 ÿÉÿ`
 ÿØÿOÿB("maadr")
ÿßÿe
codema%ÿcodema.maadr
codema$ÿÿ(codema.maadr,"000000")
ÿÊÿËcodema$ÿ" "ÿnachname.maadr
ÿ¡ÿOÿJ(codema%,codema.budat$)ÿpÿwtestma2306200413
qcode$ÿÿ(codema.maadr,"000000")ÿÿ(von%,"yyyymmdd")
qcode1$ÿÿ(codema.maadr,"000000")ÿÿ(bis%,"yyyymmdd")
ÿÉÿ`ÿ™budat$ÿ£QuickCode.budat$
ÿÉÿ¥qcode$ÿ™budat$ÿ£QuickCode.budat$
summeprov%ÿ0
summevsv%ÿ0
summesr%ÿ0
summevorsch%ÿ0
anzahl%ÿ0
ÿ¾ÿaÿ™"buchxls"
ÿØÿOÿB(budat$)ÿQuickCode.budat$ÿqcode$ÿQuickCode.budat$ÿ	qcode1$
anzahl%ÿanzahl%ÿ1
ÿÊÿË"Erstelle Liste fr: "ÿcodema$ÿ" "ÿnachname.maadrÿ" / Anzahl Buchungen "ÿÿ(anzahl%,",999999")
ÿßÿe
summeprov%ÿsummeprov%ÿbetrag.budat$
summesr%ÿsummsr%ÿsr.budat$
ÿ¡budat$ÿ"buchung1"ÿp
ÿ¡vorschujn.budat$ÿ1ÿp
	summevorsch%ÿsummevorsch%ÿbetrag.budat$
ÿ’ÿ¡
summevsv%ÿsummevsv%ÿvsv.budat$
ÿ’ÿ¡

ÿÿ™"Buchxls"
a%ÿCopyRecord%(budat$,"Buchxls")
ÿÌÿ™"buchxls"
ÿÉÿ±ÿ™budat$
ÿÙ
ÿ½ Anfang Ausgabe nach EXCEL
ÿ¡anzahl%ÿ0ÿp
ÿ¡GAFSK$ÿ"TRUE"ÿp
ÿ™"buchxls"
ÿtextdo1$
ÿ´ÿ˜Datum,Buchungstext,Betrag,SR,VSV,Nachname,Vorname,VS_Beginn,Gesellschaft,Bewertungssumme,Gesamtbetrag,Einheiten,VTAgentur,F„lligkeit,Waehrung:
agenturnr$ÿVSNRPack$(ÿF(ÿH(ÿ-(Agenturnr.maadr,8))))
ÿ¡ÿH(agenturnr$)ÿ""ÿpagenturnr$ÿÿ(codema.maadr,"000000")

datneu$ÿtextdo1$ÿ"\"ÿagenturnr$ÿ".xls"
ÿ¡ÿJ(datneu$)ÿpÿdatneu$
Superbase.Converters.SBF.SourceFormatÿ"Superbase"
Superbase.Converters.SBF.SourceFileÿ"BUCHXLS"
Superbase.Converters.SBF.Descendingÿ0
Superbase.Converters.SBF.Mergeÿÿ1
Superbase.Converters.SBF.LogErrorsÿ0
Superbase.Converters.SBF.MultiResponseÿ0
Superbase.Converters.XLS.DestFormatÿ"Microsoft Excel"
Superbase.Converters.XLS.DestFileÿdatneu$
Superbase.Converters.XLS.StartRowÿ2
Superbase.Converters.XLS.StartColÿ1
Superbase.Converters.XLS.EndRowÿÿ1
Superbase.Converters.XLS.EndColÿÿ1
Superbase.Converters.XLS.UseLabelsÿÿ1
Superbase.Converters.XLS.Convert(Superbase.Converters.SBF)
ÿ½ CALL Fehler("EXPORT " + nachname.maadr,datneu$)
ÿÊÿË"EXPORT "ÿnachname.maadrÿ"   "ÿdatneu$
ÿ^
ÿ™"buchxls"
ÿtextdo1$
ÿ´ÿ˜Datum,Buchungstext,Betrag,MWSTProz,MWSTBetragEU,NettoEU,SR,Gesamtbetrag,VSV,Nachname,Vorname,VS_Beginn,Gesellschaft,Sparte,Bewertung2EU,Einheiten,VTAgentur,F„lligkeit,Waehrung:
agenturnr$ÿVSNRPack$(ÿF(ÿH(ÿ-(Agenturnr.maadr,8))))
ÿ¡ÿH(agenturnr$)ÿ""ÿpagenturnr$ÿÿ(codema.maadr,"000000")
datneu$ÿtextdo1$ÿ"\"ÿagenturnr$ÿ".xls"
ÿ¡ÿJ(datneu$)ÿpÿdatneu$
Superbase.Converters.SBF.SourceFormatÿ"Superbase"
Superbase.Converters.SBF.SourceFileÿ"BUCHXLS"
Superbase.Converters.SBF.Descendingÿ0
Superbase.Converters.SBF.Mergeÿÿ1
Superbase.Converters.SBF.LogErrorsÿ0
Superbase.Converters.SBF.MultiResponseÿ0
Superbase.Converters.XLS.DestFormatÿ"Microsoft Excel"
Superbase.Converters.XLS.DestFileÿdatneu$
Superbase.Converters.XLS.StartRowÿ2
Superbase.Converters.XLS.StartColÿ1
Superbase.Converters.XLS.EndRowÿÿ1
Superbase.Converters.XLS.EndColÿÿ1
Superbase.Converters.XLS.UseLabelsÿÿ1
Superbase.Converters.XLS.Convert(Superbase.Converters.SBF)
ÿ½ CALL Fehler("EXPORT " + nachname.maadr,datneu$)
ÿÊÿË"EXPORT "ÿnachname.maadrÿ"   "ÿdatneu$
ÿ’ÿ¡
ziel$ÿtextdo1$ÿ"\"ÿÿåansi(nachname.maadrÿ"-"ÿvorname.maadrÿ"-"ÿagenturnr$)ÿ".xls"
 
a%ÿÿƒ("_SBFileCopy",datneu$,ziel$)
il%ÿ0
w280820063: 
ÿ½ WAIT FOR 1
ÿ³ÿ_ÿww280820063
ÿ¡ÿJ(datneu$)ÿil%ÿ
10ÿp
il%ÿil%ÿ1
ÿ½ DELETE datneu$
ÿ’ÿ¡
ÿÂ"MS Excel Ausgabe fr:",nachname.maadr,2
ÿ’ÿ¡
ÿ½ Ende Ausgabe nach Excel
testma2306200413: 
ÿ™"maadr"
ÿÉÿ±ÿ™"maadr"
 ÿÙ
ÿ½ REGISTER _netpath$ + "CODieLIB.dll","_SBSetCurrentDir","IF"
ÿ½ a% = CALL ("_SBSetCurrentDir",textdo1$)
ÿ½ REGISTER CLEAR "_SBSetCurrentDir"
ÿ½ REGISTER _netpath$ + "CODieLIB.dll","_SBGetCurrentDir","IF"
ÿ½ a% = CALL ("_SBGetCurrentDir",ziel$)
ÿ½ REGISTER CLEAR "_SBGetCurrentDir"

ÿƒFehler("Die Ausgabe der MS EXCEL Provisionslisten in das Verzeichnis: "ÿtextdo1$,"wurde beendet!")
 
end2306200410: 
 ÿ’ÿÿ
 
 

