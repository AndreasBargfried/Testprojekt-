  


 CALL main()
 
 ' Update fÅr Dateistrukturen
 ' Copyright (c) 1993-1995 CODie software products
 ' Stand   : 17.08.1999 0.05
 ' =============================================================
 ' 16.10.94 - Umgestellt auf neue SERVER.DLL 3.0
 ' 30.12.96 - Anpassung an neue Dateien
 ' öbergehen der Telefonnummernanpassung und des Aufbaus der Zusatzdateien,
 ' wenn diese schon angepasst wurden
 ' ExpAG fÅr Real Cash Export
  
SUB DoUpdate()
 CALL HideStartup()
 REM GLOBAL Changes%,ChangesMax%
 
 REM ****************************************************
 REM ** ChangesMax% wird mit der Anzahl der            **
 REM ** notwendigen énderungen in OFFICE initialisiert **
 REM ****************************************************
 
 ChangesMax% = 110

 
 REM ****************************************************
 REM ** HinzufÅgen der notwendigen énderungen des      **
 REM ** jeweilgen Projektes                            **
 REM ****************************************************
 
 SELECT CASE UCASE$ (_projekt$)
 CASE "IMMAK"
   ChangesMax% = ChangesMax% + 82
 CASE "FACTURA"
   ChangesMax% = ChangesMax% + 260
 CASE "PROVIS"
   ChangesMax% = ChangesMax% + 875
 CASE "MEDIA"
   ChangesMax% = ChangesMax% + 11
 END SELECT 
  
 Changes% = 0
 
 CREATE DIALOG "UPDATE",0,0,278,121,"Update","MS Sans Serif",8
 ADD DIALOG "UPDATE",4,0,0,278,97,0,""
 ADD DIALOG "UPDATE",9,6,6,20,22,4
 ADD DIALOG "UPDATE",5,38,9,203,10,0,"Ihre Daten werden nachfolgend an die neuen Funktionen des"
 ADD DIALOG "UPDATE",5,38,19,76,9,0,"Programmes angepa·t."
 ADD DIALOG "UPDATE",5,38,33,219,8,0,"Damit das Update fehlerfrei durchgefÅhrt werden kann, mÅssen Sie"
 ADD DIALOG "UPDATE",5,38,43,242,9,0,"sicherstellen, da· kein weiterer Mitarbeiter im Programm angemeldet ist."
 ADD DIALOG "UPDATE",5,38,60,232,8,0,"Wenn Sie das Update jetzt durchfÅhren lassen wollen, drÅcken Sie"
 ADD DIALOG "UPDATE",5,38,70,232,8,0,"auf " + CHR$ (34) + "Fortfahren" + CHR$ (34) + ", wenn Sie das Update zu einem spÑteren Zeitpunkt"
 ADD DIALOG "UPDATE",5,38,80,219,8,0,"starten wollen, drÅcken Sie auf " + CHR$ (34) + "Abbrechen" + CHR$ (34) + "."
 ADD DIALOG "UPDATE",1,82,100,55,15,1,"&Fortfahren",1,1
 ADD DIALOG "UPDATE",1,140,100,55,15,0,"&Abbrechen",0,0
 DIALOG "UPDATE",req%
 REMOVE DIALOG "UPDATE"
 
 IF req% <> 1 THEN 
   CALL EXIT()
 END IF 
 
 REM ** zusÑtzlich angemeldete Nutzer erkennen **
 GLOBAL GIndNeu%,NeuADR%,NeuPost%,NeuKVer%
    GIndNeu% = 0:NeuADR% = 0:NeuPost% = 0:NeuKVer% = 0

 IF OPEN ("supervis") THEN CLOSE FILE "supervis"
 CALL DFile(2,"accode" + _fpw$)
 CALL DFile(4,"supervis;paris")
 IF _error% = 132 OR _error% = 140 THEN 
   msg$ = "Bitte stellen Sie sicher, da· kein weiterer Mitarbeiter angemeldet ist."
   CALL Fehler("Es sind noch weitere Mitarbeiter im Programm angemeldet!",msg$)
   CALL EXIT()
 END IF 
 REM CALL FldAdd("nureigeneDaten","NUM;0",0)
 REM SAVE FILE "Supervis"
 
    IF GAFSK$ LIKE "TRUE" THEN 
      REQUEST "Wollen Sie auch das Datum der","AFSK-FÑlligeit mit dem Zahlungseingang checken?",130,req%
      IF req% = 1 THEN 
        GAFSKCheck$ = "TRUE"
      ELSE 
        GAFSKCheck$ = "False"
      END IF 
      IF RECCOUNT ("MASUPER") > 0 THEN REMOVE FROM FILE "MASUPER"
    END IF 
    GIndNeu% = 0

    DIM dlg AS Dialog
    DIM control AS DialogControl
 
    Superbase.Dialogs.Add("Dialogname")
    SET dlg = Superbase.Dialogs.Dialogname
    dlg.Move(0,0,320,288)
    dlg.Caption = "Parameter fÅr das Update"
    dlg.FontName = "MS Sans Serif"
    dlg.FontSize = 8
 
    SET control = dlg.Add("DialogFrame1","DialogFrame")
    control.Move(0,0,310,32)
    control.Caption = "Parametersetzung fÅr das Update"
 
    SET control = dlg.Add("DialogCheckBox1","DialogCheckBox")
    control.Move(8,11,300,14)
    control.Caption = "Neuaufbau der Quicksuchfelder und Neuerzeugung aller Indexdateien fÅr alle Dateien"
    control.Bind("GIndNeu%")
    control.ValueOn = - 1
    control.ValueOff = 0
  IF _projekt$ <> "IMMAK" THEN 
    SET control = dlg.Add("DialogFrame2","DialogFrame")
    control.Move(0,36,310,95)
    control.Caption = "Datenbank: Adressen"
 
    SET control = dlg.Add("DialogCheckBox2","DialogCheckBox")
    control.Move(6,46,234,14)
    control.Caption = "komplette Reorganisation und Neuaufbau der Adressdatenbank"
    control.Bind("NeuADR%")
    control.ValueOn = - 1
    control.ValueOff = 0
 
    SET control = dlg.Add("DialogLabel1","DialogLabel")
    control.Move(6,64,300,28)
    control.Caption = "Sie erhalten nachfolgend die Mîglichkeit das Postanschriftsfeld neu generieren zu lassen. Dieses Feld befindet sich auf der Notizseite/Maske Kunden und wird fÅr die Dokumenten - und Serienbrieferstellung genutzt."
 
    SET control = dlg.Add("DialogLabel2","DialogLabel")
    control.Move(6,92,300,20)
    control.Caption = "Wenn Sie bereits Adressen im Postanschriftsfeld manuell erfa·t / geÑndert haben,sollten Sie nicht die automatische Generierung durchfÅhren!!!"
 
    SET control = dlg.Add("DialogCheckBox3","DialogCheckBox")
    control.Move(6,113,244,15)
    control.Caption = "Neuerzeugung des Postanschriftsfeldes der Adressdatei"
    control.Bind("NeuPost%")
    control.ValueOn = - 1
    control.ValueOff = 0
 


    SET control = dlg.Add("DialogFrame3","DialogFrame")
    control.Move(0,134,310,40)
    control.Caption = "Datenbank: VertrÑge(KVERTRAG)"
 
    SET control = dlg.Add("DialogCheckBox4","DialogCheckBox")
    control.Move(6,145,294,11)
    control.Caption = "komplette Reorganisation und Neuaufbau der Vertragsdatenbank"
    control.Bind("NeuKVer%")
    control.ValueOn = - 1
    control.ValueOff = 0
 

    SET control = dlg.Add("DialogCheckBox5","DialogCheckBox")
    control.Move(6,155,294,11)
    control.Caption = "komplette Reorganisation und Neuaufbau der Produktdatenbank"
    control.Bind("NeuProd%")
    control.ValueOn = - 1
    control.ValueOff = 0


    SET control = dlg.Add("DialogFrame4","DialogFrame")
    control.Move(0,178,310,30)
    control.Caption = "Stufennummern der Vermittler"
 
    SET control = dlg.Add("DialogCheckBox6","DialogCheckBox")
    control.Move(6,189,294,11)
    control.Caption = "Neubestimmung der Vermittlerstufen"
    control.Bind("stufebere$")
    control.ValueOn = "j"
    control.ValueOff = "n"


    SET control = dlg.Add("DialogFrame5","DialogFrame")
    control.Move(0,210,310,30)
    control.Caption = "Aufbau der Zusatzdateien (Anrede,Titel...)"
 
    SET control = dlg.Add("DialogCheckBox7","DialogCheckBox")
    control.Move(6,221,294,11)
    control.Caption = "Aufbau Zusatzdateien"
    control.Bind("aufbzusatz$")
    control.ValueOn = "j"
    control.ValueOff = "n"


  END IF 
    SET control = dlg.Add("DialogLabel11","DialogLabel")
    control.Move(16,241,280,30)
    control.Caption = "<<<<<< Die oben aufgefÅhrten Optionen brauchen Sie nicht anzukreuzen. Sie dienen nur zur Anpassung veralteter Superbaseversionen an die neuere Versionen! Gegebenenfalls erkundigen Sie sich bei CODie software e.K.>>>>>>>"

    SET control = dlg.Add("DialogCommandButton1","DialogCommandButton")
    control.Move(120,271,58,14)
    control.Default = 1
    control.Caption = "OK"
    control.ReturnValue = 1
 
    DIALOG "Dialogname",req%
    REMOVE DIALOG ALL 
    MOUSE ON 
 GOTO w221020091
 REM**********************************************************************************************************************************************************************
 REQUEST "Mîchten Sie fÅr alle Vertragsnachberabeitungen/SchÑden,","zu denen kein Termin existiert, einen Termin erzeugen lassen?",135,Greqter%
 IF Greqter% = 1 THEN 
   IF NOT OPEN ("Aktionen") THEN CALL DFile(2,"OFFICE\aktionen" + _fpw$)
   FILE "Aktionen"
   INDEX codeak.aktionen
   FILE "Supervis"
   INDEX nachname.supervis
   SELECT FIRST FILE "Supervis" INDEX nachname.supervis
   DIM Agenturen$( RECCOUNT ("SUPERVIS") + 1)
 
 a% = 0
 
 IF gasp% <> - 1 OR workstation% = 0 THEN 
   WHILE NOT EOF ("Supervis")
     Agenturen$(a%) = Nachname.supervis + "," + Vorname.supervis + SPACE$ (80) + STR$ (codema.supervis,"000000")
     a% = a% + 1
     SELECT NEXT FILE "supervis"
   WEND 
 END IF 
 IF gasp% THEN 
   WHILE NOT EOF ("supervis")
    IF LTRIM$ (name.supervis) <> "" THEN 
     REM MALIST2$(b%) = name.supervis
     REM MALIST2%(b%) = codema.supervis
     b% = b% + 1
     REM CALL Fehler("","")
     IF GASP% THEN 
       wks% = Workstation%
       FOR ii% = 0 TO VisCount% - 1' Fall externes BÅro
         wks% = VisOff%(ii%)
         aa% = IsWksVisible%(wks%)
         na123$ = name.supervis
         REM CALL Fehler(na123$,"")
         IF aa% = - 1 AND Workstation.supervis = wks% THEN 
           sok% = - 1
           ii% = VisCount%
         ELSE 
           sok% = 0
         END IF 
       NEXT ii%
       joo% = - 1
       REM IF GMASuperCount% > 0 THEN 
         REM joo% = IsMASuper%(codema.supervis)
       REM END IF 
       IF sok% AND joo% THEN 
         Agenturen$(a%) = Nachname.supervis + "," + Vorname.supervis + SPACE$ (80) + STR$ (codema.supervis,"000000")
         REM MALIST%(a%) = codema.supervis
         a% = a% + 1
       END IF 
     ELSE 
       IF ag$ <> "j" THEN 
         ON ERROR GOTO w261020021
         IF ZugSperr.supervis <> "j" THEN 
           IF GMASuperCount% > 0 THEN 
             IF IsMASuper%(codema.supervis) THEN 
               Agenturen$(a%) = Nachname.supervis + "," + Vorname.supervis + SPACE$ (80) + STR$ (codema.supervis,"000000")
               a% = a% + 1
             END IF 
           ELSE 
             Agenturen$(a%) = Nachname.supervis + "," + Vorname.supervis + SPACE$ (80) + STR$ (codema.supervis,"000000")
             a% = a% + 1
           END IF 
         END IF 
       ELSE 
w261020021: 
         REM MALIST$(a%) = name.supervis
         REM MALIST%(a%) = codema.supervis
         IF GMASuperCount% > 0 THEN 
           IF IsMASuper%(codema.supervis) THEN 
             Agenturen$(a%) = Nachname.supervis + "," + Vorname.supervis + SPACE$ (80) + STR$ (codema.supervis,"000000")
             a% = a% + 1
           END IF 
         ELSE 
           Agenturen$(a%) = Nachname.supervis + "," + Vorname.supervis + SPACE$ (80) + STR$ (codema.supervis,"000000")
           a% = a% + 1
         END IF 
       END IF 
     END IF 
   END IF 
   SELECT NEXT FILE "supervis" INDEX nachname.supervis
  WEND 
 END IF 
 SELECT FIRST FILE "supervis"
 SELECT KEY vcodema% FILE "Supervis" INDEX codema.supervis
 auswahl$ = Nachname.supervis + "," + Vorname.supervis + SPACE$ (80) + STR$ (codema.supervis,"000000")
 FILE "Aktionen"
 INDEX Bezeichnung.Aktionen
 SELECT FIRST 
 DIM Aktionen$( RECCOUNT ("Aktionen") + 1)
 a% = 1
 Aktionen$(0) = "<allgemeiner Terminkalender>" + SPACE$ (80) + "000001"
 WHILE NOT EOF ("Aktionen")
   IF Bezeichnung.Aktionen <> "" AND codeak.aktionen > 0 THEN 
     Aktionen$(a%) = Bezeichnung.Aktionen + SPACE$ (80) + STR$ (codeak.Aktionen,"000000")
     a% = a% + 1
   END IF 
   SELECT NEXT FILE "Aktionen"
 WEND 
 LAuswahl$ = Aktionen$(0)
 
 
 
 CREATE DIALOG "TLISTE",0,0,170,136,title$,"MS Sans Serif",8
 ADD DIALOG "TLISTE",4,0,0,306,114,0,""
 ADD DIALOG "TLISTE",5,5,11,162,30,0,"Bitte wÑhlen Sie den Mitarbeiter und die Aktion die in die Termine der Nachbearbeitung eingetragen werden sollen:"
 ADD DIALOG "TLISTE",5,5,40,62,9,0,"Mitarbeiter:"
 ADD DIALOG "TLISTE",5,5,67,62,9,0,"Aktionen:"
 ADD DIALOG "TLISTE",8,5,50,146,88,259,2,Auswahl$,Agenturen$
 ADD DIALOG "TLISTE",8,5,76,146,88,259,2,LAuswahl$,Aktionen$
 ADD DIALOG "TLISTE",1,10,117,55,15,1,"&Weiter",1,1
 ADD DIALOG "TLISTE",1,67,117,55,15,0,"&Abbrechen",0,0
 DIALOG "TLISTE",req%
 REMOVE DIALOG "TLISTE"
 IF req% = 1 THEN 
   ma% = VAL ( RIGHT$ (Auswahl$,6))
   ak% = VAL ( RIGHT$ (Lauswahl$,6))
   IF ak% = 0 THEN ak% = 1
   GCodeAK% = ak%
   GMACodeMA1% = ma%
 ELSE 
   Greqter% = 0
   GMACodeMA1% = 0
   GCodeAK% = 0
 END IF 
 REM **********************************************************************************************************************************************************************
w221020091: 
 CALL Server("LOADUPDATE","")
 CALL Server("UPDFILE","")
 CALL Server("UPDFIELD","")
 CALL Server("UPDSTATUS","Update wird vorbereitet...")
 CALL Server("UPDGAUGE","0")


 REM GOTO CreateKukto1410010 

 REM 220497 zunÑchst alle Dateien reorganisieren
 REM CALL ReorgDB()
   REM -- Anpassun CONFIG.SBF --
   IF OPEN ("config") THEN CLOSE FILE "config"
   CALL DFile(22,"CONFIG" + _fpw$)
   FILE "CONFIG"
   CALL FldAdd("SOLL","TXT;1",0)
   SAVE FILE "CONFIG"
   SELECT FIRST LOCK FILE "CONFIG"
   dsoll$ = ReadConfig$(_projekt$,"SSS")
   IF dsoll$ LIKE "JOJO" THEN 
     soll.config = "j"
     STORE FILE "CONFIG"
   END IF 
   CALL WriteConfig("PROVIS","SSS","")
   UNLOCK CURRENT FILE "CONFIG"

  
   REM -- Anpassun STAMM.SBF --
   CALL DFile(3,"STAMM" + _fpw$)
   FILE "STAMM"
   REM CALL Fehler("inhouse","")
   inhouse% = - 1
   ON ERROR GOTO w210920091
   inhouse% = inhausra.stamm
   inhouse% = 0
w210920091: 
   ON ERROR GOTO ErrorHandler
   scenter% = - 1
   ON ERROR GOTO w290420101
   scenter% = scenter.stamm
   scenter% = 0
w290420101: 
   ON ERROR GOTO ErrorHandler 
   FOR i% = 1 TO 50
     t1$ = "Titel" + STR$ (i%,"00")
     CALL FldAdd(t1$,"TXT;20",0)
     t1$ = "BWS" + STR$ (i%,"00")
     CALL FldAdd(t1$,"NUM;,999999999999.00",0)
     t1$ = "SQuote" + STR$ (i%,"00")
     CALL FldAdd(t1$,"NUM;999.00",0)
     t1$ = "MAAnz" + STR$ (i%,"00")
     CALL FldAdd(t1$,"NUM;,999999.",0)
     t1$ = "Bonifik" + STR$ (i%,"00")
     CALL FldAdd(t1$,"TXT;30",0)
     t1$ = "BWSEU" + STR$ (i%,"00")
     CALL FldAdd(t1$,"NUM;,999999999999.00",0)
   NEXT i%
 


   CALL FldAdd("Umrechnung","NUM;,99999999.000000",0)
   CALL FldAdd("CodeW","NUM;000000.",1)
   CALL FldAdd("Waehrung","TXT;6",0)

   CALL FldAdd("SRRÅck","TXT;1",0)
   CALL FldAdd("KUNRPREFIX","TXT;6",0)
   CALL FldAdd("LastKunr","NUM;999999999999",0)
   CALL FldAdd("IntPREFIX","TXT;6",0)
   CALL FldAdd("LastIntnr","NUM;999999999999",0)
   CALL FldAdd("TextKopf","TXT;4000 R",0)
   CALL FldAdd("TextFuss","TXT;4000 R",0)
   CALL FldAdd("IntVerw","TXT;1",0)
   CALL FldAdd("VertrArt","TXT;1",0)
   REM fÅr Euroumstellung
   CALL FldAdd("EUBWSum","TXT;1",0)
   CALL FldAdd("EUVolumen","TXT;1",0)
   CALL FldAdd("EUBeitrag","TXT;1",0)
   CALL FldAdd("EUVSSum","TXT;1",0)
   CALL FldAdd("EUnurungekuend","TXT;1",0)
   CALL FldAdd("EUAlles","TXT;1",0)
   CALL FldAdd("EUWaehr","TXT;10",0)
   CALL FldAdd("EUCodeW","NUM;000000.",0)
   CALL FldAdd("EUBuch","TXT;1",0)
   CALL FldAdd("EUKvertrag","TXT;1",0)
   CALL FldAdd("EUZeing","TXT;1",0)
   CALL FldAdd("eukuenddat","DAT;0d.mm.yyyy",0)
   CALL FldAdd("eufondsdat","DAT;0d.mm.yyyy",0)
   CALL FldAdd("eubuchdat","DAT;0d.mm.yyyy",0)
   CALL FldAdd("euzahldat","DAT;0d.mm.yyyy",0)
   CALL FldAdd("letzteEUUmst","TXT;100 R",0)
   CALL FldAdd("EUKond","TXT;1",0)
   CALL FldAdd("EUFonds","TXT;1",0)
   CALL FldAdd("EinheitAusGeko","NUM;0.",0)
   CALL FldAdd("EinheitSach","TXT;1",0)
   CALL FldAdd("IIM","TXT;1",0)
   CALL FldAdd("IIM_CustomerID","TXT;50",0)
   CALL FldAdd("IIM_Server","TXT;50",0)
   CALL FldAdd("IIM_DB","TXT;50",0)
   CALL FldAdd("IIM_LOGIN","TXT;50",0)
   CALL FldAdd("IIM_PWD","TXT;50",0)
   CALL FldAdd("AutomNetBer","TXT;1",0)
   CALL FldAdd("KuktoerlJN","TXT;1",0)
   CALL FldAdd("RealStorno","NUM;0.",0)
   CALL FldAdd("CodeMAUebProv","NUM;000000.",0)
   CALL FldAdd("UebProvAG","TXT;61",0)
   CALL FldAdd("UebProvPausch","NUM;,999999.00",0)
   CALL FldAdd("PflegevomNetto","TXT;1",0)
   CALL FldAdd("VertrGesamt","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu1","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu2","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu3","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu4","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu5","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu6","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu7","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu8","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu9","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu10","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu11","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu12","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu13","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu14","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu15","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu16","NUM;,999999999999",0)
 
   CALL FldAdd("BWVertrGesamt","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu1","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu2","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu3","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu4","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu5","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu6","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu7","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu8","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu9","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu10","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu11","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu12","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu13","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu14","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu15","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu16","NUM;,999999999999.00",0)
 
   CALL FldAdd("BeiVertrGesamt","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu1","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu2","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu3","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu4","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu5","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu6","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu7","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu8","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu9","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu10","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu11","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu12","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu13","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu14","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu15","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu16","NUM;,999999999999.00",0)
 
   CALL FldAdd("EinhGesamt","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu1","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu2","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu3","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu4","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu5","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu6","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu7","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu8","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu9","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu10","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu11","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu12","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu13","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu14","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu15","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu16","NUM;,9999999999.0000",0)
 
   CALL FldAdd("AnzSchGesamt","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu1","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu2","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu3","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu4","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu5","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu6","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu7","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu8","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu9","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu10","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu11","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu12","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu13","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu14","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu15","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu16","NUM;,9999999999.",0)
 
   CALL FldAdd("SchGesamt","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu1","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu2","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu3","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu4","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu5","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu6","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu7","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu8","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu9","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu10","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu11","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu12","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu13","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu14","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu15","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu16","NUM;,9999999999.00",0)
   CALL FldAdd("STATISTDATE","DAT;0d.mm.yyyy",0)
   CALL FldAdd("VertrStatu0","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu0","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu0","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu0","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu0","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu0","NUM;,9999999999.00",0)
   CALL FldAdd("Schadquote","NUM;,9999999.0000",0)
   CALL FldAdd("Stornoquote","NUM;,99999.0000",0)
   CALL FldAdd("CAgez","NUM;,999999999999.00",0)
   CALL FldAdd("UEBERWTXT","TXT;27",0)
   CALL FldAdd("DruInEur","NUM;,0.",0)
   CALL FldAdd("EMAILSHost","TXT;150",0)
   CALL FldAdd("EMAILSPort","NUM;999999.",0)
   CALL FldAdd("EMAILSUserID","TXT;150",0)
   CALL FldAdd("EMAILPHost","TXT;150",0)
   CALL FldAdd("EMAILPPort","NUM;999999.",0)
   CALL FldAdd("EMAILPUserID","TXT;150",0)
   CALL FldAdd("EMAILPPasww","TXT;150",0)
   CALL FldAdd("EMAILPOP3JN","TXT;5",0)
   CALL FldAdd("EMAILSAFirma","TXT;150",0)
   CALL FldAdd("EMAILJN","NUM;,0.",0)
   CALL FldAdd("EMAILJNAuto","NUM;,0.",0)
   CALL FldAdd("BEWERT2JN","TXT;1",0)
   CALL FldAdd("ADRSchnell","NUM;,0.",0)
   CALL FldAdd("ADRZwang","NUM;,0.",0)
   CALL FldAdd("ProtAll","NUM;,0.",0)
   CALL FldAdd("GenBanrede","NUM;,0.",0)
   CALL FldAdd("VertrStatu20","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu20","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu20","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu20","NUM;,9999999999.00",0)
   CALL FldAdd("VertrStatu21","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu21","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu21","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu21","NUM;,9999999999.00",0)
   CALL FldAdd("BZwang","NUM;,0.",0)
   CALL FldAdd("nurEinh","TXT;1",0)
   CALL FldAdd("nurProv","TXT;1",0)
   CALL FldAdd("FDATE","DAT;0d.mm.yyyy",0)
   CALL FldAdd("gserdir","TXT;250",0)
   CALL FldAdd("FirmaEurEinh","NUM;,99999999.0000",0)
   CALL FldAdd("FirmaEinhTab","TXT;1",0)
   CALL FldAdd("VMoldSuch","TXT;1",0)
   CALL FldAdd("FTabnurEinh","TXT;1",0)
   CALL FldAdd("sofortBereEinh","TXT;1",0)
   CALL FldAdd("noBerechEinhEig","TXT;1",0)
   CALL FldAdd("DokPass","TXT;100",0)
   CALL FldAdd("SpezProvNormal","TXT;1",0)
   CALL FldAdd("FoerdAufSpez","TXT;1",0)
   CALL FldAdd("OBERFIRMA","NUM;000000.",0)
   CALL FldAdd("Inhaus","TXT;1",0)
   CALL FldAdd("Inhausra","NUM;0.",0)
   CALL FldAdd("scenter","NUM;0.",0)
   SAVE FILE "STAMM"
   SELECT FIRST LOCK 
   IF Inhaus.stamm = "" THEN Inhaus.stamm = "n"
   IF FoerdAufSpez.stamm = "" THEN FoerdAufSpez.stamm = "n"
   IF SpezProvNormal.stamm = "" THEN SpezProvNormal.stamm = "n"
   IF gserdir.stamm = "" AND gasp% = - 1 THEN gserdir.stamm = "H:\"
   GBVF$ = UCASE$ (ReadConfig$("PROVIS","BVF"))
   IF gbvf$ LIKE "TRUE" THEN 
     IF fdate.stamm < 1 THEN fdate.stamm = "01.07.2004"
   END IF 
   IF VMoldSuch.stamm = "" THEN VMoldSuch.stamm = "n"
   IF FirmaEinhTab.stamm = "" THEN FirmaEinhTab.stamm = "n"
   IF BEWERT2JN.stamm = "" THEN BEWERT2JN.stamm = "n"
   IF EMAILJNAuto.stamm = 0 THEN EMAILJNAuto.stamm = 2
   IF EMAILJN.stamm = 0 THEN EMAILJN.stamm = 2
   IF DruInEur.stamm < 1 THEN DruInEur.stamm = 1
   IF PflegevomNetto.stamm = "" THEN PflegevomNetto.stamm = "n"
   IF RealStorno.stamm <> - 1 THEN RealStorno.stamm = 0
   IF KuktoerlJN.stamm = "" THEN KuktoerlJN.stamm = "j"
   IF AutomNetBer.stamm = "" THEN AutomNetBer.stamm = "j"
   IF iim.stamm = "" THEN iim.stamm = "n"
   IF EinheitSach.stamm = "" THEN EinheitSach.stamm = "n"
   IF EUBWSum.stamm = "" THEN EUBWSum.stamm = "j"
   IF EUKond.stamm = "" THEN EUKond.stamm = "j"
   IF EUFonds.stamm = "" THEN EUFonds.stamm = "j"
   IF EUVolumen.stamm = "" THEN EUVolumen.stamm = "j"
   IF EUBeitrag.stamm = "" THEN EUBeitrag.stamm = "j"
   IF EUVSSum.stamm = "" THEN EUVSSum.stamm = "j"
   IF EUnurungekuend.stamm = "" THEN EUnurungekuend.stamm = "j"
   IF EUAlles.stamm = "" THEN EUAlles.stamm = "n"
   IF eubuch.stamm = "" THEN eubuch.stamm = "j"
   IF eukvertrag.stamm = "" THEN eukvertrag.stamm = "j"
   IF euzeing.stamm = "" THEN euzeing.stamm = "j"
   IF eukuenddat.stamm < 1 THEN eukuenddat.stamm = "31.12.2001"
   IF eufondsdat.stamm < 1 THEN eufondsdat.stamm = "01.01.2002"
   IF eubuchdat.stamm < 1 THEN eubuchdat.stamm = "01.01.2002"
   IF euzahldat.stamm < 1 THEN euzahldat.stamm = "01.01.2002"
   STORE FILE "stamm"
   UNLOCK CURRENT FILE "stamm"

   IF codew.stamm > 0 THEN 
     zweitwaehr$ = waehrung.stamm
     euro% = umrechnung.stamm
     ZWCodew% = codew.stamm
   ELSE 
     CALL Fehler("Es wurde fÅr diese Anwendung noch keine allgemeine FirmenwÑhrung festgelegt(z.B. DM)!","WÑhlen Sie nachfolgend eine FirmenwÑhrung aus! Die Umrechnungskurse kînnen Sie Åber Stammdaten->Einstellungen->WÑhrungstabelle festlegen!")
     CALL WaehrStamm()
   END IF 
   IF LastKunr.stamm < 1 AND KUNRPREFIX.stamm = "" THEN 
     SELECT FIRST LOCK FILE "Stamm"
     LastKunr.stamm = VAL (ReadConfig$("NUMMERN","LASTKundennummer"))
     KUNRPREFIX.stamm = "K"
     STORE FILE "stamm"
     UNLOCK CURRENT FILE "stamm"
     SELECT FIRST FILE "Stamm"
   END IF 
   IF waehrung.stamm LIKE "EUR*" AND EXISTS (_netpath$ + _projekt$ + "\buchung") THEN 
     CALL DFile(3,"KVERTRAG" + _fpw$)
     IF OPEN ("buchung") THEN CLOSE FILE "buchung"
     CALL DFile(3,"BUCHUNG" + _fpw$)
     IF OPEN ("buchung1") THEN CLOSE FILE "buchung1"
     CALL DFile(3,"BUCHUNG1" + _fpw$)
     FILE "Buchung"
     INDEX codebu.buchung
     i% = 0
     j% = RECCOUNT ("Buchung")
     IF RECCOUNT ("Buchung") > 0 THEN 
       SELECT FIRST LOCK FILE "Buchung"
       WHILE NOT EOF ("Buchung")
        IF Provision.buchung <> "j" THEN 
          i% = i% + 1
         IF codew.buchung < 1 THEN 
           codew.buchung = 3
           umrechnung.buchung = 1
           waehrung.buchung = "EUR"
         END IF 
         IF waehrung.buchung LIKE "EUR*" THEN 
           codew.buchung = 3
           waehrung.buchung = "EUR"
           umrechnung.buchung = 1
         END IF 
         IF waehrung.buchung LIKE "DM*" THEN 
           codew.buchung = 1
           waehrung.buchung = "DM"
           umrechnung.buchung = 1.95583
         END IF 
         Betrageu.buchung = VAL ( STR$ (Betrag.buchung / umrechnung.buchung,"99999999.00"))
         STORE FILE "Buchung"
         SET STATUS STR$ (i%,",99999999") + " von " + STR$ (j%,",99999999") + " Buchungen aufbereitet"
         UNLOCK CURRENT 
        END IF 
        SELECT NEXT LOCK FILE "Buchung"
       WEND 
     END IF 
     FILE "Buchung1"
     INDEX codebu.buchung1
     IF RECCOUNT ("Buchung1") > 0 THEN 
       SELECT FIRST LOCK FILE "Buchung1"
       i% = 0
       j% = RECCOUNT ("Buchung")
       WHILE NOT EOF ("Buchung1")
        IF Provision.buchung1 <> "j" THEN 
          i% = i% + 1
         IF codew.buchung1 < 1 THEN 
           codew.buchung1 = 3
           umrechnung.buchung1 = 1
           waehrung.buchung1 = "EUR"
         END IF 
         IF waehrung.buchung1 LIKE "EUR*" THEN 
           codew.buchung1 = 3
           waehrung.buchung1 = "EUR"
           umrechnung.buchung1 = 1
         END IF 
         IF waehrung.buchung1 LIKE "DM*" THEN 
           codew.buchung1 = 1
           waehrung.buchung1 = "DM"
           umrechnung.buchung1 = 1.95583
         END IF 
         Betrageu.buchung1 = VAL ( STR$ (Betrag.buchung1 / umrechnung.buchung1,"99999999.00"))
         SET STATUS STR$ (i%,",99999999") + " von " + STR$ (j%,",99999999") + " Buchungen aufbereitet"
         STORE FILE "Buchung1"
         UNLOCK CURRENT 
        END IF 
        SELECT NEXT LOCK FILE "Buchung1"
       WEND 
     END IF 

   END IF 
 
 
 REM ****************************
 REM ** Anpassung SUPERVIS.SBF **
 REM ****************************
 
 FILE "supervis"
 
 CALL FldAdd("Nachname","TXT;50",1)
 CALL FldAdd("Name","TXT;50",1)
 CALL FldAdd("Vorname","TXT;50",0)
 CALL FldAdd("ProvisProz","NUM;000.000",0)
 CALL FldAdd("AngGesGes","NUM;999999999999.00",0)
 CALL FldAdd("ReGesGes","NUM;999999999999.00",0)
 CALL FldAdd("LieGesGes","NUM;999999999999.00",0)
 CALL FldAdd("AufGesGes","NUM;999999999999.00",0)
 CALL FldAdd("BesGesGes","NUM;999999999999.00",0)
 CALL FldAdd("GutGesGes","NUM;999999999999.00",0)
 CALL FldAdd("Sperre","NUM;000000.",0)
 CALL FldAdd("AnzTermine","NUM;999999.",0)
 CALL FldAdd("AnzTermineUnerl","NUM;999999.",0)
 CALL FldAdd("AnzTermineErl","NUM;999999.",0)
 CALL FldAdd("ZugSperr","TXT;1",0)
 CALL FldAdd("BÅro","TXT;50",0)
 CALL FldAdd("EMAILSHost","TXT;150",0)
 CALL FldAdd("EMAILSPort","NUM;999999.",0)
 CALL FldAdd("EMAILSUserID","TXT;150",0)
 CALL FldAdd("EMAILSAFirma","TXT;150",0)
 CALL FldAdd("EMAILSAName","TXT;150",0)
 CALL FldAdd("EMAILNummer","TXT;150",0)
 CALL FldAdd("EMAILSKopie","TXT;5",0)
 CALL FldAdd("EMAILSErg","TXT;5",0)
 CALL FldAdd("EMAILSNummer","TXT;150",0)
 CALL FldAdd("EMAILText1","TXT;2500 R",0)
 CALL FldAdd("EMAILText2","TXT;2500 R",0)
 CALL FldAdd("NoAnzeigeJN","TXT;1",0)
 CALL FldAdd("NoEmailJN","TXT;1",0)
 CALL FldAdd("EMAILSNummer1","TXT;150",0)
 CALL FldAdd("EMAILMANummer","TXT;150",0)
 CALL FldAdd("EMAILPHost","TXT;150",0)
 CALL FldAdd("EMAILPPort","NUM;999999.",0)
 CALL FldAdd("EMAILPUserID","TXT;150",0)
 CALL FldAdd("EMAILPPasww","TXT;150",0)
 CALL FldAdd("EMAILPOP3JN","TXT;5",0)
 CALL FldAdd("EMAILJN","NUM;,0.",0)
 CALL FldAdd("EMAILJNAuto","NUM;,0.",0)
 CALL FldAdd("Strasse","TXT;50",0)
 CALL FldAdd("PLZ","TXT;15",0)
 CALL FldAdd("ort","TXT;50",0)
 CALL FldAdd("Telefon","TXT;50",0)
 CALL FldAdd("Fax","TXT;50",0)
 CALL FldAdd("Handy","TXT;50",0)
 CALL FldAdd("Absender","TXT;150",0)

 CALL FldAdd("PStrasse","TXT;50",0)
 CALL FldAdd("PPLZ","TXT;8",0)
 CALL FldAdd("Port","TXT;50",0)
 CALL FldAdd("PTelefon","TXT;50",0)
 CALL FldAdd("PFax","TXT;50",0)
 CALL FldAdd("PHandy","TXT;50",0)
 CALL FldAdd("PEMAIL","TXT;150",0)

 CALL FldAdd("OutlookName","TXT;50",0)
 CALL FldAdd("OutlookPW","TXT;50",0)
 CALL FldAdd("DisDokSchu","TXT;1",0)
 CALL FldAdd("DokPass1","TXT;90",0)

 CALL FldAdd("Werbeemail","TXT;4000 R",0)
 CALL FldAdd("Werbebetreff","TXT;150",0)
 CALL FldAdd("emailatt1","TXT;256",0)
 CALL FldAdd("Kuerzel","TXT;10",0)
  
 CALL FldAdd("Steuernr","TXT;50",0)
 CALL FldAdd("persSteuernr","TXT;50",0)
 CALL FldAdd("wirtSteuernr","TXT;50",0)
 CALL FldAdd("PLand","TXT;50",0)
 CALL MarkMain("CodeMA")
 SAVE FILE "supervis"
 INDEX CodeMA.supervis
 SELECT LAST 
 WHILE CodeMA.supervis > SER ("SUPERVIS",1)
 WEND 
 REM ** Passwîrter codieren
 CALL PWUpdate()
 FILE "SUPERVIS"
 INDEX codema.supervis
 SELECT FIRST LOCK 
 WHILE NOT EOF ("SUPERVIS")
   IF EMAILJN.supervis = 0 THEN EMAILJN.supervis = 2
   IF EMAILJNAuto.supervis = 0 THEN EMAILJNAuto.supervis = 2
   STORE FILE "supervis"
   SELECT NEXT LOCK 
 WEND 
 IF GASP% THEN 
   SELECT FIRST LOCK FILE "supervis"
   WHILE NOT EOF ("supervis")
     bÅro$ = "BÅro: " + LTRIM$ (GetWksName$(Workstation.supervis))
     BÅro.supervis = BÅro$
     STORE FILE "supervis"
     UNLOCK CURRENT FILE "supervis"
     SELECT NEXT LOCK FILE "supervis"
   WEND 
 END IF 

 REM Anpassung Sperrechte wegen inhouse%=-1
 REM CALL Fehler("inhouse","")
 REM GOTO w270420101
 IF inhouse% = - 1 THEN 
   Auswahl$(0) = "Vertrag Inhouse lîschen"
   Auswahl$(1) = "Vertrag Inhouse VertrÑge bearbeiten"
   Auswahl$(2) = "Vertrag Inhouse VertrÑge neu anlegen"
   Auswahl$(3) = "Vertrag Inhouse VertrÑge anzeigen"
   Auswahl$(4) = ""
   SELECT FIRST FILE "supervis"
   WHILE NOT EOF ("supervis")
     a% = 0
     WHILE Auswahl$(a%) <> ""
       SELECT KEY Auswahl$(a%) FILE "ACCODE" INDEX Beschreibung.ACCODE
       IF FOUND ("ACCODE") THEN 
         BLANK FILE "ACCESS"
         codeac.access = SER ("ACCESS",1)
         CodeMA.ACCESS = codema.supervis
         CodePR.ACCESS = CodePR.ACCODE
         ACCODE.ACCESS = ACCODE.ACCODE
         QuickCode.ACCESS = STR$ (CodePR.ACCODE,"000000") + STR$ (codema.supervis,"000000") + ACCODE.ACCODE
         Beschreibung.ACCESS = Beschreibung.ACCODE
         CALL QuickStore("ACCESS")
       END IF 
       a% = a% + 1
     WEND 
     SELECT NEXT FILE "supervis"
   WEND 
 END IF 
 REM Ende Anpassung Sperrechte wegen inhouse%=-1
w270420101: 


 REM CALL Fehler("Zugriff Service - Station","")
 IF scenter% = - 1 THEN 
   FILE "accode"
   INDEX accode.accode
   SELECT FIRST FILE "accode" INDEX accode.accode
   DIM ABeschr$(5000,2)
   a% = 0
   ABeschr$(0,0) = "Service-Station"
   ABeschr$(0,1) = "SERVICESTATION"
   ABeschr$(1,0) = ""
   ABeschr$(1,1) = ""
   WHILE ABeschr$(a%,1) <> ""
     accode$ = ABeschr$(a%,1)
     IF NOT EXISTS (accode$,accode.accode) THEN 
       BLANK FILE "accode"
       accode.accode = accode$
       Beschreibung.accode = ABeschr$(a%,0)
       codepr.accode = 5000
       STORE FILE "accode"
     END IF 
     SELECT FIRST FILE "supervis"
     WHILE NOT EOF ("supervis")
       SELECT FIRST FILE "ACCODE" INDEX accode.ACCODE
       SELECT KEY ABeschr$(a%,1) FILE "ACCODE" INDEX accode.ACCODE
       IF FOUND ("ACCODE") THEN 
         BLANK FILE "ACCESS"
         codeac.access = SER ("ACCESS",1)
         CodeMA.ACCESS = codema.supervis
         CodePR.ACCESS = CodePR.ACCODE
         ACCODE.ACCESS = ACCODE.ACCODE
         QuickCode.ACCESS = STR$ (CodePR.ACCODE,"000000") + STR$ (codema.supervis,"000000") + ACCODE.ACCODE
         Beschreibung.ACCESS = Beschreibung.ACCODE
         CALL QuickStore("ACCESS")
       END IF 
       SELECT NEXT FILE "supervis"
     WEND 
     a% = a% + 1
   WEND 
 END IF 



 REM ***************************************************************************
 CALL DFile(2,"pssetup" + _fpw$)
 FILE "pssetup"
 CALL FldAdd("OldProdSu","TXT;5",0)
 CALL FldAdd("GSpGSparte","NUM;0.",0)
 CALL FldAdd("GnurSpart","NUM;0.",0)
 CALL FldAdd("NoAbsendInfo","NUM;0.",0)
 SAVE FILE "pssetup"

 REM ***************************************************************************


 IF EXISTS (_netpath$ + "filiale.sbf") THEN 
   CALL DFile(2,"FILIALE" + _fpw$)
   FILE "Filiale"
   CALL FldAdd("Schadquote","NUM;,9999999.0000",0)
   CALL FldAdd("Stornoquote","NUM;,99999.0000",0)
   CALL FldAdd("VertrGesamt","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu1","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu2","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu3","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu4","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu5","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu6","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu7","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu8","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu9","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu10","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu11","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu12","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu13","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu14","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu15","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu16","NUM;,999999999999",0)
 
   CALL FldAdd("BWVertrGesamt","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu1","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu2","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu3","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu4","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu5","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu6","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu7","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu8","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu9","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu10","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu11","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu12","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu13","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu14","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu15","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu16","NUM;,999999999999.00",0)
 
   CALL FldAdd("BeiVertrGesamt","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu1","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu2","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu3","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu4","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu5","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu6","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu7","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu8","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu9","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu10","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu11","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu12","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu13","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu14","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu15","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu16","NUM;,999999999999.00",0)
 
   CALL FldAdd("EinhGesamt","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu1","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu2","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu3","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu4","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu5","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu6","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu7","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu8","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu9","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu10","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu11","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu12","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu13","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu14","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu15","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu16","NUM;,9999999999.0000",0)
 
   CALL FldAdd("AnzSchGesamt","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu1","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu2","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu3","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu4","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu5","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu6","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu7","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu8","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu9","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu10","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu11","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu12","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu13","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu14","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu15","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu16","NUM;,9999999999.",0)
 
   CALL FldAdd("SchGesamt","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu1","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu2","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu3","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu4","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu5","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu6","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu7","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu8","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu9","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu10","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu11","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu12","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu13","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu14","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu15","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu16","NUM;,9999999999.00",0)
   CALL FldAdd("STATISTDATE","DAT;0d.mm.yyyy",0)
   CALL FldAdd("VertrStatu0","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu0","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu0","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu0","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu0","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu0","NUM;,9999999999.00",0)
   CALL FldAdd("CAgez","NUM;,999999999999.00",0)
   CALL FldAdd("VertrStatu20","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu20","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu20","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu20","NUM;,9999999999.00",0)
   CALL FldAdd("VertrStatu21","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu21","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu21","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu21","NUM;,9999999999.00",0)
   CALL FldAdd("NoAnzeigeJN","TXT;1",0)
   SAVE FILE "filiale"
 END IF 
 REM ************ ACCESS anpassen **************
 CALL DFile(2,"ACCESS" + _fpw$)
 FILE "ACCESS"
 CALL FldAdd("CodeAC","NUM;000000.",1)
 SAVE FILE "ACCESS"
 INDEX Codema.access
 SELECT FIRST 
 IF RECCOUNT ("ACCESS") > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
   i% = 0
   MOUSE OFF 
   WHILE NOT EOF ("ACCESS")
     
     i% = i% + 1
       codeac.access = i%
       IF QWoNo = "" THEN 
         Workstation = 0
         QWoNo = "000000000000"
       END IF 
       STORE FILE "ACCESS"
     SELECT NEXT LOCK 
     SET STATUS "Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!"
     CALL Server("UPDSTATUS","Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!")
   WEND 
 INDEX codeac.access
 SELECT LAST 
 i% = codeac.access
 j% = SER ("Access",1)
 WHILE j% < i%
     j% = SER ("Access",1)
 WEND 

 MOUSE ON 
 REM ************ MAIL anpassen ************** 
 dat$ = "MAIL"
 IF OPEN ("mail") THEN CLOSE FILE "mail"
 CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 FILE dat$
 CALL FldAdd("Datum","DAT;0d.mm.yyyy",1)
 CALL FldAdd("CodeMAvon","NUM;000000.",1)
 CALL FldAdd("gelesen","NUM;0.",1)
 CALL FldAdd("gelîscht","NUM;0.",1)
 CALL FldAdd("Antwort","TXT;4000 R",0)
 CALL FldAdd("DatumAntwort","DAT;0d.mm.yyyy",0)
 CALL FldAdd("ZeitAntwort","TIM;hh:mm",0)
 CALL FldAdd("DatumGelesen","DAT;0d.mm.yyyy",0)
 CALL FldAdd("ZeitGelesen","TIM;hh:mm",0)
 CALL FldAdd("DatumGelîscht","DAT;0d.mm.yyyy",0)
 CALL FldAdd("ZeitGelîscht","TIM;hh:mm",0)
 CALL FldAdd("Betreff","TXT;250",0)
 CALL FldAdd("CC","TXT;4000 R",0)
 CALL FldAdd("BCC","TXT;4000 R",0)
 CALL FldAdd("MailTO","TXT;250",0)
 CALL FldAdd("EMAILCC","TXT;4000 R",0)
 CALL FldAdd("EMAILBCC","TXT;4000 R",0)

 SAVE FILE dat$
 INDEX CodeMail.dat$
 SELECT LAST 
 i% = codeMail.dat$
 INDEX codema.dat$
 IF RECCOUNT (dat$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 IF i% < 1 THEN 
   WHILE NOT EOF (dat$)
     i% = i% + 1
     codemail.dat$ = i%
     IF QWoNo = "" THEN 
       Workstation = 0
       QWoNo = "000000000000"
     END IF 
     STORE FILE dat$
     SELECT NEXT LOCK 
     SET STATUS "Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!"
     CALL Server("UPDSTATUS","Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!")
   WEND 
 END IF 
 INDEX codemail.dat$
 SELECT LAST 
 i% = codemail.dat$
 j% = SER (dat$,1)
 WHILE j% < i%
     j% = SER (dat$,1)
 WEND 

 
 REM ************ ANREDE anpassen ************** 
 dat$ = "ANREDE"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 FILE dat$
 CALL FldAdd("CodeKey","NUM;000000.",1)
 SAVE FILE dat$
 INDEX CodeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 INDEX Anrede.dat$
 IF RECCOUNT (dat$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 IF i% < 1 THEN 
   WHILE NOT EOF (dat$)
     i% = i% + 1
     codekey.dat$ = i%
     IF QWoNo = "" THEN 
       Workstation = 0
       QWoNo = "000000000000"
     END IF 
     STORE FILE dat$
     SELECT NEXT LOCK 
     SET STATUS "Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!"
     CALL Server("UPDSTATUS","Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!")
   WEND 
 END IF 
 INDEX codeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 j% = SER (dat$,1)
 WHILE j% < i%
     j% = SER (dat$,1)
 WEND 
 REMOVE FROM FILE dat$ WHERE LTRIM$ (anrede.anrede) = ""
 
 REM ************ CONNECT anpassen ************** 
 dat$ = "CONNECT"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 FILE dat$
 CALL FldAdd("CodeKey","NUM;000000.",1)
 CALL FldAdd("CodeKGR","NUM;000000.",1)
 CALL FldAdd("KontaktGruppe","TXT;50",1)
 CALL FldAdd("Erstellt_am","DAT;0d.mm.yyyy",1)
 SAVE FILE dat$
 INDEX CodeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 INDEX CodeKU.dat$
 IF RECCOUNT (dat$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 IF i% < 1 THEN 
   WHILE NOT EOF (dat$)
     i% = i% + 1
     codekey.dat$ = i%
     IF QWoNo = "" THEN 
       Workstation = 0
       QWoNo = "000000000000"
     END IF 
     STORE FILE dat$
     SELECT NEXT LOCK 
     SET STATUS "Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!"
     CALL Server("UPDSTATUS","Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!")
   WEND 
 END IF 
 INDEX codeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 j% = SER (dat$,1)
 WHILE j% < i%
     j% = SER (dat$,1)
 WEND 
 
 
 
 
 REM ************ ANSTELL anpassen ************** 
 dat$ = "ANSTELL"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 FILE dat$
 CALL FldAdd("CodeKey","NUM;000000.",1)
 SAVE FILE dat$
 INDEX CodeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 INDEX Anstellungsverh.dat$
 IF RECCOUNT (dat$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 IF i% < 1 THEN 
   WHILE NOT EOF (dat$)
     i% = i% + 1
     codekey.dat$ = i%
     IF QWoNo = "" THEN 
       Workstation = 0
       QWoNo = "000000000000"
     END IF 
     STORE FILE dat$
     SELECT NEXT LOCK 
     SET STATUS "Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!"
     CALL Server("UPDSTATUS","Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!")
   WEND 
 END IF 
 INDEX codeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 j% = SER (dat$,1)
 WHILE j% < i%
     j% = SER (dat$,1)
 WEND 
 REMOVE FROM FILE dat$ WHERE LTRIM$ (anstellungsverh.anstell) = ""
 
 


 REM ************ ONLBERAT anpassen ************** 
 dat$ = "ONLBERAT"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 FILE dat$
 CALL FldAdd("CodeKu","NUM;000000.",0)
 CALL FldAdd("gender","TXT;1",0)
 CALL FldAdd("family","TXT;1",0)
 CALL FldAdd("country","TXT;20",0)
 CALL FldAdd("isprivate","TXT;5",0)
 SAVE FILE dat$



 REM ************ Beruf anpassen ************** 
 dat$ = "BERUF"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 FILE dat$
 CALL FldAdd("CodeKey","NUM;000000.",1)
 SAVE FILE dat$
 INDEX CodeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 INDEX Beruf.dat$
 IF RECCOUNT (dat$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 IF i% < 1 THEN 
   WHILE NOT EOF (dat$)
     i% = i% + 1
     codekey.dat$ = i%
     IF QWoNo = "" THEN 
       Workstation = 0
       QWoNo = "000000000000"
     END IF 
     STORE FILE dat$
     SELECT NEXT LOCK 
     SET STATUS "Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!"
     CALL Server("UPDSTATUS","Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!")
   WEND 
 END IF 
 INDEX codeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 j% = SER (dat$,1)
 WHILE j% < i%
     j% = SER (dat$,1)
 WEND 
 REMOVE FROM FILE dat$ WHERE LTRIM$ (beruf.beruf) = ""
 
 REM ************ FIFORM anpassen ************** 
 dat$ = "FIFORM"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 FILE dat$
 CALL FldAdd("CodeKey","NUM;000000.",1)
 SAVE FILE dat$
 INDEX CodeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 INDEX Firmenform.dat$
 IF RECCOUNT (dat$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 IF i% < 1 THEN 
   WHILE NOT EOF (dat$)
     i% = i% + 1
     codekey.dat$ = i%
     IF QWoNo = "" THEN 
       Workstation = 0
       QWoNo = "000000000000"
     END IF 
     STORE FILE dat$
     SELECT NEXT LOCK 
     SET STATUS "Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!"
     CALL Server("UPDSTATUS","Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!")
   WEND 
 END IF 
 INDEX codeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 j% = SER (dat$,1)
 WHILE j% < i%
     j% = SER (dat$,1)
 WEND 
 REMOVE FROM FILE dat$ WHERE LTRIM$ (firmenform.fiform) = ""
 
 REM ************ Fstand anpassen ************** 
 dat$ = "FSTAND"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 FILE dat$
 CALL FldAdd("CodeKey","NUM;000000.",1)
 SAVE FILE dat$
 INDEX CodeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 INDEX Familienstand.dat$
 IF RECCOUNT (dat$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 IF i% < 1 THEN 
   WHILE NOT EOF (dat$)
     i% = i% + 1
     codekey.dat$ = i%
     IF QWoNo = "" THEN 
       Workstation = 0
       QWoNo = "000000000000"
     END IF 
     STORE FILE dat$
     SELECT NEXT LOCK 
     SET STATUS "Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!"
     CALL Server("UPDSTATUS","Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!")
   WEND 
 END IF 
 INDEX codeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 j% = SER (dat$,1)
 WHILE j% < i%
     j% = SER (dat$,1)
 WEND 
 REMOVE FROM FILE dat$ WHERE LTRIM$ (Familienstand.fstand) = ""
 
 REM ************ HOBBYS anpassen ************** 
 dat$ = "HOBBYS"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 FILE dat$
 CALL FldAdd("CodeKey","NUM;000000.",1)
 SAVE FILE dat$
 INDEX CodeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 INDEX HOBBYS.dat$
 IF RECCOUNT (dat$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 IF i% < 1 THEN 
   WHILE NOT EOF (dat$)
     i% = i% + 1
     codekey.dat$ = i%
     IF QWoNo = "" THEN 
       Workstation = 0
       QWoNo = "000000000000"
     END IF 
     STORE FILE dat$
     SELECT NEXT LOCK 
     SET STATUS "Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!"
     CALL Server("UPDSTATUS","Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!")
   WEND 
 END IF 
 INDEX codeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 j% = SER (dat$,1)
 WHILE j% < i%
     j% = SER (dat$,1)
 WEND 
 REMOVE FROM FILE dat$ WHERE LTRIM$ (hobbys.hobbys) = ""
 
 REM ************ LAND anpassen ************** 
 dat$ = "LAND"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 FILE dat$
 CALL FldAdd("CodeKey","NUM;000000.",1)
 SAVE FILE dat$
 INDEX CodeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 INDEX LAND.dat$
 IF RECCOUNT (dat$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 IF i% < 1 THEN 
   WHILE NOT EOF (dat$)
     i% = i% + 1
     codekey.dat$ = i%
     IF QWoNo = "" THEN 
       Workstation = 0
       QWoNo = "000000000000"
     END IF 
     STORE FILE dat$
     SELECT NEXT LOCK 
     SET STATUS "Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!"
     CALL Server("UPDSTATUS","Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!")
   WEND 
 END IF 
 INDEX codeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 j% = SER (dat$,1)
 WHILE j% < i%
     j% = SER (dat$,1)
 WEND 
 REMOVE FROM FILE dat$ WHERE LTRIM$ (land.land) = ""
 
 REM ************ NATIONAL anpassen ************** 
 dat$ = "NATIONAL"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 FILE dat$
 CALL FldAdd("CodeKey","NUM;000000.",1)
 SAVE FILE dat$
 INDEX CodeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 INDEX NationalitÑt.dat$
 IF RECCOUNT (dat$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 IF i% < 1 THEN 
   WHILE NOT EOF (dat$)
     i% = i% + 1
     codekey.dat$ = i%
     IF QWoNo = "" THEN 
       Workstation = 0
       QWoNo = "000000000000"
     END IF 
     STORE FILE dat$
     SELECT NEXT LOCK 
     SET STATUS "Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!"
     CALL Server("UPDSTATUS","Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!")
   WEND 
 END IF 
 INDEX codeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 j% = SER (dat$,1)
 WHILE j% < i%
     j% = SER (dat$,1)
 WEND 
 REMOVE FROM FILE dat$ WHERE LTRIM$ (nationalitÑt.national) = ""
 
 REM ************ ORT anpassen ************** 
 dat$ = "ORT"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 FILE dat$
 CALL FldAdd("CodeKey","NUM;000000.",1)
 SAVE FILE dat$
 INDEX CodeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 INDEX Ort.dat$
 IF RECCOUNT (dat$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 IF i% < 1 THEN 
   WHILE NOT EOF (dat$)
     i% = i% + 1
     codekey.dat$ = i%
     IF QWoNo = "" THEN 
       Workstation = 0
       QWoNo = "000000000000"
     END IF 
     STORE FILE dat$
     SELECT NEXT LOCK 
     SET STATUS "Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!"
     CALL Server("UPDSTATUS","Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!")
   WEND 
 END IF 
 INDEX codeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 j% = SER (dat$,1)
 WHILE j% < i%
     j% = SER (dat$,1)
 WEND 
 REMOVE FROM FILE dat$ WHERE LTRIM$ (ort.ort) = ""
 
 REM ************ STAAT anpassen ************** 
 dat$ = "STAAT"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 FILE dat$
 CALL FldAdd("CodeKey","NUM;000000.",1)
 SAVE FILE dat$
 INDEX CodeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 INDEX Staatsangehîrig.dat$
 IF RECCOUNT (dat$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 IF i% < 1 THEN 
   WHILE NOT EOF (dat$)
     i% = i% + 1
     codekey.dat$ = i%
     IF QWoNo = "" THEN 
       Workstation = 0
       QWoNo = "000000000000"
     END IF 
     STORE FILE dat$
     SELECT NEXT LOCK 
     SET STATUS "Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!"
     CALL Server("UPDSTATUS","Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!")
   WEND 
 END IF 
 INDEX codeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 j% = SER (dat$,1)
 WHILE j% < i%
     j% = SER (dat$,1)
 WEND 
 REMOVE FROM FILE dat$ WHERE LTRIM$ (staatsangehîrig.staat) = ""
 
 REM ************ TITEL anpassen ************** 
 dat$ = "TITEL"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 FILE dat$
 CALL FldAdd("CodeKey","NUM;000000.",1)
 SAVE FILE dat$
 INDEX CodeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 INDEX TITEL.dat$
 IF RECCOUNT (dat$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 IF i% < 1 THEN 
   WHILE NOT EOF (dat$)
     i% = i% + 1
     codekey.dat$ = i%
     IF QWoNo = "" THEN 
       Workstation = 0
       QWoNo = "000000000000"
     END IF 
     STORE FILE dat$
     SELECT NEXT LOCK 
     SET STATUS "Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!"
     CALL Server("UPDSTATUS","Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!")
   WEND 
 END IF 
 INDEX codeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 j% = SER (dat$,1)
 WHILE j% < i%
     j% = SER (dat$,1)
 WEND 
 REMOVE FROM FILE dat$ WHERE LTRIM$ (titel.titel) = ""
 
 REM ************ KEYWORDS anpassen ************** 
 dat$ = "ADRGRUP"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 FILE dat$
 CALL FldAdd("CodeKey","NUM;000000.",1)
 CALL FldAdd("keyword","TXT;50",1)
 SAVE FILE dat$
 REMOVE FROM FILE dat$ WHERE keyword.dat$ = ""


 dat$ = "ADRSTAT"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 FILE dat$
 CALL FldAdd("CodeKey","NUM;000000.",1)
 CALL FldAdd("keyword","TXT;50",1)
 SAVE FILE dat$
 REMOVE FROM FILE dat$ WHERE keyword.dat$ = ""

 dat$ = "KEYWORDS"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 FILE dat$
 CALL FldAdd("CodeKey","NUM;000000.",1)
 SAVE FILE dat$
 INDEX CodeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 INDEX KEYWORD.dat$
 IF RECCOUNT (dat$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 IF i% < 1 THEN 
   WHILE NOT EOF (dat$)
     i% = i% + 1
     codekey.dat$ = i%
     IF QWoNo = "" THEN 
       Workstation = 0
       QWoNo = "000000000000"
     END IF 
     STORE FILE dat$
     SELECT NEXT LOCK 
     SET STATUS "Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!"
     CALL Server("UPDSTATUS","Datensatz: " + STR$ (i%,"9999999") + " bearbeitet!")
   WEND 
 END IF 
 INDEX codeKey.dat$
 SELECT LAST 
 i% = codeKey.dat$
 j% = SER (dat$,1)
 WHILE j% < i%
     j% = SER (dat$,1)
 WEND 
 REMOVE FROM FILE dat$ WHERE LTRIM$ (keyword.keywords) = ""
 
          REM GOTO maadrupd18042001
 
     REM GOTO ProvStart301299
 REM GOTO ProvStart3012991
 REM GOTO FactStart270200
 
 IF _projekt$ LIKE "FACTURA" OR _projekt$ LIKE "WAWI" THEN 
 
   REM **************************
   REM ** Anpassung SERNUM.SBF **
   REM **************************
 
   REM CALL DFile(2,"OFFICE\sernum" + _fpw$)
   REM FILE "SERNUM"
  
   REM CALL FldAdd("lastartintern","NUM;99999999.99",0)
   REM SAVE FILE "sernum"
 
 END IF 
 REM ***************************
 REM ** Anpassung Dokument.SBF **
 REM ***************************

 dat$ = "adrhis"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\adrhis" + _fpw$)
 FILE "adrhis"
 CALL FldAdd("CodeKey","NUM;000000.",1)
 CALL FldAdd("CodeKU","NUM;000000.",1)
 CALL FldAdd("CodeMA","NUM;000000.",1)
 CALL FldAdd("QCodeMAKey","TXT;12",1)
 SAVE FILE "adrhis"

 dat$ = "Dokbck"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 IF _projekt$ <> "IMMAK" THEN CALL DFile(3,"KVERTRAG" + _fpw$)
 CALL DFile(2,"OFFICE\dokbck" + _fpw$)
 FILE "dokbck"
 CALL FldAdd("CodeDok","NUM;000000.",1)
 CALL FldAdd("CodeKU","NUM;000000.",1)
 CALL FldAdd("CodePR","NUM;000000.",1)
 CALL FldAdd("Erstellt_am","DAT;0d.mm.yyyy",1)
 CALL FldAdd("letzte_Bearbeit","DAT;0d.mm.yyyy",1)
 CALL FldAdd("zero","NUM;000000.",1)
 CALL FldAdd("Projekt","TXT;120",1)
 CALL FldAdd("Creator","TXT;50",1)
 CALL FldAdd("Dateiname","TXT;128 U",1)
 CALL FldAdd("transf","NUM;0.",1)
 CALL FldAdd("ELOTrans","NUM;0.",1)
 CALL FldAdd("ELODatum","DAT;0d.mm.yyyy",0)
 CALL FldAdd("ELOMA","NUM;000000.",0)
 CALL FldAdd("ELOMAName","TXT;50",0)
 CALL FldAdd("FreeFormular","NUM;0.",0)
 CALL FldAdd("DokNotiz","TXT;4000 R",0)
 CALL FldAdd("DateiOld","TXT;128 U",0)
 CALL FldAdd("DateiRes","TXT;128 U",0)
 CALL FldAdd("novi1","NUM;0.",0)
 CALL FldAdd("DatumNovi","DAT;0d.mm.yyyy",0)
 CALL FldAdd("DokPass","TXT;100",0)
 CALL FldAdd("SMAName","TXT;50",0)
 CALL FldAdd("SMATimestamp1","TXT;16",0)
 CALL FldAdd("FileHash","TXT;32",0)
 CALL FldAdd("DokPass1","TXT;100",0)
 CALL FldAdd("SMANameP","TXT;50",0)
 CALL FldAdd("SMATimestampP","TXT;16",0)
 CALL FldAdd("QuickCodekuGru","TXT;50 U",1)
 CALL FldAdd("CodeAQ","NUM;000000.",1)
 CALL FldAdd("DokNotiz","TXT;4000 R",0)
 SAVE FILE "dokbck"
 REM UPDATE zero.dokbck = 0
 REM END UPDATE 
 
 date1$ = "dokbck"
 FILE date1$
 INDEX dateiname
 SELECT FIRST 
 SELECT KEY "\" FILE date1$ INDEX Dateiname.date1$
 IF LEFT$ (Dateiname.date1$,1) = "\" THEN 
   FILE date1$
   INDEX codedok
   SELECT FIRST 
   CALL DokAnpName(date1$)
 END IF 
 FILE date1$
 INDEX codedok 

 IF RECCOUNT (date1$) > 0 THEN CALL DokAnpDir(date1$)

 dat$ = "Dokadr1"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 IF _projekt$ <> "IMMAK" THEN CALL DFile(3,"KVERTRAG" + _fpw$)
 CALL DFile(2,"OFFICE\dokadr1" + _fpw$)
 FILE dat$
 CALL FldAdd("CodeDok","NUM;000000.",1)
 CALL FldAdd("CodeKU","NUM;000000.",1)
 CALL FldAdd("CodePR","NUM;000000.",1)
 CALL FldAdd("Erstellt_am","DAT;0d.mm.yyyy",1)
 CALL FldAdd("letzte_Bearbeit","DAT;0d.mm.yyyy",1)
 CALL FldAdd("zero","NUM;000000.",1)
 CALL FldAdd("Projekt","TXT;120",1)
 CALL FldAdd("Creator","TXT;50",1)
 CALL FldAdd("Dateiname","TXT;128 U",1)
 CALL FldAdd("transf","NUM;0.",1)
 CALL FldAdd("ELOTrans","NUM;0.",1)
 CALL FldAdd("ELODatum","DAT;0d.mm.yyyy",0)
 CALL FldAdd("ELOMA","NUM;000000.",0)
 CALL FldAdd("ELOMAName","TXT;50",0)
 CALL FldAdd("FreeFormular","NUM;0.",0)
 CALL FldAdd("DokNotiz","TXT;4000 R",0)
 CALL FldAdd("DateiOld","TXT;128 U",0)
 CALL FldAdd("DateiRes","TXT;128 U",0)
 CALL FldAdd("novi1","NUM;0.",0)
 CALL FldAdd("DatumNovi","DAT;0d.mm.yyyy",0)
 CALL FldAdd("DokPass","TXT;100",0)
 CALL FldAdd("SMAName","TXT;50",0)
 CALL FldAdd("SMATimestamp1","TXT;16",0)
 CALL FldAdd("FileHash","TXT;32",0)
 CALL FldAdd("DokPass1","TXT;100",0)
 CALL FldAdd("SMANameP","TXT;50",0)
 CALL FldAdd("SMATimestampP","TXT;16",0)
 CALL FldAdd("QuickCodekuGru","TXT;50 U",1)
 CALL FldAdd("CodeAQ","NUM;000000.",1)
 CALL FldAdd("DokNotiz","TXT;4000 R",0)
 SAVE FILE "dokadr1"
 REM UPDATE zero.dokadr1 = 0
 REM END UPDATE 
 date1$ = "dokadr1"
 FILE date1$
 INDEX dateiname
 SELECT FIRST 
 SELECT KEY "\" FILE date1$ INDEX Dateiname.date1$
 IF LEFT$ (Dateiname.date1$,1) = "\" THEN 
   FILE date1$
   INDEX codedok
   SELECT FIRST 
   CALL DokAnpName(date1$)
 END IF 
 FILE date1$
 INDEX codedok 
 IF RECCOUNT (date1$) > 0 THEN CALL DokAnpDir(date1$)

 dat$ = "DOKKV"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\DOKKV" + _fpw$)
 FILE "DOKKV"
 CALL FldAdd("CodeDok","NUM;000000.",1)
 CALL FldAdd("CodeKU","NUM;000000.",1)
 CALL FldAdd("CodePR","NUM;000000.",1)
 CALL FldAdd("Erstellt_am","DAT;0d.mm.yyyy",1)
 CALL FldAdd("letzte_Bearbeit","DAT;0d.mm.yyyy",1)
 
 CALL FldAdd("zero","NUM;000000.",1)
 CALL FldAdd("Projekt","TXT;120",1)
 CALL FldAdd("Creator","TXT;50",1)
 CALL FldAdd("Dateiname","TXT;128 U",1)
 CALL FldAdd("transf","NUM;0.",1)
 CALL FldAdd("ELOTrans","NUM;0.",1)
 CALL FldAdd("ELODatum","DAT;0d.mm.yyyy",0)
 CALL FldAdd("ELOMA","NUM;000000.",0)
 CALL FldAdd("ELOMAName","TXT;50",0)
 CALL FldAdd("FreeFormular","NUM;0.",0)
 CALL FldAdd("DokNotiz","TXT;4000 R",0)
 CALL FldAdd("DateiOld","TXT;128 U",0)
 CALL FldAdd("DateiRes","TXT;128 U",0)
 CALL FldAdd("novi1","NUM;0.",0)
 CALL FldAdd("DatumNovi","DAT;0d.mm.yyyy",0)
 CALL FldAdd("DokPass","TXT;100",0)
 CALL FldAdd("SMAName","TXT;50",0)
 CALL FldAdd("SMATimestamp1","TXT;16",0)
 CALL FldAdd("FileHash","TXT;32",0)
 CALL FldAdd("DokPass1","TXT;100",0)
 CALL FldAdd("SMANameP","TXT;50",0)
 CALL FldAdd("SMATimestampP","TXT;16",0)
 CALL FldAdd("QuickCodekuGru","TXT;50 U",1)
 CALL FldAdd("CodeVG","NUM;000000.",1)
 CALL FldAdd("CodeAQ","NUM;000000.",1)
  CALL FldAdd("DokNotiz","TXT;4000 R",0)
 SAVE FILE "DOKKV"
 REM UPDATE zero.DOKKV = 0
 REM END UPDATE 
 date1$ = "DokKV"
 FILE date1$
 INDEX dateiname
 SELECT FIRST 
 SELECT KEY "\" FILE date1$ INDEX Dateiname.date1$
 IF LEFT$ (Dateiname.date1$,1) = "\" THEN 
   FILE date1$
   INDEX codedok
   SELECT FIRST 
   CALL DokAnpName(date1$)
 END IF 
 FILE date1$
 INDEX codedok 
 IF RECCOUNT (date1$) > 0 THEN CALL DokAnpDir(date1$)

 dat$ = "DOKGE"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\DOKGE" + _fpw$)
 FILE "DOKGE"
 CALL FldAdd("CodeDok","NUM;000000.",1)
 CALL FldAdd("CodeKU","NUM;000000.",1)
 CALL FldAdd("CodePR","NUM;000000.",1)
 CALL FldAdd("Erstellt_am","DAT;0d.mm.yyyy",1)
 CALL FldAdd("letzte_Bearbeit","DAT;0d.mm.yyyy",1)
 
 CALL FldAdd("zero","NUM;000000.",1)
 CALL FldAdd("Projekt","TXT;120",1)
 CALL FldAdd("Creator","TXT;50",1)
 CALL FldAdd("Dateiname","TXT;128 U",1)
 CALL FldAdd("transf","NUM;0.",1)
 CALL FldAdd("ELOTrans","NUM;0.",1)
 CALL FldAdd("ELODatum","DAT;0d.mm.yyyy",0)
 CALL FldAdd("ELOMA","NUM;000000.",0)
 CALL FldAdd("ELOMAName","TXT;50",0)
 CALL FldAdd("FreeFormular","NUM;0.",0)
 CALL FldAdd("DokNotiz","TXT;4000 R",0)
 CALL FldAdd("DateiOld","TXT;128 U",0)
 CALL FldAdd("DateiRes","TXT;128 U",0)
 CALL FldAdd("novi1","NUM;0.",0)
 CALL FldAdd("DatumNovi","DAT;0d.mm.yyyy",0)
 CALL FldAdd("DokPass","TXT;100",0)
 CALL FldAdd("SMAName","TXT;50",0)
 CALL FldAdd("SMATimestamp1","TXT;16",0)
 CALL FldAdd("FileHash","TXT;32",0)
 CALL FldAdd("DokPass1","TXT;100",0)
 CALL FldAdd("SMANameP","TXT;50",0)
 CALL FldAdd("SMATimestampP","TXT;16",0)
 CALL FldAdd("QuickCodekuGru","TXT;50 U",1)
 CALL FldAdd("CodeAQ","NUM;000000.",1)
  CALL FldAdd("DokNotiz","TXT;4000 R",0)
 SAVE FILE "DOKGE"
 UPDATE zero.DOKGE = 0
 END UPDATE 

 date1$ = "DokGE"
 FILE date1$
 INDEX dateiname
 SELECT FIRST 
 SELECT KEY "\" FILE date1$ INDEX Dateiname.date1$
 IF LEFT$ (Dateiname.date1$,1) = "\" THEN 
   FILE date1$
   INDEX codedok
   SELECT FIRST 
   CALL DokAnpName(date1$)
 END IF 
 FILE date1$
 INDEX codedok 
 IF RECCOUNT (date1$) > 0 THEN CALL DokAnpDir(date1$)

 dat$ = "DOKMA"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\DOKMA" + _fpw$)
 FILE "DOKMA"
 CALL FldAdd("CodeDok","NUM;000000.",1)
 CALL FldAdd("CodeKU","NUM;000000.",1)
 CALL FldAdd("CodePR","NUM;000000.",1)
 CALL FldAdd("Erstellt_am","DAT;0d.mm.yyyy",1)
 CALL FldAdd("letzte_Bearbeit","DAT;0d.mm.yyyy",1)
 
 CALL FldAdd("zero","NUM;000000.",1)
 CALL FldAdd("Projekt","TXT;120",1)
 CALL FldAdd("Creator","TXT;50",1)
 CALL FldAdd("Dateiname","TXT;128 U",1)
 CALL FldAdd("transf","NUM;0.",1)
 CALL FldAdd("ELOTrans","NUM;0.",1)
 CALL FldAdd("ELODatum","DAT;0d.mm.yyyy",0)
 CALL FldAdd("ELOMA","NUM;000000.",0)
 CALL FldAdd("ELOMAName","TXT;50",0)
 CALL FldAdd("FreeFormular","NUM;0.",0)
 CALL FldAdd("DokNotiz","TXT;4000 R",0)
 CALL FldAdd("DateiOld","TXT;128 U",0)
 CALL FldAdd("DateiRes","TXT;128 U",0)
 CALL FldAdd("novi1","NUM;0.",0)
 CALL FldAdd("DatumNovi","DAT;0d.mm.yyyy",0)
 CALL FldAdd("DokPass","TXT;100",0)
 CALL FldAdd("SMAName","TXT;50",0)
 CALL FldAdd("SMATimestamp1","TXT;16",0)
 CALL FldAdd("FileHash","TXT;32",0)
 CALL FldAdd("DokPass1","TXT;100",0)
 CALL FldAdd("SMANameP","TXT;50",0)
 CALL FldAdd("SMATimestampP","TXT;16",0)
 CALL FldAdd("QuickCodekuGru","TXT;50 U",1)
 CALL FldAdd("CodeAQ","NUM;000000.",1)
  CALL FldAdd("DokNotiz","TXT;4000 R",0)
 SAVE FILE "DOKMA"
 UPDATE zero.DOKMA = 0
 END UPDATE 

 date1$ = "DokMA"
 FILE date1$
 INDEX dateiname
 SELECT FIRST 
 SELECT KEY "\" FILE date1$ INDEX Dateiname.date1$
 IF LEFT$ (Dateiname.date1$,1) = "\" THEN 
   FILE date1$
   INDEX codedok
   SELECT FIRST 
   CALL DokAnpName(date1$)
 END IF 
 FILE date1$
 INDEX codedok 
 IF RECCOUNT (date1$) > 0 THEN CALL DokAnpDir(date1$)

 dat$ = "Dokument"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 IF _projekt$ <> "IMMAK" THEN CALL DFile(3,"KVERTRAG" + _fpw$)
 CALL DFile(2,"OFFICE\dokument" + _fpw$)
 FILE "dokument"
 CALL FldAdd("CodeDok","NUM;000000.",1)
 CALL FldAdd("CodeKU","NUM;000000.",1)
 CALL FldAdd("CodePR","NUM;000000.",1)
 CALL FldAdd("Erstellt_am","DAT;0d.mm.yyyy",1)
 CALL FldAdd("letzte_Bearbeit","DAT;0d.mm.yyyy",1)
 
 CALL FldAdd("zero","NUM;000000.",1)
 CALL FldAdd("Projekt","TXT;120",1)
 CALL FldAdd("Creator","TXT;50",1)
 CALL FldAdd("Dateiname","TXT;128 U",1)
 CALL FldAdd("transf","NUM;0.",1)
 CALL FldAdd("ELOTrans","NUM;0.",1)
 CALL FldAdd("ELODatum","DAT;0d.mm.yyyy",0)
 CALL FldAdd("ELOMA","NUM;000000.",0)
 CALL FldAdd("ELOMAName","TXT;50",0)
 CALL FldAdd("FreeFormular","NUM;0.",0)
 CALL FldAdd("DokNotiz","TXT;4000 R",0)
 CALL FldAdd("DateiOld","TXT;128 U",0)
 CALL FldAdd("DateiRes","TXT;128 U",0)
 CALL FldAdd("novi1","NUM;0.",0)
 CALL FldAdd("DatumNovi","DAT;0d.mm.yyyy",0)
 CALL FldAdd("DokPass","TXT;100",0)
 CALL FldAdd("SMAName","TXT;50",0)
 CALL FldAdd("SMATimestamp1","TXT;16",0)
 CALL FldAdd("FileHash","TXT;32",0)
 CALL FldAdd("DokPass1","TXT;100",0)
 CALL FldAdd("SMANameP","TXT;50",0)
 CALL FldAdd("SMATimestampP","TXT;16",0)
 CALL FldAdd("QuickCodekuGru","TXT;50 U",1)
 CALL FldAdd("CodeAQ","NUM;000000.",1)
 CALL FldAdd("DokNotiz","TXT;4000 R",0)
 SAVE FILE "dokument"
 REM UPDATE zero.dokument = 0
 REM END UPDATE 
 FILE "Dokument"
 INDEX dateiname
 SELECT FIRST 
 SELECT KEY "\" FILE "dokument" INDEX Dateiname.dokument
 IF LEFT$ (Dateiname.dokument,1) = "\" THEN 
   FILE "Dokument"
   INDEX codedok
   SELECT FIRST 
   CALL DokAnpName("dokument")
 END IF 
 FILE "Dokument"
 INDEX codedok 
 dat$ = "Dokument"
 FILE "DOKUMENT"
 INDEX codedok.dokument
 MOUSE OFF 
 REM REQUEST "Bitte warten, Dokumente werden angepasst!"
 REM UPDATE zero.dokument = 0:QuickCodekuGru.dokument = STR$ (codeku.dokument,"000000") + Gruppe.dokument
 REM END UPDATE 
 MOUSE ON 


 IF RECCOUNT (dat$) > 0 THEN CALL DokAnpDir("DOKUMENT")
 REM *******************************************************************************************************************************************************************

 dat$ = "dokument"



 FILE dat$
 INDEX codedok.dat$
 IF RECCOUNT (dat$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 i% = 0
 j% = RECCOUNT (dat$)
 
 WHILE NOT EOF (dat$)
   i% = i% + 1
   SET STATUS LTRIM$ ( STR$ (i%,",999999999")) + "/" + LTRIM$ ( STR$ (j%,",999999999")) + " in Datei " + dat$ + " bearbeitet"
   QuickCodekuGru.dokument = STR$ (codeku.dokument,"000000") + Gruppe.dokument
   SELECT NEXT LOCK FILE dat$
 WEND 





 FILE dat$
 INDEX codedok.dat$
 IF RECCOUNT (dat$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 i% = 0
 j% = RECCOUNT (dat$)
 





 WHILE NOT EOF (dat$)
   i% = i% + 1
   SET STATUS LTRIM$ ( STR$ (i%,",999999999")) + "/" + LTRIM$ ( STR$ (j%,",999999999")) + " in Datei " + dat$ + " bearbeitet"
   jamo$ = LEFT$ ( DATE$ (erstellt_am.dat$,"yyyymm0d"),6)
   jamotest$ = "*\" + jamo$ + "\*"
   IF Dateiname.dat$ LIKE jamotest$ THEN 
   ELSE 
     Dateiname$ = dateiname.dat$
     dat$ = UCASE$ (dat$)
     pos% = - 1
     posold% = 1
     REM CALL Fehler("Position des letzten \ feststellen",codedok$)
     WHILE pos% <> 0
       pos% = INSTR (posold%,Dateiname$,"\")
       IF pos% > 0 THEN posold% = pos% + 1
     WEND 
     lenge% = LEN (Dateiname$)
     DatnamNew1$ = LEFT$ (Dateiname$,posold% - 1)
     ri% = lenge% - posold% + 1
     DatnamNew2$ = RIGHT$ (Dateiname$,ri%)
     codedoktest% = VAL (DatnamNew2$)
     REM CALL Fehler(Dateiname$,DatnamNew2$)
 
     IF Dateiname.dat$ LIKE "*VERTR.DOK*" THEN 
       IF codedoktest% > 0 AND EXISTS (codedoktest%,codedok.dokkv) THEN 
         SELECT FIRST FILE "dokkv" INDEX codedok.dokkv
         SELECT KEY codedoktest% FILE "dokkv" INDEX codedok.dokkv
         dateiname.dat$ = Dateiname.dokkv
         STORE FILE dat$
       END IF 
     END IF 
 
     IF Dateiname.dat$ LIKE "*GEADR.DOK*" THEN 
       IF codedoktest% > 0 AND EXISTS (codedoktest%,codedok.dokge) THEN 
         SELECT FIRST FILE "dokge" INDEX codedok.dokge
         SELECT KEY codedoktest% FILE "dokge" INDEX codedok.dokge
         dateiname.dat$ = Dateiname.dokge
         STORE FILE dat$
       END IF 
     END IF 
 
     IF Dateiname.dat$ LIKE "*MAADR.DOK*" THEN 
       IF codedoktest% > 0 AND EXISTS (codedoktest%,codedok.dokma) THEN 
         SELECT FIRST FILE "dokma" INDEX codedok.dokma
         SELECT KEY codedoktest% FILE "dokma" INDEX codedok.dokma
         dateiname.dat$ = Dateiname.dokma
         STORE FILE dat$
       END IF 
     END IF 
 
 
   END IF 
   SELECT NEXT LOCK FILE dat$
 WEND 
 
 
 REM *******************************************************************************************************************************************************************

 GOTO endblind160620032 
 IF _projekt$ <> "IMMAK" THEN 
  FILE "Dokument"
  INDEX link.dokument
  REM SELECT KEY 1 LOCK FILE "Dokument" INDEX link.dokument
  SELECT LAST FILE "Dokument"
  REM erstmal blindmachen, bis Problem geklÑrt
  GOTO endblind160620032
  WHILE NOT EOF ("DOKUMENT")

   IF transf.dokument <> 1 THEN 
     IF NOT EXISTS (Dateiname.dokument,Dateiname.dokkv) THEN 
       IF EXISTS (link.dokument,lfdnr.kvertrag) AND lfdnr.kvertrag > 0 THEN 
           FILE "DOKKV"
           BLANK FILE "DOKKV"
           CodeDOK.DOKKV = SER ("DOKKV",1)
           IF DOKNeu% = - 1 THEN DOKNeu% = CodeDOK.DOKKV
           dokument.DOKKV = dokument.Dokument
           erstellt_am.DOKKV = erstellt_am.Dokument
           letzte_Bearbeit.DOKKV = letzte_Bearbeit.Dokument
           CodeMA.DOKKV = codema.Dokument
           CodeKU.DOKKV = link.dokument
           Bearbeiter.DOKKV = Bearbeiter.Dokument
           Creator.DOKKV = Creator.Dokument
           Dateiname.DOKKV = Dateiname.Dokument
           Gruppe.DOKKV = Gruppe.Dokument
           link.DOKKV = link.dokument
           CALL QuickStore("DOKKV")
       END IF 
     END IF 
   END IF 
   FILE "Dokument"
   transf.dokument = 1
   STORE FILE "Dokument"
   SELECT NEXT LOCK FILE "Dokument" INDEX link.dokument
  WEND 
 END IF 
 
endblind160620032:  


 CALL DFile(2,"OFFICE\" + "mail" + _fpw$)
 FILE "mail"
 CALL FldAdd("CodeMA","NUM;000000.",1)
 CALL FldAdd("EmpfÑnger","TXT;100",0)
 SAVE FILE "mail"



 REM ***************************
 REM ** Anpassung AKQUISE.SBF **
 REM ***************************
 lauf% = 0
akquilauf160620031: 
 CALL DFile(2,"OFFICE\" + "aktionen" + _fpw$)
 IF lauf% = 0 THEN 
   dat$ = "Akquise"
   IF OPEN (dat$) THEN CLOSE FILE dat$
   CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 END IF 
 IF lauf% = 1 THEN 
   dat$ = "Akquibck"
   IF OPEN (dat$) THEN CLOSE FILE dat$
   CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 END IF 
 IF lauf% = 2 THEN 
   dat$ = "Akqui1"
   IF OPEN (dat$) THEN CLOSE FILE dat$
   CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
 END IF 
 
 REM GOTO AAAA0
 FILE dat$
 CALL FldAdd("CodeAQ","NUM;000000.",1)
 CALL FldAdd("Datum","DAT;0d.mm.yyyy",1)
 CALL FldAdd("ErDatum","DAT;0d.mm.yyyy",0)
 CALL FldAdd("ErZeit","TIM;hh:mm",0)
 CALL FldAdd("Dauer","NUM;999.",0)
 CALL FldAdd("Termin","DAT;0d.mm.yyyy",1)
 CALL FldAdd("Bearbeiter","TXT;50",0)
 CALL FldAdd("Nachname","TXT;100",0)
 CALL FldAdd("erledigt_Termin","TXT;1",1)
 CALL FldAdd("Sprachnotiz","TXT;1",0)
 CALL FldAdd("Wertung","NMI;00.",0)
 CALL FldAdd("Notiz","TXT;4000 R",0)
 CALL FldAdd("Ergebnis","TXT;4000 R",0)
 CALL FldAdd("QuickCodeMA","TXT;14",1)
 CALL FldAdd("QuickCodeMAZ","TXT;18",1)
 CALL FldAdd("QuickCodeKU","TXT;14",1)
 CALL FldAdd("QuickCodeAK","TXT;14",1)
 CALL FldAdd("QuickAKMA","TXT;20",1)
 CALL FldAdd("CodeAKMA","TXT;12",1)
 CALL FldAdd("QuickKUDat","TXT;15",1)
 CALL FldAdd("QuickMADat","TXT;15",1)
 CALL FldAdd("QuickAKDat","TXT;15",1)
 CALL FldAdd("QuickAKMADat","TXT;21",1)
 CALL FldAdd("MemberOf","TXT;120",1)
 CALL FldAdd("QuickKuDatDiff","NUM;000000000000.",1)
 CALL FldAdd("QuickPRDatDiff","NUM;000000000000.",1)
 CALL FldAdd("CodePR","NUM;000000.",1)
 CALL FldAdd("Projekt","TXT;120",1)
 CALL FldAdd("QuickAKMATer","TXT;20",1)
 CALL FldAdd("QuickAKTer","TXT;14",1)
 CALL FldAdd("QuickKUTer","TXT;14",1)
 CALL FldAdd("QuickMATer","TXT;14",1)
 
 CALL FldAdd("CodeMS","NUM;000000.",1)
 CALL FldAdd("DME","TXT;10",0)
 CALL FldAdd("TerminNr","NUM;,9999999.",0)
 CALL FldAdd("AkquiseTag","TXT;20",0)
 CALL FldAdd("FolgeTermin1","TXT;10",0)
 CALL FldAdd("FolgeZeit1","TIM;hh:mm",0)
 CALL FldAdd("FolgeTermin2","TXT;10",0)
 CALL FldAdd("FolgeZeit2","TIM;hh:mm",0)
 CALL FldAdd("Ort","TXT;50",0)
 CALL FldAdd("AZ","TXT;1",0)
 CALL FldAdd("BBA","TXT;1",0)
 CALL FldAdd("Sonstiges","TXT;1",0)
 CALL FldAdd("EMAILTO","TXT;200",0)
 CALL FldAdd("EMAILCC","TXT;4000 R",0)
 CALL FldAdd("EMAILBCC","TXT;4000 R",0)
 CALL FldAdd("EMAILBETREFF","TXT;250",0)
 CALL FldAdd("EMAILTEXT","TXT;4000 R",0)
 CALL FldAdd("EMAILRAUS","TXT;1",0)
 CALL FldAdd("EMAILATT1","TXT;255",0)
 CALL FldAdd("EMAILATT2","TXT;255",0)
 CALL FldAdd("EMAILATT3","TXT;255",0)
 CALL FldAdd("EMAILATT4","TXT;255",0)
 CALL FldAdd("EMAILATT5","TXT;255",0)
 CALL FldAdd("EMAILSendDat","DAT;0d.mm.yyyy",0)
 CALL FldAdd("EMAILSendZeit","TIM;hh:mm",0)
 CALL FldAdd("EMAILVorDat","DAT;0d.mm.yyyy",0)
 CALL FldAdd("EMAILVorZeit","TIM;hh:mm",0)
 CALL FldAdd("EMAILAutomat","TXT;1",0)
 CALL FldAdd("EATT1","TXT;255",0)
 CALL FldAdd("EATT2","TXT;255",0)
 CALL FldAdd("EATT3","TXT;255",0)
 CALL FldAdd("EATT4","TXT;255",0)
 CALL FldAdd("EATT5","TXT;255",0)
 CALL FldAdd("EMAILTEXT1","TXT;4000 R",0)
 CALL FldAdd("CodeAnfrage","NUM;000000.",1)
 CALL FldAdd("CodeObjekt","NUM;000000.",1)

 CALL FldAdd("Aktion","TXT;60",1)

 CALL MarkMain("CodeAQ")
 CALL Server("UPDFIELD","Bitte warten")
 CALL Server("UPDSTATUS","Erzeugung Feldinhalt fÅr QuickCodes")


 IF lauf% = 0 THEN 
   SAVE FILE "akquise"
   lauf% = lauf% + 1

   GAkquiDat$ = "Akquise"
   GDokDat$ = "Dokument"
   FILE GAkquiDat$
   INDEX codeaq.GAkquiDat$
   IF RECCOUNT (GAkquiDat$) > 0 THEN 
     SELECT FIRST 
   ELSE 
     SELECT LAST 
   END IF 
   i% = 0
   j% = RECCOUNT (GAkquiDat$)
   WHILE NOT EOF (GAkquiDat$)
     i% = i% + 1
     IF codedok.GAkquiDat$ > 0 AND EXISTS (codedok.GAkquiDat$,codedok.GDokDat$) THEN 
       codeaq% = codeaq.GAkquiDat$
       SELECT FIRST FILE GDokDat$ INDEX codedok.GDokDat$
       SELECT KEY codedok.GAkquiDat$ LOCK FILE GDokDat$ INDEX codedok.GDokDat$
       codeaq.GDokDat$ = codeaq%
       STORE FILE GDokDat$
     END IF 
     SET STATUS GAkquiDat$ + ": " + STR$ (i%,",99999999") + " / " + STR$ (j%,",99999999")
     SELECT NEXT FILE GAkquiDat$
   WEND 

   GOTO akquilauf160620031
 END IF 
 IF lauf% = 1 THEN 
   SAVE FILE "akquibck"
   REM IF GBENE% THEN 
   lauf% = lauf% + 1
   GAkquiDat$ = "Akquibck"
   GDokDat$ = "Dokbck"
   FILE GAkquiDat$
   INDEX codeaq.GAkquiDat$
   IF RECCOUNT (GAkquiDat$) > 0 THEN 
     SELECT FIRST 
   ELSE 
     SELECT LAST 
   END IF 
   i% = 0
   j% = RECCOUNT (GAkquiDat$)
   WHILE NOT EOF (GAkquiDat$)
     i% = i% + 1
     IF codedok.GAkquiDat$ > 0 AND EXISTS (codedok.GAkquiDat$,codedok.GDokDat$) THEN 
       codeaq% = codeaq.GAkquiDat$
       SELECT FIRST FILE GDokDat$ INDEX codedok.GDokDat$
       SELECT KEY codedok.GAkquiDat$ LOCK FILE GDokDat$ INDEX codedok.GDokDat$
       codeaq.GDokDat$ = codeaq%
       STORE FILE GDokDat$
     END IF 
     SET STATUS GAkquiDat$ + ": " + STR$ (i%,",99999999") + " / " + STR$ (j%,",99999999")
     SELECT NEXT FILE GAkquiDat$
   WEND 
 
   GOTO akquilauf160620031
   REM END IF 
 END IF 
 IF lauf% = 2 THEN 
   SAVE FILE "akqui1"
   lauf% = lauf% + 1
   GAkquiDat$ = "Akqui1"
   GDokDat$ = "Dokadr1"
   FILE GAkquiDat$
   INDEX codeaq.GAkquiDat$
   IF RECCOUNT (GAkquiDat$) > 0 THEN 
     SELECT FIRST 
   ELSE 
     SELECT LAST 
   END IF 
   i% = 0
   j% = RECCOUNT (GAkquiDat$)
   WHILE NOT EOF (GAkquiDat$)
     i% = i% + 1
     IF codedok.GAkquiDat$ > 0 AND EXISTS (codedok.GAkquiDat$,codedok.GDokDat$) THEN 
       codeaq% = codeaq.GAkquiDat$
       SELECT FIRST FILE GDokDat$ INDEX codedok.GDokDat$
       SELECT KEY codedok.GAkquiDat$ LOCK FILE GDokDat$ INDEX codedok.GDokDat$
       codeaq.GDokDat$ = codeaq%
       STORE FILE GDokDat$
     END IF 
     SET STATUS GAkquiDat$ + ": " + STR$ (i%,",99999999") + " / " + STR$ (j%,",99999999")
     SELECT NEXT FILE GAkquiDat$
   WEND 
 
 END IF 

 REM CALL Fehler("Akquise anpassung","")


 FILE "Akquise"
 INDEX codeaq.akquise
 IF RECCOUNT ("Akquise") > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 i% = 0
 GADRDAT$ = "ADRESSEN"
 IF NOT OPEN (GADRDat$) THEN CALL DFile(2,"OFFICE\" + GADRDat$ + _fpw$)
 FILE "adressen"
 INDEX codeku.adressen
 FILE "aktionen"
 INDEX codeak.aktionen
 FILE "AKQUISE"
 INDEX codeaq.akquise
 IF RECCOUNT ("Akquise") > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 j% = RECCOUNT ("AKQUISE")
 MOUSE OFF 
 WHILE NOT EOF ("Akquise")
   i% = i% + 1
   IF aktion.akquise = "" THEN 
     SELECT KEY codeak.akquise FILE "aktionen" INDEX codeak.aktionen
     aktion.akquise = bezeichnung.aktionen
     IF erledigt_Termin.akquise = "" THEN erledigt_Termin.akquise = "n"
     IF EXISTS (codeku.akquise,codeku.adressen) THEN 
       SELECT KEY codeku.akquise FILE "adressen" INDEX codeku.adressen
       nachname.akquise = LEFT$ ( TRIM$ (Nachname.adressen) + "," + TRIM$ (vorname.adressen),100)
     END IF 
     STORE FILE "akquise"
   ELSE 
     IF EXISTS (codeku.akquise,codeku.adressen) THEN 
       SELECT KEY codeku.akquise FILE "adressen" INDEX codeku.adressen
       nachname.akquise = LEFT$ ( TRIM$ (Nachname.adressen) + "," + TRIM$ (vorname.adressen),100)
     END IF 
     STORE FILE "akquise"
   END IF 
   SET STATUS STR$ (i%,",99999999") + "/" + STR$ (j%,",99999999")
   SELECT NEXT LOCK FILE "akquise"
 WEND 


  
 FILE "AKQUISE"
 CALL DFile(2,"OFFICE\TVORLAGE" + _fpw$)
 FILE "Akquise"
 INDEX CodeAQ
 SELECT LAST 
 WHILE CodeAQ > SER ("AKQUISE",1)
 WEND 
 INDEX codeaq.akquise
 IF RECCOUNT ("Akquise") > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 i% = 0
 k% = RECCOUNT ("Akquise")
 REM CALL Fehler("","")
 WHILE NOT EOF ("Akquise") AND GIndNeu% = - 1
   i% = i% + 1
   erl$ = "j"
   IF Termin.akquise < TODAY THEN 
     REM 281299 erledigt_Termin.akquise = "j"
   END IF 
   IF erledigt_Termin.AKQUISE <> "j" THEN 
     erledigt_Termin.AKQUISE = "n"
     erl$ = "n"
   END IF 
     IF codema.akquise < 1 THEN 
       IF bearbeiter.akquise <> "" THEN 
         IF EXISTS (bearbeiter.akquise,nachname.supervis) THEN 
           SELECT KEY bearbeiter.akquise FILE "Supervis" INDEX nachname.supervis
           codema.akquise = codema.supervis
         END IF 
       END IF 
     END IF 
   SET STATUS STR$ (i%,"999999") + " Termine angepa·t von " + STR$ (k%,"999999")
   CALL Server("UPDSTATUS", STR$ (i%,"999999") + " Termine angepa·t von " + STR$ (k%,"999999"))
     QuickCodeMA.akquise = DATE$ (termin.akquise,"0dmmyyyy") + STR$ (CodeMA.akquise,"000000")
     QuickCodeMAZ.akquise = DATE$ (termin.akquise,"0dmmyyyy") + STR$ (CodeMA.akquise,"000000") + TIME$ (Uhrzeit.akquise,"hhmm")
     QuickCodeKU.akquise = DATE$ (termin.akquise,"0dmmyyyy") + STR$ (CodeKU.akquise,"000000")
     QuickCodeAK.akquise = DATE$ (termin.akquise,"0dmmyyyy") + STR$ (CodeAK.akquise,"000000")
     QuickAKMA.akquise = DATE$ (termin.akquise,"0dmmyyyy") + STR$ (codeak.akquise,"000000") + STR$ (CodeMA.akquise,"000000")
     CodeAKMA.akquise = STR$ (codeak.akquise,"000000") + STR$ (CodeMA.akquise,"000000")
     QuickKUDat.akquise = STR$ (CodeKU.akquise,"000000") + UCASE$ (erl$) + DATE$ (termin.akquise,"yyyymm0d")
     QuickMADat.akquise = STR$ (CodeMA.akquise,"000000") + UCASE$ (erl$) + DATE$ (termin.akquise,"yyyymm0d")
     QuickAKDat.akquise = STR$ (CodeAK.akquise,"000000") + UCASE$ (erl$) + DATE$ (termin.akquise,"yyyymm0d")
     QuickAKMADat.akquise = STR$ (codeak.akquise,"000000") + STR$ (CodeMA.akquise,"000000") + UCASE$ (erl$) + DATE$ (termin.akquise,"yyyymm0d")
     QuickKuDatDiff.akquise = codeku * 1000000 + (1000000 - DAYS (termin))
     QuickPRDatDiff.akquise = codepr * 1000000 + (1000000 - DAYS (termin))
 
     QuickAKTer.akquise = STR$ (CodeAK.akquise,"000000") + DATE$ (termin.akquise,"yyyymm0d")
     QuickMATer.akquise = STR$ (CodeMA.akquise,"000000") + DATE$ (termin.akquise,"yyyymm0d")
     QuickKUTer.akquise = STR$ (CodeKU.akquise,"000000") + DATE$ (termin.akquise,"yyyymm0d")
     QuickAKMATer.akquise = STR$ (codeak.akquise,"000000") + STR$ (CodeMA.akquise,"000000") + DATE$ (termin.akquise,"yyyymm0d")
     IF QWoNo = "" THEN 
       Workstation = 0
       QWoNo = "000000000000"
     END IF 
    STORE FILE "Akquise"
    REM falls Termin aus der Wiedervorlage datei verschwunden, dann wieder eintragen
     GAkquiDat$ = "AKQUISE"
     IF erledigt_termin.GAkquiDat$ <> "j" AND ErDatum.GAkquiDat$ > 0 THEN 
       IF NOT EXISTS (codeaq.GAkquiDat$,codeaq.tvorlage) THEN 
         BLANK FILE "TVORLAGE"
         CodeTV.TVORLAGE = SER ("TVORLAGE",1)
         codeaq.TVORLAGE = codeaq.GAkquiDat$
         codema.TVORLAGE = codema.GAkquiDat$
         Termin.TVORLAGE = termin.GAkquiDat$
         Uhrzeit.TVORLAGE = Uhrzeit.GAkquiDat$
         Datum.TVORLAGE = ERDATUM.GAkquiDat$
         Zeit.TVORLAGE = ErZeit.GAkquiDat$
         Notiz.TVORLAGE = Notiz.GAkquiDat$
         Ergebnis.TVORLAGE = Ergebnis.GAkquiDat$
         Nachname.TVORLAGE = Nachname.GAkquiDat$
         Bearbeiter.TVORLAGE = Bearbeiter.GAkquiDat$
         erledigt_Termin.tvorlage = erledigt_termin.GAkquiDat$
         DTVorlage.TVORLAGE = STR$ (CodeMA.GAkquiDat$,"000000") + DATE$ (ErDatum.GAkquiDat$,"yyyymm0d") + TIME$ (ErZeit.GAkquiDat$,"hhmm")
         Workstation.TVORLAGE = Workstation.GAkquiDat$
         QWoNo.TVORLAGE = STR$ (Workstation.GAkquiDat$,"000000") + STR$ (CodeTV.TVORLAGE,"000000")
         IF Workstation% > 0 THEN Workstation.TVORLAGE = Workstation%
         IF Workstation% > 0 THEN QWoNo.TVORLAGE = STR$ (Workstation%,"000000") + STR$ (CodeTV.TVORLAGE,"000000")
         RecStatus.TVORLAGE = "c"
         STORE FILE "TVORLAGE"
         UNLOCK CURRENT FILE "tvorlage"
       END IF 
     END IF 


    SELECT NEXT LOCK FILE "Akquise"
  WEND 
  SET STATUS ""
 
 
     FILE "supervis"
     SELECT FIRST LOCK FILE "supervis"
     i% = 0
     WHILE NOT EOF ("supervis")
       i% = i% + 1
       
       FILE "AKQUISE"
       INDEX QuickMaTer.akquise
       SELECT FIRST FILE "Akquise"
       codema$ = STR$ (codema.supervis,"000000")
       IF EXISTS (codema.supervis,codema.akquise) THEN 
         SELECT KEY codema$ LOCK FILE "Akquise" INDEX QuickMaTer.akquise
       ELSE 
         SELECT LAST FILE "akquise" INDEX codema.akquise
       END IF 
       terges% = 0
       terunerl% = 0
       tererl% = 0
       j% = 0
       WHILE NOT EOF ("Akquise") AND codema.akquise = codema.supervis
          IF codema.akquise = codema.supervis THEN 
            j% = j% + 1
            terges% = terges% + 1
            IF erledigt_Termin LIKE "j" THEN 
              tererl% = tererl% + 1
            ELSE 
              terunerl% = terunerl% + 1
            END IF 
          END IF 
          SET STATUS "Termine von " + name.supervis + " gezÑhlt   Gesamt: " + STR$ (terges%,"999999") + " davon erledigt: " + LTRIM$ ( STR$ (tererl%,"999999")) + " davon unerledigt: " + LTRIM$ ( STR$ (terunerl%,"999999"))
          IF terminnr.akquise = 0 THEN 
            terminnr.akquise = j%
            STORE FILE "Akquise"
            UNLOCK CURRENT FILE "Akquise"
          END IF 
          SELECT NEXT LOCK FILE "Akquise"
       WEND 
       FILE "supervis"
       AnzTermine.supervis = terges%
       AnzTermineUnerl.supervis = terunerl%
       AnzTermineErl.supervis = tererl%
       STORE FILE "supervis"
       UNLOCK CURRENT FILE "supervis"
       SELECT NEXT LOCK FILE "supervis"
     WEND 


 REM ***************************
 REM ** Anpassung WEMAIL.SBF **
 REM ***************************
 
 
 CALL DFile(2,"OFFICE\WEMAIL" + _fpw$)
 FILE "WEMAIL"
 CALL FldAdd("TimeStamp","NUM;0000000000.",1)
 CALL FldAdd("Ersteller","TXT;400",1)
 CALL FldAdd("EDatum","DAT;0d.mm.yyyy",1)
 SAVE FILE "WEMAIL"


 REM ***************************
 REM ** Anpassung TVORLAGE.SBF **
 REM ***************************
 
 
 REM AFSK 130420031
 REM GOTO afsk130420031 

 dat$ = "Akquise"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\AKQUISE" + _fpw$)
 dat$ = "tvorlage"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\TVORLAGE" + _fpw$)
 REM GOTO AAAA0
 FILE "TVORLAGE"
 CALL FldAdd("Nachname","TXT;100",0)
 CALL FldAdd("DME","TXT;10",0)
 CALL FldAdd("EMAILRAUS","TXT;1",0)
 CALL FldAdd("EMAILVorDat","DAT;0d.mm.yyyy",0)
 CALL FldAdd("EMAILVorZeit","TIM;hh:mm",0)
 SAVE FILE "TVORLAGE"
 FILE "TVORLAGE"
 INDEX codetv.tvorlage
 IF RECCOUNT ("TVORLAGE") > 0 THEN 
   SELECT FIRST LOCK FILE "TVORLAGE" INDEX codetv.tvorlage
 ELSE 
   SELECT LAST 
 END IF 
 codeaqold% = 0
 codeaq% = - 1
 j% = RECCOUNT ("tvorlage")
 i% = 0
 WHILE NOT EOF ("TVORLAGE")
   codeaq% = codeaq.TVORLAGE
   i% = i% + 1
   SET STATUS STR$ (i%) + "/" + STR$ (j%)
   IF NOT EXISTS (codeaq%,codeaq.akquise) THEN 
     REMOVE FROM FILE "TVORLAGE" WHERE codeaq.tvorlage = codeaq%
     IF RECCOUNT ("TVORLAGE") > 0 THEN 
       SELECT FIRST LOCK FILE "TVORLAGE"
       i% = 0
     ELSE 
       SELECT LAST 
     END IF 
 
     codeaqold% = - 1
     codeaq% = 0
   ELSE 
     IF codeaq% = codeaqold% THEN 
       SELECT REMOVE FILE "TVORLAGE"
       SELECT FIRST LOCK FILE "TVORLAGE"
       codeaqold% = - 1
     ELSE 
       IF codeaq% > 0 AND EXISTS (codeaq%,codeaq.tvorlage) THEN 
         codeaqold% = codeaq%
         SELECT KEY codeaq% FILE "AKquise" INDEX codeaq.akquise
         emailraus.tvorlage = emailraus.akquise
         DTVorlage.TVORLAGE = STR$ (CodeMA.tvorlage,"000000") + DATE$ (Datum.tvorlage,"yyyymm0d") + TIME$ (Zeit.tvorlage,"hhmm")
         STORE FILE "TVORLAGE"
         SELECT NEXT LOCK FILE "TVORLAGE"
       END IF 
       
     END IF 
   END IF 
 WEND 
  
 REM ****************************
 REM ** Anpassung AKTIONEN.SBF **
 REM ****************************
 dat$ = "Aktionen"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\AKTIONEN" + _fpw$)
 FILE "AKTIONEN"
 CALL FldAdd("MemberOf","TXT;120",1)
 CALL MarkMain("CodeAK")
 SAVE FILE "AKTIONEN"
 
 REM -- Erzeugung der MemberOf-Felder
 
 SELECT FIRST FILE "AKTIONEN"
 IF MemberOf.AKTIONEN = "" THEN 
   CALL Server("UPDFILE","AKTIONEN")
   CALL Server("UPDFIELD","MemberOf")
   CALL Server("UPDSTATUS","Erzeugung Feldinhalt")
   UPDATE MemberOf.AKTIONEN = STR$ (CodeAK.AKTIONEN,"000000") WHERE MemberOf.AKTIONEN = ""
   END UPDATE 
   CALL Server("UPDFILE","AKQUISE")
   CALL AQFileUpdate()
 END IF 
 
 REM -- StandardeintrÑge fÅr AKTIONEN erzeugen
 
 FILE "aktionen"
 INDEX codeak.aktionen
 REM SELECT KEY 999991 LOCK INDEX CodeAk.aktionen
 testeak% = 999990
 IF NOT EXISTS (testeak%,codeak.AKTIONEN) THEN 
   CALL Server("UPDFILE","AKTIONEN")
   CALL Server("UPDFIELD","")
   CALL Server("UPDSTATUS","Erzeugung der StandardeintrÑge fÅr AKTIONEN")
   BLANK 
   Codeak.aktionen = 999990
   bezeichnung.aktionen = "<Anfrage>"
   IF MemberOf.AKTIONEN = "" THEN MemberOf.AKTIONEN = STR$ (CodeAK.AKTIONEN,"000000")
   CALL QuickStore("AKTIONEN")
 END IF 
 testeak% = 999991
 IF NOT EXISTS (testeak%,codeak.AKTIONEN) THEN 
   CALL Server("UPDFILE","AKTIONEN")
   CALL Server("UPDFIELD","")
   CALL Server("UPDSTATUS","Erzeugung der StandardeintrÑge fÅr AKTIONEN")
   BLANK 
   Codeak.aktionen = 999991
   bezeichnung.aktionen = "<Angebote>"
   IF MemberOf.AKTIONEN = "" THEN MemberOf.AKTIONEN = STR$ (CodeAK.AKTIONEN,"000000")
   CALL QuickStore("AKTIONEN")
 END IF 
 testeak% = 999992
 IF NOT EXISTS (testeak%,codeak.AKTIONEN) THEN 
   BLANK 
   CodeAK.aktionen = 999992
   bezeichnung.aktionen = "<Rechnungen>"
     IF QWoNo = "" THEN 
       Workstation = 0
       QWoNo = "000000000000"
     END IF 
   CALL QuickStore("AKTIONEN")
 END IF 
 testeak% = 999993
 IF NOT EXISTS (testeak%,codeak.AKTIONEN) THEN 
   BLANK 
   CodeAK.aktionen = 999993
   bezeichnung.aktionen = "<Lieferscheine>"
   CALL QuickStore("AKTIONEN")
 END IF 
 testeak% = 999994
 IF NOT EXISTS (testeak%,codeak.AKTIONEN) THEN 
   BLANK 
   CodeAK.aktionen = 999994
   bezeichnung.aktionen = "<AuftrÑge>"
   CALL QuickStore("AKTIONEN")
 END IF 
 testeak% = 999995
 IF NOT EXISTS (testeak%,codeak.AKTIONEN) THEN 
   BLANK 
   CodeAK.aktionen = 999995
   bezeichnung.aktionen = "<Bestellungen>"
   CALL QuickStore("AKTIONEN")
 END IF 
 testeak% = 999997
 IF NOT EXISTS (testeak%,codeak.AKTIONEN) THEN 
   BLANK 
   CodeAK.aktionen = 999997
   bezeichnung.aktionen = "<Gutschriften>"
   CALL QuickStore("AKTIONEN")
 END IF 
 testeak% = 999998
 IF NOT EXISTS (testeak%,codeak.AKTIONEN) THEN 
   BLANK 
   CodeAK.aktionen = 999998
   bezeichnung.aktionen = "<Mahnungen>"
   CALL QuickStore("AKTIONEN")
 END IF 
 SELECT KEY 999991 LOCK FILE "AKTIONEN" INDEX CodeAK.AKTIONEN
 SELECT PREVIOUS 
 tst% = CodeAK
 REM WHILE tst% > SER ("AKTIONEN",1)
 REM WEND 
 
 
 REM ****************************
 REM ** Anpassung DOKUMENT.SBF **
 REM ****************************
  
 CALL DFile(2,"ACCODE" + _fpw$)
 FILE "ACCODE"
 CALL MarkMain("CodePR")
 SAVE FILE "ACCODE"
 
 
 REM ****************************
 REM ** Anpassung ACCESS.SBF **
 REM ****************************
 
 CALL DFile(2,"ACCESS" + _fpw$)
 FILE "ACCESS"
 CALL MarkMain("CodePR")
 SAVE FILE "ACCESS"
  
 
 REM ****************************
 REM ** Anpassung ADRESSEN.SBF **
 REM ****************************
 dat$ = "Telefon"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\Telefon" + _fpw$)
 FILE "Telefon"
 CALL FldAdd("CodeTEL","NUM;000000.",1)
 CALL FldAdd("CodeKU","NUM;000000.",1)
 CALL FldAdd("FonOderFax","TXT;1",0)
 CALL FldAdd("Nummer","TXT;200",1)
 CALL FldAdd("Art","TXT;200",1)
 CALL FldAdd("QNummer","TXT;220",1)
 CALL FldAdd("QArt","TXT;220",1)
 CALL FldAdd("Ort","TXT;50",0)
 CALL FldAdd("Strasse","TXT;50",0)
 CALL FldAdd("PLZ","TXT;50",0)
 CALL FldAdd("Notiz","TXT;4000 R",0)
 CALL FldAdd("Geburtstag","DAT;0d.mm.yyyy",0)
 CALL FldAdd("Geschlecht","TXT;1",0)
 CALL FldAdd("ExpAG","TXT;1",1)
 CALL FldAdd("KART1","TXT;10",1)
 CALL FldAdd("KART2","TXT;10",1)
 CALL FldAdd("QCodeKUTEL","TXT;12",1)
 SAVE FILE "Telefon"
 FILE dat$
 INDEX QCodeKUTEL
 SELECT FIRST 
 i% = 0
 j% = RECCOUNT (dat$)
 IF QCodeKUTEL = "" AND RECCOUNT (dat$) > 0 THEN 
   INDEX codeku
   IF RECCOUNT (dat$) > 0 THEN 
     SELECT FIRST LOCK 
   ELSE 
     SELECT LAST 
   END IF 
   WHILE NOT EOF (dat$)
     MOUSE OFF 
     i% = i% + 1
     SET STATUS "Anpassung " + dat$ + " " + STR$ (i%,",99999999") + "/" + STR$ (j%,",99999999")
     IF QCodeKUTEL = "" THEN 
       QCodeKUTEL = STR$ (codeku,"000000") + STR$ (codetel,"000000")
       STORE FILE dat$
     END IF 
     SELECT NEXT LOCK FILE dat$
   WEND 
 END IF 
 FILE "Telefon"
 INDEX nummer.telefon
 IF RECCOUNT ("Telefon") > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 j% = 0
 MOUSE OFF 
 k% = RECCOUNT ("TELEFON")
 WHILE NOT EOF ("Telefon") AND GIndNeu% = - 1
   j% = j% + 1
   CALL Server("UPDSTATUS", LTRIM$ ( STR$ (j%,",999999999")) + " Telefonr angepa·t von " + LTRIM$ ( STR$ (k%,",999999999")))
   SET STATUS LTRIM$ ( STR$ (j%,",999999999")) + " Telefonnummern angepa·t von " + LTRIM$ ( STR$ (k%,",999999999"))
   Qart.telefon = VSNRPack$(art.telefon)
   Qnummer.telefon = VSNRPack$(nummer.telefon)
   IF kart1.telefon = "" THEN 
     IF art.telefon LIKE "fon*" OR art.telefon LIKE "*fon*" THEN kart1.telefon = "FON"
     IF art.telefon LIKE "www*" OR art.telefon LIKE "*www*" THEN kart1.telefon = "WWW"
     IF art.telefon LIKE "Fax*" OR art.telefon LIKE "*Fax*" OR fonoderFax.telefon LIKE "j" THEN kart1.telefon = "FAX"
     IF art.telefon LIKE "email*" OR art.telefon LIKE "*email*" OR nummer.telefon LIKE "*@*" OR nummer.telefon LIKE "@*" THEN kart1.telefon = "EMAIL"
     IF art.telefon LIKE "Funk*" OR art.telefon LIKE "*Funk*" OR art.telefon LIKE "Handy*" OR art.telefon LIKE "*Handy*" OR art.telefon LIKE "Mobil*" OR art.telefon LIKE "*Mobil*" THEN kart1.telefon = "MOBIL"
   END IF 
   IF kart1.telefon = "" THEN kart1.telefon = "k.A."
   IF kart2.telefon = "" THEN kart2.telefon = "k.A."
   STORE FILE "TELEFON"
   SELECT NEXT LOCK 
 WEND 
 dat$ = "Telbck"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\TelBCK" + _fpw$)
 FILE "TelBCK"
 CALL FldAdd("FonOderFax","TXT;1",0)
 CALL FldAdd("Nummer","TXT;200",1)
 CALL FldAdd("Art","TXT;200",1)
 CALL FldAdd("QNummer","TXT;220",1)
 CALL FldAdd("QArt","TXT;220",1)
 CALL FldAdd("Ort","TXT;50",0)
 CALL FldAdd("Strasse","TXT;50",0)
 CALL FldAdd("PLZ","TXT;50",0)
 CALL FldAdd("Notiz","TXT;4000 R",0)
 CALL FldAdd("Geburtstag","DAT;0d.mm.yyyy",0)
 CALL FldAdd("Geschlecht","TXT;1",0)
 CALL FldAdd("ExpAG","TXT;1",1)
 CALL FldAdd("KART1","TXT;10",1)
 CALL FldAdd("KART2","TXT;10",1)
 CALL FldAdd("QCodeKUTEL","TXT;12",1)
 SAVE FILE "TelBCK"

 FILE dat$
 INDEX QCodeKUTEL
 SELECT FIRST 
 i% = 0
 j% = RECCOUNT (dat$)
 IF QCodeKUTEL = "" AND RECCOUNT (dat$) > 0 THEN 
   INDEX codeku
   IF RECCOUNT (dat$) > 0 THEN 
     SELECT FIRST LOCK 
   ELSE 
     SELECT LAST 
   END IF 
   WHILE NOT EOF (dat$)
     MOUSE OFF 
     i% = i% + 1
     SET STATUS "Anpassung " + dat$ + " " + STR$ (i%,",99999999") + "/" + STR$ (j%,",99999999")
     IF QCodeKUTEL = "" THEN 
       QCodeKUTEL = STR$ (codeku,"000000") + STR$ (codetel,"000000")
       STORE FILE dat$
     END IF 
     SELECT NEXT LOCK FILE dat$
   WEND 
 END IF 


 FILE "TelBCK"
 INDEX nummer.telBCK
 IF RECCOUNT ("TelBCK") > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 j% = 0
 k% = RECCOUNT ("TELBCK")
 MOUSE OFF 
 WHILE NOT EOF ("TelBCK") AND GIndNeu% = - 1
   j% = j% + 1
   SET STATUS STR$ (j%) + " Telefonnummern angepa·t"
   Qart.telBCK = VSNRPack$(art.telBCK)
   Qnummer.telBCK = VSNRPack$(nummer.telBCK)
   IF kart1.telBCK = "" THEN 
     IF art.telBCK LIKE "fon*" OR art.telBCK LIKE "*fon*" THEN kart1.telBCK = "FON"
     IF art.telBCK LIKE "WWW*" OR art.telBCK LIKE "*WWW*" THEN kart1.telBCK = "WWW"
     IF art.telBCK LIKE "Fax*" OR art.telBCK LIKE "*Fax*" OR fonoderFax.telBCK LIKE "j" THEN kart1.telBCK = "FAX"
     IF art.telBCK LIKE "email*" OR art.telBCK LIKE "*email*" OR nummer.telBCK LIKE "*@*" OR nummer.telBCK LIKE "@*" THEN kart1.telBCK = "EMAIL"
     IF art.telBCK LIKE "Funk*" OR art.telBCK LIKE "*Funk*" OR art.telBCK LIKE "Handy*" OR art.telBCK LIKE "*Handy*" OR art.telBCK LIKE "Mobil*" OR art.telBCK LIKE "*Mobil*" THEN kart1.telBCK = "MOBIL"
   END IF 
   IF kart1.telbck = "" THEN kart1.telbck = "k.A."
   IF kart2.telbck = "" THEN kart2.telbck = "k.A."
   STORE FILE "TELBCK"
   SELECT NEXT LOCK 
 WEND 

 dat$ = "Teladr1"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\Teladr1" + _fpw$)
 FILE "Teladr1"
 CALL FldAdd("FonOderFax","TXT;1",0)
 CALL FldAdd("Nummer","TXT;200",1)
 CALL FldAdd("Art","TXT;200",1)
 CALL FldAdd("QNummer","TXT;220",1)
 CALL FldAdd("QArt","TXT;220",1)
 CALL FldAdd("Ort","TXT;50",0)
 CALL FldAdd("Strasse","TXT;50",0)
 CALL FldAdd("PLZ","TXT;50",0)
 CALL FldAdd("Notiz","TXT;4000 R",0)
 CALL FldAdd("Geburtstag","DAT;0d.mm.yyyy",0)
 CALL FldAdd("Geschlecht","TXT;1",0)
 CALL FldAdd("ExpAG","TXT;1",1)
 CALL FldAdd("KART1","TXT;10",1)
 CALL FldAdd("KART2","TXT;10",1)
 CALL FldAdd("QCodeKUTEL","TXT;12",1)
 SAVE FILE "TelBCK"

 FILE dat$
 INDEX QCodeKUTEL
 SELECT FIRST 
 i% = 0
 j% = RECCOUNT (dat$)
 IF QCodeKUTEL = "" AND RECCOUNT (dat$) > 0 THEN 
   INDEX codeku
   SELECT FIRST LOCK 
   WHILE NOT EOF (dat$)
     MOUSE OFF 
     i% = i% + 1
     SET STATUS "Anpassung " + dat$ + " " + STR$ (i%,",99999999") + "/" + STR$ (j%,",99999999")
     IF QCodeKUTEL = "" THEN 
       QCodeKUTEL = STR$ (codeku,"000000") + STR$ (codetel,"000000")
       STORE FILE dat$
     END IF 
     SELECT NEXT LOCK FILE dat$
   WEND 
 END IF 

 FILE "Teladr1"
 INDEX nummer.teladr1
 IF RECCOUNT ("Teladr1") > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 j% = 0
 MOUSE OFF 
 WHILE NOT EOF ("Teladr1") AND GIndNeu% = - 1
   j% = j% + 1
   SET STATUS STR$ (j%) + " Telefonnummern angepa·t"
   Qart.teladr1 = VSNRPack$(art.teladr1)
   Qnummer.teladr1 = VSNRPack$(nummer.teladr1)
   IF kart1.teladr1 = "" THEN 
     IF art.teladr1 LIKE "fon*" OR art.teladr1 LIKE "*fon*" THEN kart1.teladr1 = "FON"
     IF art.teladr1 LIKE "WWW*" OR art.teladr1 LIKE "*WWW*" THEN kart1.teladr1 = "WWW"
     IF art.teladr1 LIKE "Fax*" OR art.teladr1 LIKE "*Fax*" OR fonoderFax.teladr1 LIKE "j" THEN kart1.teladr1 = "FAX"
     IF art.teladr1 LIKE "email*" OR art.teladr1 LIKE "*email*" OR nummer.teladr1 LIKE "*@*" OR nummer.teladr1 LIKE "@*" THEN kart1.teladr1 = "EMAIL"
     IF art.teladr1 LIKE "Funk*" OR art.teladr1 LIKE "*Funk*" OR art.teladr1 LIKE "Handy*" OR art.teladr1 LIKE "*Handy*" OR art.teladr1 LIKE "Mobil*" OR art.teladr1 LIKE "*Mobil*" THEN kart1.teladr1 = "MOBIL"
   END IF 
   IF kart1.teladr1 = "" THEN kart1.teladr1 = "k.A."
   IF kart2.teladr1 = "" THEN kart2.teladr1 = "k.A."
   STORE FILE "TELadr1"
   SELECT NEXT LOCK 
 WEND 


 dat$ = "keywords"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\Keywords" + _fpw$)
 FILE "Keywords"
 REMOVE FROM FILE "Keywords" WHERE LTRIM$ (Keyword) = ""
 SAVE FILE "Keywords"

 dat$ = "adrtemp"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\ADRTEMP" + _fpw$)
 FILE "ADRTEMP"
 CALL FldAdd("Titel","TXT;30",0)
 SAVE FILE "adrtemp"
 
 dat$ = "adrtemp1"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\ADRTEMP1" + _fpw$)
 FILE "ADRTEMP"
 CALL FldAdd("Titel","TXT;30",0)
 SAVE FILE "adrtemp1"

 dat$ = "fax"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\FAX" + _fpw$)
 FILE "FAX"
 CALL FldAdd("FAXNummer","TXT;200",0)
 SAVE FILE "FAX"
 
AAAA0: 
 lauf% = 0
 dat$ = "maadr"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 IF EXISTS (_netpath$ + _projekt$ + "\maadr.sbf") THEN CALL DFile(3,"MAADR" + _fpw$)
 CALL DFile(2,"OFFICE\BCKONTAK" + _fpw$)
 CALL DFile(2,"OFFICE\ADRLEER" + _fpw$)
 CALL DFile(2,"OFFICE\ADRE1" + _fpw$)
 dat$ = "adressen"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\ADRESSEN" + _fpw$)
 IF EXISTS (_netpath$ + "office\adrold.sbf") THEN DELETE (_netpath$ + "office\adrold.*")
 
lauf2006200101: 
 IF lauf% = 0 THEN 
   REM GOTO AAAA1
   FILE "ADRESSEN"
 END IF 
 IF lauf% = 1 THEN 
   FILE "ADRLEER"
 END IF 
 IF lauf% = 2 THEN 
   FILE "BCKONTAK"
 END IF 
  IF lauf% = 3 THEN 
   FILE "ADRE1"
 END IF 
 CALL FldAdd("CodeKU","NUM;000000.",1)
 CALL FldAdd("Stichwort","TXT;4000 R",1)
 CALL FldAdd("Nachname","TXT;50",1)
 CALL FldAdd("Vorname","TXT;50",1)
 CALL FldAdd("Stra·e","TXT;50",1)
 CALL FldAdd("Ort","TXT;50",1)
 CALL FldAdd("PLZ","TXT;15 U",1)
 CALL FldAdd("Land","TXT;50",1)
 CALL FldAdd("Hobbys","TXT;70",1)
 CALL FldAdd("ASName","TXT;50",1)
 CALL FldAdd("ASStra·e","TXT;50",1)
 CALL FldAdd("ASOrt","TXT;50",1)
 CALL FldAdd("ASLand","TXT;50",0)
  
 REM -- 05.09.93/AB -------------------------------
 
 CALL FldAdd("Geburtsname","TXT;50",1)
 CALL FldAdd("LName","TXT;50",0)
 CALL FldAdd("LVorname","TXT;50",0)
 CALL FldAdd("LStra·e","TXT;50",0)
 CALL FldAdd("LOrt","TXT;50",0)
 CALL FldAdd("Geschlecht","TXT;1",0)
 CALL FldAdd("EGNachname","TXT;50",0)
 CALL FldAdd("EGGeburtsname","TXT;50",0)
 CALL FldAdd("EGVorname","TXT;50",0)
 CALL FldAdd("EGGeburtstag","DAT;0d.mm.yyyy",0)
 CALL FldAdd("VBKreditbei","TXT;50",0)
 CALL FldAdd("VBBÅrgschbei","TXT;50",0)
 CALL FldAdd("EGASName","TXT;50",0)
 CALL FldAdd("EGASStra·e","TXT;50",0)
 CALL FldAdd("EGASOrt","TXT;50",0)
 CALL FldAdd("Inhaber1","TXT;50",0)
 CALL FldAdd("Inhaber2","TXT;50",0)
 CALL FldAdd("Inhaber3","TXT;50",0)
 CALL FldAdd("APartner1","TXT;50",0)
 CALL FldAdd("APartner2","TXT;50",0)
 CALL FldAdd("APartner3","TXT;50",0)
 CALL FldAdd("APartner4","TXT;50",0)
 CALL FldAdd("K1Bank","TXT;50",0)
 CALL FldAdd("K2Bank","TXT;50",0)
 CALL FldAdd("FIATEC","TXT;1",1)
 CALL FldAdd("FIIMMAK","TXT;1",1)
 CALL FldAdd("FIprivat","TXT;1",1)
 CALL FldAdd("AAMietint","TXT;1",1)
 CALL FldAdd("AAKaufint","TXT;1",1)
 CALL FldAdd("AALieferant","TXT;1",1)
 CALL FldAdd("AAMakler","TXT;1",1)
 CALL FldAdd("AAMitarbeiter","TXT;1",1)
 CALL FldAdd("AAKunde","TXT;1",1)
 CALL FldAdd("AAInteressent","TXT;1",1)
 CALL FldAdd("AAEigentÅmer","TXT;1",1)
  
 REM -- 11.04.94/FA ------------------------------
 
 CALL FldAdd("Kundennummer","TXT;20",1)
 CALL FldAdd("EGAnrede","TXT;60",0)
 CALL FldAdd("EGGeschlecht","TXT;1",0)
 CALL FldAdd("EGNotiz","TXT;4000 R",0)
 CALL FldAdd("K1Name","TXT;50",0)
 CALL FldAdd("K2Name","TXT;50",0)
 CALL FldAdd("K3Name","TXT;50",0)
 CALL FldAdd("K4Name","TXT;50",0)
 CALL FldAdd("K1NName","TXT;50",0)
 CALL FldAdd("K2NName","TXT;50",0)
 CALL FldAdd("K3NName","TXT;50",0)
 CALL FldAdd("K4NName","TXT;50",0)
 CALL FldAdd("K1Geschlecht","TXT;1",0)
 CALL FldAdd("K2Geschlecht","TXT;1",0)
 CALL FldAdd("K3Geschlecht","TXT;1",0)
 CALL FldAdd("K4Geschlecht","TXT;1",0)
 CALL FldAdd("K1Geburtstag","DAT;0d.mm.yyyy",0)
 CALL FldAdd("K2Geburtstag","DAT;0d.mm.yyyy",0)
 CALL FldAdd("K3Geburtstag","DAT;0d.mm.yyyy",0)
 CALL FldAdd("K4Geburtstag","DAT;0d.mm.yyyy",0)
 CALL FldAdd("K4Geschlecht","TXT;1",0)
 CALL FldAdd("K1Notiz","TXT;400 R",0)
 CALL FldAdd("K2Notiz","TXT;400 R",0)
 CALL FldAdd("K3Notiz","TXT;400 R",0)
 CALL FldAdd("K4Notiz","TXT;400 R",0)
 CALL FldAdd("DebitorKto","TXT;8",0)
 CALL FldAdd("KostentrÑger","TXT;15",1)
 CALL FldAdd("Kostenstelle","NUM;000000.",1)
 
 REM -- 16.02.95/FA -------------------------------
 
 CALL FldAdd("VorgÑnger","NUM;000000.",1)
 CALL FldAdd("Sperre","NUM;000000.",1)
 CALL FldAdd("Firmenform","TXT;15",1)
 CALL FldAdd("Beruf","TXT;50",1)
 CALL FldAdd("Reisepa·_Nr","TXT;30",0)
 CALL FldAdd("RPAussteller","TXT;100",0)
 CALL FldAdd("RPAusstellung","DAT;0d.mm.yyyy",0)
 CALL FldAdd("Titel","TXT;30",0)
 CALL FldAdd("KVPflicht","TXT;1",1)
 CALL FldAdd("RVPflicht","TXT;1",1)



 
 
 CALL FldAdd("Kunde_seit","DAT;0d.mm.yyyy",1)
 CALL FldAdd("Geburtstag","DAT;0d.mm.yyyy",1)
 CALL FldAdd("CodeMA","NUM;000000.",1)
 CALL FldAdd("letzter_Kontakt","DAT;0d.mm.yyyy",1)
 CALL FldAdd("ExpAG","TXT;1",1)
 CALL FldAdd("Telefon1","TXT;200",1)
 CALL FldAdd("Autotelefon","TXT;200",1)
 CALL FldAdd("Telefon2","TXT;200",1)
 CALL FldAdd("Telefax","TXT;200",1)
 CALL FldAdd("BTX","TXT;200",1)
 CALL FldAdd("ASTelefon1","TXT;200",1)
 CALL FldAdd("ASAutotelefon","TXT;200",1)
 CALL FldAdd("ASTelefon2","TXT;200",1)
 CALL FldAdd("ASTelefax","TXT;200",1)
 CALL FldAdd("ASBTX","TXT;200",1)
 CALL FldAdd("CodePR","NUM;000000.",1)
 CALL FldAdd("zero","NUM;000000.",1)
 CALL FldAdd("NationalitÑt","TXT;10",1)
 CALL FldAdd("Staatsangehîrig","TXT;10",1)
 CALL FldAdd("Familienstand","TXT;15",1)
 CALL FldAdd("Anstellungsverh","TXT;15",1)
 CALL FldAdd("Anzahl_Kinder","NUM;,999999.",1)
 CALL FldAdd("AuslZinsKondit","DAT;0d.mm.yyyy",0)
 CALL FldAdd("GDVNEU","DAT;0d.mm.yyyy",1)
 CALL FldAdd("GDVEDIT","DAT;0d.mm.yyyy",1)
 CALL FldAdd("Code200","NUM;000000.",1)
 CALL FldAdd("Vollmacht","TXT;1",1)
 CALL FldAdd("GeneralVollmach","TXT;1",1)
 CALL FldAdd("AAGesellschaft","TXT;1",1)
 
 CALL FldAdd("QNachname","TXT;100",1)
 CALL FldAdd("QGeburtsname","TXT;100",1)
 CALL FldAdd("QVorname","TXT;100",1)
 CALL FldAdd("QStra·e","TXT;100",1)
 CALL FldAdd("QOrt","TXT;100",1)
 CALL FldAdd("QPLZ","TXT;25",1)
 CALL FldAdd("Postanschrift","TXT;4000 R",0)
 CALL FldAdd("EGTitel","TXT;30",0)
 CALL FldAdd("EGBriefanrede","TXT;100",0)
 CALL FldAdd("ADRStatus","TXT;50 U",1)
 CALL FldAdd("ASerJN","TXT;1",0)
 CALL FldAdd("ADRFarbe","NUM;000.",0)
 CALL FldAdd("Mitarbeiter","TXT;50",0)
 CALL FldAdd("K3Bank","TXT;50",0)
 CALL FldAdd("K3BLZ","TXT;20",0)
 CALL FldAdd("K3Konto","TXT;17",0)
 CALL FldAdd("K2Konto","TXT;17",0)
 CALL FldAdd("K1Konto","TXT;17",0)
 CALL FldAdd("Uebernahme","TXT;30",0)
 CALL FldAdd("Bank1ArtKonto","TXT;9",0)
 CALL FldAdd("Bank2ArtKonto","TXT;9",0)
 CALL FldAdd("Bank3ArtKonto","TXT;9",0)
 CALL FldAdd("Kontoinh1","TXT;27",0)
 CALL FldAdd("Kontoinh2","TXT;27",0)
 CALL FldAdd("Kontoinh3","TXT;27",0)
 CALL FldAdd("EUUmstellung","TXT;1",0)
 CALL FldAdd("GebDatKurz","TXT;4",0)
 CALL FldAdd("GebDatKurz1","TXT;4",0)
 CALL FldAdd("GebDatKurz2","TXT;4",0)
 CALL FldAdd("GebDatKurz3","TXT;4",0)
 CALL FldAdd("GebDatKurz4","TXT;4",0)
 CALL FldAdd("GebDatKurzEG","TXT;4",0)
 CALL FldAdd("ExpInternet","TXT;1",1)
 CALL FldAdd("InternetPasswd","TXT;50",0)
 CALL FldAdd("Zweitanschrift","TXT;350 R",0)
 CALL FldAdd("Erstkontakt","DAT;0d.mm.yyyy",1)
 CALL FldAdd("AGNachname","TXT;50",0)
 CALL FldAdd("AGVorname","TXT;50",0)
 CALL FldAdd("AGAGNr","TXT;20",0)
 CALL FldAdd("ADRGruppe","TXT;50 U",1)
 CALL FldAdd("Ausweisnr","TXT;50",0)
 CALL FldAdd("QAusweisnr","TXT;50",1)
 CALL FldAdd("Matchcode","TXT;50",0)
 CALL FldAdd("QMatchcode","TXT;50",1)
 CALL FldAdd("PANummer","TXT;50",0)
 CALL FldAdd("QPANummer","TXT;50",1)
 CALL FldAdd("PAAustdat","DAT;0d.mm.yyyy",0)
 CALL FldAdd("PAAustOrt","TXT;50",0)
 CALL FldAdd("PANummerEG","TXT;50",0)
 REM CALL FldAdd("QPANummerEG","TXT;50",1)
 CALL FldAdd("PAAustdatEG","DAT;0d.mm.yyyy",0)
 CALL FldAdd("PAAustOrtEG","TXT;50",0)
 CALL FldAdd("PANummerK1","TXT;50",0)
 REM CALL FldAdd("QPANummerK1","TXT;50",1)
 CALL FldAdd("PAAustdatK1","DAT;0d.mm.yyyy",0)
 CALL FldAdd("PAAustOrtK1","TXT;50",0)
 CALL FldAdd("PANummerK2","TXT;50",0)
 REM CALL FldAdd("QPANummerK2","TXT;50",1)
 CALL FldAdd("PAAustdatK2","DAT;0d.mm.yyyy",0)
 CALL FldAdd("PAAustOrtK2","TXT;50",0)
 CALL FldAdd("PANummerK3","TXT;50",0)
 REM CALL FldAdd("QPANummerK3","TXT;50",1)
 CALL FldAdd("PAAustdatK3","DAT;0d.mm.yyyy",0)
 CALL FldAdd("PAAustOrtK3","TXT;50",0)
 CALL FldAdd("PANummerK4","TXT;50",0)
 REM CALL FldAdd("QPANummerK4","TXT;50",1)
 CALL FldAdd("PAAustdatK4","DAT;0d.mm.yyyy",0)
 CALL FldAdd("PAAustOrtK4","TXT;50",0)
 REM CALL FldAdd("PANummerK5","TXT;50",0)
 REM CALL FldAdd("QPANummerK5","TXT;50",1)
 REM CALL FldAdd("PAAustdatK5","DAT;0d.mm.yyyy",0)
 REM CALL FldAdd("PAAustOrtK5","TXT;50",0)
 REM CALL FldAdd("PANummerK6","TXT;50",0)
 REM CALL FldAdd("QPANummerK6","TXT;50",1)
 REM CALL FldAdd("PAAustdatK6","DAT;0d.mm.yyyy",0)
 REM CALL FldAdd("PAAustOrtK6","TXT;50",0)
 CALL FldAdd("K1Ort","TXT;50",0)
 CALL FldAdd("K1Strasse","TXT;50",0)
 CALL FldAdd("K1PLZ","TXT;50",0)
 CALL FldAdd("K1Telefon1","TXT;50",0)
 CALL FldAdd("K1Fax1","TXT;50",0)
 CALL FldAdd("K1Mobil1","TXT;50",0)
 CALL FldAdd("K1email1","TXT;50",0)
 CALL FldAdd("K1WWW1","TXT;50",0)
 CALL FldAdd("K1Telefon2","TXT;50",0)
 CALL FldAdd("K1Fax2","TXT;50",0)
 CALL FldAdd("K1Mobil2","TXT;50",0)
 CALL FldAdd("K1email2","TXT;50",0)
 CALL FldAdd("K1WWW2","TXT;50",0)

 CALL FldAdd("K2Ort","TXT;50",0)
 CALL FldAdd("K2Strasse","TXT;50",0)
 CALL FldAdd("K2PLZ","TXT;50",0)
 CALL FldAdd("K2Telefon1","TXT;50",0)
 CALL FldAdd("K2Fax1","TXT;50",0)
 CALL FldAdd("K2Mobil1","TXT;50",0)
 CALL FldAdd("K2email1","TXT;50",0)
 CALL FldAdd("K2WWW1","TXT;50",0)
 CALL FldAdd("K2Telefon2","TXT;50",0)
 CALL FldAdd("K2Fax2","TXT;50",0)
 CALL FldAdd("K2Mobil2","TXT;50",0)
 CALL FldAdd("K2email2","TXT;50",0)
 CALL FldAdd("K2WWW2","TXT;50",0)

 CALL FldAdd("K3Ort","TXT;50",0)
 CALL FldAdd("K3Strasse","TXT;50",0)
 CALL FldAdd("K3PLZ","TXT;50",0)
 CALL FldAdd("K3Telefon1","TXT;50",0)
 CALL FldAdd("K3Fax1","TXT;50",0)
 CALL FldAdd("K3Mobil1","TXT;50",0)
 CALL FldAdd("K3email1","TXT;50",0)
 CALL FldAdd("K3WWW1","TXT;50",0)
 CALL FldAdd("K3Telefon2","TXT;50",0)
 CALL FldAdd("K3Fax2","TXT;50",0)
 CALL FldAdd("K3Mobil2","TXT;50",0)
 CALL FldAdd("K3email2","TXT;50",0)
 CALL FldAdd("K3WWW2","TXT;50",0)
 
 CALL FldAdd("K4Ort","TXT;50",0)
 CALL FldAdd("K4Strasse","TXT;50",0)
 CALL FldAdd("K4PLZ","TXT;50",0)
 CALL FldAdd("K4Telefon1","TXT;50",0)
 CALL FldAdd("K4Fax1","TXT;50",0)
 CALL FldAdd("K4Mobil1","TXT;50",0)
 CALL FldAdd("K4email1","TXT;50",0)
 CALL FldAdd("K4WWW1","TXT;50",0)
 CALL FldAdd("K4Telefon2","TXT;50",0)
 CALL FldAdd("K4Fax2","TXT;50",0)
 CALL FldAdd("K4Mobil2","TXT;50",0)
 CALL FldAdd("K4email2","TXT;50",0)
 CALL FldAdd("K4WWW2","TXT;50",0)

 REM CALL FldAdd("K5Name","TXT;50",0)
 REM CALL FldAdd("K5NName","TXT;50",0)
 REM CALL FldAdd("K5Ort","TXT;50",0)
 REM CALL FldAdd("K5Strasse","TXT;50",0)
 REM CALL FldAdd("K5PLZ","TXT;50",0)
 REM CALL FldAdd("K5Telefon1","TXT;50",0)
 REM CALL FldAdd("K5Fax1","TXT;50",0)
 REM CALL FldAdd("K5Mobil1","TXT;50",0)
 REM CALL FldAdd("K5email1","TXT;50",0)
 REM CALL FldAdd("K5WWW1","TXT;50",0)
 REM CALL FldAdd("K5Telefon2","TXT;50",0)
 REM CALL FldAdd("K5Fax2","TXT;50",0)
 REM CALL FldAdd("K5Mobil2","TXT;50",0)
 REM CALL FldAdd("K5email2","TXT;50",0)
 REM CALL FldAdd("K5WWW2","TXT;50",0)
 REM CALL FldAdd("K5Notiz","TXT;400 R",0)
 REM CALL FldAdd("K5Geburtstag","DAT;0d.mm.yyyy",0)
 REM CALL FldAdd("K5Geschlecht","TXT;1",0)

 REM CALL FldAdd("K6Name","TXT;50",0)
 REM CALL FldAdd("K6NName","TXT;50",0)
 REM CALL FldAdd("K6Ort","TXT;50",0)
 REM CALL FldAdd("K6Strasse","TXT;50",0)
 REM CALL FldAdd("K6PLZ","TXT;50",0)
 REM CALL FldAdd("K6Telefon1","TXT;50",0)
 REM CALL FldAdd("K6Fax1","TXT;50",0)
 REM CALL FldAdd("K6Mobil1","TXT;50",0)
 REM CALL FldAdd("K6email1","TXT;50",0)
 REM CALL FldAdd("K6WWW1","TXT;50",0)
 REM CALL FldAdd("K6Telefon2","TXT;50",0)
 REM CALL FldAdd("K6Fax2","TXT;50",0)
 REM CALL FldAdd("K6Mobil2","TXT;50",0)
 REM CALL FldAdd("K6email2","TXT;50",0)
 REM CALL FldAdd("K6WWW2","TXT;50",0)
 REM CALL FldAdd("K6Notiz","TXT;400 R",0)
 REM CALL FldAdd("K6Geburtstag","DAT;0d.mm.yyyy",0)
 REM CALL FldAdd("K6Geschlecht","TXT;1",0)

 CALL FldAdd("VermoegDatStand","DAT;0d.mm.yyyy",0)
 CALL FldAdd("PostBriefanrede","TXT;300 R",0)
 CALL FldAdd("EGTelefon1","TXT;50",0)
 CALL FldAdd("EGFax1","TXT;50",0)
 CALL FldAdd("EGMobil1","TXT;50",0)
 CALL FldAdd("EGemail1","TXT;50",0)
 CALL FldAdd("EGWWW1","TXT;50",0)
 CALL FldAdd("EGTelefon2","TXT;50",0)
 CALL FldAdd("EGFax2","TXT;50",0)
 CALL FldAdd("EGMobil2","TXT;50",0)
 CALL FldAdd("EGemail2","TXT;50",0)
 CALL FldAdd("EGWWW2","TXT;50",0)
 CALL FldAdd("Schadquote","NUM;,9999999.0000",0)
 CALL FldAdd("Stornoquote","NUM;,99999.0000",0)
     CALL FldAdd("VertrGesamt","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu1","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu2","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu3","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu4","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu5","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu6","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu7","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu8","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu9","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu10","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu11","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu12","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu13","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu14","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu15","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu16","NUM;,999999999999",0)
 
     CALL FldAdd("BWVertrGesamt","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu1","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu2","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu3","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu4","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu5","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu6","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu7","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu8","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu9","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu10","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu11","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu12","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu13","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu14","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu15","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu16","NUM;,999999999999.00",0)
 
     CALL FldAdd("BeiVertrGesamt","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu1","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu2","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu3","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu4","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu5","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu6","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu7","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu8","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu9","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu10","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu11","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu12","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu13","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu14","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu15","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu16","NUM;,999999999999.00",0)
 
     CALL FldAdd("EinhGesamt","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu1","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu2","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu3","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu4","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu5","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu6","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu7","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu8","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu9","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu10","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu11","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu12","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu13","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu14","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu15","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu16","NUM;,9999999999.0000",0)
 
     CALL FldAdd("AnzSchGesamt","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu1","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu2","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu3","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu4","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu5","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu6","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu7","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu8","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu9","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu10","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu11","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu12","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu13","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu14","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu15","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu16","NUM;,9999999999.",0)
 
     CALL FldAdd("SchGesamt","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu1","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu2","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu3","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu4","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu5","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu6","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu7","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu8","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu9","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu10","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu11","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu12","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu13","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu14","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu15","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu16","NUM;,9999999999.00",0)
     CALL FldAdd("STATISTDATE","DAT;0d.mm.yyyy",0)
     CALL FldAdd("VertrStatu0","NUM;,999999999999",0)
     CALL FldAdd("BWVertrStatu0","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu0","NUM;,999999999999.00",0)
     CALL FldAdd("EinhStatu0","NUM;,9999999999.0000",0)
     CALL FldAdd("AnzSchStatu0","NUM;,9999999999.",0)
     CALL FldAdd("SchStatu0","NUM;,9999999999.00",0)
     CALL FldAdd("CAgez","NUM;,999999999999.00",0)
     CALL FldAdd("Zweitbeschr","TXT;100 R",0)
     CALL FldAdd("TextKV","TXT;50",0)
     CALL FldAdd("Gebort","TXT;50",0)
     CALL FldAdd("EGGebort","TXT;50",0)
     CALL FldAdd("GebortK1","TXT;50",0)
     CALL FldAdd("GebortK2","TXT;50",0)
     CALL FldAdd("GebortK3","TXT;50",0)
     CALL FldAdd("GebortK4","TXT;50",0)
     REM CALL FldAdd("GebortK5","TXT;50",0)
     REM CALL FldAdd("GebortK6","TXT;50",0)
     CALL FldAdd("FreeFormular","NUM;0.",0)
     CALL FldAdd("Drittanschrift","TXT;350 R",0)
     CALL FldAdd("Viertanschrift","TXT;350 R",0)
     CALL FldAdd("Fuenftanschrift","TXT;350 R",0)
     CALL FldAdd("Steuermandat","TXT;1",1)
     CALL FldAdd("VMitglied","TXT;1",1)
     CALL FldAdd("VBeratung","TXT;1",1)
     CALL FldAdd("VAnwalt","TXT;1",1)
     CALL FldAdd("VBav","TXT;1",1)
     CALL FldAdd("VMailing","TXT;1",1)
     CALL FldAdd("VZeitung","TXT;1",1)
     CALL FldAdd("VGebkarte","TXT;1",1)
     CALL FldAdd("BerufStatus","TXT;50",1)
     CALL FldAdd("BerufFachr","TXT;50",1)
     CALL FldAdd("BerufSchwer1","TXT;50",1)
     CALL FldAdd("BerufSchwer2","TXT;50",1)
     CALL FldAdd("BerufZus1","TXT;50",1)
     CALL FldAdd("BerufZus2","TXT;50",1)
     CALL FldAdd("Berufzus3","TXT;50",1)
     CALL FldAdd("BerufZus4","TXT;50",1)
     CALL FldAdd("BerufZus5","TXT;50",1)
     CALL FldAdd("Drittbeschr","TXT;100 R",0)
     CALL FldAdd("Viertbeschr","TXT;100 R",0)
     CALL FldAdd("Fuenftbeschr","TXT;100 R",0)
     CALL FldAdd("Stammblatt","TXT;4000 R",0)
     CALL FldAdd("BerProtok","TXT;1",1)
     CALL FldAdd("BerProtokVom","DAT;0d.mm.yyyy",1)
   CALL FldAdd("VertrStatu20","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu20","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu20","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu20","NUM;,9999999999.00",0)
   CALL FldAdd("VertrStatu21","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu21","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu21","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu21","NUM;,9999999999.00",0)
   CALL FldAdd("K1IBAN","TXT;50",0)
   CALL FldAdd("K2IBAN","TXT;50",0)
   CALL FldAdd("K3IBAN","TXT;50",0)
   CALL FldAdd("K1Swift","TXT;50",0)
   CALL FldAdd("K2Swift","TXT;50",0)
   CALL FldAdd("K3Swift","TXT;50",0)
   CALL FldAdd("K1BLZ","TXT;20",0)
   CALL FldAdd("K2BLZ","TXT;20",0)
   CALL FldAdd("CodeMA2","NUM;000000.",1)
   CALL FldAdd("Agentur2","TXT;100",0)
   CALL FldAdd("Agenturnr2","TXT;20",0)
   CALL FldAdd("EmpfehlTXT","TXT;4000 R",0)
   CALL FldAdd("EmpfehlCode","NUM;000000.",1)
   CALL FldAdd("PostanschrAlt","TXT;400",0)
   CALL FldAdd("Webanfragen","TXT;1",0)
   CALL FldAdd("Anschreiben","TXT;1",0)
   CALL FldAdd("Steuernr","TXT;50",0)
   CALL FldAdd("persSteuernr","TXT;50",0)
   CALL FldAdd("wirtSteuernr","TXT;50",0)
   CALL FldAdd("EGLand","TXT;50",0)

 CALL MarkMain("CodeKU")
 REM SAVE FILE "adressen"
 IF lauf% = 0 THEN 
   SAVE FILE "adressen"
   REM lauf% = 1
   lauf% = 2
   GOTO lauf2006200101
 END IF 
 IF lauf% = 1 THEN 
   SAVE FILE "adrleer"
   FILE "ADRESSEN"
   lauf% = 2
   GOTO lauf2006200101
 END IF 
 IF lauf% = 2 THEN 
   SAVE FILE "BCKONTAK"
   IF GBENE% THEN 
     lauf% = 3
     GOTO lauf2006200101
   ELSE 
     lauf% = 5
   END IF 
 END IF 
 IF lauf% = 3 THEN 
   SAVE FILE "ADRE1"
   FILE "ADRESSEN"
 END IF 
 FILE "ADRESSEN"
 SELECT FIRST LOCK 
 i% = 0
 j% = RECCOUNT ("Adressen")
 MOUSE OFF 
 WHILE NOT EOF ("Adressen")
   i% = i% + 1
   ok% = 0
   IF Webanfragen.adressen <> "j" THEN 
     Webanfragen.adressen = "n"
     ok% = - 1
   END IF 
   IF Anschreiben.adressen <> "j" THEN 
     Anschreiben.adressen = "n"
     ok% = - 1
   END IF 
   IF ok% = - 1 THEN STORE FILE "adressen"
   SET STATUS STR$ (i%,",999999") + "/" + STR$ (j%,",999999") + " Adressen bearbeitet"
   SELECT NEXT LOCK FILE "adressen"
 WEND 

 CALL Server("UPDFILE", FILE )
   REM ************************************ verschÑrfte Reorganisation ******************
   REM CALL Fehler("","")
   REM REQUEST "Mîchten Sie die Adressdatei komplett neu aufbauen lassen?","(Achtung dieser Vorgang kann sehr lange dauern!",135,req%
   IF NeuADR% = - 1 THEN 
     CLOSE FILE "ADRESSEN"
     dpfad$ = _netpath$ + "OFFICE\" + DATE$ ( TODAY ,"yymm0d")
     datnr$ = DATE$ ( TODAY ,"yymm0d")
     i% = 0
     ok% = 0
     WHILE ok% = 0
       i% = i% + 1
       IF i% > 99 THEN 
         ON ERROR GOTO arb3004982
         REMOVE DIRECTORY dpfad$ + "01"
arb3004982: 
         i% = 1
       END IF 
       ON ERROR GOTO arb3004981
       tpfad$ = dpfad$ + STR$ (i%,"00")
       MAKE DIRECTORY dpfad$ + STR$ (i%,"00")
       dpfad$ = dpfad$ + STR$ (i%,"00")
       ok% = - 1
arb3004981: 
       ON ERROR GOTO ErrorHandler
     WEND 

     textdo1$ = tpfad$
     REM CALL Fehler("Es wird jetzt eine Sicherungskopie der Adressdatei erstellt!",textdo1$)
     REQUEST "Sicherungskopie der Adressdatei in",textdo1$,2
     ON ERROR GOTO arb600420011
     COPY _netpath$ + "OFFICE\Adressen.*" TO dpfad$
     CALL DFile(2,"OFFICE\ADRESSEN" + _fpw$)
     CALL reorgkv(_netpath$ + "office\","ADRESSEN","ADROLD","ADRLEER",dpfad$)
     GOTO arb600420012
arb600420011: 
     CALL Fehler("Beim Kopieren der Adressdatei ist ein Fehler aufgetreten, deshalb wird der Komplettaufbau nicht durchgefÅhrt!","")
     
arb600420012: 
     ON ERROR GOTO ErrorHandler
         FILE "ADRESSEN"
         INDEX codeku.ADRESSEN
         SELECT LAST 
         codeku% = codeku.ADRESSEN
         WHILE SER ("ADRESSEN",1) <= codeku%
         WEND 
     CALL UpdADRKorr()
   END IF 
   REM **********************************************************************************
 
 REM aaa$ = "Sie erhalten nachfolgend die Mîglichkeit das Postanschriftsfeld neu generieren zu lassen. Dieses Feld befindet sich auf der Notizseite/Maske Kunden und"
 REM bbb$ = "wird fÅr die Doumenten - und Serienbrieferstellung genutzt. WennSie bereits Adressen im Postanschriftsfeld manuell erfa·t / geÑndert haben,sollten Sie nicht die automatische Generierung durchfÅhren!!!"
 REM CALL Fehler(aaa$,bbb$)
 REM REQUEST "Mîchten Sie das Feld Postanschrift neu generieren lassen?","",135,reqpost%
 REM IF reqpost% = 1 THEN 
   REM REQUEST "Sind Sie absolut sicher?","",130,reqpost%
 REM END IF 
 FILE "ADRESSEN"
 CALL Server("UPDFIELD","")
 CALL Server("UPDSTATUS","öbernahme AALieferant")
 UPDATE AALieferant.adressen = "j" WHERE AAMakler.adressen = "j"
 END UPDATE 
 
 FILE "adressen"
 INDEX CodeKU
 SELECT LAST 
 WHILE CodeKU > SER ("ADRESSEN",1)
 WEND 
 CALL Server("UPDFIELD","BITTE WARTEN, DAS DAUERT ...")
 CALL Server("UPDSTATUS","öbernahme Telefonnummern")
 dat$ = "telefon"
 IF OPEN (dat$) THEN CLOSE FILE dat$
 CALL DFile(2,"OFFICE\TELEFON" + _fpw$)
 FILE "BCKONTAK"
 INDEX nachname.BCKONTAK
 IF RECCOUNT ("BCKONTAK") > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 i% = 0
 WHILE NOT EOF ("BCKONTAK") AND EXISTS (_netpath$ + _projekt$ + "\maadr")
   i% = i% + 1
   SELECT KEY codema.BCKONTAK FILE "maadr" INDEX codema.maadr
   AGNachname.BCKONTAK = LEFT$ (Nachname.maadr,30)
   AGVorname.BCKONTAK = LEFT$ (Vorname.maadr,30)
   AGAGNr.BCKONTAK = LEFT$ (Agenturnr.maadr,20)
   STORE FILE "BCKONTAK"
   SELECT NEXT LOCK 
   SET STATUS STR$ (i%,"999999999") + " Interessenten angepa·t"
   CALL Server("UPDSTATUS", STR$ (i%,"999999999") + " Interessenten angepa·t")
 WEND 
 FILE "ADRESSEN"
 INDEX nachname.adressen
 IF RECCOUNT ("adressen") > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 i% = 0
 MOUSE OFF 
 SET STATUS "Feld BerProtok initialisieren... kann etwas dauern"
 UPDATE BerProtok.ADRESSEN = "n" WHERE BerProtok.ADRESSEN = ""
 END UPDATE 
 WHILE NOT EOF ("ADRESSEN") AND GIndNeu% = - 1
   i% = i% + 1

   IF briefanrede.adressen = "" THEN 
     GADRDat$ = "ADRESSEN"
     SELECT CASE UCASE$ ( LEFT$ (anrede.adressen,3))
     CASE "HER"
       briefanrede.GAdrDat$ = "Sehr geehrter Herr " + nachname.GAdrDat$ + ","
     CASE "FRA","FR."
       briefanrede.GAdrDat$ = "Sehr geehrte Frau " + nachname.GAdrDat$ + ","
     CASE "FRé","FRL"
       briefanrede.GAdrDat$ = "Sehr geehrtes FrÑulein " + nachname.GAdrDat$ + ","
     CASE "FA.","FIR",""
       briefanrede.GAdrDat$ = "Sehr geehrte Damen und Herren,"
     CASE "FAM"
       briefanrede.GAdrDat$ = "Sehr geehrte Familie " + nachname.GAdrDat$ + ","
     CASE "EHE"
       briefanrede.GAdrDat$ = "Sehr geehrte Eheleute " + nachname.GAdrDat$ + ","
     CASE ELSE 
       briefanrede.GAdrDat$ = "Sehr geehrte Damen und Herren,"
     END SELECT 
   END IF 
   IF BerProtok.adressen = "" THEN BerProtok.adressen = "n"
   IF PostBriefanrede.adressen = "" THEN PostBriefanrede.adressen = Briefanrede.adressen
   IF FIIMMAK.adressen = "" THEN FIIMMAK.adressen = "j"
   IF ExpInternet.adressen = "" THEN ExpInternet.adressen = "j"
   IF KVPflicht.adressen = "" THEN KVPflicht.adressen = "n"
   IF RVPflicht.adressen = "" THEN RVPflicht.adressen = "n"
   IF AAMakler.adressen = "" THEN AAMakler.adressen = "n"
   IF Vollmacht.adressen = "" THEN Vollmacht.adressen = "n"
   IF GeneralVollmach.adressen = "" THEN GeneralVollmach.adressen = "n"
   IF AAGesellschaft.adressen = "" THEN AAGesellschaft.adressen = "n"
   IF AAMitarbeiter.adressen = "" THEN AAMitarbeiter.adressen = "n"
   IF Geburtstag.adressen > 0 THEN GebDatKurz.adressen = LEFT$ ( DATE$ (Geburtstag.adressen,"0dmmyyyy"),4)
   IF K1Geburtstag.adressen > 0 THEN GebDatKurz1.adressen = LEFT$ ( DATE$ (K1Geburtstag.adressen,"0dmmyyyy"),4)
   IF K2Geburtstag.adressen > 0 THEN GebDatKurz2.adressen = LEFT$ ( DATE$ (K2Geburtstag.adressen,"0dmmyyyy"),4)
   IF K3Geburtstag.adressen > 0 THEN GebDatKurz3.adressen = LEFT$ ( DATE$ (K3Geburtstag.adressen,"0dmmyyyy"),4)
   IF K4Geburtstag.adressen > 0 THEN GebDatKurz4.adressen = LEFT$ ( DATE$ (K4Geburtstag.adressen,"0dmmyyyy"),4)
   IF EGGeburtstag.adressen > 0 THEN GebDatKurzEG.adressen = LEFT$ ( DATE$ (EGGeburtstag.adressen,"0dmmyyyy"),4)
   IF ADRGruppe.GAdrDat$ = "" THEN ADRGruppe.GAdrDat$ = "<OHNE ZUORDNUNG>"
   IF EXISTS (_netpath$ + _projekt$ + "\MAADR.SBF") THEN 
     IF EXISTS (codema.adressen,codema.maadr) THEN 
       SELECT KEY codema.adressen FILE "maadr" INDEX codema.maadr
       AGNachname.adressen = LEFT$ (Nachname.maadr,30)
       AGVorname.adressen = LEFT$ (Vorname.maadr,30)
       AGAGNr.adressen = LEFT$ (Agenturnr.maadr,20)
     ELSE 
       codema.adressen = 0
       AGNachname.adressen = ""
       AGVorname.adressen = ""
       AGAGNr.adressen = ""
     END IF 
   END IF 
   QNachname.adressen = VSNRPack$(nachname.adressen)
   QVorname.adressen = VSNRPack$(vorname.adressen)
   QOrt.adressen = VSNRPack$(Ort.adressen)
   QStra·e.adressen = VSNRPack$(Stra·e.adressen)
   QPLZ.adressen = VSNRPack$(PLZ.adressen)
   QGeburtsname.adressen = VSNRPack$(Geburtsname.adressen)
   IF Matchcode.adressen = "" THEN Matchcode.adressen = Nachname.adressen
   QMatchcode.adressen = VSNRPack$(Matchcode.adressen)
   QAusweisnr.adressen = VSNRPack$(Ausweisnr.adressen)
   IF _projekt$ LIKE "FACTURA" AND codie$ = "TRUE" THEN 
     IF ADRStatus.adressen = "" THEN 
     END IF 
   ELSE 
     IF ADRStatus.adressen = "" THEN ADRStatus.adressen = "<OHNE ZUORDNUNG>"
   END IF 
     IF Postanschrift.adressen = "" OR NeuPost% = - 1 THEN 
       REM CALL Fehler("","NeuPost% = - 1")
       p$ = ""
       IF anrede.adressen LIKE "Herr*" OR anrede.adressen LIKE "Fr*" OR anrede.adressen LIKE "Fam*" OR anrede.adressen LIKE "Ehe*" THEN 
         p$ = Anrede.adressen + " "
         IF LTRIM$ (Titel.adressen) <> "" THEN 
           p$ = p$ + " " + LTRIM$ (Titel.adressen) + CHR$ (13) + CHR$ (10)
         ELSE 
           p$ = p$ + CHR$ (13) + CHR$ (10)
         END IF 
         IF vorname.adressen <> "" THEN 
           p$ = p$ + LTRIM$ (Vorname.adressen) + " " + LTRIM$ (Nachname.adressen) + CHR$ (13) + CHR$ (10)
         ELSE 
           p$ = p$ + LTRIM$ (Nachname.adressen) + CHR$ (13) + CHR$ (10)
         END IF 
         p$ = p$ + Stra·e.adressen + CHR$ (13) + CHR$ (10) + CHR$ (13) + CHR$ (10) + plz.adressen + " " + Ort.adressen + CHR$ (13) + CHR$ (10)
         IF _projekt$ LIKE "FACTURA" THEN 
         ELSE 
           p$ = p$ + CHR$ (13) + CHR$ (10) + CHR$ (13) + CHR$ (10) + CHR$ (13) + CHR$ (10) + briefanrede.adressen
         END IF 
       ELSE 
         p$ = LTRIM$ (Anrede.adressen) + " " + LTRIM$ (titel.adressen) + CHR$ (13) + CHR$ (10)
         IF Geburtsname.adressen <> "" THEN 
           p$ = p$ + LTRIM$ (nachname.adressen) + CHR$ (13) + CHR$ (10) + LTRIM$ (geburtsname.adressen) + CHR$ (13) + CHR$ (10)
         ELSE 
           p$ = p$ + LTRIM$ (Nachname.adressen) + CHR$ (13) + CHR$ (10)
         END IF 
         IF vorname.adressen <> "" THEN 
           p$ = p$ + LTRIM$ (Vorname.adressen) + CHR$ (13) + CHR$ (10) + CHR$ (13) + CHR$ (10)
         ELSE 
           p$ = p$ + CHR$ (13) + CHR$ (10)
         END IF 
         p$ = p$ + Stra·e.adressen + CHR$ (13) + CHR$ (10) + CHR$ (13) + CHR$ (10) + plz.adressen + " " + Ort.adressen + CHR$ (13) + CHR$ (10)
         IF land.adressen <> "" THEN p$ = p$ + CHR$ (13) + CHR$ (10) + Land.adressen
         IF _projekt$ LIKE "FACTURA" THEN 
         ELSE 
           p$ = p$ + CHR$ (13) + CHR$ (10) + CHR$ (13) + CHR$ (10) + CHR$ (13) + CHR$ (10) + CHR$ (13) + CHR$ (10) + CHR$ (13) + CHR$ (10) + CHR$ (13) + CHR$ (10) + CHR$ (13) + CHR$ (10) + briefanrede.adressen
         END IF 
       END IF 
       Postanschrift.adressen = p$
     END IF 
   IF GASP% THEN 
     IF _project$ LIKE "PROVIS" THEN 
       CALL DFile(3,"MAADR" + _fpw$)
       IF codema.adressen > 0 THEN 
         SELECT KEY codema.adressen FILE "MAADR" INDEX codema.maadr
         workstation.adressen = workstation.maadr
       END IF 
     END IF 
   END IF 
   STORE FILE "Adressen"
   SELECT NEXT LOCK 
   zanz% = RECCOUNT ("ADRESSEN")
   b$ = LTRIM$ ( STR$ (zanz%,",99999999"))
   SET STATUS STR$ (i%,"999999999") + " Adressen angepa·t von " + b$
   CALL Server("UPDSTATUS", STR$ (i%,"999999999") + " Adressen angepa·t von " + b$)
 WEND 
 
 IF RECCOUNT ("adressen") > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
start29119901: 
 anpass$ = UCASE$ (ReadINI$("SYSTEM","Telefonanpassung"))
 anpass$ = "FALSE"
 REM anpass$ = "FALS"
 


 CALL DFile(2,"OFFICE\kontgr" + _fpw$)
 FILE "kontgr"
 IF NOT EXISTS (0,codekgr.kontgr) THEN 
   BLANK FILE "Kontgr"
   codekgr = 0
   Kontaktgruppe = "<ohne Zuordnung>"
   STORE FILE "kontgr"
 END IF 
 
 CALL DFile(2,"OFFICE\Anrede" + _fpw$)
 CALL DFile(2,"OFFICE\Titel" + _fpw$)
 CALL DFile(2,"OFFICE\Ort" + _fpw$)
 CALL DFile(2,"OFFICE\Land" + _fpw$)
 CALL DFile(2,"OFFICE\Beruf" + _fpw$)
 CALL DFile(2,"OFFICE\Hobbys" + _fpw$)
 CALL DFile(2,"OFFICE\FiForm" + _fpw$)
 CALL DFile(2,"OFFICE\FStand" + _fpw$)
 CALL DFile(2,"OFFICE\Anstell" + _fpw$)
 CALL DFile(2,"OFFICE\National" + _fpw$)
 CALL DFile(2,"OFFICE\Staat" + _fpw$)
 
 FILE "Adressen"
 INDEX codeku.adressen
 SELECT FIRST 
 i% = 0
 z% = RECCOUNT ("Adressen")
 anpass1$ = UCASE$ (ReadINI$("SYSTEM","Zusatzdateien"))
 REM anpass1$ = "FALSE"
 anpass1$ = "FALS"
 WHILE NOT EOF ("Adressen") AND aufbzusatz$ = "j"
   i% = i% + 1
   CALL Server("UPDFIELD","Aufbau der Zusatzdateien")
   CALL Server("UPDSTATUS", STR$ (i%,"99999") + " von " + STR$ (z%,"99999") + " Adressen")
   anrede$ = Anrede.adressen
   titel$ = Titel.adressen
   ort$ = Ort.adressen
   plz$ = PLZ.adressen
   Land$ = Land.adressen
   Beruf$ = Beruf.adressen
   Fiform$ = Firmenform.adressen
   FStand$ = Familienstand.adressen
   Anstell$ = Anstellungsverh.adressen
   National$ = NationalitÑt.adressen
   staat$ = Staatsangehîrig.adressen
   IF national$ <> "" AND NOT EXISTS (national$,nationalitÑt.national) THEN 
     BLANK FILE "national"
     nationalitÑt.national = national$
     STORE FILE "national"
   END IF 
   IF staat$ <> "" AND NOT EXISTS (staat$,staatsangehîrig.staat) THEN 
     BLANK FILE "staat"
     staatsangehîrig.staat = staat$
     STORE FILE "staat"
   END IF 
   IF anrede$ <> "" AND NOT EXISTS (anrede$,anrede.anrede) THEN 
     BLANK FILE "anrede"
     anrede.anrede = anrede$
     STORE FILE "Anrede"
   END IF 
   IF titel$ <> "" AND NOT EXISTS (titel$,titel.titel) THEN 
     BLANK FILE "titel"
     titel.titel = titel$
     STORE FILE "titel"
   END IF 
   IF land$ <> "" AND NOT EXISTS (land$,land.land) THEN 
     BLANK FILE "land"
     land.land = land$
     STORE FILE "land"
   END IF 
   IF beruf$ <> "" AND NOT EXISTS (beruf$,beruf.beruf) THEN 
     BLANK FILE "beruf"
     beruf.beruf = beruf$
     STORE FILE "beruf"
   END IF 
   IF fiform$ <> "" AND NOT EXISTS (Fiform$,Firmenform.Fiform) THEN 
     BLANK FILE "Fiform"
     Firmenform.Fiform = Fiform$
     STORE FILE "Fiform"
   END IF 
   IF fstand$ <> "" AND NOT EXISTS (FStand$,FamilienStand.FStand) THEN 
     BLANK FILE "Fstand"
     FamilienStand.FStand = FStand$
     STORE FILE "FStand"
   END IF 
   IF anstell$ <> "" AND NOT EXISTS (Anstell$,Anstellungsverh.Anstell) THEN 
     BLANK FILE "Anstell"
     Anstellungsverh.Anstell = Anstell$
     STORE FILE "Anstell"
   END IF 
   IF plz$ <> "" AND NOT EXISTS (plz$,plz.ort) THEN 
     BLANK FILE "ort"
     codeort.ort = SER ("ort",1)
     plz.ort = LEFT$ (plz$,8)
     IF ort$ <> "" THEN ort.ort = ort$
     PLZOrt.ort = FN NUMERIC(PLZ.ort) + TRIM$ ( LTRIM$ (ort.ort))
     OrtPLZ.ort = TRIM$ ( LTRIM$ (ort.ort)) + FN NUMERIC(PLZ.ort)
     STORE FILE "ort"
   END IF 
   IF ort$ <> "" AND NOT EXISTS (ort$,ort.ort) THEN 
     BLANK FILE "ort"
     codeort.ort = SER ("ort",1)
     ort.ort = ort$
     IF plz$ <> "" THEN plz.ort = plz$
     PLZOrt.ort = FN NUMERIC(PLZ.ort) + TRIM$ ( LTRIM$ (ort.ort))
     STORE FILE "ort"
   END IF 
 
 FILE "Adressen"
 SET STATUS LTRIM$ ( STR$ (i%,",99999999")) + " Adressen angepast von " + LTRIM$ ( STR$ ( RECCOUNT ("ADRESSEN"),",99999999"))
 CALL Server("UPDSTATUS", LTRIM$ ( STR$ (i%,",99999999")) + " Adressen angepast von " + LTRIM$ ( STR$ ( RECCOUNT ("ADRESSEN"),",99999999")))
 SELECT NEXT 
 WEND 
 CALL WriteINI("SYSTEM","Zusatzdateien","FALSE")
 
 REM -- Anpassung Projekt FACTURA -----------------------------------------------
AAAA1: 
FactStart270200: 
 
 
 REM ===========================
 REM -- Anpassung Projekt PROVIS
 REM -- Stand: 7.9.95
 REM ===========================
 
ProvStart301299: 
  IF _projekt$ LIKE "PROVIS" THEN 
   REM GOTO Anpass25012000
   REM -- Anpassung HISTORY.SBF --
   CALL DFile(2,"OFFICE\ADRESSEN" + _fpw$)
   CALL DFile(2,"OFFICE\Telefon" + _fpw$)
   CALL DFile(2,"OFFICE\Akquise" + _fpw$)
   CALL DFile(3,"SPARTEN" + _fpw$)
   NeuGEADR% = 0

   REM -- Anpassun GEADR.SBF --
   REM CALL Fehler("Gesellschaftsanpassung","")
   CALL DFile(3,"GEADR" + _fpw$)
   CALL DFile(3,"GEADRLEE" + _fpw$)
   FILE "GEADR"
   lauf% = 0
   ON ERROR GOTO w220820051
   xxa% = KorrAB220805.geadr
   GOTO w220820052
w220820051: 
   NeuGEADR% = - 1
   ON ERROR GOTO ErrorHandler
w220820052: 

anfgeadrreo: 
  IF lauf% = 1 THEN 
    FILE "GEADRLEE"
  END IF 

   CALL FldAdd("CodeGE","NUM;000000.",1)
   CALL FldAdd("Stra·e","TXT;30",0)
   CALL FldAdd("Ort","TXT;30",0)
   CALL FldAdd("PLZ","TXT;10",0)
   CALL FldAdd("Vermittlernr","TXT;20",0)
   CALL FldAdd("t1","TXT;50",0)

   CALL FldAdd("t2","TXT;50",0)
   CALL FldAdd("t3","TXT;50",0)
   CALL FldAdd("t4","TXT;50",0)
   CALL FldAdd("t5","TXT;50",0)
   CALL FldAdd("t6","TXT;50",0)
   CALL FldAdd("t7","TXT;50",0)
   CALL FldAdd("t8","TXT;50",0)
   CALL FldAdd("t9","TXT;50",0)
   CALL FldAdd("t10","TXT;50",0)

   CALL FldAdd("B11","TXT;20",0)
   CALL FldAdd("A11","TXT;35",0)
   CALL FldAdd("t11","TXT;50",0)
   CALL FldAdd("B12","TXT;20",0)
   CALL FldAdd("A12","TXT;35",0)
   CALL FldAdd("t12","TXT;50",0)
   CALL FldAdd("B13","TXT;20",0)
   CALL FldAdd("A13","TXT;35",0)
   CALL FldAdd("t13","TXT;50",0)
   CALL FldAdd("B14","TXT;20",0)
   CALL FldAdd("A14","TXT;35",0)
   CALL FldAdd("t14","TXT;50",0)
   CALL FldAdd("B15","TXT;20",0)
   CALL FldAdd("A15","TXT;35",0)
   CALL FldAdd("t15","TXT;50",0)
   CALL FldAdd("B16","TXT;20",0)
   CALL FldAdd("A16","TXT;35",0)
   CALL FldAdd("t16","TXT;50",0)
   CALL FldAdd("B17","TXT;20",0)
   CALL FldAdd("A17","TXT;35",0)
   CALL FldAdd("t17","TXT;50",0)
   CALL FldAdd("B18","TXT;20",0)
   CALL FldAdd("A18","TXT;35",0)
   CALL FldAdd("t18","TXT;50",0)
   CALL FldAdd("B19","TXT;20",0)
   CALL FldAdd("A19","TXT;35",0)
   CALL FldAdd("t19","TXT;50",0)
   CALL FldAdd("B20","TXT;20",0)
   CALL FldAdd("A20","TXT;35",0)
   CALL FldAdd("t20","TXT;50",0)
   REM ***GDV***
   CALL FldAdd("VUNR","NUM;00000",0)
   CALL FldAdd("GDVDATD","DAT;0d.mm.yyyy",0)
   CALL FldAdd("GDVUHRD","TIM;hh:mm",0)
   CALL FldAdd("GDVDATE","DAT;0d.mm.yyyy",0)
   CALL FldAdd("GDVUHRE","TIM;hh:mm",0)
   CALL FldAdd("GDVMITA","NUM;000000",0)
   CALL FldAdd("zero","NUM;0",1)
   CALL FldAdd("CodeKU","NUM;000000.",1)
   CALL FldAdd("Postanschrift","TXT;4000 R",0)
   CALL FldAdd("VAnzahlVor","NUM;99999999.",0)
   CALL FldAdd("SBewertung","NUM;,9999999999.00",0)
   CALL FldAdd("SBewertungEU","NUM;,9999999999.00",0)
   CALL FldAdd("SVolumen","NUM;,9999999999.00",0)
   CALL FldAdd("SVolumenEU","NUM;,9999999999.00",0)
   CALL FldAdd("SBeitragBRU","NUM;,9999999999.00",0)
   CALL FldAdd("SBeitragBRUEU","NUM;,9999999999.00",0)
   CALL FldAdd("SBeitragNET","NUM;,9999999999.00",0)
   CALL FldAdd("SBeitragNETEU","NUM;,9999999999.00",0)
   CALL FldAdd("SVSumme","NUM;,9999999999.00",0)
   CALL FldAdd("SVSummeEU","NUM;,9999999999.00",0)
   CALL FldAdd("SProvision","NUM;,9999999999.00",0)
   CALL FldAdd("SProvisionEU","NUM;,9999999999.00",0)
   CALL FldAdd("email","TXT;100",0)
   CALL FldAdd("Eintritt","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Gesellschaft2","TXT;30",0)
   CALL FldAdd("IIMsupid","TXT;50",0)
   CALL FldAdd("IIMAgentnr","TXT;50",0)
   CALL FldAdd("IIMSupName","TXT;50",0)
   CALL FldAdd("Abruf01","NUM;,9999999999.00",0)
   CALL FldAdd("Abruf02","NUM;,9999999999.00",0)
   CALL FldAdd("Abruf03","NUM;,9999999999.00",0)
   CALL FldAdd("Abruf04","NUM;,9999999999.00",0)
   CALL FldAdd("Abruf05","NUM;,9999999999.00",0)
   CALL FldAdd("Abruf06","NUM;,9999999999.00",0)
   CALL FldAdd("Abruf07","NUM;,9999999999.00",0)
   CALL FldAdd("Abruf08","NUM;,9999999999.00",0)
   CALL FldAdd("Abruf09","NUM;,9999999999.00",0)
   CALL FldAdd("Abruf10","NUM;,9999999999.00",0)
   CALL FldAdd("Abruf11","NUM;,9999999999.00",0)
   CALL FldAdd("Abruf12","NUM;,9999999999.00",0)
   CALL FldAdd("Abrufakt","NUM;,9999999999.00",0)

   CALL FldAdd("VertrGesamt","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu1","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu2","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu3","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu4","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu5","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu6","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu7","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu8","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu9","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu10","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu11","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu12","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu13","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu14","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu15","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu16","NUM;,999999999999",0)
 
   CALL FldAdd("BWVertrGesamt","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu1","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu2","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu3","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu4","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu5","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu6","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu7","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu8","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu9","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu10","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu11","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu12","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu13","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu14","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu15","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu16","NUM;,999999999999.00",0)
 
   CALL FldAdd("BeiVertrGesamt","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu1","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu2","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu3","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu4","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu5","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu6","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu7","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu8","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu9","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu10","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu11","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu12","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu13","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu14","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu15","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu16","NUM;,999999999999.00",0)
 
   CALL FldAdd("EinhGesamt","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu1","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu2","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu3","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu4","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu5","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu6","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu7","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu8","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu9","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu10","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu11","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu12","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu13","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu14","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu15","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu16","NUM;,9999999999.0000",0)


   CALL FldAdd("AnzSchGesamt","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu1","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu2","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu3","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu4","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu5","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu6","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu7","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu8","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu9","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu10","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu11","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu12","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu13","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu14","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu15","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu16","NUM;,9999999999.",0)

   CALL FldAdd("SchGesamt","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu1","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu2","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu3","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu4","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu5","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu6","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu7","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu8","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu9","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu10","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu11","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu12","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu13","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu14","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu15","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu16","NUM;,9999999999.00",0)
   CALL FldAdd("STATISTDATE","DAT;0d.mm.yyyy",0)
   CALL FldAdd("K1Ort","TXT;50",0)
   CALL FldAdd("K1Strasse","TXT;50",0)
   CALL FldAdd("K1PLZ","TXT;50",0)
   CALL FldAdd("K1Telefon1","TXT;50",0)
   CALL FldAdd("K1Fax1","TXT;50",0)
   CALL FldAdd("K1Mobil1","TXT;50",0)
   CALL FldAdd("K1email1","TXT;50",0)
   CALL FldAdd("K1WWW1","TXT;50",0)
   CALL FldAdd("K1Telefon2","TXT;50",0)
   CALL FldAdd("K1Fax2","TXT;50",0)
   CALL FldAdd("K1Mobil2","TXT;50",0)
   CALL FldAdd("K1email2","TXT;50",0)
   CALL FldAdd("K1WWW2","TXT;50",0)
   CALL FldAdd("K1Notiz","TXT;4000 R",0)
   CALL FldAdd("K1Geburtstag","DAT;0d.mm.yyyy",0)
   CALL FldAdd("K1Geschlecht","TXT;1",0)

   CALL FldAdd("K2Ort","TXT;50",0)
   CALL FldAdd("K2Strasse","TXT;50",0)
   CALL FldAdd("K2PLZ","TXT;50",0)
   CALL FldAdd("K2Telefon1","TXT;50",0)
   CALL FldAdd("K2Fax1","TXT;50",0)
   CALL FldAdd("K2Mobil1","TXT;50",0)
   CALL FldAdd("K2email1","TXT;50",0)
   CALL FldAdd("K2WWW1","TXT;50",0)
   CALL FldAdd("K2Telefon2","TXT;50",0)
   CALL FldAdd("K2Fax2","TXT;50",0)
   CALL FldAdd("K2Mobil2","TXT;50",0)
   CALL FldAdd("K2email2","TXT;50",0)
   CALL FldAdd("K2WWW2","TXT;50",0)
   CALL FldAdd("K2Notiz","TXT;4000 R",0)
   CALL FldAdd("K2Geburtstag","DAT;0d.mm.yyyy",0)
   CALL FldAdd("K2Geschlecht","TXT;1",0)

   CALL FldAdd("K3Ort","TXT;50",0)
   CALL FldAdd("K3Strasse","TXT;50",0)
   CALL FldAdd("K3PLZ","TXT;50",0)
   CALL FldAdd("K3Telefon1","TXT;50",0)
   CALL FldAdd("K3Fax1","TXT;50",0)
   CALL FldAdd("K3Mobil1","TXT;50",0)
   CALL FldAdd("K3email1","TXT;50",0)
   CALL FldAdd("K3WWW1","TXT;50",0)
   CALL FldAdd("K3Telefon2","TXT;50",0)
   CALL FldAdd("K3Fax2","TXT;50",0)
   CALL FldAdd("K3Mobil2","TXT;50",0)
   CALL FldAdd("K3email2","TXT;50",0)
   CALL FldAdd("K3WWW2","TXT;50",0)
   CALL FldAdd("K3Notiz","TXT;4000 R",0)
   CALL FldAdd("K3Geburtstag","DAT;0d.mm.yyyy",0)
   CALL FldAdd("K3Geschlecht","TXT;1",0)

   CALL FldAdd("K4Ort","TXT;50",0)
   CALL FldAdd("K4Strasse","TXT;50",0)
   CALL FldAdd("K4PLZ","TXT;50",0)
   CALL FldAdd("K4Telefon1","TXT;50",0)
   CALL FldAdd("K4Fax1","TXT;50",0)
   CALL FldAdd("K4Mobil1","TXT;50",0)
   CALL FldAdd("K4email1","TXT;50",0)
   CALL FldAdd("K4WWW1","TXT;50",0)
   CALL FldAdd("K4Telefon2","TXT;50",0)
   CALL FldAdd("K4Fax2","TXT;50",0)
   CALL FldAdd("K4Mobil2","TXT;50",0)
   CALL FldAdd("K4email2","TXT;50",0)
   CALL FldAdd("K4WWW2","TXT;50",0)
   CALL FldAdd("K4Notiz","TXT;4000 R",0)
   CALL FldAdd("K4Geburtstag","DAT;0d.mm.yyyy",0)
   CALL FldAdd("K4Geschlecht","TXT;1",0)

   CALL FldAdd("K5Ort","TXT;50",0)
   CALL FldAdd("K5Strasse","TXT;50",0)
   CALL FldAdd("K5PLZ","TXT;50",0)
   CALL FldAdd("K5Telefon1","TXT;50",0)
   CALL FldAdd("K5Fax1","TXT;50",0)
   CALL FldAdd("K5Mobil1","TXT;50",0)
   CALL FldAdd("K5email1","TXT;50",0)
   CALL FldAdd("K5WWW1","TXT;50",0)
   CALL FldAdd("K5Telefon2","TXT;50",0)
   CALL FldAdd("K5Fax2","TXT;50",0)
   CALL FldAdd("K5Mobil2","TXT;50",0)
   CALL FldAdd("K5email2","TXT;50",0)
   CALL FldAdd("K5WWW2","TXT;50",0)
   CALL FldAdd("K5Notiz","TXT;4000 R",0)
   CALL FldAdd("K5Geburtstag","DAT;0d.mm.yyyy",0)
   CALL FldAdd("K5Geschlecht","TXT;1",0)

   CALL FldAdd("K6Ort","TXT;50",0)
   CALL FldAdd("K6Strasse","TXT;50",0)
   CALL FldAdd("K6PLZ","TXT;50",0)
   CALL FldAdd("K6Telefon1","TXT;50",0)
   CALL FldAdd("K6Fax1","TXT;50",0)
   CALL FldAdd("K6Mobil1","TXT;50",0)
   CALL FldAdd("K6email1","TXT;50",0)
   CALL FldAdd("K6WWW1","TXT;50",0)
   CALL FldAdd("K6Telefon2","TXT;50",0)
   CALL FldAdd("K6Fax2","TXT;50",0)
   CALL FldAdd("K6Mobil2","TXT;50",0)
   CALL FldAdd("K6email2","TXT;50",0)
   CALL FldAdd("K6WWW2","TXT;50",0)
   CALL FldAdd("K6Notiz","TXT;4000 R",0)
   CALL FldAdd("K6Geburtstag","DAT;0d.mm.yyyy",0)
   CALL FldAdd("K6Geschlecht","TXT;1",0)

   CALL FldAdd("K7Ort","TXT;50",0)
   CALL FldAdd("K7Strasse","TXT;50",0)
   CALL FldAdd("K7PLZ","TXT;50",0)
   CALL FldAdd("K7Telefon1","TXT;50",0)
   CALL FldAdd("K7Fax1","TXT;50",0)
   CALL FldAdd("K7Mobil1","TXT;50",0)
   CALL FldAdd("K7email1","TXT;50",0)
   CALL FldAdd("K7WWW1","TXT;50",0)
   CALL FldAdd("K7Telefon2","TXT;50",0)
   CALL FldAdd("K7Fax2","TXT;50",0)
   CALL FldAdd("K7Mobil2","TXT;50",0)
   CALL FldAdd("K7email2","TXT;50",0)
   CALL FldAdd("K7WWW2","TXT;50",0)
   CALL FldAdd("K7Notiz","TXT;4000 R",0)
   CALL FldAdd("K7Geburtstag","DAT;0d.mm.yyyy",0)
   CALL FldAdd("K7Geschlecht","TXT;1",0)

   CALL FldAdd("K8Ort","TXT;50",0)
   CALL FldAdd("K8Strasse","TXT;50",0)
   CALL FldAdd("K8PLZ","TXT;50",0)
   CALL FldAdd("K8Telefon1","TXT;50",0)
   CALL FldAdd("K8Fax1","TXT;50",0)
   CALL FldAdd("K8Mobil1","TXT;50",0)
   CALL FldAdd("K8email1","TXT;50",0)
   CALL FldAdd("K8WWW1","TXT;50",0)
   CALL FldAdd("K8Telefon2","TXT;50",0)
   CALL FldAdd("K8Fax2","TXT;50",0)
   CALL FldAdd("K8Mobil2","TXT;50",0)
   CALL FldAdd("K8email2","TXT;50",0)
   CALL FldAdd("K8WWW2","TXT;50",0)
   CALL FldAdd("K8Notiz","TXT;4000 R",0)
   CALL FldAdd("K8Geburtstag","DAT;0d.mm.yyyy",0)
   CALL FldAdd("K8Geschlecht","TXT;1",0)

   CALL FldAdd("K9Ort","TXT;50",0)
   CALL FldAdd("K9Strasse","TXT;50",0)
   CALL FldAdd("K9PLZ","TXT;50",0)
   CALL FldAdd("K9Telefon1","TXT;50",0)
   CALL FldAdd("K9Fax1","TXT;50",0)
   CALL FldAdd("K9Mobil1","TXT;50",0)
   CALL FldAdd("K9email1","TXT;50",0)
   CALL FldAdd("K9WWW1","TXT;50",0)
   CALL FldAdd("K9Telefon2","TXT;50",0)
   CALL FldAdd("K9Fax2","TXT;50",0)
   CALL FldAdd("K9Mobil2","TXT;50",0)
   CALL FldAdd("K9email2","TXT;50",0)
   CALL FldAdd("K9WWW2","TXT;50",0)
   CALL FldAdd("K9Notiz","TXT;4000 R",0)
   CALL FldAdd("K9Geburtstag","DAT;0d.mm.yyyy",0)
   CALL FldAdd("K9Geschlecht","TXT;1",0)

   CALL FldAdd("K10Ort","TXT;50",0)
   CALL FldAdd("K10Strasse","TXT;50",0)
   CALL FldAdd("K10PLZ","TXT;50",0)
   CALL FldAdd("K10Telefon1","TXT;50",0)
   CALL FldAdd("K10Fax1","TXT;50",0)
   CALL FldAdd("K10Mobil1","TXT;50",0)
   CALL FldAdd("K10email1","TXT;50",0)
   CALL FldAdd("K10WWW1","TXT;50",0)
   CALL FldAdd("K10Telefon2","TXT;50",0)
   CALL FldAdd("K10Fax2","TXT;50",0)
   CALL FldAdd("K10Mobil2","TXT;50",0)
   CALL FldAdd("K10email2","TXT;50",0)
   CALL FldAdd("K10WWW2","TXT;50",0)
   CALL FldAdd("K10Notiz","TXT;4000 R",0)
   CALL FldAdd("K10Geburtstag","DAT;0d.mm.yyyy",0)
   CALL FldAdd("K10Geschlecht","TXT;1",0)

   CALL FldAdd("K11Ort","TXT;50",0)
   CALL FldAdd("K11Strasse","TXT;50",0)
   CALL FldAdd("K11PLZ","TXT;50",0)
   CALL FldAdd("K11Telefon1","TXT;50",0)
   CALL FldAdd("K11Fax1","TXT;50",0)
   CALL FldAdd("K11Mobil1","TXT;50",0)
   CALL FldAdd("K11email1","TXT;50",0)
   CALL FldAdd("K11WWW1","TXT;50",0)
   CALL FldAdd("K11Telefon2","TXT;50",0)
   CALL FldAdd("K11Fax2","TXT;50",0)
   CALL FldAdd("K11Mobil2","TXT;50",0)
   CALL FldAdd("K11email2","TXT;50",0)
   CALL FldAdd("K11WWW2","TXT;50",0)
   CALL FldAdd("K11Notiz","TXT;4000 R",0)
   CALL FldAdd("K11Geburtstag","DAT;0d.mm.yyyy",0)
   CALL FldAdd("K11Geschlecht","TXT;1",0)

   CALL FldAdd("K12Ort","TXT;50",0)
   CALL FldAdd("K12Strasse","TXT;50",0)
   CALL FldAdd("K12PLZ","TXT;50",0)
   CALL FldAdd("K12Telefon1","TXT;50",0)
   CALL FldAdd("K12Fax1","TXT;50",0)
   CALL FldAdd("K12Mobil1","TXT;50",0)
   CALL FldAdd("K12email1","TXT;50",0)
   CALL FldAdd("K12WWW1","TXT;50",0)
   CALL FldAdd("K12Telefon2","TXT;50",0)
   CALL FldAdd("K12Fax2","TXT;50",0)
   CALL FldAdd("K12Mobil2","TXT;50",0)
   CALL FldAdd("K12email2","TXT;50",0)
   CALL FldAdd("K12WWW2","TXT;50",0)
   CALL FldAdd("K12Notiz","TXT;4000 R",0)
   CALL FldAdd("K12Geburtstag","DAT;0d.mm.yyyy",0)
   CALL FldAdd("K12Geschlecht","TXT;1",0)

   CALL FldAdd("K13Ort","TXT;50",0)
   CALL FldAdd("K13Strasse","TXT;50",0)
   CALL FldAdd("K13PLZ","TXT;50",0)
   CALL FldAdd("K13Telefon1","TXT;50",0)
   CALL FldAdd("K13Fax1","TXT;50",0)
   CALL FldAdd("K13Mobil1","TXT;50",0)
   CALL FldAdd("K13email1","TXT;50",0)
   CALL FldAdd("K13WWW1","TXT;50",0)
   CALL FldAdd("K13Telefon2","TXT;50",0)
   CALL FldAdd("K13Fax2","TXT;50",0)
   CALL FldAdd("K13Mobil2","TXT;50",0)
   CALL FldAdd("K13email2","TXT;50",0)
   CALL FldAdd("K13WWW2","TXT;50",0)
   CALL FldAdd("K13Notiz","TXT;4000 R",0)
   CALL FldAdd("K13Geburtstag","DAT;0d.mm.yyyy",0)
   CALL FldAdd("K13Geschlecht","TXT;1",0)

   CALL FldAdd("K14Ort","TXT;50",0)
   CALL FldAdd("K14Strasse","TXT;50",0)
   CALL FldAdd("K14PLZ","TXT;50",0)
   CALL FldAdd("K14Telefon1","TXT;50",0)
   CALL FldAdd("K14Fax1","TXT;50",0)
   CALL FldAdd("K14Mobil1","TXT;50",0)
   CALL FldAdd("K14email1","TXT;50",0)
   CALL FldAdd("K14WWW1","TXT;50",0)
   CALL FldAdd("K14Telefon2","TXT;50",0)
   CALL FldAdd("K14Fax2","TXT;50",0)
   CALL FldAdd("K14Mobil2","TXT;50",0)
   CALL FldAdd("K14email2","TXT;50",0)
   CALL FldAdd("K14WWW2","TXT;50",0)
   CALL FldAdd("K14Notiz","TXT;4000 R",0)
   CALL FldAdd("K14Geburtstag","DAT;0d.mm.yyyy",0)
   CALL FldAdd("K14Geschlecht","TXT;1",0)

   CALL FldAdd("K15Ort","TXT;50",0)
   CALL FldAdd("K15Strasse","TXT;50",0)
   CALL FldAdd("K15PLZ","TXT;50",0)
   CALL FldAdd("K15Telefon1","TXT;50",0)
   CALL FldAdd("K15Fax1","TXT;50",0)
   CALL FldAdd("K15Mobil1","TXT;50",0)
   CALL FldAdd("K15email1","TXT;50",0)
   CALL FldAdd("K15WWW1","TXT;50",0)
   CALL FldAdd("K15Telefon2","TXT;50",0)
   CALL FldAdd("K15Fax2","TXT;50",0)
   CALL FldAdd("K15Mobil2","TXT;50",0)
   CALL FldAdd("K15email2","TXT;50",0)
   CALL FldAdd("K15WWW2","TXT;50",0)
   CALL FldAdd("K15Notiz","TXT;4000 R",0)
   CALL FldAdd("K15Geburtstag","DAT;0d.mm.yyyy",0)
   CALL FldAdd("K15Geschlecht","TXT;1",0)

   CALL FldAdd("K16Ort","TXT;50",0)
   CALL FldAdd("K16Strasse","TXT;50",0)
   CALL FldAdd("K16PLZ","TXT;50",0)
   CALL FldAdd("K16Telefon1","TXT;50",0)
   CALL FldAdd("K16Fax1","TXT;50",0)
   CALL FldAdd("K16Mobil1","TXT;50",0)
   CALL FldAdd("K16email1","TXT;50",0)
   CALL FldAdd("K16WWW1","TXT;50",0)
   CALL FldAdd("K16Telefon2","TXT;50",0)
   CALL FldAdd("K16Fax2","TXT;50",0)
   CALL FldAdd("K16Mobil2","TXT;50",0)
   CALL FldAdd("K16email2","TXT;50",0)
   CALL FldAdd("K16WWW2","TXT;50",0)
   CALL FldAdd("K16Notiz","TXT;4000 R",0)
   CALL FldAdd("K16Geburtstag","DAT;0d.mm.yyyy",0)
   CALL FldAdd("K16Geschlecht","TXT;1",0)

   CALL FldAdd("VertrStatu0","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu0","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu0","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu0","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu0","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu0","NUM;,9999999999.00",0)
   CALL FldAdd("Schadquote","NUM;,9999999.0000",0)
   CALL FldAdd("Stornoquote","NUM;,99999.0000",0)
   CALL FldAdd("CAgez","NUM;,999999999999.00",0)
   CALL FldAdd("WWW","TXT;50",0)
   CALL FldAdd("ProvVereinb1","TXT;50",0)
   CALL FldAdd("ProvVaktJN1","TXT;1",0)
   CALL FldAdd("ProvVText1","TXT;50",0)

   CALL FldAdd("ProvVereinb2","TXT;50",0)
   CALL FldAdd("ProvVaktJN2","TXT;1",0)
   CALL FldAdd("ProvVText2","TXT;50",0)

   CALL FldAdd("ProvVereinb3","TXT;50",0)
   CALL FldAdd("ProvVaktJN3","TXT;1",0)
   CALL FldAdd("ProvVText3","TXT;50",0)

   CALL FldAdd("ProvVereinb4","TXT;50",0)
   CALL FldAdd("ProvVaktJN4","TXT;1",0)
   CALL FldAdd("ProvVText4","TXT;50",0)

   CALL FldAdd("ProvVereinb5","TXT;50",0)
   CALL FldAdd("ProvVaktJN5","TXT;1",0)
   CALL FldAdd("ProvVText5","TXT;50",0)

   CALL FldAdd("ProvVereinb6","TXT;50",0)
   CALL FldAdd("ProvVaktJN6","TXT;1",0)
   CALL FldAdd("ProvVText6","TXT;50",0)

   CALL FldAdd("ProvVereinb7","TXT;50",0)
   CALL FldAdd("ProvVaktJN7","TXT;1",0)
   CALL FldAdd("ProvVText7","TXT;50",0)

   CALL FldAdd("ProvVereinb8","TXT;50",0)
   CALL FldAdd("ProvVaktJN8","TXT;1",0)
   CALL FldAdd("ProvVText8","TXT;50",0)

   CALL FldAdd("ProvVereinb9","TXT;50",0)
   CALL FldAdd("ProvVaktJN9","TXT;1",0)
   CALL FldAdd("ProvVText9","TXT;50",0)

   CALL FldAdd("ProvVereinb10","TXT;50",0)
   CALL FldAdd("ProvVaktJN10","TXT;1",0)
   CALL FldAdd("ProvVText10","TXT;50",0)

   CALL FldAdd("ProvVereinb11","TXT;50",0)
   CALL FldAdd("ProvVaktJN11","TXT;1",0)
   CALL FldAdd("ProvVText11","TXT;50",0)

   CALL FldAdd("ProvVereinb12","TXT;50",0)
   CALL FldAdd("ProvVaktJN12","TXT;1",0)
   CALL FldAdd("ProvVText12","TXT;50",0)

   CALL FldAdd("ProvVereinb13","TXT;50",0)
   CALL FldAdd("ProvVaktJN13","TXT;1",0)
   CALL FldAdd("ProvVText13","TXT;50",0)

   CALL FldAdd("ProvVereinb14","TXT;50",0)
   CALL FldAdd("ProvVaktJN14","TXT;1",0)
   CALL FldAdd("ProvVText14","TXT;50",0)

   CALL FldAdd("ProvVereinb15","TXT;50",0)
   CALL FldAdd("ProvVaktJN15","TXT;1",0)
   CALL FldAdd("ProvVText15","TXT;50",0)

   CALL FldAdd("ProvVereinb16","TXT;50",0)
   CALL FldAdd("ProvVaktJN16","TXT;1",0)
   CALL FldAdd("ProvVText16","TXT;50",0)

   CALL FldAdd("ProvVereinb17","TXT;50",0)
   CALL FldAdd("ProvVaktJN17","TXT;1",0)
   CALL FldAdd("ProvVText17","TXT;50",0)

   CALL FldAdd("ProvVereinb18","TXT;50",0)
   CALL FldAdd("ProvVaktJN18","TXT;1",0)
   CALL FldAdd("ProvVText18","TXT;50",0)

   CALL FldAdd("ProvVereinb19","TXT;50",0)
   CALL FldAdd("ProvVaktJN19","TXT;1",0)
   CALL FldAdd("ProvVText19","TXT;50",0)

   CALL FldAdd("ProvVereinb20","TXT;50",0)
   CALL FldAdd("ProvVaktJN20","TXT;1",0)
   CALL FldAdd("ProvVText20","TXT;50",0)

   CALL FldAdd("VertrStatu20","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu20","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu20","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu20","NUM;,9999999999.00",0)
   CALL FldAdd("VertrStatu21","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu21","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu21","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu21","NUM;,9999999999.00",0)
   CALL FldAdd("KreditorKto","TXT;8",0)
   CALL FldAdd("gesges","TXT;100",0)
   CALL FldAdd("FS24Nr","TXT;6",0)
   CALL FldAdd("DebitorKto","TXT;8",0)
   CALL FldAdd("FSSGE","NUM;000000.",0)
   CALL FldAdd("KorrAB220805","NUM;0.",0)
   CALL FldAdd("IBAN","TXT;50",0)
   CALL FldAdd("Swift","TXT;50",0)
   CALL FldAdd("Land","TXT;50",0)
   CALL FldAdd("eingueb","TXT;1",0)
   CALL FldAdd("noAnzeige","TXT;1",0)
   CALL FldAdd("Steuernr","TXT;50",0)
   CALL FldAdd("wirtSteuernr","TXT;50",0)
   CALL FldAdd("InHaus","NUM;0.",1)
   CALL FldAdd("GEGruppe","TXT;50 U",1)
   CALL MarkMain("CodeGE")
   IF lauf% = 0 THEN 
     SAVE FILE "GEADR"
     lauf% = 1
     GOTO anfgeadrreo
   END IF 
   IF lauf% = 1 THEN 
     SAVE FILE "GEADRLEE"
   END IF 

 
   IF EXISTS (_netpath$ + "provis\geadrold.sbf") THEN DELETE (_netpath$ + "provis\geadrold.*")
 
   REM ************************************ verschÑrfte Reorganisation ******************
   REM CALL Fehler("","")
   REM REQUEST "Mîchten Sie die Adressdatei komplett neu aufbauen lassen?","(Achtung dieser Vorgang kann sehr lange dauern!",135,req%
   IF NeuGEADR% = - 1 THEN 
     CLOSE FILE "GEADR"
     dpfad$ = _netpath$ + "PROVIS\" + DATE$ ( TODAY ,"yymm0d")
     datnr$ = DATE$ ( TODAY ,"yymm0d")
     i% = 0
     ok% = 0
     WHILE ok% = 0
       i% = i% + 1
       IF i% > 99 THEN 
         ON ERROR GOTO arb2208052
         REMOVE DIRECTORY dpfad$ + "01"
arb2208052: 
         i% = 1
       END IF 
       ON ERROR GOTO arb2208051
       tpfad$ = dpfad$ + STR$ (i%,"00")
       MAKE DIRECTORY dpfad$ + STR$ (i%,"00")
       dpfad$ = dpfad$ + STR$ (i%,"00")
       ok% = - 1
arb2208051: 
       ON ERROR GOTO ErrorHandler
     WEND 
 
     textdo1$ = tpfad$
     REQUEST "Sicherungskopie der Gesellschaftsdatei in",textdo1$,2
     ON ERROR GOTO arb6220820041
     COPY _netpath$ + "provis\geadr.*" TO dpfad$
     CALL DFile(3,"GEADR" + _fpw$)
     CALL reorgkv(_netpath$ + "provis\","GEADR","GEADROLD","GEADRLEE",dpfad$)
     GOTO arb6220820042
arb6220820041: 
     CALL Fehler("Beim Kopieren der Gesellschaftsdatei ist ein Fehler aufgetreten, deshalb wird der Komplettaufbau nicht durchgefÅhrt!","")
     
arb6220820042: 
     ON ERROR GOTO ErrorHandler
     FILE "GEADR"
    
   END IF 
   REM **********************************************************************************  
  
   FILE "GEADR"

   IF RECCOUNT ("GEADR") > 0 THEN 
     INDEX CodeGE
     SELECT LAST 
     WHILE codege.geadr > 990000
       SELECT PREVIOUS 
     WEND 
     WHILE CodeGE.geadr > SER ("GEADR",1)
     WEND 
     SELECT FIRST LOCK 
     WHILE NOT EOF ("GEADR")
       IF GEGruppe.geadr = "" THEN GEGruppe.geadr = "<ohne Zuordnung>"
       zero.geadr = 0
       STORE FILE "geadr"
       SELECT NEXT LOCK 
     WEND 
     

     SELECT LAST LOCK 
     WHILE codege.geadr > 999999
       codege.geadr = SER ("GEADR",1)
       STORE FILE "geadr"
       SELECT LAST LOCK 
     WEND 


     SELECT FIRST LOCK 
     WHILE NOT EOF ("GEADR")
       IF gesellschaft LIKE "<ohne Zuordnung>" THEN 
         CodeGE = 0
         STORE FILE "geadr"
       ELSE 
         IF CodeGE < 1 THEN 
           CodeGE = SER ("GEADR",1)
           STORE 
         END IF 
       END IF 
       SELECT NEXT LOCK 
     WEND 

     SELECT FIRST LOCK 
     WHILE NOT EOF ("GEADR")
       IF Postanschrift.geadr = "" THEN 
         p$ = ""
         p$ = p$ + LTRIM$ (gesellschaft.geadr) + CHR$ (13) + CHR$ (10)
         p$ = p$ + Stra·e.geadr + CHR$ (13) + CHR$ (10) + CHR$ (13) + CHR$ (10) + plz.geadr + " " + Ort.geadr + CHR$ (13) + CHR$ (10) + land.geadr + CHR$ (13) + CHR$ (10)
         Postanschrift.geadr = p$
         STORE FILE "geadr"
       END IF 
       SELECT NEXT LOCK 
     WEND 

   END IF 
   IF EXISTS (_ppath$ + "GEADR2.sbf") THEN 
     CALL DFile(3,"GEADR2" + _fpw$)
     FILE "GEADR2"
     CALL FldAdd("WWW","TXT;50",0)
     CALL FldAdd("Gesellschaft2","TXT;60",0)
     CALL FldAdd("K1Notiz","TXT;4000 R",0)
     CALL FldAdd("Land","TXT;50",0)
     SAVE FILE "GEADR2"
     CALL FldAdd("K2Notiz","TXT;4000 R",0)
     SAVE FILE "GEADR2"
     CALL FldAdd("K3Notiz","TXT;4000 R",0)
     SAVE FILE "GEADR2"
     CALL FldAdd("K4Notiz","TXT;4000 R",0)
     SAVE FILE "GEADR2"
     CALL FldAdd("K5Notiz","TXT;4000 R",0)
     SAVE FILE "GEADR2"
     CALL FldAdd("K6Notiz","TXT;4000 R",0)
     SAVE FILE "GEADR2"
     CALL FldAdd("K7Notiz","TXT;4000 R",0)
     SAVE FILE "GEADR2"
     CALL FldAdd("K8Notiz","TXT;4000 R",0)
     SAVE FILE "GEADR2"
     CALL FldAdd("K9Notiz","TXT;4000 R",0)
     SAVE FILE "GEADR2"
   END IF 
   REM -- Anpassung AGDIR.SBF
   IF EXISTS (_ppath$ + "AGDIR.sbf") THEN 
     CALL DFile(3,"AGDIR" + _fpw$)
     FILE "AGDIR"
     CALL FldAdd("AGNummer","NUM;000000.",0)
     CALL FldAdd("AGIteration","NUM;000.",0)
     CALL FldAdd("Schadquote","NUM;,9999999.0000",0)
     CALL FldAdd("Stornoquote","NUM;,99999.0000",0)
     CALL FldAdd("VertrGesamt","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu1","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu2","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu3","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu4","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu5","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu6","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu7","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu8","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu9","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu10","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu11","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu12","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu13","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu14","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu15","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu16","NUM;,999999999999",0)
 
     CALL FldAdd("BWVertrGesamt","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu1","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu2","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu3","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu4","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu5","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu6","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu7","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu8","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu9","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu10","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu11","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu12","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu13","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu14","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu15","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu16","NUM;,999999999999.00",0)
 
     CALL FldAdd("BeiVertrGesamt","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu1","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu2","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu3","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu4","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu5","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu6","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu7","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu8","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu9","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu10","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu11","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu12","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu13","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu14","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu15","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu16","NUM;,999999999999.00",0)
 
     CALL FldAdd("EinhGesamt","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu1","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu2","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu3","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu4","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu5","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu6","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu7","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu8","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu9","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu10","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu11","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu12","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu13","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu14","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu15","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu16","NUM;,9999999999.0000",0)
 
     CALL FldAdd("AnzSchGesamt","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu1","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu2","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu3","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu4","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu5","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu6","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu7","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu8","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu9","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu10","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu11","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu12","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu13","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu14","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu15","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu16","NUM;,9999999999.",0)
 
     CALL FldAdd("SchGesamt","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu1","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu2","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu3","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu4","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu5","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu6","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu7","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu8","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu9","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu10","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu11","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu12","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu13","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu14","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu15","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu16","NUM;,9999999999.00",0)
     CALL FldAdd("STATISTDATE","DAT;0d.mm.yyyy",0)
     CALL FldAdd("VertrStatu0","NUM;,999999999999",0)
     CALL FldAdd("BWVertrStatu0","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu0","NUM;,999999999999.00",0)
     CALL FldAdd("EinhStatu0","NUM;,9999999999.0000",0)
     CALL FldAdd("AnzSchStatu0","NUM;,9999999999.",0)
     CALL FldAdd("SchStatu0","NUM;,9999999999.00",0)
     CALL FldAdd("CAgez","NUM;,999999999999.00",0)
   CALL FldAdd("VertrStatu20","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu20","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu20","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu20","NUM;,9999999999.00",0)
   CALL FldAdd("VertrStatu21","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu21","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu21","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu21","NUM;,9999999999.00",0)
     CALL MarkMain("CodeAGDIR")
     SAVE FILE "AGDIR"
   END IF 
 
   IF EXISTS (_ppath$ + "AUMSATZ.sbf") THEN 
     CALL DFile(3,"AUMSATZ" + _fpw$)
     FILE "AUMSATZ"
     CALL FldAdd("EUUmstellung","TXT;1",0)
   END IF 


   IF EXISTS (_ppath$ + "AUMSKTO.sbf") THEN 
     CALL DFile(3,"AUMSKTO" + _fpw$)
     FILE "AUMSKTO"
     CALL FldAdd("AKonto01","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto02","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto03","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto04","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto05","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto06","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto07","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto08","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto09","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto10","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto11","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto12","NUM;,999999999999.00",0)
     CALL FldAdd("AKontoGes","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto01eu","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto02eu","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto03eu","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto04eu","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto05eu","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto06eu","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto07eu","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto08eu","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto09eu","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto10eu","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto11eu","NUM;,999999999999.00",0)
     CALL FldAdd("AKonto12eu","NUM;,999999999999.00",0)
     CALL FldAdd("AKontoGeseu","NUM;,999999999999.00",0)
     CALL FldAdd("KontoGes","NUM;,999999999999.00",0)
     CALL FldAdd("KontoGesEU","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto01","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto02","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto03","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto04","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto05","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto06","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto07","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto08","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto09","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto10","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto11","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto12","NUM;,999999999999.00",0)
     CALL FldAdd("sKontoGes","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto01eu","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto02eu","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto03eu","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto04eu","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto05eu","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto06eu","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto07eu","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto08eu","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto09eu","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto10eu","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto11eu","NUM;,999999999999.00",0)
     CALL FldAdd("sKonto12eu","NUM;,999999999999.00",0)
     CALL FldAdd("sKontoGeseu","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto01","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto02","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto03","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto04","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto05","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto06","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto07","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto08","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto09","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto10","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto11","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto12","NUM;,999999999999.00",0)
     CALL FldAdd("EKontoGes","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto01eu","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto02eu","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto03eu","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto04eu","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto05eu","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto06eu","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto07eu","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto08eu","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto09eu","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto10eu","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto11eu","NUM;,999999999999.00",0)
     CALL FldAdd("EKonto12eu","NUM;,999999999999.00",0)
     CALL FldAdd("EKontoGeseu","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto01","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto02","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto03","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto04","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto05","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto06","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto07","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto08","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto09","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto10","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto11","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto12","NUM;,999999999999.00",0)
     CALL FldAdd("dKontoGes","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto01eu","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto02eu","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto03eu","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto04eu","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto05eu","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto06eu","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto07eu","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto08eu","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto09eu","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto10eu","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto11eu","NUM;,999999999999.00",0)
     CALL FldAdd("dKonto12eu","NUM;,999999999999.00",0)
     CALL FldAdd("dKontoGeseu","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto01","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto02","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto03","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto04","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto05","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto06","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto07","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto08","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto09","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto10","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto11","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto12","NUM;,999999999999.00",0)
     CALL FldAdd("zKontoGes","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto01eu","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto02eu","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto03eu","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto04eu","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto05eu","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto06eu","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto07eu","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto08eu","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto09eu","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto10eu","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto11eu","NUM;,999999999999.00",0)
     CALL FldAdd("zKonto12eu","NUM;,999999999999.00",0)
     CALL FldAdd("zKontoGeseu","NUM;,999999999999.00",0)
     CALL FldAdd("EUUmstellung","TXT;1",0)
     CALL FldAdd("Einheit01","NUM;,999999999999.00",0)
     CALL FldAdd("Einheit02","NUM;,999999999999.00",0)
     CALL FldAdd("Einheit03","NUM;,999999999999.00",0)
     CALL FldAdd("Einheit04","NUM;,999999999999.00",0)
     CALL FldAdd("Einheit05","NUM;,999999999999.00",0)
     CALL FldAdd("Einheit06","NUM;,999999999999.00",0)
     CALL FldAdd("Einheit07","NUM;,999999999999.00",0)
     CALL FldAdd("Einheit08","NUM;,999999999999.00",0)
     CALL FldAdd("Einheit09","NUM;,999999999999.00",0)
     CALL FldAdd("Einheit10","NUM;,999999999999.00",0)
     CALL FldAdd("Einheit11","NUM;,999999999999.00",0)
     CALL FldAdd("Einheit12","NUM;,999999999999.00",0)
     CALL FldAdd("EinheitGes","NUM;,999999999999.00",0)
     CALL FldAdd("sEinheit01","NUM;,999999999999.00",0)
     CALL FldAdd("sEinheit02","NUM;,999999999999.00",0)
     CALL FldAdd("sEinheit03","NUM;,999999999999.00",0)
     CALL FldAdd("sEinheit04","NUM;,999999999999.00",0)
     CALL FldAdd("sEinheit05","NUM;,999999999999.00",0)
     CALL FldAdd("sEinheit06","NUM;,999999999999.00",0)
     CALL FldAdd("sEinheit07","NUM;,999999999999.00",0)
     CALL FldAdd("sEinheit08","NUM;,999999999999.00",0)
     CALL FldAdd("sEinheit09","NUM;,999999999999.00",0)
     CALL FldAdd("sEinheit10","NUM;,999999999999.00",0)
     CALL FldAdd("sEinheit11","NUM;,999999999999.00",0)
     CALL FldAdd("sEinheit12","NUM;,999999999999.00",0)
     CALL FldAdd("sEinheitGes","NUM;,999999999999.00",0)
     SAVE FILE "AUMSKTO"
   END IF 
maadrupd18042001: 
   REM -- Anpassun MAAUSZ.SBF --
   CALL DFile(3,"MAAUSZ" + _fpw$)
   FILE "MAAUSZ"
   CALL FldAdd("K1Bank","TXT;50",0)
   CALL FldAdd("K1BLZ","TXT;15",0)
   SAVE FILE "MAAUSZ"
   IF GAFSK$ LIKE "TRUE" THEN 
     CALL DFile(3,"AFSKSUT" + _fpw$)
     FILE "AFSKSUT"
     CALL FldAdd("Datum1","DAT;0d.mm.yyyy",1)
     CALL FldAdd("Geburtsdatum","DAT;0d.mm.yyyy",0)
     CALL FldAdd("Buchdatum","DAT;0d.mm.yyyy",0)
     CALL FldAdd("NeuVerm","TXT;20",0)
     CALL FldAdd("CodeMA","NUM;000000.",0)
     CALL FldAdd("AGNachname","TXT;30",1)
     CALL FldAdd("AGVorname","TXT;30",0)
     CALL FldAdd("Agenturnr","TXT;30",0)
     CALL FldAdd("druck","NUM;0.",1)
     CALL FldAdd("Sparte","TXT;60",0)
     CALL FldAdd("QStatCodeaz","TXT;7",1)
     CALL FldAdd("Fonds","TXT;50",0)
     CALL FldAdd("BeteilinProz","NUM;999.00",0)
     SAVE FILE "AFSKSUT"
     CALL DFile(3,"AFSKIMP" + _fpw$)
     FILE "AFSKIMP"
     CALL FldAdd("Sutexp","TXT;1",1)
     SAVE FILE "AFSKIMP"
     FILE "AFSKSUT"
     INDEX "Codeaz"
     IF RECCOUNT ("AFSKSUT") > 0 THEN 
       SELECT FIRST LOCK FILE "AFSKSUT"
     ELSE 
       SELECT LAST FILE "AFSKSUT"
     END IF 
     i% = 0
     WHILE NOT EOF ("AFSKSUT")
       MOUSE OFF 
       i% = i% + 1
       SET STATUS STR$ (i%) + " in AFSKSUT geprÅft von " + STR$ ( RECCOUNT ("AFSKSUT"),",9999999999")
       IF status_.afsksut = 1 OR status_.afsksut = 32 THEN 
         QStatCodeaz.afsksut = "1" + STR$ (codeaz.afsksut,"000000")
         STORE FILE "afsksut"
       END IF 
       SELECT NEXT LOCK FILE "AFSKSUT"
     WEND 
   END IF 

   REM -- Anpassun MAADR.SBF --
   CALL DFile(3,"KVERTRAG" + _fpw$)
   CALL DFile(3,"MAADR" + _fpw$)
   CALL DFile(3,"MAVORG" + _fpw$)
   FILE "MAADR"
   CALL FldAdd("Geburtstag","DAT;0d.mm.yyyy",0)
   CALL FldAdd("MAseit","DAT;0d.mm.yyyy",0)
   CALL FldAdd("KÅndigung","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Nachfolger","NUM;000000.",0)
   CALL FldAdd("VorgÑnger","NUM;000000.",1)
   CALL FldAdd("VorgÑngerJN","TXT;1",0)
   CALL FldAdd("k1Konto","TXT;14",0)
   CALL FldAdd("Beruf","TXT;50",0)
   CALL FldAdd("Agenturnr","TXT;20",1)
   CALL FldAdd("Stornoreserve","NUM;,9999999.00",0)
   CALL FldAdd("StornoreserveEU","NUM;,9999999.00",0)
   CALL FldAdd("StornoAb","NUM;,9999999.00",0)
   CALL FldAdd("StornoEUAb","NUM;,9999999.00",0)
   CALL FldAdd("Einheiten","NUM;,9999999999.00",0)
   CALL FldAdd("ExpAG","TXT;1",1)
   CALL FldAdd("MAGRUPPE","TXT;30",1)
   CALL FldAdd("CodeMAGR","NUM;0000000.",1)
   CALL FldAdd("CodeKU","NUM;0000000.",1)
   CALL FldAdd("Postanschrift","TXT;4000 R",0)
   CALL FldAdd("GesVolumen","NUM;,9999999999.00",0)
   CALL FldAdd("EigVolumen","NUM;,9999999999.00",0)
   CALL FldAdd("EigEinheiten","NUM;,9999999999.00",0)
   CALL FldAdd("CodeAGDIR","NUM;000000.",1)
   CALL FldAdd("Direktion","TXT;20",0)
   CALL FldAdd("StornoreservV","NUM;,9999999.00",0)
   CALL FldAdd("EinheitenV","NUM;,9999999999.00",0)
   CALL FldAdd("GesVolumenV","NUM;,9999999999.00",0)
   CALL FldAdd("EigVolumenV","NUM;,9999999999.00",0)
   CALL FldAdd("EigEinheitenV","NUM;,9999999999.00",0)
 
   CALL FldAdd("AnzMAGes","NUM;,9999999",0)
   CALL FldAdd("AntrGes","NUM;,9999999",0)
   CALL FldAdd("VertGes","NUM;,9999999",0)
   CALL FldAdd("StornoGes","NUM;,9999999",0)
   CALL FldAdd("EStornoGes","NUM;,9999999",0)
   CALL FldAdd("MStornoGes","NUM;,9999999",0)
   CALL FldAdd("BWSGes","NUM;,999999999999.00",0)
   CALL FldAdd("EBWSGes","NUM;,999999999999.00",0)
   CALL FldAdd("MBWSGes","NUM;,999999999999.00",0)
   CALL FldAdd("VolGes","NUM;,999999999999.00",0)
   CALL FldAdd("KontoGes","NUM;,999999999999.00",0)
   CALL FldAdd("EinheitGes","NUM;,999999999999.00",0)
   CALL FldAdd("AnalyseGes","NUM;,9999999",0)
 
   CALL FldAdd("SAntrGes","NUM;,9999999",0)
   CALL FldAdd("SVertGes","NUM;,9999999",0)
   CALL FldAdd("SStornoGes","NUM;,9999999",0)
   CALL FldAdd("SEStornoGes","NUM;,9999999",0)
   CALL FldAdd("SMStornoGes","NUM;,9999999",0)
   CALL FldAdd("SBWSGes","NUM;,999999999999.00",0)
   CALL FldAdd("SEBWSGes","NUM;,999999999999.00",0)
   CALL FldAdd("SMBWSGes","NUM;,999999999999.00",0)
   CALL FldAdd("SVolGes","NUM;,999999999999.00",0)
   CALL FldAdd("SKontoGes","NUM;,999999999999.00",0)
   CALL FldAdd("SEinheitGes","NUM;,999999999999.00",0)
   CALL FldAdd("SAnalyseGes","NUM;,9999999",0)
 
   CALL FldAdd("Schufa","TXT;1",0)
   CALL FldAdd("KopiePA","TXT;1",0)
   CALL FldAdd("AVAD","TXT;1",0)
   CALL FldAdd("PolFuer","TXT;1",0)
   CALL FldAdd("Leblauf","TXT;1",0)
   CALL FldAdd("GWRegister","TXT;1",0)
   CALL FldAdd("GerwerbAnm","TXT;1",0)
   CALL FldAdd("BWVAusw","TXT;1",0)
   CALL FldAdd("PROVSperreEig","TXT;1",0)
   CALL FldAdd("PROVSperreAll","TXT;1",0)
   CALL FldAdd("Beruf","TXT;1",0)
   CALL FldAdd("Hauptberufl","TXT;1",0)
   CALL FldAdd("Email","TXT;100",0)
   CALL FldAdd("PANr","TXT;50",0)
   CALL FldAdd("Karierestufe","TXT;100",0)
   CALL FldAdd("MARechtsform","TXT;10",0)
   CALL FldAdd("ReprSeit","DAT;0d.mm.yyyy",0)
   CALL FldAdd("PSperreESeit","DAT;0d.mm.yyyy",0)
   CALL FldAdd("PSperreAllSeit","DAT;0d.mm.yyyy",0)
   CALL FldAdd("AuszahlSperKo","NUM;,999999999999.00",0)
   CALL FldAdd("AuszahlSperKoEU","NUM;,999999999999.00",0)
   CALL FldAdd("Stufe","NUM;000.",1)
   CALL FldAdd("DruckStufe","TXT;100",0)
   CALL FldAdd("AuszahlAB","NUM;,999999999999.00",0)
   CALL FldAdd("AuszahlEUAB","NUM;,999999999999.00",0)
   CALL FldAdd("AuszahlSchw","NUM;,999999999999.00",0)
   CALL FldAdd("AuszahlSchwEU","NUM;,999999999999.00",0)
   CALL FldAdd("erfAuszahlAB","NUM;,999999999999.00",0)
   CALL FldAdd("erfAuszahlEUAB","NUM;,999999999999.00",0)
   CALL FldAdd("zusAuszahl","NUM;,999999999999.00",0)
   CALL FldAdd("zusAuszahlEU","NUM;,999999999999.00",0)
   CALL FldAdd("AusgeschAm","DAT;0d.mm.yyyy",0)
   CALL FldAdd("SchufaAm","DAT;0d.mm.yyyy",0)
   CALL FldAdd("SchufaNotiz","TXT;100",0)
   CALL FldAdd("PSANotiz","TXT;100",0)
   CALL FldAdd("AVADAm","DAT;0d.mm.yyyy",0)
   CALL FldAdd("AVADNotiz","TXT;100",0)
   CALL FldAdd("PolFZAm","DAT;0d.mm.yyyy",0)
   CALL FldAdd("PolFZNotiz","TXT;100",0)
   CALL FldAdd("AuszGewZAm","DAT;0d.mm.yyyy",0)
   CALL FldAdd("AusGewZNotiz","TXT;100",0)
   CALL FldAdd("GWAAm","DAT;0d.mm.yyyy",0)
   CALL FldAdd("GWANotiz","TXT;100",0)
   CALL FldAdd("BWVAm","DAT;0d.mm.yyyy",0)
   CALL FldAdd("BWVNotiz","TXT;100",0)
   CALL FldAdd("hauptberNotiz","TXT;100",0)
   CALL FldAdd("BerufNotiz","TXT;100",0)
   CALL FldAdd("BWB","TXT;1",0)
   CALL FldAdd("C34","TXT;1",0)
   CALL FldAdd("C34seit","DAT;0d.mm.yyyy",0)
   CALL FldAdd("C34Notiz","TXT;100",0)
   CALL FldAdd("BWBseit","DAT;0d.mm.yyyy",0)
   CALL FldAdd("BWBNotiz","TXT;100",0)
   CALL FldAdd("letzteVerrech","DAT;0d.mm.yyyy",0)
   CALL FldAdd("DSchufa","TXT;256",0)
   CALL FldAdd("DPSA","TXT;256",0)
   CALL FldAdd("DAVAD","TXT;256",0)
   CALL FldAdd("DPol","TXT;256",0)
   CALL FldAdd("DGEW","TXT;256",0)
   CALL FldAdd("DGWA","TXT;256",0)
   CALL FldAdd("DHauptber","TXT;256",0)
   CALL FldAdd("DHNot","TXT;256",0)
   CALL FldAdd("DBernot","TXT;256",0)
   CALL FldAdd("DBWB","TXT;256",0)
   CALL FldAdd("D34C","TXT;256",0)
   CALL FldAdd("SollBWS","NUM;,999999999999.00",0)
   CALL FldAdd("SollBWSEU","NUM;,999999999999.00",0)
   CALL FldAdd("SollQuote","NUM;999.00",0)
   CALL FldAdd("SollMAAnz","NUM;,999999.",0)
   CALL FldAdd("IstBWS","NUM;,999999999999.00",0)
   CALL FldAdd("IstBWSEU","NUM;,999999999999.00",0)
   CALL FldAdd("IstTitel","TXT;20",0)
   CALL FldAdd("IstQuote","NUM;999.00",0)
   CALL FldAdd("IstMAAnz","NUM;,999999.",0)
   CALL FldAdd("IstBonifik","TXT;30",0)
   CALL FldAdd("nichtaktiv","TXT;1",0)
   CALL FldAdd("NameVorg","TXT;90",0)
   CALL FldAdd("QNameCodema","TXT;36",1)
   CALL FldAdd("aktZusB","NUM;,999999999999.00",0)
   CALL FldAdd("aktZusBEU","NUM;,999999999999.00",0)
   CALL FldAdd("EUUmstellung","TXT;1",0)
   CALL FldAdd("NoAnzeige","TXT;1",0)
   CALL FldAdd("StornoVerrech","TXT;1",0)
   REM CALL FldAdd("nureigeneDaten","NUM;0",0)

   CALL FldAdd("VertrGesamt","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu1","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu2","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu3","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu4","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu5","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu6","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu7","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu8","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu9","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu10","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu11","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu12","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu13","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu14","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu15","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu16","NUM;,999999999999",0)

   CALL FldAdd("BWVertrGesamt","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu1","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu2","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu3","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu4","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu5","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu6","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu7","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu8","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu9","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu10","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu11","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu12","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu13","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu14","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu15","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu16","NUM;,999999999999.00",0)

   CALL FldAdd("BeiVertrGesamt","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu1","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu2","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu3","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu4","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu5","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu6","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu7","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu8","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu9","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu10","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu11","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu12","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu13","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu14","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu15","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu16","NUM;,999999999999.00",0)

   CALL FldAdd("EinhGesamt","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu1","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu2","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu3","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu4","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu5","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu6","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu7","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu8","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu9","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu10","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu11","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu12","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu13","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu14","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu15","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu16","NUM;,9999999999.0000",0)

   CALL FldAdd("AnzSchGesamt","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu1","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu2","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu3","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu4","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu5","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu6","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu7","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu8","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu9","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu10","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu11","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu12","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu13","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu14","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu15","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu16","NUM;,9999999999.",0)
 
   CALL FldAdd("SchGesamt","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu1","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu2","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu3","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu4","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu5","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu6","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu7","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu8","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu9","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu10","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu11","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu12","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu13","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu14","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu15","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu16","NUM;,9999999999.00",0)
   CALL FldAdd("STATISTDATE","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Maklerbetreuer","TXT;61",0)
   CALL FldAdd("CodeMABetreu","NUM;000000.",1)
   CALL FldAdd("StornoNachf","TXT;1",0)
   CALL FldAdd("FirmaName","TXT;60",1)
   CALL FldAdd("VertrStatu0","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu0","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu0","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu0","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu0","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu0","NUM;,9999999999.00",0)
   CALL FldAdd("Schadquote","NUM;,9999999.0000",0)
   CALL FldAdd("Stornoquote","NUM;,99999.0000",0)
   CALL FldAdd("CAgez","NUM;,999999999999.00",0)
   CALL FldAdd("MaklBetreuer","TXT;1",1)
   CALL FldAdd("Steuernummer","TXT;30",0)
   CALL FldAdd("BuchKonto1","TXT;30",0)
   CALL FldAdd("BuchKonto2","TXT;30",0)
   CALL FldAdd("PuchAP","NUM;999999.0000",0)
   CALL FldAdd("EurEinhAP","NUM;,999999999999.00",0)
   CALL FldAdd("EurEinhCourt","NUM;,999999999999.00",0)
   CALL FldAdd("EurEinhPfleg","NUM;,999999999999.00",0)
   CALL FldAdd("QAgenturnr","TXT;30",1)
   CALL FldAdd("PuchIP","NUM;999999.0000",0)
   CALL FldAdd("PuchMakl","TXT;1 U",0)
   CALL FldAdd("DebitorKto","TXT;8",0)
   CALL FldAdd("Kontoinhaber","TXT;50",0)
   CALL FldAdd("AuszProvABGes","NUM;,999999999999.00",0)
   CALL FldAdd("AuszProvABGesEU","NUM;,999999999999.00",0)
   CALL FldAdd("VertrStatu20","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu20","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu20","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu20","NUM;,9999999999.00",0)
   CALL FldAdd("VertrStatu21","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu21","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu21","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu21","NUM;,9999999999.00",0)
   CALL FldAdd("Vorschujn","NUM;0.",1)
   CALL FldAdd("Vorschuvon","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Vorschubis","DAT;0d.mm.yyyy",0)
   CALL FldAdd("KreditorKto","TXT;8",0)
   CALL FldAdd("VorschuMax","NUM;,9999999999.00",0)
   CALL FldAdd("VorschuProz","NUM;999.0000",0)
   CALL FldAdd("Kostenstelle","TXT;8",0)
   CALL FldAdd("PflegenurEig","TXT;1",0)
   CALL FldAdd("MWSTPFLICHT","TXT;1",0)
   CALL FldAdd("MWSTNOTIZ","TXT;4000 R",0)
   CALL FldAdd("dochProv","TXT;1",0)
   CALL FldAdd("Anrede2","TXT;20",0)
   CALL FldAdd("FirmaName2","TXT;50",0)
   CALL FldAdd("Nachname2","TXT;50",0)
   CALL FldAdd("Vorname2","TXT;50",0)
   CALL FldAdd("Ort2","TXT;50",0)
   CALL FldAdd("PLZ2","TXT;10",0)
   CALL FldAdd("Strasse2","TXT;50",0)
   CALL FldAdd("Postanschrift2","TXT;4000 R",0)
   CALL FldAdd("Notiz2","TXT;4000 R",0)
   CALL FldAdd("MWSTseit","DAT;0d.mm.yyyy",0)
   CALL FldAdd("IBAN","TXT;50",0)
   CALL FldAdd("Swift","TXT;50",0)
   CALL FldAdd("HRNummer","TXT;50",0)
   CALL FldAdd("GFuehrer","TXT;100",0)
   CALL FldAdd("www","TXT;100",0)
   CALL FldAdd("Information","TXT;100",0)

   REM wenn  VorschArt=0 altes System  VorschArt=1 neues 6Monate System VorschArt=2 dann allgemeiner Vorschuss jeden Monat
   CALL FldAdd("VorschArt","NMI;0.",0)
   REM 6 MonateSystem VorschArt=1
   CALL FldAdd("VorschG1","NUM;,999999.00",0)
   CALL FldAdd("VorschW1","NUM;,999999.00",0)
   CALL FldAdd("VorschGRM1","NUM;,999999.00",0)
   CALL FldAdd("VorschRM1","NUM;,999999.00",0)
   CALL FldAdd("VorschGVD1","NUM;,999999.00",0)
   CALL FldAdd("VorschVD1","NUM;,999999.00",0)

   CALL FldAdd("VorschG2","NUM;,999999.00",0)
   CALL FldAdd("VorschW2","NUM;,999999.00",0)
   CALL FldAdd("VorschGRM2","NUM;,999999.00",0)
   CALL FldAdd("VorschRM2","NUM;,999999.00",0)
   CALL FldAdd("VorschGVD2","NUM;,999999.00",0)
   CALL FldAdd("VorschVD2","NUM;,999999.00",0)

   CALL FldAdd("VorschG3","NUM;,999999.00",0)
   CALL FldAdd("VorschW3","NUM;,999999.00",0)
   CALL FldAdd("VorschGRM3","NUM;,999999.00",0)
   CALL FldAdd("VorschRM3","NUM;,999999.00",0)
   CALL FldAdd("VorschGVD3","NUM;,999999.00",0)
   CALL FldAdd("VorschVD3","NUM;,999999.00",0)

   CALL FldAdd("VorschG4","NUM;,999999.00",0)
   CALL FldAdd("VorschW4","NUM;,999999.00",0)
   CALL FldAdd("VorschGRM4","NUM;,999999.00",0)
   CALL FldAdd("VorschRM4","NUM;,999999.00",0)
   CALL FldAdd("VorschGVD4","NUM;,999999.00",0)
   CALL FldAdd("VorschVD4","NUM;,999999.00",0)

   CALL FldAdd("VorschG5","NUM;,999999.00",0)
   CALL FldAdd("VorschW5","NUM;,999999.00",0)
   CALL FldAdd("VorschGRM5","NUM;,999999.00",0)
   CALL FldAdd("VorschRM5","NUM;,999999.00",0)
   CALL FldAdd("VorschGVD5","NUM;,999999.00",0)
   CALL FldAdd("VorschVD5","NUM;,999999.00",0)

   CALL FldAdd("VorschG6","NUM;,999999.00",0)
   CALL FldAdd("VorschW6","NUM;,999999.00",0)
   CALL FldAdd("VorschGRM6","NUM;,999999.00",0)
   CALL FldAdd("VorschRM6","NUM;,999999.00",0)
   CALL FldAdd("VorschGVD6","NUM;,999999.00",0)
   CALL FldAdd("VorschVD6","NUM;,999999.00",0)
  
   REM allgemeiner Vorschuss VorschArt=2
   CALL FldAdd("Vorschallg","NUM;,999999.00",0)
   CALL FldAdd("VorschSum","NUM;,999999.00",0)
   CALL FldAdd("MakProvSum","NUM;,999999.00",0)
   CALL FldAdd("ProvSum","NUM;,999999.00",0)

   CALL FldAdd("ProvSumUberweis","NUM;,999999.00",0)
   CALL FldAdd("ProvSumTotal","NUM;,999999.00",0)
   CALL FldAdd("VorschVorschlag","NUM;,999999.00",0)
   CALL FldAdd("Vorschangewiese","NMI;0.",0)

   CALL FldAdd("AbrMonat","NUM;000000.",0)
   CALL FldAdd("MonAbgeschlosse","NMI;0.",0)
   CALL FldAdd("MKZ","NUM;000000.",0)

   CALL FldAdd("KreditSum","NUM;,9999999.00",0)
   CALL FldAdd("KreditgezSum","NUM;,9999999.00",0)
   CALL FldAdd("KreditMon","NUM;,9999999.00",0)

   CALL FldAdd("KuenAP","TXT;1",0)
   CALL FldAdd("KuenCourt1","TXT;1",0)
   CALL FldAdd("KuenCourtAlle","TXT;1",0)
   CALL FldAdd("KuenPflege","TXT;1",0)
   CALL FldAdd("KuenFoerd","TXT;1",0)
   CALL FldAdd("KuenSpezi","TXT;1",0)
   CALL FldAdd("Briefanrede1","TXT;100",0)
   CALL FldAdd("Briefanrede2","TXT;100",0)
   CALL FldAdd("Provsatz","NUM;,9999999.0000",0)
   CALL FldAdd("AFSSollStufe","NMI;00.",0)
   CALL FldAdd("SRAutoBerech","NUM;,999999999.00",0)
   CALL FldAdd("TelefonMA2","TXT;50",0)
   CALL FldAdd("FaxMA2","TXT;50",0)
   CALL FldAdd("HandyMA2","TXT;50",0)
   CALL FldAdd("emailMA2","TXT;100",0)
   CALL FldAdd("LebLaufAm","DAT;0d.mm.yyyy",0)
   CALL FldAdd("LeblaufNotiz","TXT;100",0)
   CALL FldAdd("DLeblauf","TXT;256",0)
   CALL FldAdd("SumBelast","NUM;,999999999.00",0)
   CALL FldAdd("SumBelastN","NUM;,999999999.00",0)
   CALL FldAdd("SumGut","NUM;,999999999.00",0)
   CALL FldAdd("SumGutN","NUM;,999999999.00",0)
   CALL FldAdd("PausUVzahl","NUM;0.",0)
   CALL FldAdd("ueberwtxt","TXT;54",0)
   CALL FldAdd("persSteuernr","TXT;50",0)
   CALL FldAdd("wirtSteuernr","TXT;50",0)
   CALL FldAdd("Land","TXT;50",0)
   CALL FldAdd("Land2","TXT;50",0)
   CALL FldAdd("InHaus","NUM;0.",1)
   CALL FldAdd("GebDatKurz","TXT;4",0)
   CALL MarkMain("CodeMA")
   SAVE FILE "MAADR"
   REM CALL Fehler("","")
   IF RECCOUNT ("MAADR") > 1 THEN 
     INDEX CodeMA.maadr
     SELECT LAST 
     WHILE codema.maadr > 990000
       SELECT PREVIOUS 
     WEND 
     WHILE CodeMA.maadr > SER ("MAADR",1)
     WEND 
     
     FILE "maadr"
     INDEX CodeMA.maadr

     SELECT FIRST LOCK 
     WHILE NOT EOF ("MAADR")
       IF CodeMA.maadr < 1 THEN 
         IF nachname.maadr = "<ohne Zuordnung>" THEN 
         ELSE 
           CodeMA.maadr = SER ("MAADR",1)
           STORE FILE "maadr"
         END IF 
       END IF 
       SELECT NEXT LOCK 
     WEND 

    IF RECCOUNT ("maadr") > 1 THEN 
     SELECT FIRST LOCK 
     i% = 0
     j% = RECCOUNT ("MAADR")
     WHILE NOT EOF ("MAADR")
       ok% = 0
       i% = i% + 1
       SET STATUS STR$ (i%,",999999") + " DatensÑtze in MAADR geprÅft von " + STR$ (j%,",999999")
       REM CALL Fehler("","")
       ok% = - 1
       IF LTRIM$ (nachname2.maadr) = "" AND LTRIM$ (vorname2.maadr) = "" THEN 
         ok% = - 1
         Anrede2.maadr = anrede.maadr
         firmaName2.maadr = firmaName.maadr
         nachname2.maadr = nachname.maadr
         vorname2.maadr = vorname.maadr
         ort2.maadr = ort.maadr
         strasse2.maadr = stra·e.maadr
         plz2.maadr = plz.maadr
       END IF 
       IF Briefanrede2.maadr = "" THEN Briefanrede2.maadr = Briefanrede1.maadr
       IF TelefonMA2.maadr = "" THEN TelefonMA2.maadr = Telefon1.maadr
       IF FaxMa2.maadr = "" THEN FaxMa2.maadr = TeleFax.maadr
       IF Handyma2.maadr = "" THEN Handyma2.maadr = Telefon2.maadr
       IF emailma2.maadr = "" THEN emailma2.maadr = email.maadr
       IF Postanschrift2.maadr = "" THEN Postanschrift2.maadr = Postanschrift.maadr
       IF LTRIM$ (Briefanrede1.maadr) = "" THEN 
         ok% = - 1
         SELECT CASE UCASE$ ( LEFT$ (anrede.maadr,3))
         CASE "HER"
           briefanrede1.maadr = "Sehr geehrter Herr " + nachname.maadr + ","
         CASE "FRA","FR."
           briefanrede1.maadr = "Sehr geehrte Frau " + nachname.maadr + ","
         CASE "FRé","FRL"
           briefanrede1.maadr = "Sehr geehrtes FrÑulein " + nachname.maadr + ","
         CASE "FA.","FIR",""
           briefanrede1.maadr = "Sehr geehrte Damen und Herren,"
         CASE "FAM"
           briefanrede1.maadr = "Sehr geehrte Familie " + nachname.maadr + ","
         CASE "EHE"
           briefanrede1.maadr = "Sehr geehrte Eheleute " + nachname.maadr + ","
         CASE ELSE 
           briefanrede1.maadr = "Sehr geehrte Damen und Herren,"
         END SELECT 
       END IF 
       IF LTRIM$ (Briefanrede2.maadr) = "" THEN 
         ok% = - 1
         SELECT CASE UCASE$ ( LEFT$ (anrede2.maadr,3))
         CASE "HER"
           briefanrede2.maadr = "Sehr geehrter Herr " + nachname2.maadr + ","
         CASE "FRA","FR."
           briefanrede2.maadr = "Sehr geehrte Frau " + nachname2.maadr + ","
         CASE "FRé","FRL"
           briefanrede2.maadr = "Sehr geehrtes FrÑulein " + nachname2.maadr + ","
         CASE "FA.","FIR",""
           briefanrede2.maadr = "Sehr geehrte Damen und Herren,"
         CASE "FAM"
           briefanrede2.maadr = "Sehr geehrte Familie " + nachname2.maadr + ","
         CASE "EHE"
           briefanrede2.maadr = "Sehr geehrte Eheleute " + nachname2.maadr + ","
         CASE ELSE 
           briefanrede2.maadr = "Sehr geehrte Damen und Herren,"
         END SELECT 
       END IF 
 
       IF LTRIM$ (Postanschrift.maadr) = "" THEN 
         P1$ = ""
         IF firmaName.maadr <> "" THEN p1$ = firmaName.maadr + CHR$ (13) + CHR$ (10) + "z.H. "

         IF Anrede.maadr <> "" THEN p1$ = p1$ + anrede.maadr + " "
         IF Vorname.maadr <> "" THEN p1$ = p1$ + Vorname.maadr + " "
         p1$ = p1$ + NachName.maadr + CHR$ (13) + CHR$ (10)
         p1$ = p1$ + Stra·e.maadr + CHR$ (13) + CHR$ (10) + CHR$ (13) + CHR$ (10)
         p1$ = p1$ + plz.maadr + " " + Ort.maadr + CHR$ (13) + CHR$ (10)
         Postanschrift.maadr = p1$
         ok% = - 1
       END IF 
       p0$ = LTRIM$ (Postanschrift2.maadr)
       IF LTRIM$ (Postanschrift2.maadr) = "" THEN 
          P1$ = ""
         IF firmaName2.maadr <> "" THEN p1$ = firmaName2.maadr + CHR$ (13) + CHR$ (10) + "z.H. "
         IF Anrede2.maadr <> "" THEN p1$ = p1$ + anrede2.maadr + " "
         IF Vorname2.maadr <> "" THEN p1$ = p1$ + Vorname2.maadr + " "
         p1$ = p1$ + NachName2.maadr + CHR$ (13) + CHR$ (10)
         p1$ = p1$ + Strasse2.maadr + CHR$ (13) + CHR$ (10) + CHR$ (13) + CHR$ (10)
         p1$ = p1$ + plz2.maadr + " " + Ort2.maadr + CHR$ (13) + CHR$ (10)
         Postanschrift2.maadr = p1$
         REM CALL Fehler("",p1$)
         ok% = - 1
       END IF 
       IF Geburtstag.maadr > 0 THEN 
         GebDatKurz.maadr = LEFT$ ( DATE$ (Geburtstag.maadr,"0dmmyyyy"),4)
         ok% = - 1
       END IF 
       REM CALL Fehler(Postanschrift.maadr,Postanschrift2.maadr)
       IF ok% = - 1 THEN 
         STORE FILE "maadr"
       END IF 
       SELECT NEXT LOCK FILE "maadr"
     WEND 
    END IF 
     SELECT FIRST LOCK 
     WHILE NOT EOF ("MAADR") AND GIndNeu% = - 1
       ok% = 0
       IF MaklBetreuer.maadr = "" THEN 
         MaklBetreuer.maadr = "n"
         ok% = - 1
       END IF 
       IF CodeMAGR.maadr < 1 THEN 
         CodeMAGR.maadr = 0
         ok% = - 1
       END IF 
       IF Maklerbetreuer.maadr = "" OR CodeMABetreu.maadr < 1 THEN 
         Maklerbetreuer.maadr = "<ohne Zuordnung>"
         CodeMABetreu.maadr = 0
         ok% = - 1
       END IF 
       IF Agenturnr.maadr <> "" AND QAgenturnr.maadr = "" THEN 
         QAgenturnr.maadr = VSNRPackNum$(Agenturnr.maadr)
         ok% = - 1
       END IF 
       IF ok% = - 1 THEN 
         STORE FILE "maadr"
       END IF 
       SELECT NEXT LOCK FILE "maadr"
     WEND 
     SELECT FIRST LOCK 
     i% = 0
     j% = RECCOUNT ("maadr")
     WHILE NOT EOF ("MAADR")
       IF nachname.maadr = "<ohne Zuordnung>" THEN 
         IF codema.maadr <> 0 THEN 
           codema.maadr = 0
           STORE 
           SELECT LAST 
         END IF 
       END IF 
       SELECT NEXT LOCK 
     WEND 
     IF GIndNeu% = - 1 THEN 
       MOUSE OFF 
       UPDATE QNameCodema.maadr = LTRIM$ (NACHNAME.maadr) + STR$ (codema.maadr,"000000")
       END UPDATE 
       UPDATE StornoVerrech.maadr = "n" WHERE StornoVerrech.maadr <> "j"
       END UPDATE 
     END IF 
     FILE "maadr"
     INDEX codema.maadr
     SELECT FIRST 
     REM CALL Fehler("Agentur:" + ag$,"")
    
     i% = 0
     j% = RECCOUNT ("maadr")
     FILE "maadr"
     INDEX codema.maadr
     IF RECCOUNT ("maadr") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     WHILE NOT EOF ("maadr")
       i% = i% + 1
       codema% = codema.maadr
         GMaAnrede$ = Anrede.maadr
         GMaAnrede2$ = Anrede2.maadr
         GMaVorname$ = Vorname.maadr
         GMaVorname2$ = Vorname2.maadr
         GMaNachname$ = Nachname.maadr
         GMaNachname2$ = Nachname2.maadr
         GMaFirmaName$ = FirmaName.maadr
         GMaFirmaName2$ = FirmaName2.maadr
         GMaOrt$ = Ort.maadr
         GMaOrt2$ = Ort2.maadr
         GMaStrasse$ = Stra·e.maadr
         GMaStrasse2$ = Strasse2.maadr
         GMaPLZ$ = plz.maadr
         GMaPLZ2$ = plz2.maadr
 
       IF codema% > 0 THEN 
         IF NOT EXISTS (VorgÑnger.maadr,Codema.maadr) OR VorgÑnger.maadr < 1 THEN 
           VorgÑnger.maadr = Codema.maadr
           NameVorg.maadr = LTRIM$ (nachname.maadr) + "," + LTRIM$ (vorname.maadr) + "," + Agenturnr.maadr
           STORE FILE "maadr"
         END IF 
       END IF 
       SET STATUS STR$ (i%) + " von " + STR$ (j%) + " Mitarbeitern verarbeitet"
       SELECT NEXT LOCK FILE "maadr" INDEX codema.maadr
     WEND 
   REM CALL Fehler("Test StruAll","")
   IF ag$ <> "j" AND stufebere$ = "j" AND GIndNeu% = - 1 THEN CALL StruAll()
   IF ag$ <> "j" AND stufebere$ = "j" AND GIndNeu% = - 1 THEN 
     FILE "maadr"
     INDEX codema.maadr
     IF RECCOUNT ("maadr") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     WHILE NOT EOF ("maadr")
       IF codema.maadr > 0 AND vorgÑnger.maadr > 0 THEN 
         ma% = codema.maadr
         ma2% = ma%
         found1% = - 1
         l% = 0
         WHILE found1% = - 1
           SELECT KEY ma2% FILE "maadr" INDEX codema.maadr
           IF vorgÑnger.maadr = ma2% THEN 
             found1% = 0
           ELSE 
             REM ma2old% = ma2%
             ma2% = vorgÑnger.maadr
             REM IF ma2% = ma2old% THEN found1% = 0
           END IF 
           l% = l% + 1
         WEND 
         SELECT FIRST FILE "maadr" INDEX codema.maadr
         SELECT KEY ma% LOCK FILE "maadr" INDEX codema.maadr
         stufe.maadr = l%
         STORE FILE "maadr"
         UNLOCK CURRENT FILE "maadr"
       END IF 
     SELECT NEXT 
     WEND 
     FILE "maadr"
     INDEX codema.maadr
     IF RECCOUNT ("maadr") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     i% = 0
     j% = RECCOUNT ("maadr")
     WHILE NOT EOF ("maadr")
       i% = i% + 1
       codema% = codema.maadr
       IF VorgÑnger.maadr < 1 THEN 
         VorgÑnger.maadr = Codema.maadr
         NameVorg.maadr = LTRIM$ (nachname.maadr) + "," + LTRIM$ (vorname.maadr) + "," + Agenturnr.maadr
         STORE FILE "maadr"
       END IF 
       SET STATUS STR$ (i%) + " von " + STR$ (j%)
       SELECT NEXT LOCK FILE "maadr" INDEX codema.maadr
     WEND 
    REM END IF 
    REM end if von if ag$<>"j"
     FILE "maadr"
     INDEX codema.maadr
     IF RECCOUNT ("maadr") > 0 THEN 
       SELECT FIRST 
     ELSE 
       SELECT LAST 
     END IF 
     i% = 0
     j% = RECCOUNT ("maadr")
     WHILE NOT EOF ("maadr")
       i% = i% + 1
 
       IF NOT EXISTS (codema.maadr,codema.mavorg) THEN 
         codema% = codema.maadr
         SELECT KEY VorgÑnger.maadr FILE "maadr" INDEX codema.maadr
         name$ = LTRIM$ (nachname.maadr)
         vorn$ = LTRIM$ (vorname.maadr)
         agn$ = Agenturnr.maadr

         SELECT KEY codema% FILE "maadr" INDEX codema.maadr
         BLANK FILE "mavorg"
         codekey.mavorg = SER ("mavorg",1)
         codema.mavorg = codema.maadr
         codevma.mavorg = VorgÑnger.maadr
         NameVMA.mavorg = name$
         VornameMA.mavorg = vorn$
         AgenturnrVMA.mavorg = agn$
         aktiviert.mavorg = "j"
         STORE FILE "mavorg"
       END IF 
       SET STATUS STR$ (i%) + " von " + STR$ (j%)
       SELECT NEXT FILE "maadr" INDEX codema.maadr
     WEND 
    REM END IF 
    CALL MASollBWS()
   END IF 
  END IF 
   CALL DFile(3,"AGDIR" + _fpw$)
   FILE "AGDIR"
   IF RECCOUNT ("AGDIR") < 2 THEN 
     FILE "maadr"
     INDEX codema.maadr
     SELECT LAST 
     l% = VAL (agenturnr.maadr)
     IF l% < RECCOUNT ("maadr") THEN l% = RECCOUNT ("maadr")
     SELECT KEY 0 LOCK FILE "AGDIR" INDEX codeagdir.agdir
     AGNummer.agdir = l%
     AnzahlAGs.agdir = RECCOUNT ("maadr")
     STORE FILE "AGDIR"
   END IF 

   CALL DFile(3,"FOERKOND" + _fpw$)
   FILE "FOERKOND"
   CALL FldAdd("VvonCodeMA","NUM;000000.",0)
   CALL FldAdd("VvonAgentur","TXT;70",0)
   CALL FldAdd("Agentur","TXT;70",1)
   CALL FldAdd("EUUmstellung","TXT;1",0)
   SAVE FILE "FOERKOND"
    
ProvStart3012991: 

   CALL Server("UPDFILE","KVERTRAG")
   CALL DFile(3,"KVERTRAG" + _fpw$)
   CALL DFile(3,"KVLEER" + _fpw$)
   CALL DFile(3,"HISTORY" + _fpw$)
   CALL DFile(3,"zeingan1" + _fpw$)
   ttestFeld% = 0
   ON ERROR GOTO tfe140320051
   ttestFeld$ = KuenCourt1.kvertrag
   ttestFeld% = 1
tfe140320051: 
   ON ERROR GOTO ErrorHandler


   IF EXISTS (_netpath$ + "provis\kvold.sbf") THEN DELETE (_netpath$ + "provis\kvold.*")
   IF EXISTS (_netpath$ + "provis\versich.sbf") AND GLundWrigg$ LIKE "TRUE" THEN 
     CALL DFile(3,"VERSICH" + _fpw$)
     FILE "VERSICH"
     INDEX versid.versich
     SELECT FIRST 
     i% = 0
     WHILE NOT EOF ("VERSICH") AND GIndNeu% = - 1
       i% = i% + 1
       SET STATUS STR$ (i%) + " VERTRéGE testen und Kennzeichen eintragen"
       SELECT FIRST FILE "KVERTRAG" INDEX lfdnr.kvertrag
       SELECT KEY versid.versich LOCK FILE "KVERTRAG" INDEX lfdnr.kvertrag
       cuvt% = lfdnr.kvertrag
         aender% = 0
         IF abruf.kvertrag = "j" THEN 
           UEBERWTXT.kvertrag = Risiko1.versich
           aender% = - 1
         END IF 
         IF branche.versich LIKE "KFZ" THEN 
           aender% = - 1
           ttt$ = Risiko1.versich
           Kennzeichen.kvertrag = LEFT$ (Risiko1.versich,15)
           QuickKennz.KVERTRAG = VSNRPack$(Kennzeichen.KVERTRAG)
           Fabrikat.kvertrag = LEFT$ (Risiko2.versich,20)
         END IF 
         IF aender% = - 1 THEN STORE FILE "kvertrag"
       UNLOCK CURRENT FILE "kvertrag"
       FILE "VERSICH"
       SELECT NEXT FILE "VERSICH" INDEX versid.versich
     WEND 
     DELETE _netpath$ + "provis\versich.*"
   END IF 
   lauf% = 0
lauf20062001002: 
   REM CALL Fehler("KVERTRAG","")
     ON ERROR GOTO kvn2207200401
     IF IIMSendDate.kvertrag <> "" THEN ggga$ = "a"
     NeuKVer% = - 1
     GOTO kvn2207200402
kvn2207200401: 
     ON ERROR GOTO ErrorHandler 
kvn2207200402: 
     ON ERROR GOTO ErrorHandler 
   IF lauf% = 0 THEN 
     FILE "KVERTRAG"
     IF NeuKVer% <> - 1 THEN 
       REM CALL StruDat("KVERTRAG")
     END IF 
     REM *********************************************************************************************************


     REM ************************************ verschÑrfte Reorganisation ******************
     REM CALL Fehler("","")
     REM REQUEST "Mîchten Sie die Vertragsdatei komplett neu aufbauen lassen?","(Achtung dieser Vorgang kann sehr lange dauern!",135,req%
     ON ERROR GOTO ErrorHandler
     CALL KVCheck(1)
     IF NeuKVer% = - 1 THEN 
       CLOSE FILE "KVERTRAG"
       dpfad$ = _netpath$ + "PROVIS\" + DATE$ ( TODAY ,"yymm0d")
       datnr$ = DATE$ ( TODAY ,"yymm0d")
       i% = 0
       ok% = 0
       WHILE ok% = 0
         i% = i% + 1
         IF i% > 99 THEN 
           ON ERROR GOTO karb3004982
           REMOVE DIRECTORY dpfad$ + "01"
karb3004982: 
           i% = 1
         END IF 
         ON ERROR GOTO karb3004981
         tpfad$ = dpfad$ + STR$ (i%,"00")
         MAKE DIRECTORY dpfad$ + STR$ (i%,"00")
         dpfad$ = dpfad$ + STR$ (i%,"00")
         ok% = - 1
karb3004981: 
         ON ERROR GOTO ErrorHandler
       WEND 
       textdo1$ = "Sicherungskopie befindet sich im Pfad: " + tpfad$
       REM CALL Fehler("Es wird jetzt eine Sicherungskopie der Vertragsdatei erstellt!",textdo1$)
       REQUEST "Sicherungskopie wird erstellt in",tpfad$,2
       ON ERROR GOTO krb600420011
       COPY _netpath$ + "PROVIS\KVERTRAG.*" TO dpfad$
       CALL DFile(3,"KVERTRAG" + _fpw$)
       CALL reorgkv(_ppath$,"KVERTRAG","KVOLD","KVLEER",dpfad$)
       GOTO krb600420012
krb600420011: 
       CALL Fehler ("Beim kopieren der Vertragsdatei ist ein Fehler aufgetreten!, deshalb wird der Komplettaufbau nicht durchgefÅhrt","")
krb600420012: 
       ON ERROR GOTO ErrorHandler
     END IF 
     REM CALL Fehler("Reorg KV","")
     FILE "KVERTRAG"
     INDEX lfdnr.KVERTRAG
     SELECT LAST 
     lfdnr% = lfdnr.KVERTRAG
     WHILE SER ("KVERTRAG",1) <= lfdnr%
     WEND 
     REM ********************Ende verschÑrfte Reorganisation ************************************************************** 


     REM**********************************************************************************************************
   END IF 
   IF lauf% = 1 THEN 
     FILE "KVLEER"
     IF GIndNeu% = - 1 THEN CALL StruDat("KVLEER")
   END IF 
   IF lauf% = 2 THEN 
     FILE "HISTORY"
     IF GIndNeu% = - 1 THEN CALL StruDat("HISTORY")
   END IF 
   CALL KVCheck(2)
 REM GOTO ProvStart3012992
   REM CALL Fehler("InHaus", FILE )
   ON ERROR GOTO w230820091
   datei1$ = FILE 
   inhaus% = inhaus.datei1$
   GOTO w230820092
w230820091: 
   CALL FldRen("CODeMV","InHaus","NUM;0.",1)
w230820092: 
   CALL FldAdd("KÅndigung","DAT;0d.mm.yyyy",0)
   CALL FldAdd("lfdnr","NUM;000000.",1)
   CALL FldAdd("CodeKU","NUM;000000.",1)
   CALL FldAdd("CodeMA","NUM;000000.",1)
   CALL FldAdd("CodeGE","NUM;000000.",1)
   CALL FldAdd("CodeVA","NUM;000000.",1)
   CALL FldAdd("Storno","NMI;0.",0)
   CALL FldAdd("VS_Dauer","NUM;99.00",0)
   CALL FldAdd("StornoAnteil","NUM;,999.99",0)
   CALL FldAdd("StornoBetrag","NUM;,99999999.00",0)
   CALL FldAdd("Beitrag","NUM;,9999999999.00",0)
   CALL FldAdd("VSumme","NUM;,9999999999.00",0)
   CALL FldAdd("StornoProv","TXT;1",0)
   CALL FldAdd("vorzeitig","TXT;1",0)
   CALL FldAdd("Provision","TXT;1",0)
   CALL FldAdd("énderung","TXT;1",0)
   CALL FldAdd("TZRate","NMI;999.",0)
   CALL FldAdd("letztePflege","DAT;0d.mm.yyyy",0)
   CALL FldAdd("ProviAb","DAT;0d.mm.yyyy",1)
   CALL FldAdd("VS_Beginn","DAT;0d.mm.yyyy",1)
   CALL FldAdd("CodeKO","NUM;000000.",0)
   CALL FldAdd("Volumen","NUM;,9999999.00",0)'                          ; WÑhrungsanzeige entfernt
   CALL FldAdd("Antragsdatum","DAT;0d.mm.yyyy",1)
   CALL FldAdd("Altvertrag","TXT;1",0)
   CALL FldAdd("Fremdvertrag","TXT;1",1)
   CALL FldAdd("gez_Abschlu·","TXT;1",0)
   CALL FldAdd("gez_Pauschale","TXT;1",0)
   CALL FldAdd("BeitrFreiheit","TXT;1",0)
   CALL FldAdd("BUZ_Beitragfrei","TXT;1",0)
   CALL FldAdd("Dynamik_HV","TXT;1",0)
   CALL FldAdd("Dynamik_TZV","TXT;1",0)
   CALL FldAdd("Dynamik_öZR","TXT;1",0)
   CALL FldAdd("Dynamik_BU","TXT;1",0)
   CALL FldAdd("Dynamik_UZV","TXT;1",0)
   CALL FldAdd("Tarif","TXT;50",0)
   CALL FldAdd("QTarif","TXT;80",1)
   CALL FldAdd("zvP1Geschlecht","TXT;1",0)
   CALL FldAdd("zvP2Geschlecht","TXT;1",0)
   CALL FldAdd("zvP3Geschlecht","TXT;1",0)
   CALL FldAdd("zvP4Geschlecht","TXT;1",0)
   CALL FldAdd("zvP5Geschlecht","TXT;1",0)

   CALL FldAdd("zvP1Name","TXT;50",0)
   CALL FldAdd("zvP2Name","TXT;50",0)
   CALL FldAdd("zvP3Name","TXT;50",0)
   CALL FldAdd("zvP4Name","TXT;50",0)
   CALL FldAdd("zvP5Name","TXT;50",0)
   CALL FldAdd("zvP6Name","TXT;50",0)
   CALL FldAdd("zvP1vName","TXT;50",0)
   CALL FldAdd("zvP2vName","TXT;50",0)
   CALL FldAdd("zvP3vName","TXT;50",0)
   CALL FldAdd("zvP4vName","TXT;50",0)
   CALL FldAdd("zvP5vName","TXT;50",0)
   CALL FldAdd("zvP6vName","TXT;50",0)

   CALL FldAdd("QzvP1Name","TXT;80",1)
   CALL FldAdd("QzvP2Name","TXT;80",1)
   CALL FldAdd("QzvP3Name","TXT;80",1)
   CALL FldAdd("QzvP4Name","TXT;80",1)
   CALL FldAdd("QzvP5Name","TXT;80",1)
   CALL FldAdd("QzvP6Name","TXT;80",1)
   CALL FldAdd("QzvP1vName","TXT;80",1)
   CALL FldAdd("QzvP2vName","TXT;80",1)
   CALL FldAdd("QzvP3vName","TXT;80",1)
   CALL FldAdd("QzvP4vName","TXT;80",1)
   CALL FldAdd("QzvP5vName","TXT;80",1)
   CALL FldAdd("QzvP6vName","TXT;80",1)

   CALL FldAdd("zvP1PLZ","TXT;10",0)
   CALL FldAdd("zvP2PLZ","TXT;10",0)
   CALL FldAdd("zvP3PLZ","TXT;10",0)
   CALL FldAdd("zvP4PLZ","TXT;10",0)
   CALL FldAdd("zvP5PLZ","TXT;10",0)
   CALL FldAdd("zvP6PLZ","TXT;10",0)
   CALL FldAdd("zvP1Ort","TXT;40",0)
   CALL FldAdd("zvP2Ort","TXT;40",0)
   CALL FldAdd("zvP3Ort","TXT;40",0)
   CALL FldAdd("zvP4Ort","TXT;40",0)
   CALL FldAdd("zvP5Ort","TXT;40",0)
   CALL FldAdd("zvP6Ort","TXT;40",0)
   CALL FldAdd("zvP1Strasse","TXT;40",0)
   CALL FldAdd("zvP2Strasse","TXT;40",0)
   CALL FldAdd("zvP3Strasse","TXT;40",0)
   CALL FldAdd("zvP4Strasse","TXT;40",0)
   CALL FldAdd("zvP5Strasse","TXT;40",0)
   CALL FldAdd("zvP6Strasse","TXT;40",0)
   CALL FldAdd("zvP1Geb","DAT;0d.mm.yyyy",0)
   CALL FldAdd("zvP2Geb","DAT;0d.mm.yyyy",0)
   CALL FldAdd("zvP3Geb","DAT;0d.mm.yyyy",0)
   CALL FldAdd("zvP4Geb","DAT;0d.mm.yyyy",0)
   CALL FldAdd("zvP5Geb","DAT;0d.mm.yyyy",0)
   CALL FldAdd("zvP6Geb","DAT;0d.mm.yyyy",0)
   CALL FldAdd("zvP6Geschlecht","TXT;1",0)
   CALL FldAdd("KVVollkosten","TXT;1",0)
   CALL FldAdd("KVRestkosten","TXT;1",0)
   CALL FldAdd("KVAmbulanteZV","TXT;1",0)
   CALL FldAdd("KVZahnZV","TXT;1",0)
   CALL FldAdd("KVStationÑrZV","TXT;1",0)
   CALL FldAdd("KVKrankenTG","TXT;1",0)
   CALL FldAdd("KVReise","TXT;1",0)
   CALL FldAdd("KVAllgemeineZV","TXT;1",0)
   CALL FldAdd("KVHausTG","TXT;1",0)
   CALL FldAdd("KVKurTG","TXT;1",0)
   CALL FldAdd("UVGruppe1","TXT;1",0)
   CALL FldAdd("UVGruppe2","TXT;1",0)
   CALL FldAdd("UVGruppe3","TXT;1",0)
   CALL FldAdd("UVGruppe4","TXT;1",0)
   CALL FldAdd("UVGruppe5","TXT;1",0)
   CALL FldAdd("Kennzeichen","TXT;15",0)
   CALL FldAdd("Fahrzeugart","NMI;9.",0)
   CALL FldAdd("Fabrikat","TXT;20",0)
   CALL FldAdd("Fahrgestell_Nr","TXT;25",0)
   CALL FldAdd("Typ_Nr","TXT;20",0)
   CALL FldAdd("Typklasse","TXT;3",0)
   CALL FldAdd("TypklasseHP","TXT;4",0)
   CALL FldAdd("FahrzeugstÑrke","NUM;,999999.000",0)
   CALL FldAdd("Verkehrsart","NMI;9.",0)
   CALL FldAdd("Erstzlassung","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Fahrzeugwert","NUM;,99999999.00",0)
   CALL FldAdd("Reg_Haftpflicht","TXT;7",0)
   CALL FldAdd("Reg_Teilkasko","TXT;4",0)
   CALL FldAdd("Reg_Vollkasko","TXT;4",0)
   CALL FldAdd("Haftpflicht","NMI;9.",0)
   CALL FldAdd("HaftpflT","TXT;7",0)
   CALL FldAdd("HaftpflichtDat","DAT;0d.mm.yyyy",0)
   CALL FldAdd("VK_Dat","DAT;0d.mm.yyyy",0)
   CALL FldAdd("FÑlligkeit","DAT;0d.mm.yyyy",0)
   CALL FldAdd("KFZ_DeckUnfDat","DAT;0d.mm.yyyy",0)
   CALL FldAdd("KFZ_UnfJBeitr","Num;99999999.00",0)
   CALL FldAdd("KFZ_UTod","Num;,99999999.00",0)
   CALL FldAdd("KFZ_UInv","Num;,99999999.00",0)
   CALL FldAdd("KFZ_UHeilk","Num;,99999999.00",0)
   CALL FldAdd("KFZ_UTage","Num;,99999999.00",0)
   CALL FldAdd("KFZ_KTageGe","Num;,99999999.00",0)
   CALL FldAdd("KFZ_Wegfahr","TXT;1",0)
   CALL FldAdd("KFZ_WKZ","TXT;5",1)
   CALL FldAdd("KFZ_Wenig","TXT;1",0)
   CALL FldAdd("KFZ_Einzel","TXT;1",0)
   CALL FldAdd("KFZ_Garage","TXT;1",0)
   CALL FldAdd("KFZ_Schutz","TXT;1",0)
   CALL FldAdd("KFZ_Superkasko","TXT;1",0)
   CALL FldAdd("KFZ_Leasing","TXT;3",0)
   CALL FldAdd("KFZ_LAST","TXT;1",0)
   CALL FldAdd("KFZ_TK","TXT;1",0)
   CALL FldAdd("KFZ_VK","TXT;1",0)
   CALL FldAdd("KFZ_Unfall","TXT;1",0)
   CALL FldAdd("KFZ_UnfDeck","TXT;5",0)
   CALL FldAdd("KFZ_Nachl","TXT;1",0)
   CALL FldAdd("KFZ_Zuschl","TXT;1",0)
   CALL FldAdd("KFZ_ZuKH","Num;99.00",0)
   CALL FldAdd("KFZ_ZuVK","Num;99.00",0)
   CALL FldAdd("KFZ_ZuTK","Num;99.00",0)
   CALL FldAdd("KFZ_NaKH","Num;99.00",0)
   CALL FldAdd("KFZ_NaVK","Num;99.00",0)
   CALL FldAdd("KFZ_NaTK","Num;99.00",0)
   CALL FldAdd("KFZ_sDat1","DAT;0d.mm.yyyy",0)
   CALL FldAdd("KFZ_sDat2","DAT;0d.mm.yyyy",0)
   CALL FldAdd("KFZ_sDat3","DAT;0d.mm.yyyy",0)
   CALL FldAdd("KFZ_sDat4","DAT;0d.mm.yyyy",0)
   CALL FldAdd("KFZ_sDat5","DAT;0d.mm.yyyy",0)
   CALL FldAdd("KFZ_sDat6","DAT;0d.mm.yyyy",0)
   CALL FldAdd("KFZ_sDat7","DAT;0d.mm.yyyy",0)
   CALL FldAdd("KFZ_sDat8","DAT;0d.mm.yyyy",0)
   CALL FldAdd("KFZ_sDat9","DAT;0d.mm.yyyy",0)
   CALL FldAdd("KFZ_sDat10","DAT;0d.mm.yyyy",0)
   CALL FldAdd("KFZ_sa1","TXT;50",0)
   CALL FldAdd("KFZ_sa2","TXT;50",0)
   CALL FldAdd("KFZ_sa3","TXT;50",0)
   CALL FldAdd("KFZ_sa4","TXT;50",0)
   CALL FldAdd("KFZ_sa5","TXT;50",0)
   CALL FldAdd("KFZ_sa6","TXT;50",0)
   CALL FldAdd("KFZ_sa7","TXT;50",0)
   CALL FldAdd("KFZ_sa8","TXT;50",0)
   CALL FldAdd("KFZ_sa9","TXT;50",0)
   CALL FldAdd("KFZ_sa10","TXT;50",0)
 
   CALL FldAdd("KFZ_VSBH","Num;,99999999.00",0)
   CALL FldAdd("KFZ_VSBK","Num;,99999999.00",0)
   CALL FldAdd("KFZ_VSBU","Num;,99999999.00",0)
   CALL FldAdd("KFZ_BTGES","Num;,99999999.00",0)
 
   CALL FldAdd("KFZ_Halter","TXT;1",0)
   CALL FldAdd("KFZ_ZULADR","TXT;1",0)
   CALL FldAdd("KFZ_SBRIEF","TXT;1",0)
   CALL FldAdd("KFZ_TGRPTEIL","TXT;7",0)
   CALL FldAdd("KFZ_Benutzer","TXT;20",0)
   CALL FldAdd("KFZ_StandOrt","TXT;30",0)
   CALL FldAdd("KFZ_kmJahr","Num;,999999.",0)
   CALL FldAdd("KFZ_ArtNutzung","TXT;10",0)
   CALL FldAdd("KFZ_FamRabatt","TXT;10",0)
   CALL FldAdd("KFZ_Tarifgruppe","TXT;10",0)
   CALL FldAdd("KFZ_AlterFahrer","Num;,999.",0)
   CALL FldAdd("KFZ_FScheinseit","DAT;0d.mm.yyyy",0)
   CALL FldAdd("KFZ_FNummer","TXT;20",0)

   CALL FldAdd("HV_SFR","NUM;999.",0)
   CALL FldAdd("HV_SFRVJ","NUM;999.",0)
   CALL FldAdd("Unf_SFR","NUM;999.",0)
   CALL FldAdd("Unf_SFRVJ","NUM;999.",0)
   CALL FldAdd("Teilkasko","NMI;9.",0)
   CALL FldAdd("TK_Betrag","NUM;,99999999.00",0)
   CALL FldAdd("Vollkasko","NMI;9.",0)
   CALL FldAdd("VK_Betrag","NUM;,99999999.00",0)
   CALL FldAdd("VK_SFR","NUM;999.",0)
   CALL FldAdd("VK_SFRVJ","NUM;999.",0)
   REM 210597
   CALL FldAdd("KFZRegionZo","TXT;20",0)
   CALL FldAdd("TypklasseVK","TXT;3",0)
   CALL FldAdd("KFZSufe1","TXT;5",0)
   CALL FldAdd("KFZSufe2","TXT;5",0)
   CALL FldAdd("KFZSufe1VJ","TXT;5",0)
   CALL FldAdd("KFZSufe2VJ","TXT;5",0)
 
   CALL FldAdd("Basisinvalid","NUM;,99999999.00",0)
   CALL FldAdd("Progression1","NUM;999.00",0)
   CALL FldAdd("Progression2","NUM;999.00",0)
   CALL FldAdd("Todesfall","NUM;,99999999.00",0)
   CALL FldAdd("KHT","NUM;,99999999.00",0)
   CALL FldAdd("Genesungsgeld","NUM;,99999999.00",0)
   CALL FldAdd("öbergangsleist","NUM;,99999999.00",0)
   CALL FldAdd("Chir_Leist","NUM;,99999999.00",0)
   CALL FldAdd("Unfallrente","NUM;,99999999.00",0)
   CALL FldAdd("Unfall_KHT","NUM;,99999999.00",0)
   CALL FldAdd("Bewertungssumme","NUM;,999999999999.00",0)
   CALL FldAdd("VSumme","NUM;,999999999999.00",0)
   REM GebÑude
   CALL FldAdd("Risiko","TXT;1000R",0)
   CALL FldAdd("F_VSjn","TXT;1",0)
   CALL FldAdd("F_VS","NUM;,99999999.00;",0)
   CALL FldAdd("F_Satz","NUM;,9999.000",0)
   CALL FldAdd("F_Beitrag","NUM;,99999999.00",0)
   CALL FldAdd("FKBU_VSjn","TXT;1",0)
   CALL FldAdd("FKBU_VS","NUM;,99999999.00",0)
   CALL FldAdd("FKBU_Satz","NUM;,9999.000",0)
   CALL FldAdd("FKBU_Beitrag","NUM;,99999999.00",0)
   CALL FldAdd("LW_VSjn","TXT;1",0)
   CALL FldAdd("LW_VS","NUM;,99999999.00",0)
   CALL FldAdd("LW_Satz","NUM;,9999.000",0)
   CALL FldAdd("LW_Beitrag","NUM;,99999999.00",0)
   CALL FldAdd("LWKBU_VSjn","TXT;1",0)
   CALL FldAdd("LWKBU_VS","NUM;,99999999.00",0)
   CALL FldAdd("LWKBU_Satz","NUM;,9999.000",0)
   CALL FldAdd("LWKBU_Beitrag","NUM;,99999999.00",0)
   CALL FldAdd("ST_VSjn","TXT;1",0)
   CALL FldAdd("ST_VS","NUM;,99999999.00",0)
   CALL FldAdd("ST_Satz","NUM;,9999.000",0)
   CALL FldAdd("ST_Beitrag","NUM;,99999999.00",0)
   CALL FldAdd("STKBU_VSjn","TXT;1",0)
   CALL FldAdd("STKBU_VS","NUM;,99999999.00",0)
   CALL FldAdd("STKBU_Satz","NUM;,9999.000",0)
   CALL FldAdd("STKBU_Beitrag","NUM;,99999999.00",0)
   CALL FldAdd("ED_VSjn","TXT;1",0)
   CALL FldAdd("ED_VS","NUM;,99999999.00",0)
   CALL FldAdd("ED_Satz","NUM;,9999.000",0)
   CALL FldAdd("ED_Beitrag","NUM;,99999999.00",0)
   CALL FldAdd("EDVANDA_VSjn","TXT;1",0)
   CALL FldAdd("EDVANDA_VS","NUM;,99999999.00",0)
   CALL FldAdd("EDVANDA_Satz","NUM;,9999.000",0)
   CALL FldAdd("EDVANDA_Beitrag","NUM;,99999999.00",0)
   CALL FldAdd("EDKBU_VSjn","TXT;1",0)
   CALL FldAdd("EDKBU_VS","NUM;,99999999.00",0)
   CALL FldAdd("EDKBU_Satz","NUM;,9999.000",0)
   CALL FldAdd("EDKBU_Beitrag","NUM;,99999999.00",0)
   CALL FldAdd("Gesamtbeitrag","NUM;,999999999999.00",0)
   CALL FldAdd("BesVereinbarung","TXT;4000R",0)
   CALL FldAdd("Bedingungen","TXT;4000 R",0)
   CALL FldAdd("SB_Vereinbarung","TXT;400 R",0)
   CALL FldAdd("GEFH","TXT;1",0)
   CALL FldAdd("GMFH","TXT;1",0)
   CALL FldAdd("GRH","TXT;1",0)
   CALL FldAdd("GBAAK","TXT;10",0)
   CALL FldAdd("GBaujahr","NUM;0000.",0)
   CALL FldAdd("GNeuwert","TXT;1",0)
   CALL FldAdd("GGleitNeuwert","TXT;1",0)
   CALL FldAdd("GZeitwert","TXT;1",0)
   CALL FldAdd("GAlleGefahren","TXT;1",0)
   CALL FldAdd("GAlleGefWert","NUM;,9999999999",0)
   CALL FldAdd("GAlleGeSatz","NUM;,9999.000",0)
   CALL FldAdd("GAlleGeBeitr","NUM;,9999999999.00",0)
   CALL FldAdd("GSelbstbet","NUM;,9999999999.00",0)
   CALL FldAdd("GGewerbeanteil","NUM;999.000",0)
   CALL FldAdd("GGefaherhoehung","TXT;400 R",0)
   CALL FldAdd("GUnterversverz","TXT;1",0)
   CALL FldAdd("GNutzwaerm","TXT;1",0)
   CALL FldAdd("GWaermepump","TXT;1",0)
   CALL FldAdd("GSchwimmbad","TXT;1",0)
   CALL FldAdd("GUeberspann","TXT;1",0)
   CALL FldAdd("GUeberspProz","NUM;999.000",0)
   CALL FldAdd("GFussbodenheiz","TXT;1",0)
   CALL FldAdd("GFussbodProz","NUM;999.000",0)
   CALL FldAdd("GAbbrucharb","TXT;1",0)
   CALL FldAdd("GAbbruchProz","NUM;999.000",0)
 
 
 
 
 
   CALL FldAdd("Deckung_Pers","NUM;,999999999.00",0)
   CALL FldAdd("Deckung_Sach","NUM;,999999999.00",0)
   CALL FldAdd("Deckung_Verm","NUM;,999999999.00",0)
   CALL FldAdd("TÑtigk_SchÑden","NUM;,999999999.00",0)
   CALL FldAdd("TÑtigk_SBBetrag","NUM;,999999.00",0)
   CALL FldAdd("TÑtigk_SBSatz","NUM;99.99",0)
   CALL FldAdd("Ums_Betrag","NUM;,999999999.00",0)
   CALL FldAdd("Ums_Satz","NUM;,9999.000",0)
   CALL FldAdd("Ums_Beitrag","NUM;,999999999.00",0)
   CALL FldAdd("Lîhne_Betrag","NUM;,999999999.00",0)
   CALL FldAdd("Lîhne_Satz","NUM;,9999.",0)
   CALL FldAdd("Lîhne_Beitrag","NUM;,999999999.00",0)
   CALL FldAdd("Gehalt_Betrag","NUM;,999999999.00",0)
   CALL FldAdd("Gehalt_Satz","NUM;,9999.",0)
   CALL FldAdd("Gehalt_Beitrag","NUM;,999999999.00",0)
   CALL FldAdd("PersB_Betrag","NUM;,999999999.00",0)
   CALL FldAdd("PersB_Satz","NUM;,9999.",0)
   CALL FldAdd("PersB_Beitrag","NUM;,999999999.00",0)
   CALL FldAdd("PersBa_Betrag","NUM;,999999999.00",0)
   CALL FldAdd("PersBa_Satz","NUM;,9999.",0)
   CALL FldAdd("PersBa_Beitrag","NUM;,999999999.00",0)
   CALL FldAdd("Gesamt_Beitrag","NUM;,999999999.00",0)
   CALL FldAdd("QuickVSNR","TXT;60",1)
   CALL FldAdd("VS_Nr","TXT;30",1)
   CALL FldAdd("VTNext","NUM;000000.",1)
   CALL FldAdd("VTPrev","NUM;000000.",1)
   CALL FldAdd("Pool","NUM;,99999999.00",0)
   CALL FldAdd("Todesvollmacht","TXT;60",0)
   CALL FldAdd("Beitragssatz","NUM;999.00",0)
   CALL FldAdd("Eintrittsalter","NUM;999",0)
   CALL FldAdd("WohnflÑche","NUM;999.99",0)
   CALL FldAdd("BZDauer","NUM;999",0)
   CALL FldAdd("Leistungsdauer","NUM;999",0)
   CALL FldAdd("Deckung","TXT;60",0)
   CALL FldAdd("VSArt","TXT;30",0)
   CALL FldAdd("Fondname","TXT;50",0)
   CALL FldAdd("Fondgattung","TXT;50",0)
   CALL FldAdd("Fremdvertrag","TXT;1",1)
   CALL FldAdd("Check","TXT;1",0)
   CALL FldAdd("Mahnung","TXT;1",0)
 
   CALL FldAdd("Vollinvalid","NUM;,99999999.00",0)
   CALL FldAdd("Vollinvalid1","NUM;,99999999.00",0)
   CALL FldAdd("Vollinvalid2","NUM;,99999999.00",0)
   CALL FldAdd("Vollinvalid3","NUM;,99999999.00",0)
   CALL FldAdd("Vollinvalid4","NUM;,99999999.00",0)
   CALL FldAdd("Vollinvalid5","NUM;,99999999.00",0)
   CALL FldAdd("Vollinvalid6","NUM;,99999999.00",0)
   CALL FldAdd("Basisinvalid1","NUM;,99999999.00",0)
   CALL FldAdd("Basisinvalid2","NUM;,99999999.00",0)
   CALL FldAdd("Basisinvalid3","NUM;,99999999.00",0)
   CALL FldAdd("Basisinvalid4","NUM;,99999999.00",0)
   CALL FldAdd("Basisinvalid5","NUM;,99999999.00",0)
   CALL FldAdd("Basisinvalid6","NUM;,99999999.00",0)
   CALL FldAdd("Progression1_1","NUM;,99999999.00",0)
   CALL FldAdd("Progression1_2","NUM;,99999999.00",0)
   CALL FldAdd("Progression1_3","NUM;,99999999.00",0)
   CALL FldAdd("Progression1_4","NUM;,99999999.00",0)
   CALL FldAdd("Progression1_5","NUM;,99999999.00",0)
   CALL FldAdd("Progression1_6","NUM;,99999999.00",0)
   CALL FldAdd("Progression2_1","NUM;,99999999.00",0)
   CALL FldAdd("Progression2_2","NUM;,99999999.00",0)
   CALL FldAdd("Progression2_3","NUM;,99999999.00",0)
   CALL FldAdd("Progression2_4","NUM;,99999999.00",0)
   CALL FldAdd("Progression2_5","NUM;,99999999.00",0)
   CALL FldAdd("Progression2_6","NUM;,99999999.00",0)
   CALL FldAdd("Todesfall1","NUM;,99999999.00",0)
   CALL FldAdd("Todesfall2","NUM;,99999999.00",0)
   CALL FldAdd("Todesfall3","NUM;,99999999.00",0)
   CALL FldAdd("Todesfall4","NUM;,99999999.00",0)
   CALL FldAdd("Todesfall5","NUM;,99999999.00",0)
   CALL FldAdd("Todesfall6","NUM;,99999999.00",0)
   CALL FldAdd("KHT1","NUM;,99999999.00",0)
   CALL FldAdd("KHT2","NUM;,99999999.00",0)
   CALL FldAdd("KHT3","NUM;,99999999.00",0)
   CALL FldAdd("KHT4","NUM;,99999999.00",0)
   CALL FldAdd("KHT5","NUM;,99999999.00",0)
   CALL FldAdd("KHT6","NUM;,99999999.00",0)
   CALL FldAdd("Genesungsgeld1","NUM;,99999999.00",0)
   CALL FldAdd("Genesungsgeld2","NUM;,99999999.00",0)
   CALL FldAdd("Genesungsgeld3","NUM;,99999999.00",0)
   CALL FldAdd("Genesungsgeld4","NUM;,99999999.00",0)
   CALL FldAdd("Genesungsgeld5","NUM;,99999999.00",0)
   CALL FldAdd("Genesungsgeld6","NUM;,99999999.00",0)
   CALL FldAdd("öbergangsleist1","NUM;,99999999.00",0)
   CALL FldAdd("öbergangsleist2","NUM;,99999999.00",0)
   CALL FldAdd("öbergangsleist3","NUM;,99999999.00",0)
   CALL FldAdd("öbergangsleist4","NUM;,99999999.00",0)
   CALL FldAdd("öbergangsleist5","NUM;,99999999.00",0)
   CALL FldAdd("öbergangsleist6","NUM;,99999999.00",0)
   CALL FldAdd("Chir_Leist1","NUM;,99999999.00",0)
   CALL FldAdd("Chir_Leist2","NUM;,99999999.00",0)
   CALL FldAdd("Chir_Leist3","NUM;,99999999.00",0)
   CALL FldAdd("Chir_Leist4","NUM;,99999999.00",0)
   CALL FldAdd("Chir_Leist5","NUM;,99999999.00",0)
   CALL FldAdd("Chir_Leist6","NUM;,99999999.00",0)
   CALL FldAdd("Unfallrente1","NUM;,99999999.00",0)
   CALL FldAdd("Unfallrente2","NUM;,99999999.00",0)
   CALL FldAdd("Unfallrente3","NUM;,99999999.00",0)
   CALL FldAdd("Unfallrente4","NUM;,99999999.00",0)
   CALL FldAdd("Unfallrente5","NUM;,99999999.00",0)
   CALL FldAdd("Unfallrente6","NUM;,99999999.00",0)
   CALL FldAdd("QuickKennz","TXT;30",1)
   CALL FldAdd("Kartenwert","NUM;,99999.00",0)
   CALL FldAdd("CodeGrSp","NUM;000000.",1)
   CALL FldAdd("Kartenanzahl","NUM;,999999.",0)
   REM Leben
   CALL FldAdd("BURenteJahr","TXT;20",0)
   CALL FldAdd("BURenteMonat","NUM;,999999999.00",0)
   CALL FldAdd("PflegeDM","NUM;,999999999.00",0)
   CALL FldAdd("PflegeProz","NUM;,99999.000",0)
   REM Unfall
   CALL FldAdd("KuGliedertaxe","TXT;1",0)
   CALL FldAdd("zvp1Gliedertaxe","TXT;1",0)
   CALL FldAdd("zvp2Gliedertaxe","TXT;1",0)
   CALL FldAdd("zvp3Gliedertaxe","TXT;1",0)
   CALL FldAdd("zvp4Gliedertaxe","TXT;1",0)
   CALL FldAdd("zvp5Gliedertaxe","TXT;1",0)
   CALL FldAdd("zvp6Gliedertaxe","TXT;1",0)
   CALL FldAdd("UNFBergung1","NUM;,999999999.00",0)
   CALL FldAdd("UNFBergung2","NUM;,999999999.00",0)
   CALL FldAdd("UNFBergung3","NUM;,999999999.00",0)
   CALL FldAdd("UNFBergung4","NUM;,999999999.00",0)
   CALL FldAdd("UNFBergung5","NUM;,999999999.00",0)
   CALL FldAdd("UNFBergung6","NUM;,999999999.00",0)
   CALL FldAdd("UNFKurBH1","NUM;,999999999.00",0)
   CALL FldAdd("UNFKurBH2","NUM;,999999999.00",0)
   CALL FldAdd("UNFKurBH3","NUM;,999999999.00",0)
   CALL FldAdd("UNFKurBH4","NUM;,999999999.00",0)
   CALL FldAdd("UNFKurBH5","NUM;,999999999.00",0)
   CALL FldAdd("UNFKurBH6","NUM;,999999999.00",0)
   CALL FldAdd("UNFsonAs1","NUM;,999999999.00",0)
   CALL FldAdd("UNFsonAs2","NUM;,999999999.00",0)
   CALL FldAdd("UNFsonAs3","NUM;,999999999.00",0)
   CALL FldAdd("UNFsonAs4","NUM;,999999999.00",0)
   CALL FldAdd("UNFsonAs5","NUM;,999999999.00",0)
   CALL FldAdd("UNFsonAs6","NUM;,999999999.00",0)
   REM Krankenversicherung
   CALL FldAdd("KAmbulant","TXT;1",0)
   CALL FldAdd("zvp1Ambulant","TXT;1",0)
   CALL FldAdd("zvp2Ambulant","TXT;1",0)
   CALL FldAdd("zvp3Ambulant","TXT;1",0)
   CALL FldAdd("zvp4Ambulant","TXT;1",0)
   CALL FldAdd("zvp5Ambulant","TXT;1",0)
   CALL FldAdd("zvp6Ambulant","TXT;1",0)
   CALL FldAdd("Kstation","TXT;1",0)
   CALL FldAdd("zvp1station","TXT;1",0)
   CALL FldAdd("zvp2station","TXT;1",0)
   CALL FldAdd("zvp3station","TXT;1",0)
   CALL FldAdd("zvp4station","TXT;1",0)
   CALL FldAdd("zvp5station","TXT;1",0)
   CALL FldAdd("zvp6station","TXT;1",0)
   CALL FldAdd("KZahn","TXT;1",0)
   CALL FldAdd("zvp1Zahn","TXT;1",0)
   CALL FldAdd("zvp2Zahn","TXT;1",0)
   CALL FldAdd("zvp3Zahn","TXT;1",0)
   CALL FldAdd("zvp4Zahn","TXT;1",0)
   CALL FldAdd("zvp5Zahn","TXT;1",0)
   CALL FldAdd("zvp6Zahn","TXT;1",0)
   CALL FldAdd("KZers","TXT;1",0)
   CALL FldAdd("zvp1Zers","TXT;1",0)
   CALL FldAdd("zvp2Zers","TXT;1",0)
   CALL FldAdd("zvp3Zers","TXT;1",0)
   CALL FldAdd("zvp4Zers","TXT;1",0)
   CALL FldAdd("zvp5Zers","TXT;1",0)
   CALL FldAdd("zvp6Zers","TXT;1",0)
   CALL FldAdd("KuKHG","TXT;1",0)
   CALL FldAdd("zvp1KHG","TXT;1",0)
   CALL FldAdd("zvp2KHG","TXT;1",0)
   CALL FldAdd("zvp3KHG","TXT;1",0)
   CALL FldAdd("zvp4KHG","TXT;1",0)
   CALL FldAdd("zvp5KHG","TXT;1",0)
   CALL FldAdd("zvp6KHG","TXT;1",0)
   CALL FldAdd("KuKTG","TXT;1",0)
   CALL FldAdd("zvp1KTG","TXT;1",0)
   CALL FldAdd("zvp2KTG","TXT;1",0)
   CALL FldAdd("zvp3KTG","TXT;1",0)
   CALL FldAdd("zvp4KTG","TXT;1",0)
   CALL FldAdd("zvp5KTG","TXT;1",0)
   CALL FldAdd("zvp6KTG","TXT;1",0)
   CALL FldAdd("KuPV","TXT;1",0)
   CALL FldAdd("zvp1PV","TXT;1",0)
   CALL FldAdd("zvp2PV","TXT;1",0)
   CALL FldAdd("zvp3PV","TXT;1",0)
   CALL FldAdd("zvp4PV","TXT;1",0)
   CALL FldAdd("zvp5PV","TXT;1",0)
   CALL FldAdd("zvp6PV","TXT;1",0)
   CALL FldAdd("KuPTG","TXT;1",0)
   CALL FldAdd("zvp1PTG","TXT;1",0)
   CALL FldAdd("zvp2PTG","TXT;1",0)
   CALL FldAdd("zvp3PTG","TXT;1",0)
   CALL FldAdd("zvp4PTG","TXT;1",0)
   CALL FldAdd("zvp5PTG","TXT;1",0)
   CALL FldAdd("zvp6PTG","TXT;1",0)
   CALL FldAdd("KuZusVers","TXT;1",0)
   CALL FldAdd("zvp1ZusVers","TXT;1",0)
   CALL FldAdd("zvp2ZusVers","TXT;1",0)
   CALL FldAdd("zvp3ZusVers","TXT;1",0)
   CALL FldAdd("zvp4ZusVers","TXT;1",0)
   CALL FldAdd("zvp5ZusVers","TXT;1",0)
   CALL FldAdd("zvp6ZusVers","TXT;1",0)
   CALL FldAdd("KuReise","TXT;1",0)
   CALL FldAdd("zvp1Reise","TXT;1",0)
   CALL FldAdd("zvp2Reise","TXT;1",0)
   CALL FldAdd("zvp3Reise","TXT;1",0)
   CALL FldAdd("zvp4Reise","TXT;1",0)
   CALL FldAdd("zvp5Reise","TXT;1",0)
   CALL FldAdd("zvp6Reise","TXT;1",0)
   CALL FldAdd("KuBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("zvp1Beitrag","NUM;,999999999.00",0)
   CALL FldAdd("zvp2Beitrag","NUM;,999999999.00",0)
   CALL FldAdd("zvp3Beitrag","NUM;,999999999.00",0)
   CALL FldAdd("zvp4Beitrag","NUM;,999999999.00",0)
   CALL FldAdd("zvp5Beitrag","NUM;,999999999.00",0)
   CALL FldAdd("zvp6Beitrag","NUM;,999999999.00",0)
   CALL FldAdd("SummeBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("KVNotiz1","TXT;4000 R",0)
   CALL FldAdd("KVNotiz2","TXT;4000 R",0)
   CALL FldAdd("KVNotiz3","TXT;4000 R",0)
   CALL FldAdd("KVNotiz4","TXT;4000 R",0)
   CALL FldAdd("KVNotiz5","TXT;4000 R",0)
   CALL FldAdd("KVNotiz6","TXT;4000 R",0)
   REM Inventar Praxis
   CALL FldAdd("IVSu","NUM;,999999999.00",0)
   CALL FldAdd("IVSB","NUM;,999999999.00",0)
   CALL FldAdd("IVSatz","NUM;,99999999.000",0)
   CALL FldAdd("IVBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("KBUSu","NUM;,999999999.00",0)
   CALL FldAdd("KBUSB","NUM;,999999999.00",0)
   CALL FldAdd("KBUSatz","NUM;,99999999.000",0)
   CALL FldAdd("KBUBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("GLESu","NUM;,999999999.00",0)
   CALL FldAdd("GLESB","NUM;,999999999.00",0)
   CALL FldAdd("GLESatz","NUM;,99999999.000",0)
   CALL FldAdd("GLEBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("GLPSu","NUM;,999999999.00",0)
   CALL FldAdd("GLPSB","NUM;,999999999.00",0)
   CALL FldAdd("GLPSatz","NUM;,99999999.000",0)
   CALL FldAdd("GLPBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("ELSu","NUM;,999999999.00",0)
   CALL FldAdd("ELSB","NUM;,999999999.00",0)
   CALL FldAdd("ELSatz","NUM;,99999999.000",0)
   CALL FldAdd("ELBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("BEWSu","NUM;,999999999.00",0)
   CALL FldAdd("BEWSB","NUM;,999999999.00",0)
   CALL FldAdd("BEWSatz","NUM;,99999999.000",0)
   CALL FldAdd("BEWBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("IVPRabatt","NUM;,99999999.000",0)
   CALL FldAdd("IVPSumme","NUM;,999999999.00",0)
   REM Berufshaftpflicht
   CALL FldAdd("BHBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("BEHZusRisiko","NUM;,999999999.00",0)
   CALL FldAdd("BEHRabatt","NUM;,99999999.000",0)
   CALL FldAdd("BEHPHV","NUM;,999999999.00",0)
   CALL FldAdd("BEHSumme","NUM;,999999999.00",0)
   REM Rechtsschutz
   CALL FldAdd("RSPrivatjn","TXT;1",0)
   CALL FldAdd("RSPrivatSB","NUM;,999999999.00",0)
   CALL FldAdd("RSPrivatBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("RSBerufjn","TXT;1",0)
   CALL FldAdd("RSBerufSB","NUM;,999999999.00",0)
   CALL FldAdd("RSBerufBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("RSVerkjn","TXT;1",0)
   CALL FldAdd("RSVerkSB","NUM;,999999999.00",0)
   CALL FldAdd("RSVerkBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("RSVertrjn","TXT;1",0)
   CALL FldAdd("RSVertrSB","NUM;,999999999.00",0)
   CALL FldAdd("RSVertrBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("RSRegrjn","TXT;1",0)
   CALL FldAdd("RSRegrSB","NUM;,999999999.00",0)
   CALL FldAdd("RSRegrBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("RSSpezijn","TXT;1",0)
   CALL FldAdd("RSSpeziSB","NUM;,999999999.00",0)
   CALL FldAdd("RSSpeziBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("RSWohnjn","TXT;1",0)
   CALL FldAdd("RSWohnSB","NUM;,999999999.00",0)
   CALL FldAdd("RSWohnBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("Rechtsumme","NUM;,999999999.00",0)
   REM Rechtsschutz2
   CALL FldAdd("RSRisiko","TXT;4000 R",0)
   CALL FldAdd("RSNichtSelbjn","TXT;1",0)
   CALL FldAdd("RSSelbstjn","TXT;1",0)
   CALL FldAdd("RSLandwirtjn","TXT;1",0)
   CALL FldAdd("RSArztjn","TXT;1",0)
   CALL FldAdd("RSSinglejn","TXT;1",0)
   CALL FldAdd("RSFamiliejn","TXT;1",0)
   CALL FldAdd("RSoeffDienstjn","TXT;1",0)
   CALL FldAdd("RSSeniorjn","TXT;1",0)
   CALL FldAdd("RSPriBerufjn","TXT;1",0)
   CALL FldAdd("RSPriBeVerjn","TXT;1",0)
   CALL FldAdd("RSSpezialjn","TXT;1",0)
   CALL FldAdd("RSSelbstBetjn","TXT;1",0)
   CALL FldAdd("RSSelbstDM","NUM;,999999999.",0)
   CALL FldAdd("RSDeckung","TXT;10",0)
   CALL FldAdd("RSStrafKautDM","NUM;,9999999999.",0)
   CALL FldAdd("RSNotiz","TXT;4000 R",0)
   REM Kapitalanlagen
   CALL FldAdd("BezFond1","TXT;20",0)
   CALL FldAdd("BezFond2","TXT;20",0)
   CALL FldAdd("BezFond3","TXT;20",0)
   CALL FldAdd("BezFond4","TXT;20",0)
   CALL FldAdd("BezFond5","TXT;20",0)
   CALL FldAdd("BezFond6","TXT;20",0)
   CALL FldAdd("BezIFond1","TXT;20",0)
   CALL FldAdd("BezIFond2","TXT;20",0)
   CALL FldAdd("BezIFond3","TXT;20",0)
   CALL FldAdd("BezIFond4","TXT;20",0)
   CALL FldAdd("BezIFond5","TXT;20",0)
   CALL FldAdd("BezIFond6","TXT;20",0)
   CALL FldAdd("AnlFond1","NUM;,99999999999999.",0)
   CALL FldAdd("AnlFond2","NUM;,99999999999999.",0)
   CALL FldAdd("AnlFond3","NUM;,99999999999999.",0)
   CALL FldAdd("AnlFond4","NUM;,99999999999999.",0)
   CALL FldAdd("AnlFond5","NUM;,99999999999999.",0)
   CALL FldAdd("AnlFond6","NUM;,99999999999999.",0)
   CALL FldAdd("AnliFond1","NUM;,99999999999999.",0)
   CALL FldAdd("AnliFond2","NUM;,99999999999999.",0)
   CALL FldAdd("AnliFond3","NUM;,99999999999999.",0)
   CALL FldAdd("AnliFond4","NUM;,99999999999999.",0)
   CALL FldAdd("AnliFond5","NUM;,99999999999999.",0)
   CALL FldAdd("AnliFond6","NUM;,99999999999999.",0)
   CALL FldAdd("SparFond1","NUM;,99999999999999.",0)
   CALL FldAdd("SparFond2","NUM;,99999999999999.",0)
   CALL FldAdd("SparFond3","NUM;,99999999999999.",0)
   CALL FldAdd("SparFond4","NUM;,99999999999999.",0)
   CALL FldAdd("SparFond5","NUM;,99999999999999.",0)
   CALL FldAdd("SparFond6","NUM;,99999999999999.",0)
   CALL FldAdd("SpariFond1","NUM;,99999999999999.",0)
   CALL FldAdd("SpariFond2","NUM;,99999999999999.",0)
   CALL FldAdd("SpariFond3","NUM;,99999999999999.",0)
   CALL FldAdd("SpariFond4","NUM;,99999999999999.",0)
   CALL FldAdd("SpariFond5","NUM;,99999999999999.",0)
   CALL FldAdd("SpariFond6","NUM;,99999999999999.",0)
   CALL FldAdd("EingFond1","DAT;0d.mm.yyyy",0)
   CALL FldAdd("EingFond2","DAT;0d.mm.yyyy",0)
   CALL FldAdd("EingFond3","DAT;0d.mm.yyyy",0)
   CALL FldAdd("EingFond4","DAT;0d.mm.yyyy",0)
   CALL FldAdd("EingFond5","DAT;0d.mm.yyyy",0)
   CALL FldAdd("EingFond6","DAT;0d.mm.yyyy",0)
   CALL FldAdd("EingiFond1","DAT;0d.mm.yyyy",0)
   CALL FldAdd("EingiFond2","DAT;0d.mm.yyyy",0)
   CALL FldAdd("EingiFond3","DAT;0d.mm.yyyy",0)
   CALL FldAdd("EingiFond4","DAT;0d.mm.yyyy",0)
   CALL FldAdd("EingiFond5","DAT;0d.mm.yyyy",0)
   CALL FldAdd("EingiFond6","DAT;0d.mm.yyyy",0)
   CALL FldAdd("NotizKapital","TXT;4000 R",0)
   CALL FldAdd("FondBest","NUM;,999999999999.00",0)
   CALL FldAdd("FondBestOld","NUM;,999999999999.00",0)
   REM Hausrat
   CALL FldAdd("HRSicherungsma","TXT;4000 R",0)
   CALL FldAdd("HRNutzwÑrme","TXT;1",0)
   CALL FldAdd("HRWertsachProz","NUM;,9999.0000",0)
   CALL FldAdd("HRVertragsinhal","TXT;4000R",0)
   CALL FldAdd("HRZuschlagfÅr","TXT;4000R",0)
   CALL FldAdd("HRUnterversVerz","TXT;1",0)
   CALL FldAdd("HRUnterdeckProz","NUM;,9999.0000",0)
   CALL FldAdd("HRöberspannProz","NUM;,9999.0000",0)
   CALL FldAdd("HRFahrdiebProz","NUM;,9999.000",0)
   CALL FldAdd("HRWohnflÑche","NUM;,99999.000",0)
   CALL FldAdd("HRTarifzone","TXT;20",0)
   CALL FldAdd("HRBauartklasse","TXT;20",0)
   CALL FldAdd("HRWohnungsart","TXT;20",0)
   CALL FldAdd("HRGewerbebetr","TXT;1",0)
   CALL FldAdd("HRZuschlagProz","NUM;,99999.0000",0)
   CALL FldAdd("AquariumJN","TXT;1",0)
   CALL FldAdd("FahrradDM","NUM;,999999.00",0)
   CALL FldAdd("VHB","TXT;20",0)
 
   REM Privathaftpflicht
   CALL FldAdd("PHVertragsinhal","TXT;4000R",0)
   CALL FldAdd("PHHaftft","TXT;1",0)
   CALL FldAdd("PHVermieterHaft","TXT;1",0)
   CALL FldAdd("PHDienst","TXT;1",0)
   CALL FldAdd("PHJagd","TXT;1",0)
   CALL FldAdd("PHBauherr","TXT;1",0)
   CALL FldAdd("PHBausumme","NUM;,99999999.",0)
   CALL FldAdd("PHEigenl","NUM;,99999999.",0)
   CALL FldAdd("PHGewaesser","TXT;1",0)
   CALL FldAdd("PH1Tank","TXT;1",0)
   CALL FldAdd("PH2Tank","TXT;1",0)
   CALL FldAdd("PH1Tankober","TXT;1",0)
   CALL FldAdd("PH1Tankunter","TXT;1",0)
   CALL FldAdd("PH2Tankober","TXT;1",0)
   CALL FldAdd("PH2Tankunter","TXT;1",0)
   CALL FldAdd("PH1TankLit","NUM;,9999999999.",0)
   CALL FldAdd("PH2TankLit","NUM;,9999999999.",0)
   CALL FldAdd("PHSingle","TXT;1",0)
   CALL FldAdd("PHFamilie","TXT;1",0)
   CALL FldAdd("PHNotiz","TXT;4000 R",0)
   CALL FldAdd("PHSelbst","TXT;1",0)
   CALL FldAdd("PHVSSSelbst","NUM;,9999999999.",0)
   CALL FldAdd("PHVSSMiet","NUM;,9999999999.",0)
 
   CALL FldAdd("PHArtLageGrunds","TXT;4000 R",0)
   CALL FldAdd("PHBrutJahrMiete","TXT;20",0)
   CALL FldAdd("PHAnzFerienwohn","TXT;20",0)
   CALL FldAdd("PHUnbebGrundst","TXT;20",0)
   CALL FldAdd("PHAnzEinliegWoh","TXT;20",0)
   CALL FldAdd("PHAnzEigtWohn","TXT;20",0)
   CALL FldAdd("PHVSPersonsch","TXT;20",0)
   CALL FldAdd("PHVSSachschad","TXT;20",0)
   CALL FldAdd("PHVSVermoegsch","TXT;20",0)
   CALL FldAdd("PHTierhalter","TXT;1",0)
   CALL FldAdd("PHAnzHunde","TXT;20",0)
   CALL FldAdd("PHAnzPferde","TXT;20",0)
   CALL FldAdd("PHAnzSonst1","TXT;4000 R",0)
 
   REM Glasbruch
   CALL FldAdd("GBVersObjekt","TXT;20",0)
   CALL FldAdd("GBVertragsinh","TXT;4000 R",0)
   CALL FldAdd("GBWohnflaeche","TXT;20",0)
   CALL FldAdd("GBRisiko","TXT;200 R",0)
   CALL FldAdd("GBNurMobiliar","TXT;1",0)
   CALL FldAdd("GBCeranfeld","TXT;1",0)
   CALL FldAdd("GBFeuerrisiko","TXT;1",0)
   CALL FldAdd("GBGlasflaeche","TXT;20",0)
   CALL FldAdd("GBAquariumLiter","TXT;20",0)
   CALL FldAdd("GBArt","NMI;9.",0)
   
   CALL FldAdd("QuickKUSpar","TXT;66",1)
   CALL FldAdd("QuickKUGEs","TXT;36",1)
   CALL FldAdd("QuickGEsSpar","TXT;96",1)
   CALL FldAdd("Gesellschaft","TXT;30",1)
   CALL FldAdd("Sparte","TXT;60",1)
   CALL FldAdd("QuickGesSpart","TXT;90",1)
   CALL FldAdd("Spartengruppe","TXT;60",1)
   CALL FldAdd("Agentur","TXT;30",1)
 
   CALL FldAdd("KFZHaftBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("KFZVollkBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("KFZTeilkBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("KFZGesBeitrag","NUM;,999999999.00",0)
   REM tatsÑchliches KÅndigungsdatum
   CALL FldAdd("TatsKuenDat","DAT;0d.mm.yyyy",0)
   REM Deckung
   CALL FldAdd("Deckung1","NUM;,99999999.00",0)
   CALL FldAdd("Deckung2","NUM;,99999999.00",0)
   CALL FldAdd("Deckung3","NUM;,99999999.00",0)
   CALL FldAdd("Deckung4","NUM;,99999999.00",0)
   CALL FldAdd("ExpAG","TXT;1",1)
   CALL FldAdd("VGezGesamtPlus","NUM;,999999999.00",0)
   CALL FldAdd("VGezGesamtMinus","NUM;,999999999.00",0)
   CALL FldAdd("VGezLetzt","DAT;0d.mm.yyyy",0)
   CALL FldAdd("ANachname","TXT;50",1)
   CALL FldAdd("AVorname","TXT;50",0)
   CALL FldAdd("AOrt","TXT;50",0)
   CALL FldAdd("AStrasse","TXT;50",0)
   CALL FldAdd("APLZ","TXT;15",0)
   CALL FldAdd("DynJN","TXT;1 U",1)
   CALL FldAdd("Umrechnung","NUM;,99999999.000000",0)
   CALL FldAdd("CodeW","NUM;000000.",1)
   CALL FldAdd("Waehrung","TXT;6",0)
   CALL FldAdd("WaehrungBezeich","TXT;30",0)
 
   REM Finanzierung
   CALL FldAdd("FDarlnehmer","TXT;50",0)
   CALL FldAdd("FObjekt","TXT;50",0)
   CALL FldAdd("FOrt","TXT;50",0)
   CALL FldAdd("FDarlNummer","TXT;50",0)
   CALL FldAdd("FEigmittel","NUM;,999999999.00",0)
   CALL FldAdd("FDarlBetrag","NUM;,999999999.00",0)
   CALL FldAdd("FDarlGeber","TXT;50",0)
   CALL FldAdd("FFestschreib","TXT;50",0)
   CALL FldAdd("FZinsNom","NUM;999.0000",0)
   CALL FldAdd("FZinsEff","NUM;999.0000",0)
   CALL FldAdd("FAblFestschr","TXT;10",0)
   CALL FldAdd("FPrlongAm","TXT;10",0)
   CALL FldAdd("FPrlongBis","TXT;10",0)
   CALL FldAdd("FBeitrag","NUM;,999999999.00",0)
   CALL FldAdd("FAuszahl","NUM;,999999999.00",0)
   CALL FldAdd("FZinsBind","NUM;00.",0)
   CALL FldAdd("FTilgung","NUM;,999999999.00",0)
   CALL FldAdd("FBeginnDarl","DAT;0d.mm.yyyy",0)
   CALL FldAdd("FLaufzeit","NUM;000.",0)
   CALL FldAdd("FAblaufDarl","DAT;0d.mm.yyyy",0)
   CALL FldAdd("FAntragVom","DAT;0d.mm.yyyy",0)
   CALL FldAdd("FWeitergabe","DAT;0d.mm.yyyy",0)
 
 
   REM fÅr GDV-Standard
   CALL FldAdd("gdvimp","NUM;0.",0)
   CALL FldAdd("KFZ_Genes","NUM;,99999999.00",0)
   CALL FldAdd("Risiko1","TXT;4000 R",0)
   CALL FldAdd("Risiko2","TXT;4000 R",0)
   CALL FldAdd("INKART","NMI;0",0)
 
   REM Bankverbindung
   CALL FldAdd("K1Bank","TXT;50",0)
   CALL FldAdd("K1BLZ","TXT;20",0)
   CALL FldAdd("K1Konto","TXT;17",0)
   CALL FldAdd("BeitrSum","NUM;,9999999999.00",0)
 
   REM Vertragsstatus
   CALL FldAdd("CodeVStatus","NUM;00.",1)
   CALL FldAdd("VStatusTxT","TXT;50",0)
   CALL FldAdd("GDVStatus","NUM;00.",1)
   CALL FldAdd("GDVStatusTxT","TXT;50",0)
   CALL FldAdd("Code200","NUM;000000.",1)
   REM 1=lebend
   REM 2=leben/kurzfristig/unterjÑhrig
   REM 3=ruhend/Anwartschaft
   REM 4=storniert
   REM 5=ruhend/beitragsfrei
   REM 6=beitragsfrei
   REM 7=beitragsfrei durch Leistung
   REM 8=Beitragsstundung
   REM 9=Sonstiges 
   REM 10=Altvertrag
   REM 11=Fremdvertrag
   REM 12=Antrag
   REM 13=storniert durch Dynamisierung
 
   REM Vertragsteilung
   CALL FldAdd("BKZ","NUM;0.",0):REM BÅndelungskennzeichen
   CALL FldAdd("lfdnrTotal","NUM;0000000000.",1)
   CALL FldAdd("HauptfÑlligkeit","NUM;00.",1)
   CALL FldAdd("VertragAktiv","TXT;1",1)
   CALL FldAdd("GDVNEU","DAT;0d.mm.yyyy",1)
   CALL FldAdd("GDVEDIT","DAT;0d.mm.yyyy",1)
   CALL FldAdd("letzteRechleg","DAT;0d.mm.yyyy",1)
   CALL FldAdd("lRlegOld","DAT;0d.mm.yyyy",0)
   REM QuickVIH=CodeVStatus+Vermittlerink+HauptfÑlligkeit
   CALL FldAdd("QuickVIH","TXT;5",1)
   CALL FldAdd("QuickVIK","TXT;3",1)
   CALL FldAdd("BewertEinm","NUM;,99999999.00",0)
   CALL FldAdd("BewertEinmDat","DAT;0d.mm.yyyy",0)
   CALL FldAdd("BewertcalcDat","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Dtaus","TXT;1",0)
   CALL FldAdd("CodeHist","NUM;000000.",1)
   CALL FldAdd("QHistCodeVT","TXT;12",1)
   CALL FldAdd("ErfasDatum","DAT;0d.mm.yyyy",1)
   CALL FldAdd("SummeAnteile","NUM;,9999999999.0000",0)
   CALL FldAdd("SummeEinzDM","NUM;,999999999999.00",0)
   CALL FldAdd("SummeEinzUS","NUM;,999999999999.00",0)
   CALL FldAdd("SummeEinzEur","NUM;,999999999999.00",0)
   CALL FldAdd("CodeVStatusOld","NUM;00.",1)
   CALL FldAdd("VStatusTxTOld","TXT;50",0)
   CALL FldAdd("CodeImportGDV","NUM;000000.",1)
   CALL FldAdd("Produkt","TXT;130",1)
   CALL FldAdd("SRHaftung","NUM;999.",0)
   CALL FldAdd("QuickGEVA","TXT;12",1)
   CALL FldAdd("NettoBeitrag","NUM;,999999999999.00",0)
   CALL FldAdd("MWST","NUM;999.00",0)
   CALL FldAdd("SpezProvAktiv","TXT;1",0)
   CALL FldAdd("CodeTarif","NUM;000000.",1)
   CALL FldAdd("TARIFFO","TXT;60",0)
   CALL FldAdd("Einheiten","NUM;,999999999.0000",0)
   CALL FldAdd("DBeitrZahlung","NUM;99.00",0)
   CALL FldAdd("CodeVP","NUM;000000.",1)
   CALL FldAdd("TarifFoAktiv","TXT;1",0)
   CALL FldAdd("ProdFOAktiv","TXT;1",0)
   CALL FldAdd("BewertCalcDaV","DAT;0d.mm.yyyy",0)
   CALL FldAdd("letzteProviV","DAT;0d.mm.yyyy",0)
   CALL FldAdd("TZRateV","NMI;999.",0)
   CALL FldAdd("gez_AbschluV","TXT;1",0)
   CALL FldAdd("gez_PauschalV","TXT;1",0)
   CALL FldAdd("letztePflegV","DAT;0d.mm.yyyy",0)
   CALL FldAdd("PoolV","NUM;,99999999.00",0)
   CALL FldAdd("MahnungV","TXT;1",0)
   CALL FldAdd("StatusZOK","TXT;10 U",0)
   CALL FldAdd("BDatumBerech","DAT;0d.mm.yyyy",0)
   CALL FldAdd("SummeEinzWaehr","NUM;+,999999999999.00",0)
   CALL FldAdd("BAnteilsprWaehr","NUM;+,9999999999.0000",0)
   CALL FldAdd("BAnteilsprDM","NUM;+,9999999999.0000",0)
   CALL FldAdd("BAnteilsprUS","NUM;+,9999999999.0000",0)
   CALL FldAdd("BAnteilsprEuro","NUM;+,9999999999.0000",0)
   CALL FldAdd("rzumon","NUM;999.0000",0)
   CALL FldAdd("rzuviert","NUM;999.0000",0)
   CALL FldAdd("rzuhalb","NUM;999.0000",0)
   CALL FldAdd("rzujÑhrl","NUM;999.0000",0)
   CALL FldAdd("rzueinmal","NUM;999.0000",0)
   CALL FldAdd("rzusonst","NUM;999.0000",0)
   CALL FldAdd("SummeBestWaehr","NUM;+,999999999999.00",0)
   CALL FldAdd("BRÅckkaufWaehr","NUM;+,9999999999.0000",0)
   CALL FldAdd("BRÅckkaufDM","NUM;+,9999999999.0000",0)
   CALL FldAdd("BRÅckkaufUS","NUM;+,9999999999.0000",0)
   CALL FldAdd("BRÅckkaufEuro","NUM;+,9999999999.0000",0)
   CALL FldAdd("BBestandDM","NUM;+,999999999999.00",0)
   CALL FldAdd("BBestandUS","NUM;+,999999999999.00",0)
   CALL FldAdd("BBestandEuro","NUM;+,999999999999.00",0)
   CALL FldAdd("BBestandWaehr","NUM;+,999999999999.00",0)
   CALL FldAdd("WinDok","TXT;256",0)
   CALL FldAdd("GefGr1","TXT;4",0)
   CALL FldAdd("GefGr2","TXT;4",0)
   CALL FldAdd("GefGr3","TXT;4",0)
   CALL FldAdd("GefGr4","TXT;4",0)
   CALL FldAdd("GefGr5","TXT;4",0)
   CALL FldAdd("GefGr6","TXT;4",0)

   REM *** Lund Wriggers *************************************
   CALL FldAdd("BeitrAnd","TXT;3",0)
   CALL FldAdd("EinzBeitrag","NUM;,999999999999.00",0)
   CALL FldAdd("Abgerufenam","DAT;0d.mm.yyyy",0)
   CALL FldAdd("letzteZahlung","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Abruf","TXT;1",0)
   CALL FldAdd("EinzAbruf","TXT;1",0)
   CALL FldAdd("Wiedervorlage","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Courtage","NUM;,999999999999.00",0)
   CALL FldAdd("EinzCourtage","NUM;,999999999999.00",0)
   CALL FldAdd("Kontoinh","TXT;27",0)
   CALL FldAdd("AbgerufenamOld","DAT;0d.mm.yyyy",0)
   CALL FldAdd("letzteZahlungOl","DAT;0d.mm.yyyy",0)
   CALL FldAdd("EinzBeitragOld","NUM;,999999999999.00",0)
   CALL FldAdd("EinzAbrufOld","TXT;1",0)
   CALL FldAdd("UEBERWTXT","TXT;27",0)
   REM *******************************************************

   CALL FldAdd("AntragsNr","TXT;30",0)
   CALL FldAdd("VNehmer","TXT;210",0)
   CALL FldAdd("QAntragsNr","TXT;50",1)
   CALL FldAdd("KFZ_FHalter","TXT;100",0)
   CALL FldAdd("KFZ_WagKZ","TXT;3",0)
   CALL FldAdd("StrafkautBem","TXT;20",0)
   CALL FldAdd("PHVSSSbem","TXT;30",0)
   CALL FldAdd("PHVSPbem","TXT;30",0)
   CALL FldAdd("PHVSSsabem","TXT;30",0)
   CALL FldAdd("PHVSVMbem","TXT;30",0)
   CALL FldAdd("PHVSMietbem","TXT;30",0)
   CALL FldAdd("Amtshaftpflicht","TXT;1",0)
   CALL FldAdd("SchlÅsselrisiko","TXT;1",0)
   REM CALL FldAdd("IIMSendDate","TXT;16",0)
   REM CALL FldAdd("IIMSendMA","TXT;50",0)
   REM CALL FldAdd("IIMsupid","TXT;50",0)
   REM CALL FldAdd("IIMsparteid","TXT;50",0)
   REM CALL FldAdd("IIMLastDok","TXT;150",0)
   REM CALL FldAdd("IIMLastDok1","TXT;150",0)
   REM CALL FldAdd("IIMLastDok2","TXT;150",0)
   CALL FldAdd("WMon","NUM;00.",0)
   CALL FldAdd("WJahr","NUM;0000.",0)
   CALL FldAdd("WMonJahr","TXT;6",1)
   CALL FldAdd("Sollst","TXT;6",0)
   CALL FldAdd("ExpInternet","TXT;6",1)
   CALL FldAdd("UnterVermNr","TXT;8",0)
   CALL FldAdd("UnfBezugsPers1","TXT;50",0)
   CALL FldAdd("UnfBezugsKomm1","TXT;50",0)
   CALL FldAdd("UnfBezugsPers2","TXT;50",0)
   CALL FldAdd("UnfBezugsKomm2","TXT;50",0)
   CALL FldAdd("UnfBezugsPers3","TXT;50",0)
   CALL FldAdd("UnfBezugsKomm3","TXT;50",0)
   CALL FldAdd("UnfBezugsPers4","TXT;50",0)
   CALL FldAdd("UnfBezugsKomm4","TXT;50",0)
   CALL FldAdd("UnfBezugsPers5","TXT;50",0)
   CALL FldAdd("UnfBezugsKomm5","TXT;50",0)
   CALL FldAdd("UnfBezugsPers6","TXT;50",0)
   CALL FldAdd("UnfBezugsKomm6","TXT;50",0)
   CALL FldAdd("UnfBezugsGeb1","DAT;0d.mm.yyyy",0)
   CALL FldAdd("UnfBezugsGeb2","DAT;0d.mm.yyyy",0)
   CALL FldAdd("UnfBezugsGeb3","DAT;0d.mm.yyyy",0)
   CALL FldAdd("UnfBezugsGeb4","DAT;0d.mm.yyyy",0)
   CALL FldAdd("UnfBezugsGeb5","DAT;0d.mm.yyyy",0)
   CALL FldAdd("UnfBezugsGeb6","DAT;0d.mm.yyyy",0)
   CALL FldAdd("GDVAgentNR","TXT;20",1)
   CALL FldAdd("DradDisease","TXT;1",0)
   CALL FldAdd("DradDiSum","NUM;,999999999.00",0)
   CALL FldAdd("DradDiLZ","TXT;20",0)
   CALL FldAdd("DradDiNote","TXT;400 R",0)
   CALL FldAdd("QNumVSNR","TXT;60",1)
   REM CALL FldAdd("PANummerVN","TXT;50",0)
   REM CALL FldAdd("QPANummerVN","TXT;50",1)
   REM CALL FldAdd("PAAustdatVN","DAT;0d.mm.yyyy",0)
   REM CALL FldAdd("PAAustOrtVN","TXT;50",0)
   CALL FldAdd("KundenNotiz","TXT;4000 R",0)
   CALL FldAdd("KMStand","NUM;,999999999999.",0)
   CALL FldAdd("DatumKMStand","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Schadquote","NUM;,9999999.0000",0)
   CALL FldAdd("AFSKPAUJN","TXT;1",0)
   CALL FldAdd("AFSKPAUEUR","NUM;,99999.00",0)
   CALL FldAdd("AFSKPAUDAT","DAT;0d.mm.yyyy",0)
   CALL FldAdd("QAFSKPAUDAT","TXT;9",1)
   CALL FldAdd("ErfassDatum","DAT;0d.mm.yyyy",1)
   CALL FldAdd("Bewertung2","NUM;,9999999999.00",0)
   REM CALL FldAdd("GebortVN","TXT;50",0)
   REM CALL FldAdd("GebortP1","TXT;50",0)
   REM CALL FldAdd("GebortP2","TXT;50",0)
   REM CALL FldAdd("GebortP3","TXT;50",0)
   REM CALL FldAdd("GebortP4","TXT;50",0)
   REM CALL FldAdd("GebortP5","TXT;50",0)
   REM CALL FldAdd("GebortP6","TXT;50",0)
   CALL FldAdd("AFSKPauschJN","TXT;1",0)
   CALL FldAdd("AFSKPausch","NUM;,9999999.00",0)
   CALL FldAdd("AFSKPauschDat","DAT;0d.mm.yyyy",0)
   CALL FldAdd("QAFSKPAUMADAT","TXT;9",1)
   CALL FldAdd("FixCodeMA","NUM;000000.",0)
   CALL FldAdd("StorWarnJN","TXT;1",1)
   CALL FldAdd("StorWarnDatGes","DAT;0d.mm.yyyy",0)
   CALL FldAdd("StorWarnDatMA","DAT;0d.mm.yyyy",0)
   CALL FldAdd("StorWarnGrund","TXT;400",0)
   CALL FldAdd("StorWarnMasn","TXT;400",0)
   CALL FldAdd("StorWarnErg","TXT;100",0)
   CALL FldAdd("StorWarnHist","TXT;4000 R",0)
   REM CALL FldAdd("IIMdokid","NUM;000000.",1)
   CALL FldAdd("AbrSperre","TXT;1",0)
   CALL FldAdd("HRSBjn","TXT;1",0)
   CALL FldAdd("HRSB","NUM;,9999999999",0)
   CALL FldAdd("Kontoeroejn","TXT;1",0)
   CALL FldAdd("Depouebjn","TXT;1",0)
   CALL FldAdd("WPHGjn","TXT;1",0)
   CALL FldAdd("Freistantrjn","TXT;1",0)
   CALL FldAdd("PA_Kopie","TXT;1",0)
   REM IF Gfsc% = - 1 THEN 
     CALL FldAdd("FS24Satz_ID","TXT;14",0)
     CALL FldAdd("FS24Satz_ID2","TXT;17",0)
     CALL FldAdd("FS24ZEDat","DAT;0d.mm.yyyy",0)
     CALL FldAdd("FS24MaklProv","NUM;,9999999999.00",0)
     CALL FldAdd("FS24GesCourt","NUM;,9999999999.00",0)
     CALL FldAdd("FS24DatVors","DAT;0d.mm.yyyy",0)
     CALL FldAdd("FS24Vors","NUM;,9999999999.00",0)
     CALL FldAdd("FS24VorsRu","TXT;1",0)
     CALL FldAdd("FS24DatVorsR","DAT;0d.mm.yyyy",0)
     CALL FldAdd("KZV","TXT;1",0)
     CALL FldAdd("Policedatum","DAT;0d.mm.yyyy",1)
     CALL FldAdd("Vorschfaehig","NMI;0.",0)
     CALL FldAdd("BerProtok","TXT;1",1)
     CALL FldAdd("BerProtokVom","DAT;0d.mm.yyyy",0)
     CALL FldAdd("ProvSperreJN","TXT;1",1)
     CALL FldAdd("ProvSperreVom","DAT;0d.mm.yyyy",0)
     CALL FldAdd("KuenCourt1","TXT;1",0)
     CALL FldAdd("StatusKey","NUM;000000.",1)
     CALL FldAdd("StatusDat","DAT;0d.mm.yyyy",0)
     CALL FldAdd("statusintern","TXT;30",0)
     CALL FldAdd("WKNr","TXT;30",0)
     CALL FldAdd("WKNText","TXT;100",0)
     CALL FldAdd("Teiler","NUM;,9999999999.0000",0)
     CALL FldAdd("EigVertrag","TXT;1",0)
     CALL FldAdd("Pflegepflicht","NUM;,9999999999.00",0)
     CALL FldAdd("KVRisikozu","NUM;,9999999999.00",0)
     CALL FldAdd("KVBrutto","NUM;,9999999999.00",0)
     CALL FldAdd("AnzCourtZahlung","NUM;999.",0)
     CALL FldAdd("SFRbleibt","TXT;1",0)
     CALL FldAdd("ErstzulassungVN","DAT;0d.mm.yyyy",0)
     CALL FldAdd("SaisonKennz","TXT;1",0)
     CALL FldAdd("SaisonKennzVon","TXT;10",0)
     CALL FldAdd("SaisonKennzBis","TXT;10",0)

     CALL FldAdd("AxaDeck1","NUM;,9999999999.00",0)
     CALL FldAdd("AxaDeck2","NUM;,9999999999.00",0)
     CALL FldAdd("AxaDeck3","NUM;,9999999999.00",0)
     CALL FldAdd("AxaDeck4","NUM;,9999999999.00",0)
     CALL FldAdd("AxaSelbstbeh","NUM;,9999999999.00",0)
     CALL FldAdd("AxaModul1","TXT;1",0)
     CALL FldAdd("AxaModul2","TXT;1",0)
     CALL FldAdd("AxaModul3","TXT;1",0)
     CALL FldAdd("AxaModul3a","TXT;1",0)
     CALL FldAdd("AxaModul4","TXT;1",0)
     CALL FldAdd("AxaModul4a","TXT;1",0)
     CALL FldAdd("AxaModul5","TXT;1",0)
     CALL FldAdd("AxaModul6","TXT;1",0)
     CALL FldAdd("AxaAnz1","NUM;,9999999999.",0)
     CALL FldAdd("AxaAnz2","NUM;,9999999999.",0)
     CALL FldAdd("AxaAnz3","NUM;,9999999999.",0)
     CALL FldAdd("AxaAnz4","NUM;,9999999999.",0)
     CALL FldAdd("AxaAnz5","NUM;,9999999999.",0)
     CALL FldAdd("DirektVSKZ","TXT;1",0)
     CALL FldAdd("CodeEingGE","NUM;000000.",0)
     CALL FldAdd("EingereichtBei","TXT;50",0)
     CALL FldAdd("BezugTod","TXT;70",0)
     CALL FldAdd("GAPDeckung","TXT;1",0)
     CALL FldAdd("GAPNotiz","TXT;50",0)
     CALL FldAdd("CODeMV","NUM;000000.",0)
     CALL FldAdd("BezugsberErl","TXT;50",0)
     CALL FldAdd("BezugsberPErl","TXT;50",0)
     CALL FldAdd("GarAblLstgErl","NUM;,9999999999.00",0)
     CALL FldAdd("MaxAblLstgErl","NUM;,9999999999.00",0)
     CALL FldAdd("RueckkaufErl","NUM;,9999999999.00",0)
     CALL FldAdd("RueckDatErl","DAT;0d.mm.yyyy",0)
     CALL FldAdd("GarRenteErl","NUM;,9999999999.00",0)
     CALL FldAdd("MaxRenteErl","NUM;,9999999999.00",0)
     CALL FldAdd("LZErl","NUM;,999.",0)
     CALL FldAdd("BezugsberTod","TXT;50",0)
     CALL FldAdd("BezugsberPTod","TXT;50",0)
     CALL FldAdd("GarAblLstgTod","NUM;,9999999999.00",0)
     CALL FldAdd("MaxAblLstgTod","NUM;,9999999999.00",0)
     CALL FldAdd("RueckkaufTod","NUM;,9999999999.00",0)
     CALL FldAdd("RueckDatTod","DAT;0d.mm.yyyy",0)
     CALL FldAdd("GarRenteTod","NUM;,9999999999.00",0)
     CALL FldAdd("MaxRenteTod","NUM;,9999999999.00",0)
     CALL FldAdd("LZTod","NUM;,999.",0)
     CALL FldAdd("ADRErleben","TXT;1000 R",0)
     CALL FldAdd("ADRTod","TXT;1000 R",0)
     CALL FldAdd("GebDatErl","DAT;0d.mm.yyyy",0)
     CALL FldAdd("GebDatTod","DAT;0d.mm.yyyy",0)
     REM CALL FldAdd("FS24KVSPLITT","TXT;1",0)
   REM END IF 
   
 REM BeitrAnd.a$ = BeitrAnd.b$
 REM EinzBeitrag.a$ = EinzBeitrag.b$
 
 REM Abgerufenam.a$ = AbgerufenB$
 REM letzteZahlung.a$ = letzteZahlung.b$
 REM Abruf.a$ = Abruf.b$
 REM EinzAbruf.a$ = EinzAbruf.b$
 REM Wiedervorlage.a$ = Wiedervorlage.b$
 REM Courtage.a$ = Courtage.b$
 REM einzcourtage.a$ = einzcourtage.b$

   REM CALL MarkMain("lfdnr")
   IF lauf% = 0 THEN 
     SAVE FILE "KVERTRAG"
     lauf% = 2
     REM FILE "KVLEER"
     FILE "HISTORY"
     GOTO lauf20062001002
   END IF 
   IF lauf% = 1 THEN 
     SAVE FILE "KVLEER"
     lauf% = 2
     FILE "HISTORY"
     GOTO lauf20062001002 
   END IF 
   IF lauf% = 2 THEN 
     SAVE FILE "HISTORY"
     lauf% = 3
   END IF 
   FILE "KVERTRAG"
   CALL Server("UPDFILE", FILE )
   REM ** Seriennummer korrigieren
   INDEX lfdnr.KVERTRAG
   SELECT LAST 
   CALL Server("UPDFILE","öberprÅfung lfd.Nr")
   CALL Server("UPDFIELD"," ")
   CALL Server("UPDSTATUS"," ")
   WHILE lfdnr.KVERTRAG > SER ("KVERTRAG",1)
   WEND 
ProvStart3012992: 
   FILE "kvertrag"
   INDEX lfdnr.kvertrag
   SELECT LAST 
   lfdnr% = lfdnr.kvertrag + 1
   WHILE lfdnr% > SER ("KVERTRAG",1)
   WEND 

   CALL KVCheck(3)

   CALL DFile(3,"AUMSATZ" + _fpw$)
   CALL DFile(3,"maadr" + _fpw$)
   CALL DFile(3,"WAEHRUNG" + _fpw$)
   MOUSE OFF 
   CALL Server("UPDFILE","öberprÅfung des Vertragsstatusses")
   CALL Server("UPDFIELD"," ")
   CALL Server("UPDSTATUS"," ")

 
   CALL Server("UPDFILE","öberprÅfung auf WÑhrung")
   CALL Server("UPDFIELD"," ")
   CALL Server("UPDSTATUS"," ")
   FILE "stamm"
   SELECT FIRST 
   euro1% = umrechnung.stamm
   codew1% = codew.stamm
   waehrung1$ = waehrung.stamm
   wbez1$ = waehrung.stamm
   
   FILE "kvertrag"
   INDEX lfdnr.kvertrag
   IF RECCOUNT ("kvertrag") > 0 THEN 
     SELECT FIRST LOCK 
   ELSE 
     SELECT LAST 
   END IF 
   a% = 0
   j% = RECCOUNT ("Kvertrag")

   REM wenn ttestFeld% = 0 dann wurde das Feld KuenCourt1 neu erfunden und muss jett entsprechend den Angaben in der ZE Datei
   REM gesetzt werden fÅr RealCash
   IF ttestFeld% = 0 AND PrvVerfahr$ = "ZAHLUNGSEINGANG" THEN 
     CALL Kvan14032005()
   END IF 

   IF RECCOUNT ("kvertrag") > 0 THEN 
     SELECT FIRST LOCK 
   ELSE 
     SELECT LAST 
   END IF 
   a% = 0
   j% = RECCOUNT ("Kvertrag")
   WHILE NOT EOF ("kvertrag") AND GIndNeu% = - 1
     a% = a% + 1
     CALL Server("UPDSTATUS", STR$ (a%,"999999") + " von " + STR$ (j%,"999999"))
     SET STATUS STR$ (a%,"999999") + "  von " + STR$ (j%,"999999") + " DatensÑtzen in KVERTRAG angepa·t"
     IF CodeVStatus.kvertrag = 20 OR CodeVStatus.kvertrag = 21 THEN Altvertrag.kvertrag = "j"
     IF umrechnung.kvertrag < 0.0001 THEN 
       umrechnung.kvertrag = euro1%
       codew.kvertrag = codew1%
       waehrung.kvertrag = waehrung1$
       WaehrungBezeich.kvertrag = wbez1$
     END IF 
     IF waehrung.kvertrag LIKE "EUR*" THEN 
       codew.kvertrag = 3
       waehrung.kvertrag = "EUR"
       umrechnung.kvertrag = 1
     END IF 
     IF waehrung.kvertrag LIKE "DM*" THEN 
       codew.kvertrag = 1
       waehrung.kvertrag = "DM"
       umrechnung.kvertrag = 1.95583
     END IF 
 
     IF codew.kvertrag = 1 THEN 
       umrechnung.kvertrag = 1.95583
     END IF 
     IF sollst.kvertrag = "" THEN sollst.kvertrag = "n"
     proviab$ = DATE$ (proviab.kvertrag)
     KÅn$ = DATE$ (kÅndigung.kvertrag)
     VA$ = VertragAktiv.kvertrag
     REM CALL Fehler("Vertragstestung","Proviab " + proviab$ + " KÅnd: " + kÅn$ + " Vertrakt: " + va$)
     IF CodeVStatus.kvertrag < 1 OR VStatusTXT.kvertrag = "" THEN 
       IF ProviAb.kvertrag > 0 AND ProviAb.kvertrag <= TODAY THEN 
         IF KÅndigung.kvertrag > 0 THEN 
           IF KÅndigung.kvertrag >= TODAY THEN 
             VertragAktiv.kvertrag = "j"
             VStatusTXT.kvertrag = "lebend"
             CodeVStatus.kvertrag = 1
             IF lfdnrtotal.kvertrag < 1 THEN lfdnrtotal.kvertrag = lfdnr.kvertrag * 10000
           ELSE 
             VertragAktiv.kvertrag = "n"
             VStatusTXT.kvertrag = "storniert"
             CodeVStatus.kvertrag = 4
           END IF 
         ELSE 
           VertragAktiv.kvertrag = "j"
             VStatusTXT.kvertrag = "lebend"
             CodeVStatus.kvertrag = 1
           IF lfdnrtotal.kvertrag < 1 THEN lfdnrtotal.kvertrag = lfdnr.kvertrag * 10000
         END IF 
       ELSE 
         IF KÅndigung.kvertrag > 0 THEN 
           VertragAktiv.kvertrag = "n"
           IF KÅndigung.kvertrag >= TODAY THEN 
             IF proviab.kvertrag <= TODAY THEN 
               VStatusTXT.kvertrag = "lebend"
               CodeVStatus.kvertrag = 1
               IF lfdnrtotal.kvertrag < 1 THEN lfdnrtotal.kvertrag = lfdnr.kvertrag * 10000
             END IF 
           ELSE 
             VStatusTXT.kvertrag = "storniert"
             CodeVStatus.kvertrag = 4
           END IF 
         END IF 
         
       END IF 
       IF TatsKuenDat.kvertrag > 0 THEN 
         IF TatsKuenDat.kvertrag >= TODAY THEN 
           VertragAktiv.kvertrag = "j"
             VStatusTXT.kvertrag = "lebend"
             CodeVStatus.kvertrag = 1
             IF lfdnrtotal.kvertrag < 1 THEN lfdnrtotal.kvertrag = lfdnr.kvertrag * 10000
         ELSE 
           VertragAktiv.kvertrag = "n"
           VStatusTXT.kvertrag = "storniert"
           CodeVStatus.kvertrag = 4
         END IF 
       END IF 
       IF UCASE$ (fremdvertrag.kvertrag) = "J" THEN 
           VStatusTXT.kvertrag = "Fremdvertrag"
           CodeVStatus.kvertrag = 11
       END IF 
       IF UCASE$ (Altvertrag.kvertrag) = "J" THEN 
           VStatusTXT.kvertrag = "Altvertrag"
           CodeVStatus.kvertrag = 10
       END IF 
       yea% = YEAR (VS_Beginn.kvertrag) + vs_dauer.kvertrag
       tag% = DAY (VS_Beginn.kvertrag)
       mon% = MONTH (VS_Beginn.kvertrag)
       IF yea% > 0 THEN 
       ELSE 
         yea% = 1950:tag% = 1:mon% = 1
       END IF 
       IF mon% > 0 THEN 
       ELSE 
         yea% = 1950:tag% = 1:mon% = 1
       END IF 
       IF tag% > 0 THEN 
       ELSE 
         yea% = 1950:tag% = 1:mon% = 1
       END IF 
       dat$ = STR$ (tag%,"00") + "." + STR$ (mon%,"00") + "." + STR$ (yea%,"0000")
       atext$ = VStatusTXT.kvertrag
       REM CALL Fehler(VS_NR.kvertrag,tarif.kvertrag)
       IF UCASE$ (fremdvertrag.kvertrag) <> "J" AND UCASE$ (Altvertrag.kvertrag) <> "J" AND TatsKuenDat.kvertrag < 1 AND ProviAb.kvertrag < 1 AND codeko.kvertrag < 1 THEN 
         IF KÅndigung.kvertrag > 0 THEN 
           IF KÅndigung.kvertrag < TODAY THEN 
             VertragAktiv.kvertrag = "n"
             VStatusTXT.kvertrag = "storniert"
             CodeVStatus.kvertrag = 4
           ELSE 
             VertragAktiv.kvertrag = "n"
             VStatusTXT.kvertrag = "Antrag"
             CodeVStatus.kvertrag = 12
             IF lfdnrtotal.kvertrag < 1 THEN lfdnrtotal.kvertrag = lfdnr.kvertrag * 10000
           END IF 
         ELSE 
           
             VertragAktiv.kvertrag = "n"
             VStatusTXT.kvertrag = "lebend"
             CodeVStatus.kvertrag = 1
             IF lfdnrtotal.kvertrag < 1 THEN lfdnrtotal.kvertrag = lfdnr.kvertrag * 10000
           
         END IF 
       END IF 
     END IF 
     REM QuickVIH=CodeVStatus+Vermittlerink+HauptfÑlligkeit
     QuickVIH = STR$ (CodeVStatus.kvertrag,"00") + STR$ (inkart,"0") + STR$ (HauptfÑlligkeit.kvertrag,"00")
     QuickVIK = STR$ (CodeVStatus.kvertrag,"00") + STR$ (inkart,"0")
     IF StorWarnJN.kvertrag = "" THEN 
       StorWarnJN.kvertrag = "n"
     END IF 
     IF WMonJahr.kvertrag = "" THEN 
       WMon.kvertrag = 0
       WJahr.kvertrag = 0000
     END IF 
     WMonJahr.kvertrag = STR$ (WMon.kvertrag,"00") + STR$ (WJahr.kvertrag,"0000")
     IF dtaus.kvertrag = "" THEN 
       IF inkart.kvertrag = 1 THEN 
         dtaus.kvertrag = "j"
       ELSE 
         dtaus.kvertrag = "n"
       END IF 
     END IF 
     IF CodeVStatusOld.kvertrag < 1 THEN 
       CodeVStatusOld.kvertrag = CodeVStatus.kvertrag
       VStatusTxTOld.kvertrag = VStatusTXT.kvertrag
     END IF 
     IF GDVStatus.kvertrag < 1 THEN 
       GDVStatus.kvertrag = CodeVStatus.kvertrag
       GDVStatusTxT.kvertrag = VStatusTXT.kvertrag
     END IF 
     produkt.kvertrag = Gesellschaft.kvertrag + " / " + sparte.kvertrag
     lf% = lfdnr.kvertrag
     IF EXISTS (codeku.kvertrag,codeku.adressen) AND VNehmer.kvertrag = "" THEN 
       SELECT FIRST FILE "adressen" INDEX codeku.adressen
       SELECT KEY codeku.kvertrag FILE "adressen" INDEX codeku.adressen
       VNehmer.kvertrag = LEFT$ ( LTRIM$ ( TRIM$ (Nachname.adressen)) + "," + LTRIM$ ( TRIM$ (vorname.adressen)) + "," + LTRIM$ ( TRIM$ (Stra·e.adressen)) + "," + LTRIM$ ( TRIM$ (PLZ.adressen + " " + Ort.adressen)),210)
     END IF 
     IF LTRIM$ (StatusZOK.kvertrag) = "" AND CodeVStatus.kvertrag <> 11 AND CodeVStatus.kvertrag <> 13 AND codema.kvertrag > 0 THEN 
       IF codema.kvertrag > 0 AND Antragsdatum.kvertrag > 0 THEN 
         StatusZOK.kvertrag = "ANTRAG"
         CALL ZentrAGZaehl(codema.kvertrag,"ANTRAG",Bewertungssumme.kvertrag,Volumen.kvertrag,0,Antragsdatum.kvertrag,0)
       END IF 
       STORE FILE "kvertrag"
       UNLOCK CURRENT FILE "KVERTRAG"
       SELECT KEY lf% LOCK FILE "kvertrag" INDEX lfdnr.kvertrag
       CALL ZokTest()
     ELSE 
       FILE "Kvertrag"
       STORE FILE "kvertrag"
       UNLOCK CURRENT FILE "KVERTRAG"
     END IF 
     FILE "Kvertrag"
     SELECT FIRST FILE "kvertrag" INDEX lfdnr.kvertrag
     SELECT KEY lf% FILE "kvertrag" INDEX lfdnr.kvertrag
     REM CALL MADMEuro()
     
     SELECT NEXT LOCK FILE "Kvertrag"
     IF lfdnr.kvertrag = lf% THEN SELECT NEXT LOCK FILE "Kvertrag"
   WEND 
 
   SpezAnp$ = UCASE$ (ReadConfig$("PROVIS","SPEZIALANPASSUNG"))
   SpezAnp$ = "FALSE"
   IF SpezAnp$ <> "FALSE" THEN 
     REQUEST "Wollen Sie die AntrÑge und stornierten","VertrÑge als lebende VertrÑge setzen?",130,req%
     IF req% = 1 THEN 
       FILE "Kvertrag"
       SELECT FIRST LOCK 
       WHILE NOT EOF ("KVERTRAG")
         IF CodeVStatus.kvertrag = 12 OR CodeVStatus.kvertrag = 4 THEN 
           CodeVStatus.kvertrag = 1
           VStatusTXT.kvertrag = "lebend"
           STORE FILE "Kvertrag"
         END IF 
         SELECT NEXT LOCK 
       WEND 
       
     END IF 
   END IF 
 
   CALL KVCheck(4)
 
   REM ** "Null"-SÑtze korrigieren
   CALL Server("UPDFILE","Anpassung an Spartengruppen!")
   CALL Server("UPDFIELD"," ")
   CALL Server("UPDSTATUS"," ")
   REM UPDATE CodeGrSP = 0 WHERE codegrsp < 1
   REM END UPDATE 
   IF RECCOUNT ("KVERTRAG") > 0 THEN 
     SELECT FIRST LOCK 
   ELSE 
     SELECT LAST 
   END IF 
   WHILE NOT EOF ("KVERTRAG") AND lfdnr < 1
     CALL Server("UPDFILE","PrÅfung auf PlausibilitÑt!")
     CALL Server("UPDFIELD","Versich.nr " + VS_NR.kvertrag)
     CALL Server("UPDSTATUS"," ")
     IF lfdnr < 1 THEN 
       lfdnr = SER ("KVERTRAG",1)
       STORE 
     END IF 
     SELECT NEXT LOCK 
   WEND 
   CALL DFile(3,"Geadr" + _fpw$)
   CALL DFile(3,"sparten" + _fpw$)
   CALL DFile(3,"maadr" + _fpw$)
   CALL DFile(3,"spgruppe" + _fpw$)
   CALL DFile(3,"vprodukt" + _fpw$)
   FILE "VPRODUKT"
     REM *********************************************************************************************************
 
 
     REM ************************************ verschÑrfte Reorganisation ******************
     REM CALL Fehler("","")
     REM REQUEST "Mîchten Sie die Vertragsdatei komplett neu aufbauen lassen?","(Achtung dieser Vorgang kann sehr lange dauern!",135,req%
     IF NeuProd% = - 1 THEN 
       CLOSE FILE "VPRODUKT"
       dpfad$ = _netpath$ + "PROVIS\" + DATE$ ( TODAY ,"yymm0d")
       datnr$ = DATE$ ( TODAY ,"yymm0d")
       i% = 0
       ok% = 0
       WHILE ok% = 0
         i% = i% + 1
         IF i% > 99 THEN 
           ON ERROR GOTO vkarb3004982
           REMOVE DIRECTORY dpfad$ + "01"
vkarb3004982: 
           i% = 1
         END IF 
         ON ERROR GOTO vkarb3004981
         tpfad$ = dpfad$ + STR$ (i%,"00")
         MAKE DIRECTORY dpfad$ + STR$ (i%,"00")
         dpfad$ = dpfad$ + STR$ (i%,"00")
         ok% = - 1
vkarb3004981: 
         ON ERROR GOTO ErrorHandler
       WEND 
       textdo1$ = "Sicherungskopie befindet sich im Pfad: " + tpfad$
       REM CALL Fehler("Es wird jetzt eine Sicherungskopie der Vertragsdatei erstellt!",textdo1$)
       REQUEST "Sicherungskopie wird erstellt in",tpfad$,2
       ON ERROR GOTO vkrb600420011
       COPY _netpath$ + "PROVIS\VPRODUKT.*" TO dpfad$
       CALL DFile(3,"VPRODUKT" + _fpw$)
       CALL reorgkv(_ppath$,"VPRODUKT","VPRODOLD","VPLEER",dpfad$)
       GOTO vkrb600420012
vkrb600420011: 
       CALL Fehler ("Beim kopieren der Produktdatei ist ein Fehler aufgetreten!, deshalb wird der Komplettaufbau nicht durchgefÅhrt","")
vkrb600420012: 
       ON ERROR GOTO ErrorHandler
     END IF 
         FILE "VPRODUKT"
         INDEX codevp.vprodukt
         SELECT LAST 
         IF codevp.vprodukt = 999999 THEN 
           SELECT PREVIOUS 
         END IF 
         codevp% = codevp.vprodukt
         IF codevp.vprodukt < 999999 THEN 
           WHILE SER ("VPRODUKT",1) <= codevp%
           WEND 
         END IF 
     REM ********************Ende verschÑrfte Reorganisation ************************************************************** 
 


   FILE "kvertrag"
   INDEX codeku.kvertrag
   IF RECCOUNT ("kvertrag") > 0 THEN 
     SELECT FIRST LOCK 
   ELSE 
     SELECT LAST 
   END IF 
   i% = 0
   verloren% = 0
   j% = RECCOUNT ("Kvertrag")
   WHILE NOT EOF ("KVERTRAG") AND GIndNeu% = - 1
     REM CALL Fehler("Test auf nicht gefundene VODEVP: " + STR$ (codevp.kvertrag),sparte.kvertrag)
     i% = i% + 1
     IF codeku.kvertrag < 1 THEN 
       SELECT REMOVE 
       SELECT FIRST LOCK 
     END IF 
     SET STATUS "DatensÑtze in KVERTRAG angepa·t: " + STR$ (i%,",9999999") + " von " + STR$ (j%,",9999999")
     CALL Server("UPDFILE","Erzeugung QuickCode")
     CALL Server("UPDFIELD","QuickKUGEs " + STR$ (CodeKU.kvertrag,"000000"))
     CALL Server("UPDSTATUS", STR$ (i%,"999999") + " von " + STR$ (j%,"999999"))
     codege% = Codege.kvertrag
     codeva% = codeva.kvertrag
     codema% = Codema.kvertrag
     codeku% = CodeKU.Kvertrag
     codegrsp% = Codegrsp.kvertrag
     REM SET NUMBASE ",000000000.00"
     IF codevp.kvertrag > 50000 THEN 
       codevp% = 0
     ELSE 
       codevp% = Codevp.kvertrag
     END IF 
     REM 210597
     IF (kÅndigung.kvertrag > 0 AND TatsKuenDat.kvertrag < 1 AND storno.kvertrag > 0) THEN 
       TatsKuenDat.kvertrag = kÅndigung.kvertrag
     ELSE 
       REM 100598 lieber nicht mehr automatisch behandeln TatsKuenDat.kvertrag = 0
     END IF 
     IF EXISTS (codeku%,codeku.adressen) THEN 
       SELECT KEY codeku% FILE "adressen" INDEX codeku.adressen
       ANachname.kvertrag = nachname.adressen
       AVorname.kvertrag = vorname.adressen
       AStrasse.kvertrag = Stra·e.adressen
       AOrt.kvertrag = Ort.adressen
       APLZ.kvertrag = Plz.adressen
     ELSE 
       cfile$ = FILE 
       FILE "Adressen"
       BLANK FILE "Adressen"
       codeku.adressen = codeku%
       Kundennummer.adressen = "Verloren"
       nachname.adressen = ANachname.kvertrag
       vorname.adressen = AVorname.kvertrag
       Stra·e.adressen = Astrasse.kvertrag
       Ort.adressen = AOrt.kvertrag
       PLZ.Adressen = APlz.kvertrag
       verloren% = 1
       STORE FILE "Adressen"
       WHILE SER ("Adressen",1) <= codeku%
       WEND 
       FILE cfile$
     END IF 
     IF EXISTS (codege%,codege.geadr) THEN 
       SELECT KEY codege% FILE "geadr" INDEX codege.geadr
       ges$ = TRIM$ (Gesellschaft.geadr)
     ELSE 
       BLANK FILE "geadr"
       codege.geadr = codege%
       Gesellschaft.geadr = Gesellschaft.kvertrag
       STORE FILE "geadr"
       UNLOCK CURRENT FILE "geadr"
       ges$ = TRIM$ (Gesellschaft.geadr)
       IF codege% < 999999 THEN 
         WHILE SER ("geadr",1) <= codege%
         WEND 
       END IF 
     END IF 
     IF EXISTS (codeva%,codeva.sparten) THEN 
       SELECT KEY codeva% FILE "sparten" INDEX codeva.sparten
       spar$ = TRIM$ (sparte.sparten)
     ELSE 
       REM spar$ = "<keine Zuordnung>"
       BLANK FILE "Sparten"
       codeva.sparten = codeva%
       Sparte.sparten = sparte.kvertrag
       STORE FILE "sparten"
       UNLOCK CURRENT FILE "sparten"
       spar$ = TRIM$ (sparte.sparten)
       IF codeva% < 999999 THEN 
         WHILE SER ("Sparten",1) <= codeva%
         WEND 
       END IF 
     END IF 
     IF EXISTS (codema%,codema.maadr) THEN 
       SELECT KEY codema% FILE "maadr" INDEX codema.maadr
       ma$ = TRIM$ (Nachname.maadr)
     ELSE 
       REM ma$ = "<keine Zuordnung>"
       REM codema.kvertrag = 0
       BLANK FILE "maadr"
       codema.maadr = codema%
       Nachname.maadr = Agentur.kvertrag
       QNameCodema.maadr = LTRIM$ (NAchnaME.maadr) + STR$ (codema.maadr,"000000")
       STORE FILE "maadr"
       UNLOCK CURRENT FILE "maadr"
       ma$ = TRIM$ (Nachname.maadr)
       IF codema% < 999999 THEN 
         WHILE SER ("MAADR",1) <= codema%
         WEND 
       END IF 
     END IF 
     IF EXISTS (codegrsp%,codegrsp.spgruppe) THEN 
       SELECT KEY codegrsp% FILE "spgruppe" INDEX codegrsp.spgruppe
       spgr$ = TRIM$ (gruppe.spgruppe)
     ELSE 
       REM spgr$ = "<keine Zuordnung>"
       BLANK FILE "Spgruppe"
       CodeGRSP.spgruppe = codegrsp%
       Gruppe.spgruppe = STR$ (codegrsp%,"000000")
       STORE FILE "spgruppe"
       UNLOCK CURRENT FILE "spgruppe"
       spgr$ = TRIM$ (gruppe.spgruppe)
       IF codegrsp% < 999999 THEN 
         WHILE SER ("spgruppe",1) <= codegrsp%
         WEND 
       END IF 
     END IF 
     acvp% = codevp.kvertrag
     agg$ = Gesellschaft.kvertrag
     avo$ = sparte.kvertrag
     IF codevp% > 0 THEN 
       IF EXISTS (codevp%,codevp.vprodukt) THEN 
       ELSE 
         REM CALL Fehler("codevp>0","es existiert aber kein Produkt mit dieser codevp")
         qcodegeva$ = STR$ (codege%,"000000") + STR$ (codeva%,"000000")
         IF EXISTS (qcodegeva$,QCodeGEVA.vprodukt) THEN 
           SELECT FIRST FILE "VPRODUKT" INDEX QCodeGEVA.vprodukt
           SELECT KEY QCodeGEVA$ FILE "VPRODUKT" INDEX QCodeGEVA.vprodukt
            codevp.kvertrag = codevp.vprodukt
           codevp% = codevp.vprodukt
         ELSE 
           FILE "VPRODUKT"
           INDEX codevp.vprodukt
           SELECT LAST 
           REM codevp% = codevp.vprodukt
           IF codevp% < 999999 THEN 
             WHILE SER ("VPRODUKT",1) <= codevp%
             WEND 
           END IF 
           REM CALL Fehler("Vprod aufnehmen1","")
           BLANK FILE "Vprodukt"
           codevp% = SER ("VPRODUKT",1)
           codevp.vprodukt = codevp%
           codege.vprodukt = codege%
           codeva.vprodukt = codeva%
           Gesellschaft.vprodukt = Gesellschaft.kvertrag
           Sparte.vprodukt = Sparte.kvertrag
           QCodeGEVA.vprodukt = STR$ (CodeGE.vprodukt,"000000") + STR$ (Codeva.vprodukt,"000000")
           GesSpa.Vprodukt = Gesellschaft.vprodukt + Sparte.vprodukt
           STORE FILE "Vprodukt"
           UNLOCK CURRENT FILE "Vprodukt"
           codevp.kvertrag = codevp%
         END IF 
       END IF 
     ELSE 
       
       qcodegeva$ = STR$ (codege%,"000000") + STR$ (codeva%,"000000")
       
       IF EXISTS (qcodegeva$,QCodeGEVA.vprodukt) THEN 
         REM CALL Fehler("codevp=0",qcodegeva$ + " existiert in Produktdatei")
         SELECT FIRST FILE "vprodukt" INDEX QCodeGEVA.vprodukt
         SELECT KEY qcodegeva$ FILE "vprodukt" INDEX QCodeGEVA.vprodukt
         codevp% = codevp.vprodukt
         codevp.kvertrag = codevp%
       ELSE 
         REM CALL Fehler("codevp=0",qcodegeva$ + " existiert nicht in Produktdatei")
         FILE "VPRODUKT"
         INDEX codevp.vprodukt
         SELECT LAST 
         codevp% = codevp.vprodukt
         IF codevp% < 999999 THEN 
           WHILE SER ("VPRODUKT",1) <= codevp%
           WEND 
         END IF 
         REM CALL Fehler("Vprod aufnehmen2","")
         BLANK FILE "Vprodukt"
         codevp% = SER ("VPRODUKT",1)
         codevp.vprodukt = codevp%
         codege.vprodukt = codege%
         codeva.vprodukt = codeva%
         Gesellschaft.vprodukt = Gesellschaft.kvertrag
         Sparte.vprodukt = sparte.kvertrag
         QCodeGEVA.vprodukt = STR$ (CodeGE.vprodukt,"000000") + STR$ (Codeva.vprodukt,"000000")
         GesSpa.Vprodukt = Gesellschaft.vprodukt + Sparte.vprodukt
         STORE FILE "vprodukt"
         UNLOCK CURRENT FILE "vprodukt"
         codevp.kvertrag = codevp%
       END IF 
     END IF 

     Agentur.kvertrag = ma$
     Spartengruppe.kvertrag = spgr$
     Gesellschaft.kvertrag = ges$
     sparte.kvertrag = spar$
     QuickGesSpart.kvertrag = ges$ + spar$
     QuickKUGEs.kvertrag = STR$ (CodeKU.kvertrag,"000000") + ges$
     QuickKUSpar.kvertrag = STR$ (CodeKU.kvertrag,"000000") + spar$
     QuickGesSpar.kvertrag = STR$ (CodeKU.kvertrag,"000000") + ges$ + spar$
     QzvP1Name.kvertrag = VSNRPack$(zvP1Name.kvertrag)
     QzvP2Name.kvertrag = VSNRPack$(zvP2Name.kvertrag)
     QzvP3Name.kvertrag = VSNRPack$(zvP3Name.kvertrag)
     QzvP4Name.kvertrag = VSNRPack$(zvP4Name.kvertrag)
     QzvP5Name.kvertrag = VSNRPack$(zvP5Name.kvertrag)
     QzvP6Name.kvertrag = VSNRPack$(zvP6Name.kvertrag)

     QzvP1vName.kvertrag = VSNRPack$(zvP1vName.kvertrag)
     QzvP2vName.kvertrag = VSNRPack$(zvP2vName.kvertrag)
     QzvP3vName.kvertrag = VSNRPack$(zvP3vName.kvertrag)
     QzvP4vName.kvertrag = VSNRPack$(zvP4vName.kvertrag)
     QzvP5vName.kvertrag = VSNRPack$(zvP5vName.kvertrag)
     QzvP6vName.kvertrag = VSNRPack$(zvP6vName.kvertrag)
     QNumVSNR.kvertrag = VSNRPackNum$(VS_NR.kvertrag)
     QuickVSNR.KVERTRAG = VSNRPack$(VS_NR.kvertrag)
     QAntragsnr.KVERTRAG = VSNRPack$(Antragsnr.kvertrag)
     QuickKennz.kvertrag = VSNRPack$(Kennzeichen.kvertrag)
     QTarif.kvertrag = VSNRPack$(Tarif.kvertrag)
     QHistCodeVT.Kvertrag = STR$ (Codehist.Kvertrag,"000000") + STR$ (lfdnr.Kvertrag,"000000")
     QuickGEVA.kvertrag = STR$ (CodeGE.kvertrag,"000000") + STR$ (CodeVA.kvertrag,"000000")
     IF AFSKPAUDAT.kvertrag < 1 THEN 
       QAFSKPAUDAT.kvertrag = AFSKPAUJN.kvertrag + "00000000"
     ELSE 
       QAFSKPAUDAT.kvertrag = AFSKPAUJN.kvertrag + DATE$ (AFSKPAUDAT.kvertrag,"yyyymm0d")
     END IF 
     IF GASP% THEN 
       IF _project$ LIKE "PROVIS" THEN 
         IF codema.kvertrag > 0 THEN 
           workstation.kvertrag = workstation.maadr
         END IF 
       END IF 
     END IF 
     STORE FILE "kvertrag"
     FILE "kvertrag"
     SELECT NEXT LOCK FILE "KVERTRAG"
   WEND 
   CALL KVCheck(5)

   IF verloren% = 1 THEN 
     CALL Fehler("Es wurde festgestellt, da· in der Vertragsdatei VertrÑge existieren, zu denen keine Adressen zu finden sind!","Diese Adressen wurden jetzt angelegt(Kundennummer: verloren). Die Adressdatei wird jetzt noch einmal geprÅft! ")
     CALL UpdADRKorr()
     GOTO AAAA0
   END IF 

   REM Anpassung KVFAEL
   CALL DFile(3,"KVERTRAG" + _fpw$)
   CALL DFile(3,"VPRODUKT" + _fpw$)
   CALL DFile(3,"VPGEKOND" + _fpw$)
   CALL DFile(3,"KVFAEL" + _fpw$)
   FILE "KVFAEL"
   REM *******AFSK-Kamrodt************************
   CALL FldAdd("abserledigt","TXT;1",1)
   CALL FldAdd("erledigt","TXT;1",1)
   CALL FldAdd("gezProv","NUM;,99999999.00",0)
   CALL FldAdd("gezProvEU","NUM;,99999999.00",0)
   CALL FldAdd("gezProvAnz","NUM;999.00",0)
   CALL FldAdd("TgezProvAnz","NUM;,000.",0)
   CALL FldAdd("erwProvAnz","NUM;,000.",0)
   CALL FldAdd("VMProv","NUM;,99999999.00",0)
   CALL FldAdd("VMProvEU","NUM;,99999999.00",0)
   CALL FldAdd("StornoBetrag","NUM;,99999999.00",0)
   CALL FldAdd("StornoBetrEU","NUM;,99999999.00",0)
   CALL FldAdd("StornoDat","DAT;0d.mm.yyyy",0)
   CALL FldAdd("CodeBU","NUM;000000.",0)
   CALL FldAdd("autokuend","TXT;1",0)
   REM ********************************************
   REM *** Lund Wriggers *************************************
   CALL FldAdd("BeitrAnd","TXT;3",0)
   CALL FldAdd("EinzBeitrag","NUM;,999999999999.00",0)
   CALL FldAdd("Abgerufenam","DAT;0d.mm.yyyy",0)
   CALL FldAdd("letzteZahlung","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Abruf","TXT;1",0)
   CALL FldAdd("EinzAbruf","TXT;1",0)
   CALL FldAdd("Wiedervorlage","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Courtage","NUM;,999999999999.00",0)
   CALL FldAdd("EinzCourtage","NUM;,999999999999.00",0)
   CALL FldAdd("Kontoinh","TXT;27",0)
   CALL FldAdd("AbgerufenamOld","DAT;0d.mm.yyyy",0)
   CALL FldAdd("letzteZahlungOl","DAT;0d.mm.yyyy",0)
   CALL FldAdd("EinzBeitragOld","NUM;,999999999999.00",0)
   CALL FldAdd("EinzAbrufOld","TXT;1",0)
   CALL FldAdd("UEBERWTXT","TXT;27",0)
   CALL FldAdd("INKART","NMI;0",0)
   CALL FldAdd("ZW","NMI;99",0)
   CALL FldAdd("Zahlart","NMI;0",0)
   CALL FldAdd("Beitrag","NUM;,999999999999.00",0)
   REM Bankverbindung
   CALL FldAdd("K1Bank","TXT;50",0)
   CALL FldAdd("K1BLZ","TXT;20",0)
   CALL FldAdd("K1Konto","TXT;17",0)
   CALL FldAdd("CodeVStatus","NUM;00.",1)
   CALL FldAdd("nextHauptf","NUM;00.",0)
   CALL FldAdd("QuickVIK","TXT;3",1)

   CALL FldAdd("Kunde","TXT;100",1)
   CALL FldAdd("Gesellschaft","TXT;30",1)
   CALL FldAdd("CodeVA","NUM;000000.",0)
   CALL FldAdd("Sparte","TXT;30",0)
   CALL FldAdd("CodeKu","NUM;000000.",1)
   CALL FldAdd("CodeGE","NUM;000000.",1)
   CALL FldAdd("VS_NR","TXT;30",0)
   CALL FldAdd("QIAZAAbr","TXT;3",1)
   CALL FldAdd("dtausfehl","NMI;0",1)
   CALL FldAdd("Fehlertext","TXT;60 R",0)
   CALL FldAdd("EUUmstellung","TXT;1",0)
   REM ******************************************************* 
   SAVE FILE "KVFAEL"
   FILE "KVFAEL"

   IF GAFSK$ LIKE "TRUE" THEN 
     INDEX codevt.kvfael
     IF RECCOUNT ("KVFAEL") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     i% = 0
     zanz% = RECCOUNT ("KVFAEL")
     b$ = LTRIM$ ( STR$ (zanz%,",99999999"))
     WHILE NOT EOF ("KVFAEL")
       i% = i% + 1
       SET STATUS STR$ (i%,",99999999") + " KVFAEL - DatensÑtze verarbeitet von " + b$
      IF EXISTS (codevt.kvfael,lfdnr.kvertrag) THEN 
       SELECT FIRST FILE "KVERTRAG" INDEX lfdnr.kvertrag
       SELECT KEY codevt.kvfael FILE "KVERTRAG" INDEX lfdnr.kvertrag
       IF EXISTS (codevp.kvertrag,codevp.vpgekond) THEN 
         SELECT FIRST FILE "VPGEKOND" INDEX codevp.vpgekond
         SELECT KEY codevp.kvertrag FILE "VPGEKOND" INDEX codevp.vpgekond
         IF afsk.vpgekond = "j" THEN 
           EUUmstellung.kvfael = "j"
           STORE FILE "KVFAEL"
           UNLOCK CURRENT FILE "KVFAEL"
         ELSE 
           erwProvAnz.kvfael = 0
           fÑlligam.kvfael = 0
           VMProv.kvfael = 0
           VMProvEu.kvfael = 0
           gezProvAnz.kvfael = 0
           gezprov.kvfael = 0
           erledigt.kvfael = "j"
           STORE FILE "KVFAEL"
           UNLOCK CURRENT FILE "KVFAEL"
         END IF 
       END IF 
       SELECT NEXT LOCK 
      ELSE 
       SELECT REMOVE FILE "KVFAEL"
       IF RECCOUNT ("KVFAEL") > 0 THEN 
         SELECT FIRST LOCK 
       ELSE 
         SELECT LAST 
       END IF 
      END IF 
    WEND 

     INDEX codevt.kvfael
     IF RECCOUNT ("KVFAEL") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     i% = 0
     WHILE NOT EOF ("KVFAEL") AND GIndNeu% = - 1
       i% = i% + 1
       SET STATUS STR$ (i%,",99999999") + " KVFAEL - DatensÑtze geprÅft von " + b$
       IF EXISTS (codevt.kvfael,lfdnr.kvertrag) THEN 
         SELECT FIRST FILE "KVERTRAG" INDEX lfdnr.kvertrag
         SELECT KEY codevt.kvfael FILE "KVERTRAG" INDEX lfdnr.kvertrag
         IF GAFSK$ = "TRUE22222" THEN 
           IF EUUmstellung.kvfael <> "j" THEN 
             gezProv.kvfael = VAL ( STR$ (gezProv.kvfael / 1.95583,"999999999.00"))
             gezproveu.kvfael = gezprov.kvfael
             VMProv.kvfael = VAL ( STR$ (VMProv.kvfael / 1.95583,"999999999.00"))
             VMProvEu.kvfael = VMProv.kvfael
             StornoBetrag.kvfael = VAL ( STR$ (StornoBetrag.kvfael / 1.95583,"999999999.00"))
             StornoBetreu.kvfael = StornoBetrag.kvfael
             EUUmstellung.kvfael = "j"
             STORE FILE "KVFAEL"
             UNLOCK CURRENT FILE "KVFAEL"
           END IF 
         END IF 
         IF GLundWrigg$ = "TRUE2222" THEN 
           IF EUUmstellung.kvfael <> "j" THEN 
             gezProv.kvfael = VAL ( STR$ (gezProv.kvfael / 1.95583,"999999999.00"))
             gezproveu.kvfael = gezprov.kvfael
             VMProv.kvfael = VAL ( STR$ (VMProv.kvfael / 1.95583,"999999999.00"))
             VMProvEu.kvfael = VMProv.kvfael
             StornoBetrag.kvfael = VAL ( STR$ (StornoBetrag.kvfael / 1.95583,"999999999.00"))
             StornoBetreu.kvfael = StornoBetrag.kvfael


             ProvBetrag.kvfael = ProvBetragEU.kvfael
             UE.kvfael = VAL ( STR$ (UE.kvfael / umrechnung.kvertrag,"999999999.00"))
             Pool.kvfael = VAL ( STR$ (Pool.kvfael / umrechnung.kvertrag,"999999999.00"))
             EinzBeitrag.kvfael = VAL ( STR$ (EinzBeitrag.kvfael / 1.95583,"999999999.00"))
             Courtage.kvfael = VAL ( STR$ (Courtage.kvfael / 1.95583,"999999999.00"))
             EinzCourtage.kvfael = VAL ( STR$ (EinzCourtage.kvfael / 1.95583,"999999999.00"))
             EinzBeitragOld.kvfael = VAL ( STR$ (EinzBeitragOld.kvfael / 1.95583,"999999999.00"))
             Beitrag.kvfael = VAL ( STR$ (Beitrag.kvfael / 1.95583,"999999999.00"))


             EUUmstellung.kvfael = "j"
             STORE FILE "KVFAEL"
             UNLOCK CURRENT FILE "KVFAEL"
           END IF 
         END IF 
         SELECT NEXT LOCK FILE "KVFAEL" INDEX codevt.kvfael
       ELSE 
         SELECT REMOVE FILE "KVFAEL"
         IF RECCOUNT ("KVFAEL") > 0 THEN 
           SELECT FIRST LOCK 
         ELSE 
           SELECT LAST 
         END IF 
       END IF 
     WEND 
   END IF 
   CALL KVCheck(6)
   IF GLundWrigg$ = "TRUEEEEEEEE" THEN 
     FILE "kvertrag"
     INDEX lfdnr.kvertrag
     SELECT FIRST 
     i% = 0
     WHILE NOT EOF ("KVERTRAG")
       i% = i% + 1
       lfdnr% = lfdnr.kvertrag
       SET STATUS STR$ (i%) + " KVFAEL verarbeitet"
       IF NOT EXISTS (lfdnr.kvertrag,codevt.kvfael) THEN 
         BLANK FILE "kvfael"
         codevt.kvfael = lfdnr%
         STORE FILE "kvfael"
         UNLOCK CURRENT FILE "kvfael"
       END IF 
       SELECT FIRST FILE "KVFAEL"
       SELECT KEY lfdnr% LOCK FILE "KVFAEL" INDEX codevt.kvfael
      IF inkart.kvfael < 1 THEN 
       REM kann nur 1 oder 2 sein, deshalb wenn 0 wurde dieser Lauf noch nicht gemacht!!!
       vs_nr.kvfael = vs_nr.kvertrag
       codeku.kvfael = codeku.kvertrag
       codege.kvfael = codege.kvertrag
       SELECT KEY codeku.kvertrag FILE "Adressen" INDEX codeku.adressen
       Kunde.kvfael = LEFT$ ( LTRIM$ (Nachname.adressen) + LTRIM$ (Vorname.adressen),100)
       SELECT KEY codege.kvertrag FILE "geadr" INDEX codege.geadr
       Gesellschaft.kvfael = Gesellschaft.geadr
       SELECT KEY codeva.kvertrag FILE "Sparten" INDEX codeva.sparten
       codeva.kvfael = Codeva.kvertrag
       Sparte.kvfael = LEFT$ (Sparte.sparten,30)
       HauptfÑlligkeit.kvfael = HauptfÑlligkeit.kvertrag
       Beitrag.kvfael = Beitrag.kvertrag
       BeitrAnd.kvfael = BeitrAnd.kvertrag
       EinzBeitrag.kvfael = EinzBeitrag.kvertrag
       Abgerufenam.kvfael = Abgerufenam.kvertrag
       letzteZahlung.kvfael = letzteZahlung.kvertrag
       Abruf.kvfael = Abruf.kvertrag
       EinzAbruf.kvfael = EinzAbruf.kvertrag
       Wiedervorlage.kvfael = Wiedervorlage.kvertrag
       Courtage.kvfael = Courtage.kvertrag
       EinzCourtage.kvfael = EinzCourtage.kvertrag
       Kontoinh.kvfael = Kontoinh.kvertrag
       AbgerufenamOld.kvfael = AbgerufenamOld.kvertrag
       letzteZahlungOl.kvfael = letzteZahlungOl.kvertrag
       EinzBeitragOld.kvfael = EinzBeitragOld.kvertrag
       EinzAbrufOld.kvfael = EinzAbrufOld.kvertrag
       UEBERWTXT.kvfael = UEBERWTXT.kvertrag
       INKART.kvfael = INKART.kvertrag
       ZW.kvfael = zw.kvertrag
       Zahlart.kvfael = Zahlart.kvertrag
       K1Bank.kvfael = K1Bank.kvertrag
       K1BLZ.kvfael = K1BLZ.kvertrag
       K1Konto.kvfael = K1Konto.kvertrag
       CodeVStatus.kvfael = CodeVStatus.kvertrag
       QuickVIK.kvFAEL = STR$ (CodeVStatus.kvFAEL,"00") + STR$ (inkart,"0")
       QIAZAAbr.kvFAEL = STR$ (Inkart.kvfael,"0") + STR$ (Zahlart.kvfael,"0") + Abruf.kvfael
       REM *******  Erzeugubg nextHauptf  ***************
       REM ZW% = 1,"jÑhrlich", IF (ZW% = 2,"halbjÑhrlich", IF (ZW% = 4,"vierteljÑhrlich", IF (ZW% = 6,"2monatlich", IF (ZW% = 12,"monatlich", IF (ZW% = 0,"einmalig", IF (ZW% = 55,"<keine Zuordnung>"
       IF zw.kvertrag <> 55 THEN 
          IF zw.kvertrag = 1 THEN 
            nextHauptf.kvfael = HauptfÑlligkeit.kvertrag
          END IF 
          IF zw.kvertrag = 2 THEN 
            nextHauptf.kvfael = HauptfÑlligkeit.kvertrag + 6
            IF nextHauptf.kvfael < 10 THEN nextHauptf.kvfael = nextHauptf.kvfael + 6
          END IF 
          IF zw.kvertrag = 4 THEN 
            nextHauptf.kvfael = HauptfÑlligkeit.kvertrag + 3
            IF nextHauptf.kvfael < 10 THEN nextHauptf.kvfael = nextHauptf.kvfael + 3
            IF nextHauptf.kvfael < 10 THEN nextHauptf.kvfael = nextHauptf.kvfael + 3
            IF nextHauptf.kvfael < 10 THEN nextHauptf.kvfael = nextHauptf.kvfael + 3
            IF nextHauptf.kvfael < 10 THEN nextHauptf.kvfael = nextHauptf.kvfael + 3
          END IF 
          IF zw.kvertrag = 6 THEN 
            nextHauptf.kvfael = HauptfÑlligkeit.kvertrag + 2
            IF nextHauptf.kvfael < 10 THEN nextHauptf.kvfael = nextHauptf.kvfael + 2
            IF nextHauptf.kvfael < 10 THEN nextHauptf.kvfael = nextHauptf.kvfael + 2
            IF nextHauptf.kvfael < 10 THEN nextHauptf.kvfael = nextHauptf.kvfael + 2
            IF nextHauptf.kvfael < 10 THEN nextHauptf.kvfael = nextHauptf.kvfael + 2
            IF nextHauptf.kvfael < 10 THEN nextHauptf.kvfael = nextHauptf.kvfael + 2
            IF nextHauptf.kvfael < 10 THEN nextHauptf.kvfael = nextHauptf.kvfael + 2
          END IF 
          IF zw.kvertrag = 12 THEN 
            nextHauptf.kvfael = 10
          END IF 
       END IF 
       STORE FILE "kvfael"
      END IF 
       UNLOCK CURRENT FILE "KVFAEL"
       FILE "kvertrag"
       SELECT NEXT LOCK INDEX lfdnr.kvertrag
     WEND 
   END IF 




   REM -- Anpassung Buchgead.sbf --
   REM CALL Fehler("update","")
   IF EXISTS (_ppath$ + "buchges.sbf") THEN 
     CALL DFile(3,"BUCHges" + _fpw$)
     FILE "BUCHges"
     CALL FldAdd("CodeInkGead","NUM;0000000.",1)
     CALL FldAdd("ProvanGesEu","NUM;,999999999.00",0)
     CALL FldAdd("Umrechnung","NUM;,99999999.000000",0)
     CALL FldAdd("CodeW","NUM;000000.",1)
     CALL FldAdd("Waehrung","TXT;6",0)
     CALL FldAdd("BeitragEu","NUM;,999999999.00",0)
     CALL FldAdd("gezBeitragEu","NUM;,999999999.00",0)
     CALL FldAdd("gezBeitrag1","NUM;,99999999.00",0)
     CALL FldAdd("gezBeitrag1Eu","NUM;,99999999.00",0)
     CALL FldAdd("einzelabruf","NUM;0.",0)
     CALL FldAdd("Courtage","NUM;,99999999.00",0)
     SAVE FILE "BUCHGes"
   END IF 
   IF EXISTS (_ppath$ + "KURSHIST.sbf") THEN 
     CALL DFile(3,"KURSHIST" + _fpw$)
     FILE "KURSHIST"
     CALL FldAdd("FondsKZ","TXT;1",0)
     CALL FldAdd("BRÅckkaufDM","NUM;+,9999999999.0000",0)
     CALL FldAdd("BRÅckkaufUS","NUM;+,9999999999.0000",0)
     CALL FldAdd("BRÅckkaufEuro","NUM;+,9999999999.0000",0)
     CALL FldAdd("BRÅckkaufWaehr","NUM;+,9999999999.0000",0)
     CALL FldAdd("WKNr","TXT;30",1)
     SAVE FILE "KURSHIST"
   END IF 
   IF EXISTS (_ppath$ + "DTAUS.sbf") THEN 
     CALL DFile(3,"dtaus" + _fpw$)
     FILE "DTAUS"
     CALL FldAdd("Gesellschaft","TXT;30",0)
     CALL FldAdd("codege","NUM;,000000.",0)
     SAVE FILE "dtaus"
   END IF 
   REM -- Anpassung TARIF.SBF --
   IF EXISTS (_ppath$ + "TARIF.sbf") THEN 
     CALL DFile(3,"TARIF" + _fpw$)
     FILE "TARIF"
     CALL FldAdd("MinBewBBei","NUM;,9999999999.00",0)
     CALL FldAdd("MaxBewBBei","NUM;,9999999999.00",0)
     CALL FldAdd("MinSRDBBei","NUM;,9999999999.00",0)
     CALL FldAdd("MaxSRDBBei","NUM;,9999999999.00",0)
     CALL FldAdd("MinVolBBei","NUM;,9999999999.00",0)
     CALL FldAdd("MaxVolBBei","NUM;,9999999999.00",0)

     CALL FldAdd("MinVol","NUM;9999.00",0)
     CALL FldAdd("MaxVol","NUM;9999.00",0)

     CALL FldAdd("MinTarBBei","NUM;,9999999999.00",0)
     CALL FldAdd("MaxTarBBei","NUM;,9999999999.00",0)

     CALL FldAdd("MinTar","NUM;9999.00",0)
     CALL FldAdd("MaxTar","NUM;9999.00",0)

     CALL FldAdd("MinBewNBei","NUM;,9999999999.00",0)
     CALL FldAdd("MaxBewNBei","NUM;,9999999999.00",0)
     CALL FldAdd("MinSRDNBei","NUM;,9999999999.00",0)
     CALL FldAdd("MaxSRDNBei","NUM;,9999999999.00",0)

     CALL FldAdd("MinSRD","NUM;9999.00",0)
     CALL FldAdd("MaxSRD","NUM;9999.00",0)

     CALL FldAdd("MinVolNBei","NUM;,9999999999.00",0)
     CALL FldAdd("MaxVolNBei","NUM;,9999999999.00",0)
     CALL FldAdd("MinTarNBei","NUM;,9999999999.00",0)
     CALL FldAdd("MaxTarNBei","NUM;,9999999999.00",0)
     CALL FldAdd("MinBew","NUM;9999.00",0)
     CALL FldAdd("MaxBew","NUM;9999.00",0)
     CALL FldAdd("MinBewBzD","NUM;9999.00",0)
     CALL FldAdd("MaxBewBzD","NUM;9999.00",0)
     CALL FldAdd("MinSRDBzD","NUM;9999.00",0)
     CALL FldAdd("MaxSRDBzD","NUM;9999.00",0)
     CALL FldAdd("MinVolBzD","NUM;9999.00",0)
     CALL FldAdd("MaxVolBzD","NUM;9999.00",0)
     CALL FldAdd("MinTarBzD","NUM;9999.00",0)
     CALL FldAdd("MaxTarBzD","NUM;9999.00",0)
     CALL FldAdd("MinBewVS","NUM;,9999999999.00",0)
     CALL FldAdd("MaxBewVS","NUM;,9999999999.00",0)
     CALL FldAdd("MinSRDVS","NUM;,9999999999.00",0)
     CALL FldAdd("MaxSRDVS","NUM;,9999999999.00",0)
     CALL FldAdd("MinVolVS","NUM;,9999999999.00",0)
     CALL FldAdd("MaxVolVS","NUM;,9999999999.00",0)
     CALL FldAdd("MinTarVS","NUM;,9999999999.00",0)
     CALL FldAdd("MaxTarVS","NUM;,9999999999.00",0)
     CALL FldAdd("BAntPreisinWaeh","NUM;,9999999999.0000",0)
     CALL FldAdd("BAntPreisinDM","NUM;,9999999999.0000",0)
     CALL FldAdd("BAntPreisinUS","NUM;,9999999999.0000",0)
     CALL FldAdd("BAntPreisinEuro","NUM;,9999999999.0000",0)
     CALL FldAdd("BKursEuro","NUM;999999.00000000",0)
     CALL FldAdd("BKursUS","NUM;999999.00000000",0)
     CALL FldAdd("BAnlageDM","NUM;+,999999999999.00",0)
     CALL FldAdd("BAnlageUS","NUM;+,999999999999.00",0)
     CALL FldAdd("BAnlageEuro","NUM;+,999999999999.00",0)
     CALL FldAdd("BKursTag","DAT;0d.mm.yyyy",0)
     CALL FldAdd("BAnlageWaehr","NUM;+,999999999999.00",0)
     CALL FldAdd("QuickVTBerDat","TXT;20",1)
     CALL FldAdd("BKursZeit","TIM;hh:mm:ss",0)
     CALL FldAdd("Umrechnung","NUM;,99999999.000000",0)
     CALL FldAdd("CodeW","NUM;000000.",1)
     CALL FldAdd("Waehrung","TXT;6",0)
     CALL FldAdd("WaehrungBezeich","TXT;30",0)
     CALL FldAdd("FondsKZ","TXT;1",0)
     CALL FldAdd("BRÅckkaufDM","NUM;+,9999999999.0000",0)
     CALL FldAdd("BRÅckkaufUS","NUM;+,9999999999.0000",0)
     CALL FldAdd("BRÅckkaufEuro","NUM;+,9999999999.0000",0)
     CALL FldAdd("BRÅckkaufWaehr","NUM;+,9999999999.0000",0)
     CALL FldAdd("WKNr","TXT;30",1)
     CALL FldAdd("CodeVP","NUM;000000.",1)

     CALL FldAdd("FormelBewertun2","TXT;4000",0)
     CALL FldAdd("MinBew2","NUM;9999.00",0)
     CALL FldAdd("MaxBew2","NUM;9999.00",0)
 
     CALL FldAdd("MinBewBBei2","NUM;,9999999999.00",0)
     CALL FldAdd("MaxBewBBei2","NUM;,9999999999.00",0)
 
     CALL FldAdd("MinBewNBei2","NUM;,9999999999.00",0)
     CALL FldAdd("MaxBewNBei2","NUM;,9999999999.00",0)
 
     CALL FldAdd("MinBewBzD2","NUM;9999.00",0)
     CALL FldAdd("MaxBewBzD2","NUM;9999.00",0)
 
     CALL FldAdd("MinBewVS2","NUM;,9999999999.00",0)
     CALL FldAdd("MaxBewVS2","NUM;,9999999999.00",0)
     CALL FldAdd("FBew2","TXT;4000",0)
     CALL FldAdd("FormelBewertOld","TXT;4000",0)
     CALL FldAdd("FBWénd","DAT;0d.mm.yyyy",0)
     CALL FldAdd("SR60","TXT;1",0)
     CALL MarkMain("CodeTarif")
     SAVE FILE "tarif"

     FILE "Tarif"
     INDEX codetarif.tarif
     SELECT LAST 
     WHILE codetarif.tarif > SER ("Tarif",1)
     WEND 
     IF GIndNeu% = - 1 THEN 
  UPDATE QuickVTBerDat.TARIF = DATE$ (BKursTag.TARIF,"yyyymm0d") + LEFT$ ( TIME$ (BKursZeit.TARIF,"hh:mm:ss"),2) + MID$ ( TIME$ (BKursZeit.TARIF,"hh:mm:ss"),4,2) + RIGHT$ ( TIME$ (BKursZeit.TARIF,"hh:mm:ss"),2)
     END UPDATE 
     END IF 
     FILE "stamm"
     SELECT FIRST 
     euro1% = umrechnung.stamm
     codew1% = codew.stamm
     waehrung1$ = waehrung.stamm
     wbez1$ = waehrung.stamm



     FILE "tarif"
     INDEX codetarif.tarif
     IF RECCOUNT ("tarif") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     a% = 0
     j% = RECCOUNT ("tarif")
     WHILE NOT EOF ("tarif") AND GIndNeu% = - 1
       a% = a% + 1
       CALL Server("UPDSTATUS", STR$ (a%,"999999") + " von " + STR$ (j%,"999999"))
       SET STATUS STR$ (a%,"999999") + " von " + STR$ (j%,"999999") + " DatensÑtze angepa·t"
       IF umrechnung.tarif < 0.0001 THEN 
         umrechnung.tarif = euro1%
         codew.tarif = codew1%
         waehrung.tarif = waehrung1$
         WaehrungBezeich.tarif = wbez1$
         STORE FILE "tarif"
         UNLOCK CURRENT FILE "tarif"
       END IF 
       SELECT NEXT LOCK FILE "tarif"
     WEND 
   END IF 

   REM -- Anpassung KGEADR.SBF
   IF EXISTS (_ppath$ + "KGEADR.sbf") THEN 
     CALL DFile(3,"KGEADR" + _fpw$)
     FILE "KGEADR"
     CALL MarkMain("CodeGE")
     SAVE FILE "KGEADR"
   END IF 
   CALL KVCheck(7)
   REM CALL Fehler("TSpez","")
   REM -- Anpassung SPEZKOND.SBF --
   IF EXISTS (_ppath$ + "SPEZKOND.sbf") THEN 
     CALL DFile(3,"MAADR" + _fpw$)
     CALL DFile(3,"KVERTRAG" + _fpw$)
     CALL DFile(3,"SPEZKOND" + _fpw$)
     FILE "SPEZKOND"
     CALL FldAdd("CodeVP","NUM;000000.",1)
     CALL FldAdd("vonCodeMA","NUM;000000.",0)
     CALL FldAdd("vonAgentur","TXT;70",0)
     CALL FldAdd("SR","NUM;999.0000",0)
     CALL FldAdd("SRLZ","NUM;999.",0)
     CALL FldAdd("EUUmstellung","TXT;1",0)
     CALL FldAdd("TStruk","NMI;0.",0)
     CALL FldAdd("EinhBuchJN","TXT;1",0)
     CALL FldAdd("EuroproEinh","NUM;,999999999.00",0)
     CALL FldAdd("APEurEinh","NUM;,999999999.00",0)
     CALL FldAdd("CourtEurEinh","NUM;,999999999.00",0)
     CALL FldAdd("PflEurEinh","NUM;,999999999.00",0)
     CALL FldAdd("DynEurEinh","NUM;,999999999.00",0)
     CALL FldAdd("FolgEurEinh","NUM;,999999999.00",0)
     CALL FldAdd("codekogekond","NUM;000000.",0)
     CALL FldAdd("APjn","TXT;1",0)
     CALL FldAdd("CourtageJN","TXT;1",0)
     CALL FldAdd("PflegeJN","TXT;1",0)
     CALL FldAdd("DynamikPjn","TXT;1",0)
     CALL FldAdd("Betreujn","TXT;1",0)
     CALL FldAdd("sortKond","NUM;000000.",0)
     CALL FldAdd("QCodeVTsort","TXT;12",1)
     
     SAVE FILE "spezkond"
     FILE "spezkond"
     INDEX codekey.spezkond
     SELECT LAST 
     a1% = codekey.spezkond
     WHILE i% >= SER ("spezkond",1)
     WEND 
     IF RECCOUNT ("spezkond") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     REM CALL Fehler("Spezkond","")
     WHILE NOT EOF ("Spezkond") AND GIndNeu% = - 1
       IF voncodema.spezkond < 1 AND voncodema.spezkond = 1 THEN 
         SELECT FIRST FILE "kvertrag" INDEX lfdnr.kvertrag
         SELECT KEY codevt.spezkond FILE "kvertrag" INDEX lfdnr.kvertrag
         SELECT FIRST FILE "maadr" INDEX codema.maadr
         SELECT KEY codema.kvertrag FILE "maadr" INDEX codema.maadr
         IF vonFirmaAgentur.spezkond LIKE "j" THEN 
           vonCodema.spezkond = codema.kvertrag
           vonAgentur.spezkond = Nachname.maadr + "," + Vorname.maadr
         ELSE 
           ok% = 1
           WHILE ok% = 1
             IF codema.maadr <> vorgÑnger.maadr AND vorgÑnger.maadr <> 0 THEN 
               SELECT KEY vorgÑnger.maadr FILE "maadr" INDEX codema.maadr
             ELSE 
               ok% = 0
             END IF 
           WEND 
           vonCodema.spezkond = codema.kvertrag
           vonAgentur.spezkond = Nachname.maadr + "," + Vorname.maadr
         END IF 
         STORE FILE "spezkond"
         UNLOCK CURRENT FILE "spezkond"
       END IF 
       SELECT NEXT LOCK FILE "spezkond" INDEX codekey.spezkond
     WEND 
   END IF 
   CALL KVCheck(8)
   REM -- Anpassung VPSPEZKO.SBF --
   IF EXISTS (_ppath$ + "VPSPEZKO.sbf") THEN 
     CALL DFile(3,"MAADR" + _fpw$)
     CALL DFile(3,"KVERTRAG" + _fpw$)
     CALL DFile(3,"VPSPEZKO" + _fpw$)
     FILE "VPSPEZKO"
     CALL FldAdd("CodeVP","NUM;000000.",1)
     CALL FldAdd("vonCodeMA","NUM;000000.",0)
     CALL FldAdd("vonAgentur","TXT;70",0)
     CALL FldAdd("SR","NUM;999.0000",0)
     CALL FldAdd("SRLZ","NUM;999.",0)
     CALL FldAdd("EUUmstellung","TXT;1",0)
     CALL FldAdd("TStruk","NMI;0.",0)
     SAVE FILE "VPSPEZKO"
     FILE "VPSPEZKO"
     INDEX codekey.VPSPEZKO
     SELECT LAST 
     a1% = codekey.VPSPEZKO
     WHILE i% >= SER ("VPSPEZKO",1)
     WEND 
   END IF 

   CALL KVCheck(9)
   REM -- Anpassung VPRODUKT.SBF --
   IF EXISTS (_ppath$ + "VPRODUKT.sbf") THEN 
     CALL DFile(3,"VPRODUKT" + _fpw$)
     CALL DFile(3,"GEADR" + _fpw$)
     CALL DFile(3,"SPARTEN" + _fpw$)
     FILE "VPRODUKT"
     CALL FldAdd("MWST","NUM;999.00",0)
     CALL FldAdd("AnzahlVertr","NUM;,99999999999999.",0)
     CALL FldAdd("AnzahlStorno","NUM;,99999999999999.",0)
     CALL FldAdd("MinBew","NUM;9999.00",0)
     CALL FldAdd("MaxBew","NUM;9999.00",0)
     CALL FldAdd("MinSRD","NUM;9999.00",0)
     CALL FldAdd("MaxSRD","NUM;9999.00",0)
     CALL FldAdd("MinVol","NUM;9999.00",0)
     CALL FldAdd("MaxVol","NUM;9999.00",0)
     CALL FldAdd("MinTar","NUM;9999.00",0)
     CALL FldAdd("MaxTar","NUM;9999.00",0)
     CALL FldAdd("Bewertungsbasis","NUM;,999999999.0000",0)
     CALL FldAdd("MinBewBBei","NUM;,9999999999.00",0)
     CALL FldAdd("MaxBewBBei","NUM;,9999999999.00",0)
     CALL FldAdd("MinSRDBBei","NUM;,9999999999.00",0)
     CALL FldAdd("MaxSRDBBei","NUM;,9999999999.00",0)
     CALL FldAdd("MinVolBBei","NUM;,9999999999.00",0)
     CALL FldAdd("MaxVolBBei","NUM;,9999999999.00",0)
     CALL FldAdd("MinTarBBei","NUM;,9999999999.00",0)
     CALL FldAdd("MaxTarBBei","NUM;,9999999999.00",0)
     CALL FldAdd("MinBewNBei","NUM;,9999999999.00",0)
     CALL FldAdd("MaxBewNBei","NUM;,9999999999.00",0)
     CALL FldAdd("MinSRDNBei","NUM;,9999999999.00",0)
     CALL FldAdd("MaxSRDNBei","NUM;,9999999999.00",0)
     CALL FldAdd("MinVolNBei","NUM;,9999999999.00",0)
     CALL FldAdd("MaxVolNBei","NUM;,9999999999.00",0)
     CALL FldAdd("MinTarNBei","NUM;,9999999999.00",0)
     CALL FldAdd("MaxTarNBei","NUM;,9999999999.00",0)
     CALL FldAdd("MinBewBzD","NUM;9999.00",0)
     CALL FldAdd("MaxBewBzD","NUM;9999.00",0)
     CALL FldAdd("MinSRDBzD","NUM;9999.00",0)
     CALL FldAdd("MaxSRDBzD","NUM;9999.00",0)
     CALL FldAdd("MinVolBzD","NUM;9999.00",0)
     CALL FldAdd("MaxVolBzD","NUM;9999.00",0)
     CALL FldAdd("MinTarBzD","NUM;9999.00",0)
     CALL FldAdd("MaxTarBzD","NUM;9999.00",0)
     CALL FldAdd("MinBewVS","NUM;,9999999999.00",0)
     CALL FldAdd("MaxBewVS","NUM;,9999999999.00",0)
     CALL FldAdd("MinSRDVS","NUM;,9999999999.00",0)
     CALL FldAdd("MaxSRDVS","NUM;,9999999999.00",0)
     CALL FldAdd("MinVolVS","NUM;,9999999999.00",0)
     CALL FldAdd("MaxVolVS","NUM;,9999999999.00",0)
     CALL FldAdd("MinTarVS","NUM;,9999999999.00",0)
     CALL FldAdd("MaxTarVS","NUM;,9999999999.00",0)
     CALL FldAdd("Provision","NUM;9999.0000",0)
     CALL FldAdd("ProvVonBrutto","TXT;1",0)
     CALL FldAdd("ProzVerteilung","NUM;9999.0000",0)
     CALL FldAdd("VAnzahlVor","NUM;99999999.",0)
     CALL FldAdd("SBewertung","NUM;,9999999999.00",0)
     CALL FldAdd("SBewertungEU","NUM;,9999999999.00",0)
     CALL FldAdd("SVolumen","NUM;,9999999999.00",0)
     CALL FldAdd("SVolumenEU","NUM;,9999999999.00",0)
     CALL FldAdd("SBeitragBRU","NUM;,9999999999.00",0)
     CALL FldAdd("SBeitragBRUEU","NUM;,9999999999.00",0)
     CALL FldAdd("SBeitragNET","NUM;,9999999999.00",0)
     CALL FldAdd("SBeitragNETEU","NUM;,9999999999.00",0)
     CALL FldAdd("SVSumme","NUM;,9999999999.00",0)
     CALL FldAdd("SVSummeEU","NUM;,9999999999.00",0)
     CALL FldAdd("SProvision","NUM;,9999999999.00",0)
     CALL FldAdd("SProvisionEU","NUM;,9999999999.00",0)
     CALL FldAdd("rzumon","NUM;999.0000",0)
     CALL FldAdd("rzuviert","NUM;999.0000",0)
     CALL FldAdd("rzuhalb","NUM;999.0000",0)
     CALL FldAdd("rzujÑhrl","NUM;999.0000",0)
     CALL FldAdd("rzueinmal","NUM;999.0000",0)
     CALL FldAdd("rzusonst","NUM;999.0000",0)
     CALL FldAdd("rzu2mon","NUM;999.0000",0)
     CALL FldAdd("IMWST","NUM;999.00",0)
     CALL FldAdd("NoAnzeige","TXT;1",0)
     CALL FldAdd("AutomNetBer","TXT;1",0)


     CALL FldAdd("VertrGesamt","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu1","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu2","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu3","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu4","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu5","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu6","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu7","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu8","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu9","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu10","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu11","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu12","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu13","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu14","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu15","NUM;,999999999999",0)
     CALL FldAdd("VertrStatu16","NUM;,999999999999",0)
 
     CALL FldAdd("BWVertrGesamt","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu1","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu2","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu3","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu4","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu5","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu6","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu7","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu8","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu9","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu10","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu11","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu12","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu13","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu14","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu15","NUM;,999999999999.00",0)
     CALL FldAdd("BWVertrStatu16","NUM;,999999999999.00",0)
 
     CALL FldAdd("BeiVertrGesamt","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu1","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu2","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu3","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu4","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu5","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu6","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu7","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu8","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu9","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu10","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu11","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu12","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu13","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu14","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu15","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu16","NUM;,999999999999.00",0)
 
     CALL FldAdd("EinhGesamt","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu1","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu2","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu3","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu4","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu5","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu6","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu7","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu8","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu9","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu10","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu11","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu12","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu13","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu14","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu15","NUM;,9999999999.0000",0)
     CALL FldAdd("EinhStatu16","NUM;,9999999999.0000",0)

     CALL FldAdd("AnzSchGesamt","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu1","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu2","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu3","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu4","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu5","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu6","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu7","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu8","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu9","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu10","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu11","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu12","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu13","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu14","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu15","NUM;,9999999999.",0)
     CALL FldAdd("AnzSchStatu16","NUM;,9999999999.",0)
 
     CALL FldAdd("SchGesamt","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu1","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu2","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu3","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu4","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu5","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu6","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu7","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu8","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu9","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu10","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu11","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu12","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu13","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu14","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu15","NUM;,9999999999.00",0)
     CALL FldAdd("SchStatu16","NUM;,9999999999.00",0)
     CALL FldAdd("STATISTDATE","DAT;0d.mm.yyyy",0)
     CALL FldAdd("VertrStatu0","NUM;,999999999999",0)
     CALL FldAdd("BWVertrStatu0","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu0","NUM;,999999999999.00",0)
     CALL FldAdd("EinhStatu0","NUM;,9999999999.0000",0)
     CALL FldAdd("AnzSchStatu0","NUM;,9999999999.",0)
     CALL FldAdd("SchStatu0","NUM;,9999999999.00",0)
     CALL FldAdd("Schadquote","NUM;,9999999.0000",0)
     CALL FldAdd("Stornoquote","NUM;,99999.0000",0)
     CALL FldAdd("CAgez","NUM;,999999999999.00",0)
     CALL FldAdd("RZuschlBer","TXT;1",0)

     CALL FldAdd("FormelBewertun2","TXT;4000",0)
     CALL FldAdd("MinBew2","NUM;9999.00",0)
     CALL FldAdd("MaxBew2","NUM;9999.00",0)

     CALL FldAdd("MinBewBBei2","NUM;,9999999999.00",0)
     CALL FldAdd("MaxBewBBei2","NUM;,9999999999.00",0)

     CALL FldAdd("MinBewNBei2","NUM;,9999999999.00",0)
     CALL FldAdd("MaxBewNBei2","NUM;,9999999999.00",0)

     CALL FldAdd("MinBewBzD2","NUM;9999.00",0)
     CALL FldAdd("MaxBewBzD2","NUM;9999.00",0)

     CALL FldAdd("MinBewVS2","NUM;,9999999999.00",0)
     CALL FldAdd("MaxBewVS2","NUM;,9999999999.00",0)
     CALL FldAdd("FBew2","TXT;4000",0)

     CALL FldAdd("FormelBewertOld","TXT;4000",0)
     CALL FldAdd("FBWénd","DAT;0d.mm.yyyy",0)

     CALL FldAdd("VertrStatu20","NUM;,999999999999",0)
     CALL FldAdd("BWVertrStatu20","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu20","NUM;,999999999999.00",0)
     CALL FldAdd("EinhStatu20","NUM;,9999999999.0000",0)
     CALL FldAdd("AnzSchStatu20","NUM;,9999999999.",0)
     CALL FldAdd("SchStatu20","NUM;,9999999999.00",0)
     CALL FldAdd("VertrStatu21","NUM;,999999999999",0)
     CALL FldAdd("BWVertrStatu21","NUM;,999999999999.00",0)
     CALL FldAdd("BeiVertrStatu21","NUM;,999999999999.00",0)
     CALL FldAdd("EinhStatu21","NUM;,9999999999.0000",0)
     CALL FldAdd("AnzSchStatu21","NUM;,9999999999.",0)
     CALL FldAdd("SchStatu21","NUM;,9999999999.00",0)
     CALL FldAdd("MWSTProvJN","TXT;1",0)
     CALL FldAdd("MWSTProv","NUM;999.00",0)
     CALL FldAdd("MWSTseit","DAT;0d.mm.yyyy",0)
     CALL FldAdd("ZahlBertrMin","NUM;,9999999999.00",0)
     CALL FldAdd("ZahlBertrMax","NUM;,9999999999.00",0)
     CALL FldAdd("noanzaspbuero","TXT;1",0)
     CALL FldAdd("Notiz","TXT;4000 R",0)
     CALL FldAdd("CodeGRSP","NUM;000000.",1)
     CALL FldAdd("Gruppe","TXT;60",0)
     CALL FldAdd("ausgauf","NUM;,999999999.0000",0)
     CALL FldAdd("WKNr","TXT;30",0)
     CALL FldAdd("ImportKZ","TXT;30",1)
     CALL FldAdd("DirektVSKZ","TXT;1",0)
     CALL FldAdd("SR60","TXT;1",0)
     CALL FldAdd("InHaus","NUM;0.",1)
     SAVE FILE "vprodukt"
     MOUSE OFF 
     INDEX codevp.vprodukt
     SELECT LAST 
     WHILE codevp.vprodukt > 990000
       SELECT PREVIOUS 
     WEND 
     WHILE codevp.vprodukt > SER ("VPRODUKT",1)
     WEND 
     IF GIndNeu% = - 1 THEN 
       UPDATE AutomNetBer.vprodukt = "j" WHERE AutomNetBer.vprodukt = ""
       END UPDATE 
     END IF 
     CALL KVCheck(9)
     IF RECCOUNT ("vprodukt") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     WHILE NOT EOF ("vprodukt")
       weiter% = - 1
       CALL Server("UPDFIELD","PrÅfung auf verwendete Gesellschaften und Sparten!")
       CALL Server("UPDSTATUS", STR$ (codevp.vprodukt))
       codege% = codege.vprodukt
       codeva% = codeva.vprodukt
       IF NOT EXISTS (codege.vprodukt,codege.geadr) AND weiter% = - 1 THEN 
         REMOVE FROM FILE "vprodukt" WHERE codege.vprodukt = codege%
         SELECT FIRST LOCK 
         weiter% = 0
       END IF 
       IF NOT EXISTS (codeva.vprodukt,codeva.sparten) AND weiter% = - 1 THEN 
         REMOVE FROM FILE "vprodukt" WHERE codeva.vprodukt = codeva%
         SELECT FIRST LOCK 
         weiter% = 0
       END IF 
       codevp% = codevp.vprodukt
       SELECT FIRST FILE "vprodukt" INDEX codevp.vprodukt
       SELECT KEY codevp% LOCK FILE "vprodukt" INDEX codevp.vprodukt
       IF codegrsp.vprodukt = 0 THEN 
         SELECT FIRST FILE "sparten" INDEX codeva.sparten
         SELECT KEY codeva% FILE "sparten" INDEX codeva.sparten
         IF codeva.sparten = codeva% AND codegrsp.sparten > 0 THEN 
           SELECT FIRST FILE "spgruppe" INDEX codegrsp.spgruppe
           SELECT KEY codegrsp.sparten FILE "spgruppe" INDEX codegrsp.spgruppe
           codegrsp.vprodukt = codegrsp.sparten
           gruppe.vprodukt = gruppe.spgruppe
           STORE FILE "vprodukt"
         ELSE 
           IF codegrsp.sparten = 0 THEN 
             codegrsp.vprodukt = 0
             Gruppe.vprodukt = "<ohne Zuordnung>"
             STORE FILE "vprodukt"
           END IF 
         END IF 
       END IF 
       IF weiter% <> 0 THEN SELECT NEXT LOCK FILE "vprodukt"
     WEND 

     FILE "Vprodukt"
     IF RECCOUNT ("vprodukt") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     WHILE NOT EOF ("vprodukt")
       IF Bewertungsbasis.vprodukt = 0 THEN 
         Bewertungsbasis.vprodukt = 1
         STORE FILE "VPRODUKT"
       END IF 
       SELECT NEXT LOCK 
     WEND 


     CALL KVCheck(10)

     FILE "KVERTRAG"
     INDEX QuickGEVA.kvertrag
     IF RECCOUNT ("Kvertrag") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     i% = 0
    zanz% = RECCOUNT ("Kvertrag")
    b$ = LTRIM$ ( STR$ (zanz%,",9999999"))
    WHILE NOT EOF ("Kvertrag") AND GIndNeu% = - 1
      lfdnr% = lfdnr.kvertrag
      i% = i% + 1
      SET STATUS "Erstelle Produktdatei, prÅfe VertrÑge: " + STR$ (i%,",999999") + " von " + b$
      IF EXISTS (codevp.kvertrag,codevp.vprodukt) THEN 
        SELECT FIRST FILE "vprodukt" INDEX codevp.vprodukt
        SELECT KEY codevp.kvertrag FILE "vprodukt" INDEX codevp.vprodukt
        codege.kvertrag = codege.vprodukt
        codeva.kvertrag = codeva.vprodukt
        Gesellschaft.kvertrag = Gesellschaft.vprodukt
        Sparte.kvertrag = Sparte.vprodukt
        QuickGEVA.kvertrag = STR$ (CodeGE,"000000") + STR$ (CodeVA,"000000")
        QuickKUGEs.kvertrag = STR$ (CodeKU,"000000") + gesellschaft.kvertrag
        QuickKUSpar.kvertrag = STR$ (CodeKU,"000000") + sparte.kvertrag
        QuickGesSpar.kvertrag = STR$ (CodeKU,"000000") + gesellschaft.kvertrag + sparte.kvertrag
        produkt.kvertrag = Gesellschaft.kvertrag + " / " + sparte.kvertrag
        QuickGesSpart.kvertrag = gesellschaft.kvertrag + sparte.kvertrag
        IF Bewertungssumme.kvertrag <> 0 THEN 
          bewert% = Bewertungsbasis.vprodukt
          IF Bewertungsbasis.vprodukt = - 1 THEN 
            Einheiten.kvertrag = 0
          ELSE 
            einh$ = STR$ (Bewertungssumme.kvertrag / bewert%,",9999999999.0000")
            Einheiten.kvertrag = VAL (einh$)
          END IF 
        END IF 
        STORE FILE "kvertrag"
      ELSE 
       IF NOT EXISTS (QuickGEVA.kvertrag,QCodeGEVA.vprodukt) AND codege.kvertrag > 0 AND codeva.kvertrag > 0 THEN 
         SELECT KEY codege.kvertrag FILE "geadr" INDEX codege.geadr
         SELECT KEY codeva.kvertrag FILE "Sparten" INDEX codeva.sparten
         IF EXISTS (codege.kvertrag,codege.geadr) AND EXISTS (codeva.kvertrag,codeva.sparten) THEN 
           FILE "vprodukt"
           REM CALL Fehler("Vprod aufnehmen3","")
           BLANK FILE "VProdukt"
           codevp% = SER ("Vprodukt",1)
           codevp.vprodukt = codevp%
           codege.vprodukt = codege.kvertrag
           codeva.vprodukt = codeva.kvertrag
           Gesellschaft.vprodukt = Gesellschaft.geadr
           Sparte.vprodukt = Sparte.sparten
           QCodeGEVA.vprodukt = STR$ (CodeGE.vprodukt,"000000") + STR$ (Codeva.vprodukt,"000000")
           GesSpa.Vprodukt = Gesellschaft.vprodukt + Sparte.vprodukt
           STORE FILE "Vprodukt"
           UNLOCK CURRENT 
           codevp.kvertrag = codevp%
           IF Bewertungssumme.kvertrag <> 0 THEN 
             bewert% = Bewertungsbasis.vprodukt
             IF Bewertungsbasis.vprodukt = - 1 THEN 
               Einheiten.kvertrag = 0
             ELSE 
               einh$ = STR$ (Bewertungssumme.kvertrag / bewert%,",9999999999.0000")
               Einheiten.kvertrag = VAL (einh$)
             END IF 
           END IF 
           STORE FILE "Kvertrag"
           UNLOCK CURRENT 
         END IF 
       ELSE 
         okkv% = 0
         IF codevp.Kvertrag < 1 THEN 
           SELECT KEY QuickGEVA.kvertrag FILE "Vprodukt" INDEX QCodeGEVA.vprodukt
           codevp.kvertrag = codevp.vprodukt
         ELSE 
           SELECT KEY codevp.kvertrag FILE "Vprodukt" INDEX codevp.vprodukt
         END IF 
         rzumon.kvertrag = rzumon.vprodukt
         mwst.kvertrag = mwst.vprodukt
         rzuviert.kvertrag = rzuviert.vprodukt
         rzuhalb.kvertrag = rzuhalb.vprodukt
         rzujÑhrl.kvertrag = rzujÑhrl.vprodukt
         rzueinmal.kvertrag = rzueinmal.vprodukt
         rzusonst.kvertrag = rzusonst.vprodukt
         IF Bewertungssumme.kvertrag <> 0 THEN 
           bewert% = Bewertungsbasis.vprodukt
           IF Bewertungsbasis.vprodukt = - 1 THEN 
             Einheiten.kvertrag = 0
           ELSE 
             einh$ = STR$ (Bewertungssumme.kvertrag / bewert%,",9999999999.0000")
             Einheiten.kvertrag = VAL (einh$)
           END IF 
         END IF 
         STORE FILE "kvertrag"
         UNLOCK CURRENT FILE "kvertrag"
       END IF 
      END IF 
       FILE "kvertrag"
       SELECT NEXT LOCK FILE "kvertrag"
    WEND 

     CALL KVCheck(11)

     FILE "Kvertrag"
     INDEX QuickGEVA.kvertrag
     SELECT FIRST 
     FILE "Vprodukt"
     INDEX CodeVP.vprodukt
     IF RECCOUNT ("Vprodukt") > 0 THEN 
       SELECT FIRST LOCK 
       j% = 0
       j1% = RECCOUNT ("VPRODUKT")
       WHILE NOT EOF ("Vprodukt") AND GIndNeu% = - 1
         j% = j% + 1
         codevp% = codevp.vprodukt
         FILE "Kvertrag"
         SELECT FIRST 
         SELECT KEY CodeVP% FILE "Kvertrag" INDEX CodeVP.kvertrag
         i% = 0
         WHILE NOT EOF ("Kvertrag") AND CodeVP.kvertrag = CodeVP%
           i% = i% + 1
           SELECT NEXT 
           SET STATUS STR$ (j%,"999999") + " von " + STR$ (j1%,"999999") + "    gefunden " + STR$ (i%,"999999")
         WEND 
         FILE "VPRODUKT"
         AnzahlVertr.vprodukt = i%
         STORE FILE "Vprodukt"
         UNLOCK CURRENT FILE "Vprodukt"
         SELECT NEXT LOCK 
       WEND 
     END IF 
   END IF 
   CALL KVCheck(12)

   REM -- Anpassung FONDS.SBF --
   IF EXISTS (_ppath$ + "FONDS.sbf") THEN 
     CALL DFile(3,"FONDS" + _fpw$)
     FILE "FONDS"
     CALL FldAdd("DatumImport","DAT;0d.mm.yyyy",1)
     CALL FldAdd("ProviDM","NUM;,999999999999.00",0)
     CALL FldAdd("ProviEuro","NUM;,999999999999.00",0)
     CALL FldAdd("ProviWaehr","NUM;,999999999999.00",0)
     CALL FldAdd("CodeImp","NUM;0000000.",1)
     CALL FldAdd("QuickVSIMP","TXT;12",1)
     CALL FldAdd("ProzFirma","NUM;999.0000",0)
     CALL FldAdd("CodeAZ","NUM;0000000.",1)
     CALL FldAdd("ZEUebern","TXT;1",0)
     CALL FldAdd("UmrechUSTag","NUM;999999.00000000",0)
     CALL FldAdd("BAntPreisinWaeh","NUM;,9999999999.0000",0)
     CALL FldAdd("BAntPreisinDM","NUM;,9999999999.0000",0)
     CALL FldAdd("BAntPreisinUS","NUM;,9999999999.0000",0)
     CALL FldAdd("BAntPreisinEuro","NUM;,9999999999.0000",0)
     CALL FldAdd("BKursEuro","NUM;999999.00000000",0)
     CALL FldAdd("BKursUS","NUM;999999.00000000",0)
     CALL FldAdd("BAnlageDM","NUM;+,999999999999.00",0)
     CALL FldAdd("BAnlageUS","NUM;+,999999999999.00",0)
     CALL FldAdd("BAnlageEuro","NUM;+,999999999999.00",0)
     CALL FldAdd("BKursTag","DAT;0d.mm.yyyy",0)
     CALL FldAdd("BAnlageWaehr","NUM;+,999999999999.00",0)
     CALL FldAdd("QuickVTBerDat","TXT;20",1)
     CALL FldAdd("BKursZeit","TIM;hh:mm:ss",0)
     CALL FldAdd("BRÅckkaufDM","NUM;+,9999999999.0000",0)
     CALL FldAdd("BRÅckkaufUS","NUM;+,9999999999.0000",0)
     CALL FldAdd("BRÅckkaufEuro","NUM;+,9999999999.0000",0)
     CALL FldAdd("BRÅckkaufWaehr","NUM;+,9999999999.0000",0)
     CALL FldAdd("BBestandDM","NUM;+,999999999999.00",0)
     CALL FldAdd("BBestandUS","NUM;+,999999999999.00",0)
     CALL FldAdd("BBestandEuro","NUM;+,999999999999.00",0)
     CALL FldAdd("BBestandWaehr","NUM;+,999999999999.00",0)
     CALL FldAdd("Preis","NUM;+,999999999999.00",0)
     CALL FldAdd("PreisEuro","NUM;+,999999999999.00",0)
     CALL FldAdd("PreisDollar","NUM;+,999999999999.00",0)
     CALL FldAdd("Anteile","NUM;+,9999999999.0000",0)
     CALL FldAdd("ISIN","TXT;20",0)
     CALL FldAdd("WKN","TXT;20",0)
     CALL FldAdd("Buchungsnr","TXT;20",0)
     CALL FldAdd("Emissionsk","NUM;99.0000",0)
     CALL FldAdd("VT_Anlage","TXT;20",0)
     CALL FldAdd("Transaktion","TXT;20",0)
     CALL FldAdd("CodeW","NUM;000000.",0)
 
     SAVE FILE "FONDS"
     IF GIndNeu% = - 1 THEN 
       UPDATE QuickVTBerDat.fonds = STR$ (codevt.fonds,"000000") + DATE$ (BKursTag.fonds,"yyyymm0d") + LEFT$ ( TIME$ (BKursZeit.fonds,"hh:mm:ss"),2) + MID$ ( TIME$ (BKursZeit.fonds,"hh:mm:ss"),4,2) + RIGHT$ ( TIME$ (BKursZeit.fonds,"hh:mm:ss"),2)
       END UPDATE 
     END IF 
     FILE "fonds"
     INDEX codevt.fonds
     IF RECCOUNT ("fonds") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     WHILE NOT EOF ("fonds") AND GIndNeu% = - 1
       IF kauf.fonds <> "k" THEN 
         IF kauf.fonds <> "j" THEN 
           IF Preis.fonds > 0 THEN Preis.fonds = Preis.fonds * - 1
           IF Anteile.fonds > 0 THEN Anteile.fonds = Anteile.fonds * - 1
           kauf.fonds = "n"
           STORE FILE "fonds"
         ELSE 
           IF kauf.fonds = "j" THEN 
             IF Preis.fonds < 0 THEN Preis.fonds = Preis.fonds * - 1
             IF Anteile.fonds < 0 THEN Anteile.fonds = Anteile.fonds * - 1
             kauf.fonds = "j"
             STORE FILE "fonds"
           END IF 
         END IF 
       END IF 
       SELECT NEXT LOCK 
     WEND 
     
   END IF 
   IF EXISTS (_ppath$ + "REDRU.sbf") THEN 
     CALL DFile(3,"REDRU" + _fpw$)
     FILE "REDRU"
     CALL FldAdd("Postanschrift","TXT;4000 R",1)
     SAVE FILE "REDRU"
   END IF 
   REM -- Anpassung KUKTO.SBF --
CreateKukto1410010: 
   IF EXISTS (_ppath$ + "KUKTO.sbf") THEN 
   j% = 0
CreateKukto141001: 
     IF j% = 0 THEN 
       CALL DFile(3,"KUKTO" + _fpw$)
       FILE "KUKTO"
     END IF 
     IF j% = 1 THEN 
       CALL DFile(3,"BUCHges" + _fpw$)
       FILE "BUCHGES"
     END IF 
     CALL FldAdd("manuell","TXT;1",1)
     CALL FldAdd("gedruckt","TXT;1",1)
     CALL FldAdd("QuickVSNR","TXT;60",1)
     CALL FldAdd("QVTDat","TXT;14",1)
     CALL FldAdd("CodeInk","NUM;0000000.",1)
     CALL FldAdd("mahn","NUM;0000000.",1)
     CALL FldAdd("nachname","TXT;50",1)
     CALL FldAdd("Vorname","TXT;50",0)
     CALL FldAdd("Geburtsname","TXT;50",0)
     CALL FldAdd("Anrede","TXT;50",0)
     CALL FldAdd("Titel","TXT;50",0)
     CALL FldAdd("Stra·e","TXT;50",0)
     CALL FldAdd("Ort","TXT;50",0)
     CALL FldAdd("PLZ","TXT;8",0)
     CALL FldAdd("dtaus","TXT;1",1)
     CALL FldAdd("DtausDatei","TXT;100",0)
     CALL FldAdd("DatumDruck","DAT;0d.mm.yyyy",0)
     CALL FldAdd("wannerstellt","DAT;0d.mm.yyyy",0)
     CALL FldAdd("gezahltam2","DAT;0d.mm.yyyy",0)
     CALL FldAdd("Zahlungseingang","TXT;4000 R",0)
     CALL FldAdd("NotizText","TXT;4000 R",0)
     CALL FldAdd("Mahnung","TXT;100",1)
     CALL FldAdd("MahnDruck","DAT;0d.mm.yyyy",0)
     CALL FldAdd("NotizProvision","TXT;400 R",0)
     CALL FldAdd("verrechnet","TXT;1",1)
     CALL FldAdd("CodeBU","NUM;0000000.",1)
     CALL FldAdd("CodeVP","NUM;0000000.",1)
     CALL FldAdd("erlverr","TXT;2",1)
     CALL FldAdd("CodeInkGead","NUM;0000000.",1)
     CALL FldAdd("GesBuDat","DAT;0d.mm.yyyy",0)
     CALL FldAdd("Umrechnung","NUM;,99999999.000000",0)
     CALL FldAdd("CodeW","NUM;000000.",1)
     CALL FldAdd("Waehrung","TXT;6",0)
     CALL FldAdd("BeitragEu","NUM;,99999999.00",0)
     CALL FldAdd("Beitrag","NUM;,99999999.00",0)
     CALL FldAdd("gezBetragEu","NUM;,99999999.00",0)
     CALL FldAdd("gezBetrag","NUM;,99999999.00",0)
     CALL FldAdd("gezBeitrag1","NUM;,99999999.00",0)
     CALL FldAdd("gezBeitrag1Eu","NUM;,99999999.00",0)
     CALL FldAdd("einzelabruf","TXT;1",0)
     CALL FldAdd("Courtage","NUM;,99999999.00",0)
     CALL FldAdd("UEBERWTXT","TXT;27",0)
     CALL FldAdd("Abruf","TXT;1",0)
     CALL FldAdd("BeitrAnd","TXT;3",0)
     CALL FldAdd("Provision","NUM;,99999999.00",0)
     CALL FldAdd("QNumVSNR","TXT;60",1)
     IF j% = 0 THEN 
       SAVE FILE "KUKTO"
       j% = 1
       GOTO CreateKukto141001
     END IF 
     IF j% = 1 THEN 
       SAVE FILE "BUCHGES"
     END IF 
     FILE "KUKTO"
     INDEX codekuko.kukto
     SELECT LAST 
     WHILE codekuko.kukto > SER ("KUKTO",1)
     WEND 
     IF RECCOUNT ("KUKTO") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     i% = 0
     WHILE NOT EOF ("Kukto") AND GIndNeu% = - 1
       i% = i% + 1
       SET STATUS STR$ (i%,"99999999") + " DatensÑtze angepasst"
       IF mahnung.kukto = "" THEN mahnung.kukto = "n"
       IF erledigtJaNein.kukto = "" THEN erledigtJaNein.kukto = "n"
       IF dtaus.kukto = "" THEN dtaus.kukto = "n"
       IF gedruckt.kukto = "" THEN gedruckt.kukto = "n"
       IF erlverr.kukto = "" THEN erlverr.kukto = "n"
       SELECT FIRST FILE "KVERTRAG" INDEX lfdnr.kvertrag
       SELECT KEY codevt.kukto FILE "KVERTRAG" INDEX lfdnr.kvertrag
       codevp.kukto = codevp.kvertrag
       codew.kukto = codew.kvertrag
       waehrung.kukto = waehrung.kvertrag
       umrechnung.kukto = umrechnung.kvertrag
       BeitragEU.kukto = Beitrag.kukto / umrechnung.kukto
       gezBetragEu.kukto = gezBetrag.kukto / umrechnung.kukto
       gezBeitrag1Eu.kukto = gezBeitrag1.kukto / umrechnung.kukto
       QuickVSNR.KUKTO = VSNRPack$(VS_Nr.KUKTO)
       QNumVSNR.kukto = VSNRPackNum$(VS_NR.kukto)
       IF einzelabruf.kukto LIKE "0" THEN 
         einzelabruf.kukto = "n"
       ELSE 
         einzelabruf.kukto = "j"
       END IF 
       REM Anpassung an EuroFelder

       STORE FILE "kukto"
       SELECT NEXT LOCK 
     WEND 
     SET STATUS ""

   END IF 
 
   REM -- Anpassung INKSTAMM.SBF --
   IF EXISTS (_ppath$ + "INKSTAMM.sbf") THEN 
     CALL DFile(3,"INKSTAMM" + _fpw$)
     FILE "INKSTAMM"
     CALL FldAdd("HauptfÑlligkeit","NUM;00.",1)
     CALL FldAdd("DtausDatei","TXT;100",0)
     CALL FldAdd("wannerstellt","DAT;0d.mm.yyyy",0)
     SAVE FILE "INKSTAMM"
   END IF 
 
   CALL KVCheck(12)

   REM -- Anpassung ZEINGANG.SBF --
   CALL DFile(3,"ZEINGANG" + _fpw$)
   FILE "zeingang"
   CALL FldAdd("CodeAZ","NUM;0000000.",1)
   CALL FldAdd("CodeVT","NUM;0000000.",1)
   CALL FldAdd("CodeGE","NUM;0000000.",1)
   CALL FldAdd("gebucht","TXT;1",1)
   CALL FldAdd("Betrag_gezahlt","NUM;,9999999.00",0)
   CALL FldAdd("BetragEU","NUM;,9999999.00",0)
   CALL FldAdd("VS_Nr","TXT;30",1)
   CALL FldAdd("Datum","DAT;0d.mm.yyyy",1)
   CALL FldAdd("QuickVSNR","TXT;60",1)
   CALL FldAdd("QNumVSNR","TXT;60",1)
   CALL FldAdd("Umrechnung","NUM;,99999999.000000",0)
   CALL FldAdd("CodeW","NUM;000000.",1)
   CALL FldAdd("Waehrung","TXT;6",0)
   CALL FldAdd("CodeImp","NUM;0000000.",1)
   CALL FldAdd("Ausgabeauf","NUM;,999.00",0)
   CALL FldAdd("AntragsNr","TXT;30",0)
   CALL FldAdd("CodeEingGE","NUM;000000.",1)
   CALL FldAdd("EingereichtBei","TXT;50",0)
   CALL MarkMain("CodeAZ")
   SAVE FILE "ZEINGANG"
 
   IF RECCOUNT ("ZEINGANG") <> 0 THEN 
     INDEX CodeAZ
     SELECT LAST 
     WHILE CodeAZ > SER ("ZEINGANG",1)
     WEND 
     SELECT FIRST LOCK 
     WHILE NOT EOF ("ZEINGANG")
       IF CodeAZ < 1 THEN 
         CodeAZ = SER ("ZEINGANG",1)
         STORE 
       END IF 
       SELECT NEXT LOCK 
     WEND 
     CALL Server("UPDFIELD","")'                         ; Anzeige aktualisieren
     CALL Server("UPDSTATUS","PrÅfe VertrÑge...")
     REM -- VertrÑge mit vorhandenen ZahlungseingÑngen fÅr
     REM -- Zahlungseingangskontrolle markieren
     FILE "ZEINGANG"
     INDEX CodeAZ.ZEINGANG
     SELECT FIRST 
     IF RECCOUNT ("KVERTRAG") > 0 AND RECCOUNT ("zeingang") > 0 THEN 
       WHILE NOT EOF ("ZEINGANG")
         SELECT KEY CodeVT.ZEINGANG LOCK FILE "KVERTRAG" INDEX lfdnr.KVERTRAG
         CALL Server("UPDSTATUS","PrÅfe VertrÑge...(" + VS_NR.KVERTRAG + ")")
         IF FOUND ("KVERTRAG") AND Check.KVERTRAG <> "j" THEN 
           Check.KVERTRAG = "j"
           CALL QuickStore("KVERTRAG")
         END IF 
         SELECT NEXT FILE "ZEINGANG" INDEX CodeAZ.ZEINGANG
       WEND 
           FILE "zeingang"
           INDEX codeaz.zeingang
           SELECT FIRST LOCK 
           i% = 0
           j% = RECCOUNT ("zeingang")
           WHILE NOT EOF ("Zeingang")
             i% = i% + 1
             SET STATUS STR$ (i%,",99999999") + " DatensÑtze in ZEINGAN1 angepasst"
             SELECT FIRST FILE "KVERTRAG" INDEX lfdnr.kvertrag
             SELECT KEY codevt.zeingang FILE "KVERTRAG" INDEX lfdnr.kvertrag
             IF CodeEingGE.kvertrag > 0 THEN 
               CodeEingGE.zeingang = CodeEingGE.kvertrag
               EingereichtBei.zeingang = EingereichtBei.kvertrag
               STORE FILE "zeingang"
             END IF 
             SELECT NEXT LOCK FILE "zeingang" INDEX codeaz.zeingang
           WEND 
     END IF 
     FILE "stamm"
     SELECT FIRST 
     euro1% = umrechnung.stamm
     codew1% = codew.stamm
     waehrung1$ = waehrung.stamm
     wbez1$ = waehrung.stamm

     CALL KVCheck(13)
     FILE "ZEINGANG"
     INDEX CodeAZ.ZEINGANG
     IF RECCOUNT ("ZEINGANG") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     i% = 0
     j% = RECCOUNT ("ZEINGANG")
     WHILE NOT EOF ("ZEINGANG") AND GIndNeu% = - 1
       i% = i% + 1
       SET STATUS STR$ (i%,"999999") + " von " + STR$ (j%,"999999") + " DatensÑtze angepa·t"
       ok% = 0
       IF umrechnung.ZEINGANG < 0.0001 THEN 
         umrechnung.ZEINGANG = euro1%
         codew.ZEINGANG = codew1%
         waehrung.ZEINGANG = waehrung1$
         BetragEU = Betrag_gezahlt / euro1%
         ok% = 1
       END IF 
       IF waehrung.ZEINGANG LIKE "EUR*" THEN 
         codew.ZEINGANG = 3
         waehrung.ZEINGANG = "EUR"
         umrechnung.ZEINGANG = 1
       END IF 
       IF waehrung.ZEINGANG LIKE "DM*" THEN 
         codew.ZEINGANG = 1
         waehrung.ZEINGANG = "DM"
         umrechnung.ZEINGANG = 1.95583
       END IF 
       IF codew.zeingang = 1 THEN 
         ok% = 1
         umrechnung.zeingang = 1.955830
         euro1% = 1.955830
         BetragEU = Betrag_gezahlt / euro1%
       END IF 
       QNumVSNR.zeingang = VSNRPackNum$(VS_NR.zeingang)
       ok% = 1
       IF ok% = 1 THEN STORE FILE "zeingang"
       SELECT NEXT LOCK 
     WEND 
 
   END IF 
   CALL KVCheck(14)
 
   REM -- Anpassung ZEINVOR.SBF --
   IF EXISTS (_ppath$ + "zeinvor.sbf") THEN 
     CALL DFile(3,"zeinvor" + _fpw$)
     FILE "zeinvor"
     CALL FldAdd("CodeVP","NUM;0000000.",1)
     CALL FldAdd("QuickVSNR","TXT;60",1)
     CALL FldAdd("QNumVSNR","TXT;60",1)
     CALL FldAdd("FaelSR","DAT;0d.mm.yyyy",0)
     CALL FldAdd("CodeEingGE","NUM;000000.",1)
     CALL FldAdd("EingereichtBei","TXT;50",0)
     SAVE FILE "zeinvor"
     IF RECCOUNT ("zeinvor") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     i% = 0
     WHILE NOT EOF ("Zeinvor")
       i% = i% + 1
       SET STATUS LTRIM$ ( STR$ (i%,",9999999")) + " in zeinvor angepasst"
       QuickVSNR.zeinvor = VSNRPack$(VS_Nr.zeinvor)
       QNumVSNR.zeinvor = VSNRPackNum$(VS_Nr.zeinvor)
       BewertungEU.zeinvor = VAL ( STR$ (Bewertung.zeinvor / Umrechnung.zeinvor,"99999999.00"))
       SREU.zeinvor = VAL ( STR$ (SR.zeinvor / Umrechnung.zeinvor,"99999999.00"))
       IF EXISTS (codevt.zeinvor,lfdnr.kvertrag) THEN 
         SELECT FIRST FILE "KVERTRAG" INDEX lfdnr.kvertrag
         SELECT KEY codevt.zeinvor FILE "KVERTRAG" INDEX lfdnr.kvertrag
         workstation.zeinvor = workstation.kvertrag
         CodeEingGE.zeinvor = CodeEingGE.kvertrag
         EingereichtBei.zeinvor = EingereichtBei.kvertrag
         REM codema.zeinvor = codema.kvertrag
       END IF 
       STORE FILE "ZEINVOR"
       SELECT NEXT LOCK FILE "zeinvor"
     WEND 
   END IF 
   IF EXISTS (_ppath$ + "zeingan1.sbf") THEN 
     REM CALL Fehler("zeingan1","")
     CALL DFile(3,"KVERTRAG" + _fpw$)
     CALL DFile(3,"zeingan1" + _fpw$)
     FILE "zeingan1"
     CALL FldAdd("QuickVSNR","TXT;60",1)
     CALL FldAdd("QNumVSNR","TXT;60",1)
 
     CALL FldAdd("BetragEU","NUM;,9999999.00",0)
     CALL FldAdd("BetraggezEU","NUM;,9999999.00",0)
     CALL FldAdd("gezahltEU","NUM;,9999999.00",0)
     CALL FldAdd("SREU","NUM;,9999999.00",0)
     CALL FldAdd("SRAuszahlungEU","NUM;,9999999.00",0)
     CALL FldAdd("BewertungEU","NUM;,999999999.00",0)
     CALL FldAdd("Umrechnung","NUM;,99999999.000000",0)
     CALL FldAdd("CodeW","NUM;000000.",1)
     CALL FldAdd("Waehrung","TXT;6",0)
     CALL FldAdd("QuickVSNRDat","TXT;38",1)
     CALL FldAdd("CodeImp","NUM;0000000.",1)
     CALL FldAdd("Ausgabeauf","NUM;,999.00",0)
     CALL FldAdd("KundEinzahlung","NUM;,999999999.00",0)
     CALL FldAdd("KundEinzahluEU","NUM;,999999999.00",0)
     CALL FldAdd("AnlageDatum","DAT;0d.mm.yyyy",0)
     CALL FldAdd("AntragsNr","TXT;30",0)
     CALL FldAdd("BuchDatOld","DAT;0d.mm.yyyy",0)
     CALL FldAdd("CoderoImp","NUM;0000000.",1)
     CALL FldAdd("Vorschujn","NUM;0.",1)
     CALL FldAdd("FS24Satz_ID","TXT;14",1)
     CALL FldAdd("BetragBrut","NUM;,999999999.00",0)
     CALL FldAdd("ZahlBertrMin","NUM;,9999999999.00",0)
     CALL FldAdd("ZahlBertrMax","NUM;,9999999999.00",0)
     CALL FldAdd("MWST","NUM;999.00",0)
     CALL FldAdd("BewertKV","NUM;,999999999999.00",0)
     CALL FldAdd("CodeImpPSP","NUM;0000000.",1)
     CALL FldAdd("ZNotiz","TXT;400 R",0)
     CALL FldAdd("ausZESplitt","NUM;0.",0)
     CALL FldAdd("EinhNichtBuchJN","TXT;1",0)
     CALL FldAdd("CodeImpPFL","NUM;0000000.",1)
     REM CALL FldAdd("SRSPEZ","TXT;1",0)
     CALL FldAdd("gebuchtJN","TXT;1",1)
     CALL FldAdd("CodeEingGE","NUM;000000.",1)
     CALL FldAdd("EingereichtBei","TXT;50",0)
     CALL MarkMain("CodeAZ")
     SAVE FILE "zeingan1"

     CALL KVCheck(15)

     FILE "zeingan1"
     IF RECCOUNT ("zeingan1") <> 0 THEN 
       INDEX CodeAZ
       SELECT LAST 
       WHILE CodeAZ > SER ("zeingan1",1)
       WEND 
w120820062: 
       SELECT FIRST LOCK 
       i% = 0
       j% = RECCOUNT ("zeingan1")
       WHILE NOT EOF ("zeingan1") AND CodeAZ.zeingan1 < 1
         i% = i% + 1
         SET STATUS STR$ (i%,",999999999") + " von " + STR$ (j%,",999999999") + "in zeingan1 geprÅft"
         IF CodeAZ.zeingan1 < 1 THEN 
           CodeAZ.zeingan1 = SER ("zeingan1",1)
           STORE FILE "zeingan1"
           GOTO w120820062
         END IF 
         SELECT NEXT LOCK 
       WEND 

       INDEX codeaz.zeingan1
ze270601001: 
       REM CALL Fehler("","")
       SELECT WHERE FILE "zeingan1"

       REM IF Geurofin% = - 1 AND RECCOUNT ("zeingan1") > 0 THEN 
       IF RECCOUNT ("zeingan1") > 0 THEN 
         INDEX codege.zeingan1
         SELECT FIRST FILE "zeingan1" INDEX codege.zeingan1
         IF codege.zeingan1 < 1 THEN 
           SELECT FIRST LOCK FILE "zeingan1" INDEX codege.zeingan1
           ok% = - 1
           i% = 0
           WHILE NOT EOF ("Zeingan1") AND ok% = - 1
             REM SELECT FIRST FILE "KVERTRAG" INDEX lfdnr.kvertrag
             REM SELECT KEY codevt.zeingan1 FILE "KVERTRAG" INDEX lfdnr.kvertrag
             IF codege.zeingan1 < 1 THEN 
               i% = i% + 1
               SET STATUS STR$ (i%,",99999999") + " DatensÑtze in ZEINGAN1 angepasst"
               SELECT FIRST FILE "KVERTRAG" INDEX lfdnr.kvertrag
               SELECT KEY codevt.zeingan1 FILE "KVERTRAG" INDEX lfdnr.kvertrag
               codege.zeingan1 = codege.kvertrag
               CALL QuickStore("zeingan1")
               SELECT FIRST LOCK FILE "zeingan1" INDEX codege.zeingan1
             ELSE 
               IF codevt.zeingan1 < 1 THEN 
                 SELECT NEXT LOCK FILE "zeingan1" INDEX codege.zeingan1
               ELSE 
                 ok% = 0
               END IF 
             END IF 

           WEND 
           FILE "zeingan1"
           INDEX codeaz.zeingan1
           SELECT FIRST LOCK 
           i% = 0
           WHILE NOT EOF ("Zeingan1") AND ok% = - 1
             i% = i% + 1
             SET STATUS STR$ (i%,",99999999") + " DatensÑtze in ZEINGAN1 angepasst"
             SELECT FIRST FILE "KVERTRAG" INDEX lfdnr.kvertrag
             SELECT KEY codevt.zeingan1 FILE "KVERTRAG" INDEX lfdnr.kvertrag
             IF CodeEingGE.kvertrag > 0 THEN 
               CodeEingGE.zeingan1 = CodeEingGE.kvertrag
               EingereichtBei.zeingan1 = EingereichtBei.kvertrag
               STORE FILE "zeingan1"
             END IF 
             SELECT NEXT LOCK FILE "zeingan1" INDEX codeaz.zeingan1
           WEND 
         END IF 
       END IF 
       MOUSE OFF 
       REQUEST "Anpassung zeingan1!","Das dauert etwas!",2
       UPDATE BetragBrut.zeingan1 = Bewertung.zeingan1 WHERE Betragbrut.zeingan1 = 0
       END UPDATE 
       CALL KVCheck(16)
       REM GOTO ze270601002
       IF RECCOUNT ("zeingan1") > 0 THEN 
         SELECT FIRST LOCK 
       ELSE 
         SELECT LAST 
       END IF 
       m% = 0
       mm% = RECCOUNT ("zeingan1")
       mmm% = 0
       WHILE NOT EOF ("zeingan1")
         m% = m% + 1
         SET STATUS STR$ (m%,",99999999") + "  zeingan1 geprÅft von " + STR$ (mm%,",99999999") + "   gesetzt " + STR$ (mmm%,",99999999")
         IF gebuchtJN.zeingan1 LIKE "J" THEN 
         ELSE 
           IF BewertKV.zeingan1 < 0.01 THEN 
             codevt% = codevt.zeingan1
             SELECT FIRST FILE "kvertrag" INDEX lfdnr.kvertrag
             SELECT KEY codevt% FILE "kvertrag" INDEX lfdnr.kvertrag
             REM SELECT CURRENT LOCK FILE "zeingan1"
             BewertKV.zeingan1 = Bewertungssumme.kvertrag
             STORE FILE "zeingan1"
           END IF 
           mmm% = mmm% + 1
         END IF 
         SELECT NEXT LOCK FILE "zeingan1"
       WEND 
ze270601002: 
       CALL Server("UPDFIELD","")'                         ; Anzeige aktualisieren
       CALL Server("UPDSTATUS","PrÅfe VertrÑge...")
       CALL KVCheck(17)
       FILE "stamm"
       SELECT FIRST 
       euro1% = umrechnung.stamm
       codew1% = codew.stamm
       waehrung1$ = waehrung.stamm
       wbez1$ = waehrung.stamm

       FILE "zeingan1"
       INDEX CodeAZ.zeingan1
       IF RECCOUNT ("zeingan1") > 0 THEN 
         SELECT FIRST LOCK 
       ELSE 
         SELECT LAST 
       END IF 
       i% = 0
       DATEBASE "0d.mm.yyyy"
       zanz% = RECCOUNT ("zeingan1")
       b$ = LTRIM$ ( STR$ (zanz%,",99999999"))
       WHILE NOT EOF ("zeingan1") AND GIndNeu% = - 1
         i% = i% + 1
         SET STATUS STR$ (i%,",9999999") + " ZEINGAN1 - DatensÑtze angepa·t von " + b$
         IF umrechnung.zeingan1 < 0.0001 THEN 
           umrechnung.zeingan1 = euro1%
           codew.zeingan1 = codew1%
           waehrung.zeingan1 = waehrung1$
           BetragEU = Betrag / euro1%
           BetraggezEU = Betrag_gezahlt / euro1%
           gezahltEU = gezahlt / euro1%
           SREU = SR / euro1%
           SRAuszahlungEU = SRAuszahlung / euro1%
           BewertungEU = Bewertung / euro1%
         END IF 
         IF waehrung.ZEINGAN1 LIKE "EUR*" THEN 
           codew.ZEINGAN1 = 3
           waehrung.ZEINGAN1 = "EUR"
           umrechnung.ZEINGAN1 = 1
         END IF 
         IF waehrung.ZEINGAN1 LIKE "DM*" THEN 
           codew.ZEINGAN1 = 1
           waehrung.ZEINGAN1 = "DM"
           umrechnung.ZEINGAN1 = 1.95583
         END IF 
         IF codew.zeingan1 = 1 THEN 
           euro1% = 1.955830
           umrechnung.zeingan1 = euro1%
           BetragEU = Betrag / euro1%
           BetraggezEU = Betrag_gezahlt / euro1%
           gezahltEU = gezahlt / euro1%
           SREU = SR / euro1%
           SRAuszahlungEU = SRAuszahlung / euro1%
           BewertungEU = Bewertung / euro1%
         END IF 
         QuickVSNRDat.zeingan1 = QuickVSNR.ZEINGAN1 + STR$ ( YEAR (Buchungsdatum.zeingan1),"0000") + STR$ ( MONTH (Buchungsdatum.zeingan1),"00") + STR$ ( DAY (Buchungsdatum.zeingan1),"00")
         QNumVSNR.ZEINGAN1 = VSNRPackNum$(VS_Nr.ZEINGAN1)
         QuickVSNR.ZEINGAN1 = VSNRPack$(VS_Nr.ZEINGAN1)
         QuickVSNRDat.zeingan1 = QuickVSNR.ZEINGAN1 + STR$ ( YEAR (Buchungsdatum.zeingan1),"0000") + STR$ ( MONTH (Buchungsdatum.zeingan1),"00") + STR$ ( DAY (Buchungsdatum.zeingan1),"00")
         BetraggezEU.zeingan1 = Betrag_gezahlt.zeingan1 / umrechnung.zeingan1
         BetragEU.zeingan1 = Betrag.zeingan1 / umrechnung.zeingan1
         BetraggezEU.zeingan1 = Betrag_gezahlt.zeingan1 / umrechnung.zeingan1
         gezahltEU.zeingan1 = gezahlt.zeingan1 / umrechnung.zeingan1
         SREU.zeingan1 = SR.zeingan1 / umrechnung.zeingan1
         SRAuszahlungEU.zeingan1 = SRAuszahlung.zeingan1 / umrechnung.zeingan1
         BewertungEU.zeingan1 = Bewertung.zeingan1 / umrechnung.zeingan1
         KundEinzahluEU.zeingan1 = KundEinzahlung.zeingan1 / umrechnung.zeingan1
         IF BuchDatOld.zeingan1 < 1 THEN 
           BuchDatOld.zeingan1 = BuchungsDatum.zeingan1
         END IF 
         IF EXISTS (codevt.zeingan1,lfdnr.kvertrag) THEN 
           SELECT KEY codevt.zeingan1 FILE "kvertrag" INDEX lfdnr.kvertrag
           Antragsnr.zeingan1 = Antragsnr.kvertrag
           workstation.zeingan1 = workstation.kvertrag
         END IF 
         STORE FILE "zeingan1"
         SELECT NEXT LOCK FILE "zeingan1"
       WEND 
     END IF 
   END IF 
   CALL KVCheck(18)

   REM ********** öberprÅfung auf Datum 1.ZE wird bei fÑlligam.KVFael eingetragen
   IF GAFSK$ LIKE "TRUE" AND GAFSKCheck$ = "TRUE" THEN 
     CALL DFile(3,"KVERTRAG" + _fpw$)
     CALL DFile(3,"KVFAEL" + _fpw$)
     CALL DFile(3,"VPGEKOND" + _fpw$)
     CALL DFile(3,"ZEINGAN1" + _fpw$)
     FILE "KVERTRAG"
     INDEX lfdnr.kvertrag
     SELECT FIRST FILE "KVERTRAG"
     i% = 0
     j% = 0
     k% = 0
     WHILE NOT EOF ("KVERTRAG")
       i% = i% + 1
       IF EXISTS (codevp.kvertrag,codevp.vpgekond) AND EXISTS (lfdnr.kvertrag,codevt.kvfael) THEN 
         j% = j% + 1
         SELECT FIRST FILE "KVFAEL" INDEX codevt.kvfael
         SELECT KEY lfdnr.kvertrag LOCK FILE "KVFAEL" INDEX codevt.kvfael
         ok% = 0
         IF EXISTS (lfdnr.kvertrag,codevt.zeingan1) THEN 
           SELECT FIRST FILE "Zeingan1" INDEX codevt.zeingan1
           SELECT KEY lfdnr.kvertrag FILE "Zeingan1" INDEX codevt.zeingan1
           datumold% = BuchungsDatum.zeingan1
           WHILE NOT EOF ("zeingan1") AND codevt.zeingan1 = lfdnr.kvertrag
             IF BuchungsDatum.zeingan1 < datumold% AND BuchungsDatum.zeingan1 > 0 THEN 
               datumold% = BuchungsDatum.zeingan1
             END IF 
             SELECT NEXT FILE "Zeingan1" INDEX codevt.zeingan1
           WEND 
           fÑlligam.KVFael = datumold%
           ok% = - 1
         ELSE 
           IF proviab.kvertrag > 0 THEN 
             IF VMProv.kvfael > 0 THEN 
               fÑlligam.KVFael = proviab.kvertrag
               ok% = - 1
             END IF 
           END IF 
         END IF 
         IF ok% = - 1 THEN 
           k% = k% + 1
           STORE FILE "KVFAEL"
           UNLOCK FILE "KVFAEL"
         END IF 
       END IF 
       SET STATUS LTRIM$ ( STR$ (i%,"999999")) + " VertrÑge geprÅft, davon " + LTRIM$ ( STR$ (j%,"999999")) + " im AFSK-Verfahren  " + LTRIM$ ( STR$ (k%,"999999")) + " fÑlligam geÑndert"
       SELECT NEXT FILE "KVERTRAG" INDEX lfdnr.kvertrag
     WEND 
     CALL Fehler( LTRIM$ ( STR$ (i%,"999999")) + " VertrÑge geprÅft, davon " + LTRIM$ ( STR$ (j%,"999999")) + " im AFSK-Verfahren  " + LTRIM$ ( STR$ (k%,"999999")) + " fÑlligam geÑndert","")
   END IF 
 
 
   CALL KVCheck(19)
  
   REM -- Anpassung VORGANG.SBF --
   CALL DFile(3,"KVERTRAG" + _fpw$)
   CALL DFile(3,"Geadr" + _fpw$)
   CALL DFile(3,"MAADR" + _fpw$)
   CALL DFile(3,"sparten" + _fpw$)
   CALL DFile(2,"OFFICE\ADRESSEN" + _fpw$)
   CALL DFile(2,"OFFICE\akquise" + _fpw$)
   CALL DFile(2,"OFFICE\aktionen" + _fpw$)
   CALL DFile(2,"OFFICE\adressen" + _fpw$)
   CALL DFile(3,"VORGANG" + _fpw$)
   FILE "VORGANG"
   CALL FldAdd("erledigt","TXT;1",0)
   CALL FldAdd("QuickCode","TXT;14",1)
   REM 220597
   CALL FldAdd("CodeAQ","NUM;0000000.",1)
   CALL FldAdd("Termin","DAT;0d.mm.yyyy",1)
   CALL FldAdd("Datum","DAT;0d.mm.yyyy",1)
   CALL FldAdd("DatumSchaden","DAT;0d.mm.yyyy",1)
   CALL FldAdd("SchadenNr","TXT;30",1)
   CALL FldAdd("Kurznotiz","TXT;30",0)
   CALL FldAdd("CodeKU","NUM;0000000.",1)
   CALL FldAdd("QuickCodeKU","TXT;14",1)
   CALL FldAdd("gezahlt_am","DAT;0d.mm.yyyy",1)
   CALL FldAdd("SchadenJN","TXT;1",1)
   CALL FldAdd("ExpInternet","TXT;6",1)
   CALL FldAdd("Zahlung1","NUM;,9999999.00",0)
   CALL FldAdd("ZahlDat1","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Zahlung2","NUM;,9999999.00",0)
   CALL FldAdd("ZahlDat2","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Zahlung3","NUM;,9999999.00",0)
   CALL FldAdd("ZahlDat3","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Zahlung4","NUM;,9999999.00",0)
   CALL FldAdd("ZahlDat4","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Zahlung5","NUM;,9999999.00",0)
   CALL FldAdd("ZahlDat5","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Zahlung6","NUM;,9999999.00",0)
   CALL FldAdd("ZahlDat6","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Zahlung7","NUM;,9999999.00",0)
   CALL FldAdd("ZahlDat7","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Zahlung8","NUM;,9999999.00",0)
   CALL FldAdd("ZahlDat8","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Zahlung9","NUM;,9999999.00",0)
   CALL FldAdd("ZahlDat9","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Zahlung10","NUM;,9999999.00",0)
   CALL FldAdd("ZahlDat10","DAT;0d.mm.yyyy",0)
   CALL FldAdd("VS_NR","TXT;30",1)
   CALL FldAdd("ANTRAGSNR","TXT;30",0)
   CALL FldAdd("Anspruchsteller","TXT;300 R",0)
   CALL FldAdd("Schadensort","TXT;300 R",0)
   CALL FldAdd("UnterlKomplett","TXT;1",0)
   CALL FldAdd("VstAbzugsberech","TXT;1",0)
   CALL FldAdd("Regulierungvon","TXT;300 R",0)
   CALL FldAdd("UeberweisungAN","TXT;300 R",0)
   CALL FldAdd("Beschreibung1","TXT;4000 R",0)
   CALL FldAdd("Beschreibung2","TXT;4000 R",0)
   CALL MarkMain("CodeVG")
   SAVE FILE "VORGANG"
   IF RECCOUNT ("VORGANG") > 0 THEN 
     INDEX CodeVG
     SELECT LAST 
     WHILE CodeVG > SER ("VORGANG",1)
     WEND 
     SELECT FIRST LOCK 
     WHILE NOT EOF ("VORGANG")
       IF CodeMA < 1 THEN 
         CodeMA = _vcodema%
         STORE FILE "vorgang"
       END IF 
       SELECT NEXT LOCK 
     WEND 
     REM 220597
     INDEX codevg.vorgang
     REM CALL Fehler("","")
     IF RECCOUNT ("Vorgang") > 1 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     WHILE NOT EOF ("VORGANG") AND RECCOUNT ("Vorgang") > 1 AND GIndNeu% = - 1
       CALL Server("UPDFIELD","QuickCode")
       CALL Server("UPDSTATUS","Erzeuge Feldinhalt fÅr " + LTRIM$ ( STR$ ( RECCOUNT ("VORGANG"),"9999999")) + " DatensÑtze")
       codevt% = codevt.vorgang
       SELECT KEY codevt% FILE "Kvertrag" INDEX lfdnr.kvertrag
       codeku% = Codeku.kvertrag
       codeku.vorgang = Codeku%
       IF Datum.vorgang < "1.1.1980" THEN 
         Datum.vorgang = VS_Beginn.kvertrag
         IF Termin.vorgang < "1.1.1980" THEN Termin.vorgang = Datum.vorgang
       ELSE 
         IF Termin.vorgang < "1.1.1980" THEN Termin.vorgang = Datum.vorgang
       END IF 
       VS_NR.vorgang = vs_nr.kvertrag
       ANTRAGSNR.vorgang = ANTRAGSNR.kvertrag
       QuickCode.VORGANG = STR$ (CodeVT.VORGANG,"000000") + DATE$ (Datum.VORGANG,"yyyymmdd")
       QuickCodeKU.VORGANG = STR$ (CodeKU.VORGANG,"000000") + DATE$ (Datum.VORGANG,"yyyymmdd")
       SELECT KEY codevt.VORGANG FILE "KVERTRAG" INDEX lfdnr.kvertrag
       workstation.VORGANG = workstation.kvertrag
       QWoNo.VORGANG = STR$ (Workstation.VORGANG,"000000") + STR$ (CodeVG.VORGANG,"000000")
       STORE FILE "Vorgang"
       SELECT NEXT LOCK FILE "vorgang" INDEX codevg.vorgang
     WEND 
     INDEX codevg.vorgang
     IF RECCOUNT ("Vorgang") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     REM CALL Fehler("Vorgang","Termine")
     WHILE NOT EOF ("VORGANG") AND Greqter% = 1
       CALL Server("UPDFIELD","CodeAQ")
       CALL Server("UPDSTATUS","Erzeuge TermineintrÑge fÅr Vorgang " + LTRIM$ ( STR$ ( RECCOUNT ("VORGANG"),"9999999")) + " DatensÑtze")
       codevg% = CodeVG.vorgang
       codeaq% = codeaq.vorgang
       IF codeaq.vorgang < 1 OR NOT EXISTS (codeaq.vorgang,codeaq.akquise) THEN 
         CALL VorgAkqui(codevg%,GMACodeMA1%,Gcodeak%)
       END IF 
       ON ERROR GOTO ErrorHandler
       FILE "Vorgang"
       SELECT NEXT LOCK FILE "vorgang" INDEX codevg.vorgang
     WEND 
     FILE "VORGANG"
     INDEX QuickCode.VORGANG
     SELECT FIRST 
   END IF 
 
   CALL KVCheck(19)

   CALL DFile(3,"maadrgru" + _fpw$)
   FILE "maadrgru"
   CALL FldAdd("VertrGesamt","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu1","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu2","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu3","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu4","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu5","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu6","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu7","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu8","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu9","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu10","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu11","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu12","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu13","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu14","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu15","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu16","NUM;,999999999999",0)
 
   CALL FldAdd("BWVertrGesamt","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu1","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu2","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu3","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu4","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu5","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu6","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu7","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu8","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu9","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu10","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu11","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu12","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu13","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu14","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu15","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu16","NUM;,999999999999.00",0)
 
   CALL FldAdd("BeiVertrGesamt","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu1","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu2","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu3","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu4","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu5","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu6","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu7","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu8","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu9","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu10","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu11","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu12","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu13","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu14","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu15","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu16","NUM;,999999999999.00",0)
 
   CALL FldAdd("EinhGesamt","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu1","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu2","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu3","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu4","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu5","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu6","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu7","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu8","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu9","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu10","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu11","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu12","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu13","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu14","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu15","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu16","NUM;,9999999999.0000",0)
 
   CALL FldAdd("AnzSchGesamt","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu1","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu2","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu3","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu4","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu5","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu6","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu7","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu8","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu9","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu10","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu11","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu12","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu13","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu14","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu15","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu16","NUM;,9999999999.",0)
 
   CALL FldAdd("SchGesamt","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu1","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu2","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu3","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu4","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu5","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu6","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu7","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu8","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu9","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu10","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu11","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu12","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu13","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu14","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu15","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu16","NUM;,9999999999.00",0)
   CALL FldAdd("STATISTDATE","DAT;0d.mm.yyyy",0)
   CALL FldAdd("VertrStatu0","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu0","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu0","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu0","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu0","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu0","NUM;,9999999999.00",0)
   CALL FldAdd("Schadquote","NUM;,9999999.0000",0)
   CALL FldAdd("Stornoquote","NUM;,99999.0000",0)
   CALL FldAdd("CAgez","NUM;,999999999999.00",0)
   CALL FldAdd("VertrStatu20","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu20","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu20","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu20","NUM;,9999999999.00",0)
   CALL FldAdd("VertrStatu21","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu21","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu21","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu21","NUM;,9999999999.00",0)
   SAVE FILE "MAADRGRU"


   REM -- Anpassun VERMOEG.SBF --
   CALL DFile(3,"VERMOEG" + _fpw$)
   FILE "VERMOEG"
   CALL FldAdd("Betrag","NUM;,9999999999.00",0)
   SAVE FILE "VERMOEG"

   REM -- Anpassun SPARTEN.SBF --
   CALL DFile(3,"SPARTEN" + _fpw$)
   CALL DFile(3,"SPARTLEE" + _fpw$)
   FILE "SPARTEN"
   lauf% = 0
   NeuCodeVA% = 0
   ON ERROR GOTO w220820055
   xxa% = KorrAB220805.sparten
   GOTO w220820056
w220820055: 
   NeuCodeVA% = - 1
   ON ERROR GOTO ErrorHandler
w220820056: 
 
 

anfspart2208: 
   IF lauf% = 1 THEN 
     FILE "SPARTLEE"
   END IF 

   CALL FldAdd("CodeVA","NUM;000000.",1)
   CALL FldAdd("Sparte","TXT;60",1)
   CALL FldAdd("Tarif","TXT;35",1)
   CALL FldAdd("Fondsgattung","TXT;50",1)
   CALL FldAdd("Vertragsart","TXT;8",0)
   CALL FldAdd("Formular","TXT;8",1)
   CALL FldAdd("CodeGrSp","NUM;000000.",1)
   CALL FldAdd("Auswertung","NUM;00.",0)
   CALL FldAdd("Hauptsparte","NUM;000.",1)
   CALL FldAdd("Untersparte","NUM;000.",0)
   CALL FldAdd("FormelBewert","TXT;4000",0)
   CALL FldAdd("GDVImport","TXT;1",0)
   CALL FldAdd("VAnzahlVor","NUM;99999999.",0)
   CALL FldAdd("SBewertung","NUM;,9999999999.00",0)
   CALL FldAdd("SBewertungEU","NUM;,9999999999.00",0)
   CALL FldAdd("SVolumen","NUM;,9999999999.00",0)
   CALL FldAdd("SVolumenEU","NUM;,9999999999.00",0)
   CALL FldAdd("SBeitragBRU","NUM;,9999999999.00",0)
   CALL FldAdd("SBeitragBRUEU","NUM;,9999999999.00",0)
   CALL FldAdd("SBeitragNET","NUM;,9999999999.00",0)
   CALL FldAdd("SBeitragNETEU","NUM;,9999999999.00",0)
   CALL FldAdd("SVSumme","NUM;,9999999999.00",0)
   CALL FldAdd("SVSummeEU","NUM;,9999999999.00",0)
   CALL FldAdd("SProvision","NUM;,9999999999.00",0)
   CALL FldAdd("SProvisionEU","NUM;,9999999999.00",0)
   CALL FldAdd("VST","NUM;999.00",0)
   CALL FldAdd("GDVStandardSpar","NUM;0.",0)
   CALL FldAdd("QHauptDGVStanda","TXT;4",1)
   CALL FldAdd("SparteIstSach","NUM;0.",1)
   CALL FldAdd("IIMsparteid","TXT;50",0)
   CALL FldAdd("IIMSpartname","TXT;50",0)

   CALL FldAdd("VertrGesamt","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu1","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu2","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu3","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu4","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu5","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu6","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu7","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu8","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu9","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu10","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu11","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu12","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu13","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu14","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu15","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu16","NUM;,999999999999",0)
 
   CALL FldAdd("BWVertrGesamt","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu1","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu2","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu3","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu4","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu5","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu6","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu7","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu8","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu9","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu10","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu11","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu12","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu13","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu14","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu15","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu16","NUM;,999999999999.00",0)
 
   CALL FldAdd("BeiVertrGesamt","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu1","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu2","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu3","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu4","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu5","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu6","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu7","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu8","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu9","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu10","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu11","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu12","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu13","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu14","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu15","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu16","NUM;,999999999999.00",0)
 
   CALL FldAdd("EinhGesamt","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu1","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu2","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu3","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu4","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu5","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu6","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu7","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu8","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu9","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu10","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu11","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu12","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu13","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu14","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu15","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu16","NUM;,9999999999.0000",0)

   CALL FldAdd("AnzSchGesamt","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu1","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu2","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu3","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu4","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu5","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu6","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu7","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu8","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu9","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu10","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu11","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu12","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu13","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu14","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu15","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu16","NUM;,9999999999.",0)
 
   CALL FldAdd("SchGesamt","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu1","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu2","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu3","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu4","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu5","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu6","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu7","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu8","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu9","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu10","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu11","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu12","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu13","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu14","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu15","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu16","NUM;,9999999999.00",0)
   CALL FldAdd("STATISTDATE","DAT;0d.mm.yyyy",0)
   CALL FldAdd("VertrStatu0","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu0","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu0","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu0","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu0","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu0","NUM;,9999999999.00",0)
   CALL FldAdd("Schadquote","NUM;,9999999.0000",0)
   CALL FldAdd("Stornoquote","NUM;,99999.0000",0)
   CALL FldAdd("CAgez","NUM;,999999999999.00",0)
   CALL FldAdd("VertrStatu20","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu20","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu20","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu20","NUM;,9999999999.00",0)
   CALL FldAdd("VertrStatu21","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu21","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu21","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu21","NUM;,9999999999.00",0)
   CALL FldAdd("Kostentraeger","TXT;8",0)
   CALL FldAdd("ZahlBertrMin","NUM;,9999999999.00",0)
   CALL FldAdd("ZahlBertrMax","NUM;,9999999999.00",0)
   CALL FldAdd("Spartenart","TXT;30",0)
   CALL FldAdd("WKNr","TXT;30",0)
   CALL FldAdd("KorrAB220805","NUM;0.",0)
   CALL FldAdd("InHaus","NUM;0.",1)
   CALL FldAdd("noAnzeige","TXT;1",0)
   CALL MarkMain("CodeVA")
   IF lauf% = 0 THEN 
     SAVE FILE "SPARTEN"
     lauf% = 1
     GOTO anfspart2208
   END IF 
   IF lauf% = 0 THEN 
     SAVE FILE "SPARTLEE"
   END IF 
   FILE "sparten"

   IF EXISTS (_netpath$ + "provis\spartold.sbf") THEN DELETE (_netpath$ + "provis\spartold.*")
 
   REM ************************************ verschÑrfte Reorganisation ******************
   REM CALL Fehler("","")
   REM REQUEST "Mîchten Sie die Adressdatei komplett neu aufbauen lassen?","(Achtung dieser Vorgang kann sehr lange dauern!",135,req%
   IF NeuCodeVA% = - 1 THEN 
     CLOSE FILE "SPARTEN"
     dpfad$ = _netpath$ + "PROVIS\" + DATE$ ( TODAY ,"yymm0d")
     datnr$ = DATE$ ( TODAY ,"yymm0d")
     i% = 0
     ok% = 0
     WHILE ok% = 0
       i% = i% + 1
       IF i% > 99 THEN 
         ON ERROR GOTO arb2208057
         REMOVE DIRECTORY dpfad$ + "01"
arb2208057: 
         i% = 1
       END IF 
       ON ERROR GOTO arb2208058
       tpfad$ = dpfad$ + STR$ (i%,"00")
       MAKE DIRECTORY dpfad$ + STR$ (i%,"00")
       dpfad$ = dpfad$ + STR$ (i%,"00")
       ok% = - 1
arb2208058: 
       ON ERROR GOTO ErrorHandler
     WEND 
 
     textdo1$ = tpfad$
     REM CALL Fehler("Es wird jetzt eine Sicherungskopie der Spartendatei erstellt!",textdo1$)
     REQUEST "Sicherungskopie der Spartendatei in",textdo1$,2
     ON ERROR GOTO arb6220820051
     COPY _netpath$ + "provis\sparten.*" TO dpfad$
     CALL DFile(3,"SPARTEN" + _fpw$)
     CALL reorgkv(_netpath$ + "provis\","SPARTEN","SPARTOLD","SPARTLEE",dpfad$)
     GOTO arb6220820052
arb6220820051: 
     CALL Fehler("Beim Kopieren der Spartendatei ist ein Fehler aufgetreten, deshalb wird der Komplettaufbau nicht durchgefÅhrt!","")
     
arb6220820052: 
     ON ERROR GOTO ErrorHandler
     FILE "SPARTEN"
    
   END IF 
   REM **********************************************************************************   

   FILE "SPARTEN"

   IF RECCOUNT ("SPARTEN") > 0 THEN 
     INDEX CodeVA
     SELECT LAST 
     WHILE codeva.sparten > 990000
       SELECT PREVIOUS 
     WEND 
     WHILE CodeVA > SER ("SPARTEN",1)
     WEND 

     SELECT LAST LOCK 
     WHILE codeva.sparten > 999999
       codeva.sparten = SER ("SPARTEN",1)
       STORE FILE "sparten"
       SELECT LAST LOCK 
     WEND 

     SELECT FIRST LOCK 
     WHILE NOT EOF ("SPARTEN")
       ok% = 0
       IF vertragsart LIKE "VERTR*" THEN 
       ELSE 
         zahl% = VAL (vertragsart)
         vertragsart = "VERTR" + STR$ (zahl%,"000")
         ok% = 1
       END IF 
       IF CodeVA < 1 THEN 
         CodeVA = SER ("SPARTEN",1)
         ok% = 1
       END IF 
       IF sparte.sparten LIKE "<ohne Zuordnung>" THEN codeva.sparten = 0
       IF codegrsp < 1 THEN codegrsp = 0
       IF vertragsart LIKE "VERTR022" THEN vertragsart = "VERTR023"
       IF vertragsart LIKE "VERTR008" THEN vertragsart = "VERTR021"
       IF vertragsart LIKE "VERTR012" THEN vertragsart = "VERTR019"
       IF vertragsart LIKE "VERTR016" THEN vertragsart = "VERTR020"

       formular = vertragsart
       IF GDVImport.sparten = "" THEN GDVImport.sparten = "j"
       STORE FILE "sparten"
       IF NOT EOF ("sparten") THEN SELECT NEXT LOCK 
     WEND 
   END IF 
   REM -- Anpassun SPGRUPPE.SBF --
   CALL DFile(3,"SPGRUPPE" + _fpw$)
   FILE "SPGRUPPE"
  
    CALL FldAdd("SBewertung","NUM;,9999999999.00",0)
   CALL FldAdd("SBewertungEU","NUM;,9999999999.00",0)
   CALL FldAdd("SVolumen","NUM;,9999999999.00",0)
   CALL FldAdd("SVolumenEU","NUM;,9999999999.00",0)
   CALL FldAdd("SBeitragBRU","NUM;,9999999999.00",0)
   CALL FldAdd("SBeitragBRUEU","NUM;,9999999999.00",0)
   CALL FldAdd("SBeitragNET","NUM;,9999999999.00",0)
   CALL FldAdd("SBeitragNETEU","NUM;,9999999999.00",0)
   CALL FldAdd("SVSumme","NUM;,9999999999.00",0)
   CALL FldAdd("SVSummeEU","NUM;,9999999999.00",0)
   CALL FldAdd("SProvision","NUM;,9999999999.00",0)
   CALL FldAdd("SProvisionEU","NUM;,9999999999.00",0)
   CALL FldAdd("VST","NUM;999.00",0)
   CALL FldAdd("GDVStandardSpar","NUM;0.",0)
   CALL FldAdd("QHauptDGVStanda","TXT;4",1)
   CALL FldAdd("SparteIstSach","NUM;0.",1)
   CALL FldAdd("IIMsparteid","TXT;50",0)
   CALL FldAdd("IIMSpartname","TXT;50",0)
 
   CALL FldAdd("VertrGesamt","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu1","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu2","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu3","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu4","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu5","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu6","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu7","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu8","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu9","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu10","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu11","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu12","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu13","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu14","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu15","NUM;,999999999999",0)
   CALL FldAdd("VertrStatu16","NUM;,999999999999",0)
 
   CALL FldAdd("BWVertrGesamt","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu1","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu2","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu3","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu4","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu5","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu6","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu7","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu8","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu9","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu10","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu11","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu12","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu13","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu14","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu15","NUM;,999999999999.00",0)
   CALL FldAdd("BWVertrStatu16","NUM;,999999999999.00",0)
 
   CALL FldAdd("BeiVertrGesamt","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu1","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu2","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu3","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu4","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu5","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu6","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu7","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu8","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu9","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu10","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu11","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu12","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu13","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu14","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu15","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu16","NUM;,999999999999.00",0)
 
   CALL FldAdd("EinhGesamt","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu1","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu2","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu3","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu4","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu5","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu6","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu7","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu8","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu9","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu10","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu11","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu12","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu13","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu14","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu15","NUM;,9999999999.0000",0)
   CALL FldAdd("EinhStatu16","NUM;,9999999999.0000",0)
 
   CALL FldAdd("AnzSchGesamt","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu1","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu2","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu3","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu4","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu5","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu6","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu7","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu8","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu9","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu10","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu11","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu12","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu13","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu14","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu15","NUM;,9999999999.",0)
   CALL FldAdd("AnzSchStatu16","NUM;,9999999999.",0)
 
   CALL FldAdd("SchGesamt","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu1","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu2","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu3","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu4","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu5","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu6","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu7","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu8","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu9","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu10","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu11","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu12","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu13","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu14","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu15","NUM;,9999999999.00",0)
   CALL FldAdd("SchStatu16","NUM;,9999999999.00",0)
   CALL FldAdd("STATISTDATE","DAT;0d.mm.yyyy",0)
   CALL FldAdd("VertrStatu0","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu0","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu0","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu0","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu0","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu0","NUM;,9999999999.00",0)
   CALL FldAdd("Schadquote","NUM;,9999999.0000",0)
   CALL FldAdd("Stornoquote","NUM;,99999.0000",0)
   CALL FldAdd("VertrStatu20","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu20","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu20","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu20","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu20","NUM;,9999999999.00",0)
   CALL FldAdd("VertrStatu21","NUM;,999999999999",0)
   CALL FldAdd("BWVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("BeiVertrStatu21","NUM;,999999999999.00",0)
   CALL FldAdd("EinhStatu21","NUM;,9999999999.0000",0)
   CALL FldAdd("AnzSchStatu21","NUM;,9999999999.",0)
   CALL FldAdd("SchStatu21","NUM;,9999999999.00",0)
   SAVE FILE "SPGRUPPE"
   FILE "SPGRUPPE"
   IF RECCOUNT ("SPGRUPPE") > 0 THEN 
     INDEX CodeGRSP
     SELECT LAST 
     WHILE CodeGRSP > SER ("SPGRUPPE",1)
     WEND 
   END IF 
Anpass25012000: 
   CALL DFile(3,"KVERTRAG" + _fpw$)
   REM -- Anpassung BUCHTEMP/BUCHUNG.SBF --
   REM 220697
   CALL DFile(3,"BUCHTEMP" + _fpw$)
   FILE "BUCHTEMP"
   CALL FldAdd("SR","NUM;,999999999.00",0)
   CALL FldAdd("Einheiten","NUM;,9999999999.00",0)
   CALL FldAdd("GesamtbetragEU","NUM;,9999999.00",0)
   CALL FldAdd("BetragEU","NUM;,9999999.00",0)
   CALL FldAdd("SREU","NUM;,9999999.00",0)
   CALL FldAdd("BewertungssumEU","NUM;,999999999.00",0)
   CALL FldAdd("gezahltEU","NUM;,9999999.00",0)
   CALL FldAdd("Umrechnung","NUM;,99999999.000000",0)
   CALL FldAdd("CodeW","NUM;000000.",1)
   CALL FldAdd("Waehrung","TXT;6",0)
   CALL FldAdd("WaehrungBezeich","TXT;30",0)
   CALL FldAdd("CodeBUMON","TXT;14",1)
   CALL FldAdd("SRAuszahlung","DAT;0d.mm.yyyy",0)
   CALL FldAdd("VS_Beginn","DAT;0d.mm.yyyy",0)
   CALL FldAdd("KÅndigung","DAT;0d.mm.yyyy",0)
   CALL FldAdd("FÑlligkeit","DAT;0d.mm.yyyy",0)
   CALL FldAdd("gezahlt_am","DAT;0d.mm.yyyy",0)
   CALL FldAdd("VTCodeMA","NUM;000000.",1)
   SAVE FILE "BUCHTEMP"
   
                                            

 
   CALL KVCheck(22)


   CALL DFile(3,"KVSKOND" + _fpw$)
   FILE "KVSKOND"
   CALL FldAdd("AFSKPAUJN","TXT;1",0)
   CALL FldAdd("AFSKPAUEUR","NUM;,99999.00",0)
   CALL FldAdd("AFSPSolBeitrSu","NUM;999.0000",0)
   CALL FldAdd("AFSPSollMB","NUM;999.0000",0)
   CALL FldAdd("AFSTMB","NUM;999.0000",0)
   CALL FldAdd("AFSTMBProz","NUM;999.0000",0)
   CALL FldAdd("AFSVBSumProz","NUM;999.0000",0)
   CALL FldAdd("AFSVProzRate","NUM;999.00000",0)
   CALL FldAdd("AFSVProBei","NUM;999.0000",0)
   CALL FldAdd("AFSPSPJN","TXT;1",0)
   CALL FldAdd("AnzCourtZahlung","NUM;999.",0)
   SAVE FILE "KVSKOND"


   CALL DFile(3,"VPGEKOND" + _fpw$)
   FILE "VPGEKOND"
   LOCK ALL FILE "VPGEKOND"
   CALL FldAdd("APAnzBeitr","NUM;99.000",0)
   CALL FldAdd("CoAnzBeitr","NUM;99.000",0)
   CALL FldAdd("APAnzBvB","TXT;1",0)
   CALL FldAdd("CoAnzBvB","TXT;1",0)
   CALL FldAdd("AFSK","TXT;1",0)
   CALL FldAdd("MonatJN","TXT;1",0)
   CALL FldAdd("MonatAPCOu","TXT;1",0)
   CALL FldAdd("MonatFakt","NUM;999.00000",0)
   CALL FldAdd("MonatZWjn","TXT;1",0)
   CALL FldAdd("MonatZW","NMI;00",0)
   CALL FldAdd("MonatBrutto","TXT;1",0)
   CALL FldAdd("VD1AP","NUM;99.00000",0)
   CALL FldAdd("VD2AP","NUM;99.00000",0)
   CALL FldAdd("VD3AP","NUM;99.00000",0)
   CALL FldAdd("VD4AP","NUM;99.00000",0)
   CALL FldAdd("VD5AP","NUM;99.00000",0)
   CALL FldAdd("AFSKPAUJN","TXT;1",0)
   CALL FldAdd("AFSKPAUEUR","NUM;,99999.00",0)
   CALL FldAdd("PflegeNachBei","NUM;0.",0)
   CALL FldAdd("erwProvAnzVP","NMI;00",0)

 
   CALL FldAdd("AFSPSolBeitrSu","NUM;999.0000",0)
   CALL FldAdd("AFSPSollMB","NUM;999.0000",0)
   CALL FldAdd("AFSTMB","NUM;999.0000",0)
   CALL FldAdd("AFSTMBProz","NUM;999.0000",0)
   CALL FldAdd("AFSVBSumProz","NUM;999.0000",0)
   CALL FldAdd("AFSVProzRate","NUM;999.00000",0)
   CALL FldAdd("AFSVProBei","NUM;999.0000",0)
   CALL FldAdd("AFSPSPJN","TXT;1",0)
   CALL FldAdd("AFSSollStufe","NMI;00.",0)

   CALL FldAdd("APKVMonatJN","TXT;1",0)
   CALL FldAdd("KVMonatFakt","NUM;999.00000",0)
   CALL FldAdd("APPfMonatJN","TXT;1",0)
   CALL FldAdd("PflMonatFakt","NUM;999.00000",0)
   CALL FldAdd("AnzCourtZahlung","NUM;999.",0)

   CALL FldAdd("PflegevomNetto","TXT;1",0)
   CALL FldAdd("CodeEingGE","NUM;000000.",1)
   CALL FldAdd("EingereichtBei","TXT;50",0)

   SAVE FILE "VPGEKOND"
 


   REM GOTO Ende25012000
   REM -- Anpassung GEKOND.SBF --
  
   CALL DFile(3,"GEKOND" + _fpw$)
   CALL DFile(3,"spgruppe" + _fpw$)
   CALL DFile(3,"vprodukt" + _fpw$)
   FILE "GEKOND"
   LOCK ALL FILE "GEKOND"
   CALL FldAdd("TZ6","NUM;999.00",0)
   CALL FldAdd("TZ7","NUM;999.00",0)
   CALL FldAdd("TZ8","NUM;999.00",0)
   CALL FldAdd("TZ9","NUM;999.00",0)
   CALL FldAdd("TZ10","NUM;999.00",0)
   CALL FldAdd("TZ11","NUM;999.00",0)
   CALL FldAdd("TZ12","NUM;999.00",0)
   CALL FldAdd("TZD6","NUM;999.",0)
   CALL FldAdd("TZD7","NUM;999.",0)
   CALL FldAdd("TZD8","NUM;999.",0)
   CALL FldAdd("TZD9","NUM;999.",0)
   CALL FldAdd("TZD10","NUM;999.",0)
   CALL FldAdd("TZD11","NUM;999.",0)
   CALL FldAdd("TZD12","NUM;999.",0)
   CALL FldAdd("PflegeZW","NMI;99.",0)
   CALL FldAdd("Courtage","NUM;999.0000",0)
   CALL FldAdd("AP","NUM;999.0000",0)
   CALL FldAdd("SR","NUM;999.0000",0)
   CALL FldAdd("PflegeProvi","NUM;999.0000",0)
   CALL FldAdd("BWjn","TXT;1",0)
   CALL FldAdd("VDjn","TXT;1",0)
   CALL FldAdd("TZjn","TXT;1",0)
   CALL FldAdd("PflegeJN","TXT;1",0)
   CALL FldAdd("PauschaleJN","TXT;1",0)
   CALL FldAdd("FormelJN","TXT;1",0)
   CALL FldAdd("DynamikJN","TXT;1",0)
   CALL FldAdd("MaximierungJN","TXT;1",0)
   CALL FldAdd("APjn","TXT;1",0)
   CALL FldAdd("CourtageJN","TXT;1",0)
   CALL FldAdd("SRjn","TXT;1",0)
   CALL FldAdd("CourtageZWjn","TXT;1",0)
   CALL FldAdd("CourtHaftUnbeg","TXT;1",0)
   CALL FldAdd("PflegeNachZahlw","TXT;1",0)
   CALL FldAdd("CourtEinstellen","TXT;1",0)
   CALL FldAdd("DMEinheit","NUM;,9999999.000000",0)
   CALL FldAdd("Anpass","NUM;0.",1)
   CALL FldAdd("Notiz","TXT;70",0)
   CALL FldAdd("RechArt","NUM;0.",0)
   CALL FldAdd("Faktor","NUM;,99999999.000000",0)
   CALL FldAdd("FormelHaft","TXT;4000",0)
   CALL FldAdd("QCodeGEVA","TXT;12",1)
   CALL FldAdd("Gesellschaft","TXT;30",0)
   CALL FldAdd("Sparte","TXT;60",0)
   CALL FldAdd("Kurzname","TXT;30",0)
   CALL FldAdd("QuickCodeGes","TXT;104",1)
   CALL FldAdd("CodeVP","NUM;000000.",1)
   CALL FldAdd("EuroEinheit","NUM;,9999999.000000",0)
   CALL FldAdd("EUUmstellung","TXT;1",0)
   CALL FldAdd("AFSKPauschJN","TXT;1",0)
   CALL FldAdd("AFSKPausch","NUM;,9999999.00",0)
   CALL FldAdd("VSVjn","TXT;1",0)
   CALL FldAdd("VSV","NUM;999.00",0)
   CALL FldAdd("nurEinh","TXT;1",0)
   CALL FldAdd("EuroproEinh","NUM;,999999999.00",0)
   CALL FldAdd("DynamikPjn","TXT;1",0)
   CALL FldAdd("DynamikProz","NUM;999.0000",0)
   CALL FldAdd("Betreujn","TXT;1",0)
   CALL FldAdd("BetreuProz","NUM;999.0000",0)
   CALL FldAdd("MWSTProvBN","TXT;1",0)
   IF GAFSK$ LIKE "TRUE" THEN 
     CALL FldAdd("pfleganzfehl","TXT;1",0)
   END IF 
   CALL FldAdd("APEurEinh","NUM;,999999999.00",0)
   CALL FldAdd("CourtEurEinh","NUM;,999999999.00",0)
   CALL FldAdd("PflEurEinh","NUM;,999999999.00",0)
   CALL FldAdd("DynEurEinh","NUM;,999999999.00",0)
   CALL FldAdd("FolgEurEinh","NUM;,999999999.00",0)
   CALL FldAdd("APKVMonatJN","TXT;1",0)
   CALL FldAdd("KVMonatFakt","NUM;999.00000",0)
   CALL FldAdd("APPfMonatJN","TXT;1",0)
   CALL FldAdd("PflMonatFakt","NUM;999.00000",0)
   CALL FldAdd("CodeGRSP","NUM;000000.",1)
   CALL FldAdd("Gruppe","TXT;60",0)
   CALL FldAdd("CodeEingGE","NUM;000000.",1)
   CALL FldAdd("EingereichtBei","TXT;50",0)
   CALL MarkMain("lfdnr")
   SAVE FILE "GEKOND"

   CALL KVCheck(22)


   CALL Server("UPDFIELD","PflegeZW")
   CALL Server("UPDSTATUS","Erzeuge Feldinhalt")
   IF GIndNeu% = - 1 THEN 
     UPDATE PflegeZW.GEKOND = 12 WHERE PflegeJN.GEKOND LIKE "j" AND PflegeZW.GEKOND = 0
     END UPDATE 
   END IF 
   FILE "gekond"
   IF RECCOUNT ("GEKOND") > 0 THEN 
     INDEX lfdnr.GEKOND
     SELECT LAST 
     WHILE lfdnr.GEKOND > SER ("GEKOND",1)
     WEND 
     i% = 0
     j% = RECCOUNT ("GEKOND")
     FILE "spgruppe"
     INDEX codegrsp.spgruppe
     FILE "sparten"
     INDEX codeva.sparten
     FILE "gekond"
     INDEX codegrsp.gekond
     SELECT LAST 
     IF codegrsp.gekond < 1 OR gruppe.gekond = "" THEN 
       FILE "gekond"
       INDEX lfdnr.gekond
       SELECT FIRST LOCK 
       WHILE NOT EOF ("gekond")
         i% = i% + 1
         SET STATUS STR$ (i%,",99999999") + " Konditionen von " + STR$ (j%,",99999999") + " angepasst"
         codeva% = codeva.gekond
         SELECT KEY codeva% FILE "sparten" INDEX codeva.sparten
         codegrsp.gekond = codegrsp.sparten
         SELECT KEY codegrsp.sparten FILE "spgruppe" INDEX codegrsp.spgruppe
         gruppe.gekond = gruppe.spgruppe
         STORE FILE "gekond"
         SELECT NEXT LOCK FILE "gekond" INDEX lfdnr.gekond
       WEND 
     END IF 
     FILE "gekond"
     INDEX lfdnr.gekond
     SELECT FIRST LOCK 
     IF Geurofin% = - 1 AND RECCOUNT ("gekond") > 0 THEN 
       i% = 0
       j% = RECCOUNT ("GEKOND")
       SELECT FIRST LOCK 
       WHILE NOT EOF ("gekond")
         ok% = 0
         IF courtagejn.gekond = "j" AND apjn.gekond <> "j" THEN 
           apjn.gekond = "j"
           ap.gekond = courtage.gekond
           ok% = - 1
         END IF 
         IF courtagejn.gekond <> "j" AND apjn.gekond = "j" AND pflegejn.gekond = "j" THEN 
           courtagejn.gekond = "j"
           courtage.gekond = pflegeprovi.gekond
           courtagezwjn.gekond = "n"
           ok% = - 1
         END IF 
         IF ap.gekond = courtage.gekond AND pflegejn.gekond <> "j" THEN 
           pflegejn.gekond = "j"
           pflegeprovi.gekond = ap.gekond
           ok% = - 1
         END IF 
         IF ok% = - 1 THEN 
           STORE FILE "gekond"
         END IF 
         SELECT NEXT LOCK 
       WEND 
     END IF 
     SELECT FIRST LOCK 
     REM CALL Fehler("gekond","")
     WHILE NOT EOF ("GEKOND") AND GIndNeu% = - 1
       i% = i% + 1
       SET STATUS LTRIM$ ( STR$ (i%,",999999999")) + " DatensÑtze in GEKOND geprÅft von " + LTRIM$ ( STR$ (j%,",999999999"))
       lfdnr$ = STR$ (lfdnr,"0000000")
       CALL Server("UPDFIELD","PrÅfung auf int.Vertragsnummer!")
       CALL Server("UPDSTATUS",lfdnr$)
       IF lfdnr.GEKOND < 1 THEN 
         lfdnr.GEKOND = SER ("GEKOND",1)
       END IF 
       QCodeGEVA$ = STR$ (Codege.gekond,"000000") + STR$ (Codeva.gekond,"000000")
       IF codevp.gekond < 1 THEN 
         IF EXISTS (QCodeGEVA$,QCodeGEVA.vprodukt) THEN 
           QCodeGEVA.gekond = STR$ (Codege.gekond,"000000") + STR$ (Codeva.gekond,"000000")
           SELECT KEY QCodeGEVA.gekond FILE "Vprodukt" INDEX QCodeGEVA.vprodukt
           codevp.gekond = codevp.vprodukt
           Gesellschaft.gekond = gesellschaft.vprodukt
           Sparte.gekond = sparte.vprodukt
           Kurzname.gekond = kurzname.vprodukt
           QuickCodeGes.gekond = STR$ (CodeMA.gekond,"000000") + UCASE$ (gesellschaft.gekond) + UCASE$ (sparte.gekond) + DATE$ (bwvon.gekond,"yyyymm0d")
         ELSE 
           codevp.gekond = 0
         END IF 
       ELSE 
         IF EXISTS (codevp.gekond,codevp.vprodukt) THEN 
           SELECT FIRST FILE "vprodukt" INDEX codevp.vprodukt
           SELECT KEY codevp.gekond FILE "vprodukt" INDEX codevp.vprodukt
           s1$ = STR$ (codevp.gekond,"000000") + "   vp " + STR$ (codevp.vprodukt,"000000") + " ge " + STR$ (codege.vprodukt,"000000") + " va " + STR$ (codeva.vprodukt,"000000")
           s2$ = Gesellschaft.vprodukt + "    " + sparte.vprodukt
           REM CALL Fehler(s1$,s2$)
           IF codege.gekond = codege.vprodukt AND codeva.gekond = codeva.vprodukt THEN 
             Gesellschaft.gekond = gesellschaft.vprodukt
             Sparte.gekond = sparte.vprodukt
             Kurzname.gekond = kurzname.vprodukt
             QuickCodeGes.gekond = STR$ (CodeMA.gekond,"000000") + UCASE$ (gesellschaft.gekond) + UCASE$ (sparte.gekond) + DATE$ (bwvon.gekond,"yyyymm0d")
           ELSE 
             IF EXISTS (QCodeGEVA$,QCodeGEVA.vprodukt) THEN 
               QCodeGEVA.gekond = STR$ (Codege.gekond,"000000") + STR$ (Codeva.gekond,"000000")
               SELECT KEY QCodeGEVA.gekond FILE "Vprodukt" INDEX QCodeGEVA.vprodukt
               codevp.gekond = codevp.vprodukt
               Gesellschaft.gekond = gesellschaft.vprodukt
               Sparte.gekond = sparte.vprodukt
               Kurzname.gekond = kurzname.vprodukt
               QuickCodeGes.gekond = STR$ (CodeMA.gekond,"000000") + UCASE$ (gesellschaft.gekond) + UCASE$ (sparte.gekond) + DATE$ (bwvon.gekond,"yyyymm0d")
             ELSE 
               codevp.gekond = 0
             END IF 
           END IF 
         ELSE 
           codevp.gekond = 0
         END IF 
       END IF 
       STORE FILE "gekond"
       SELECT NEXT LOCK FILE "gekond"
     WEND 

     CALL KVCheck(22)

     REM 15092004
     IF GIndNeu% = - 1 THEN 
       REM REMOVE FROM FILE "gekond" WHERE codevp.gekond = 0
       IF RECCOUNT ("gekond") > 1 THEN 
         SELECT FIRST LOCK FILE "gekond"
       ELSE 
         SELECT LAST FILE "gekond"
       END IF 
       i% = 0
       j% = RECCOUNT ("GEKOND")
     END IF 
     WHILE NOT EOF ("GEKOND") AND GIndNeu% = - 1
       lfdnr$ = STR$ (lfdnr,"0000000")
       weiter% = - 1
       i% = i% + 1
       SET STATUS LTRIM$ ( STR$ (i%,",999999999")) + " DatensÑtze in GEKOND geprÅft von " + LTRIM$ ( STR$ (j%,",999999999"))
       CALL Server("UPDFIELD","PrÅfung auf verwendete Gesellschaften und Sparten!")
       CALL Server("UPDSTATUS",lfdnr$)
       codege% = codege.gekond
       codeva% = codeva.gekond
       IF NOT EXISTS (codege.gekond,codege.vprodukt) AND weiter% = - 1 THEN 
         REMOVE FROM FILE "gekond" WHERE codege.gekond = codege%
         SELECT FIRST LOCK 
         weiter% = 0
       END IF 
       IF NOT EXISTS (codeva.gekond,codeva.vprodukt) AND weiter% = - 1 THEN 
         REMOVE FROM FILE "gekond" WHERE codeva.gekond = codeva%
         SELECT FIRST LOCK 
         weiter% = 0
       END IF 
       QCodeGEVA$ = STR$ (Codege.gekond,"000000") + STR$ (Codeva.gekond,"000000")
       IF NOT EXISTS (QCodeGEVA$,QCodeGEVA.vprodukt) AND weiter% = - 1 THEN 
         REMOVE FROM FILE "gekond" WHERE QCodeGEVA.gekond = QCodeGEVA$
         SELECT FIRST LOCK 
         weiter% = 0
       END IF 
       IF weiter% <> 0 THEN SELECT NEXT LOCK 
     WEND 
   END IF 

   CALL KVCheck(23)

   REM -- Anpassung GEKONDM.SBF --
   
   CALL DFile(3,"GEKONDM" + _fpw$)
   FILE "GEKONDM"
   CALL FldAdd("TZ6","NUM;999.00",0)
   CALL FldAdd("TZ7","NUM;999.00",0)
   CALL FldAdd("TZ8","NUM;999.00",0)
   CALL FldAdd("TZ9","NUM;999.00",0)
   CALL FldAdd("TZ10","NUM;999.00",0)
   CALL FldAdd("TZ11","NUM;999.00",0)
   CALL FldAdd("TZ12","NUM;999.00",0)
   CALL FldAdd("TZD6","NUM;999.",0)
   CALL FldAdd("TZD7","NUM;999.",0)
   CALL FldAdd("TZD8","NUM;999.",0)
   CALL FldAdd("TZD9","NUM;999.",0)
   CALL FldAdd("TZD10","NUM;999.",0)
   CALL FldAdd("TZD11","NUM;999.",0)
   CALL FldAdd("TZD12","NUM;999.",0)
   CALL FldAdd("PflegeZW","NMI;99.",0)
   CALL FldAdd("QuickCode","TXT;18",1)
   CALL FldAdd("Courtage","NUM;999.0000",0)
   CALL FldAdd("AP","NUM;999.0000",0)
   CALL FldAdd("SR","NUM;999.0000",0)
   CALL FldAdd("PflegeProvi","NUM;999.0000",0)
 
   CALL FldAdd("BWjn","TXT;1",0)
   CALL FldAdd("VDjn","TXT;1",0)
   CALL FldAdd("TZjn","TXT;1",0)
   CALL FldAdd("PflegeJN","TXT;1",0)
   CALL FldAdd("PauschaleJN","TXT;1",0)
   CALL FldAdd("FormelJN","TXT;1",0)
   CALL FldAdd("DynamikJN","TXT;1",0)
   CALL FldAdd("MaximierungJN","TXT;1",0)
   CALL FldAdd("APjn","TXT;1",0)
   CALL FldAdd("CourtageJN","TXT;1",0)
   CALL FldAdd("SRjn","TXT;1",0)
   CALL FldAdd("CourtageZWjn","TXT;1",0)
   CALL FldAdd("CourtHaftUnbeg","TXT;1",0)
   CALL FldAdd("PflegeNachZahlw","TXT;1",0)
   CALL FldAdd("CourtEinstellen","TXT;1",0)
   CALL FldAdd("DMEinheit","NUM;,9999999.00",0)
   CALL FldAdd("Notiz","TXT;70",0)
   CALL FldAdd("RechArt","NUM;0.",0)
   CALL FldAdd("Faktor","NUM;,99999999.000000",0)
   CALL FldAdd("FormelHaft","TXT;4000",0)
   CALL FldAdd("QCodeGEVA","TXT;12",1)
   CALL FldAdd("Gesellschaft","TXT;30",0)
   CALL FldAdd("Sparte","TXT;60",0)
   CALL FldAdd("Kurzname","TXT;30",0)
   CALL FldAdd("CodeVP","NUM;000000.",1)
   CALL FldAdd("EuroEinheit","NUM;,9999999.000000",0)
   CALL FldAdd("EUUmstellung","TXT;1",0)
   CALL FldAdd("VSVjn","TXT;1",0)
   CALL FldAdd("VSV","NUM;999.00",0)
   CALL FldAdd("nurEinh","TXT;1",0)
   CALL FldAdd("EuroproEinh","NUM;,999999999.00",0)
   CALL FldAdd("DynamikPjn","TXT;1",0)
   CALL FldAdd("DynamikProz","NUM;999.0000",0)
   CALL FldAdd("Betreujn","TXT;1",0)
   CALL FldAdd("BetreuProz","NUM;999.0000",0)
   CALL FldAdd("APKVMonatJN","TXT;1",0)
   CALL FldAdd("KVMonatFakt","NUM;999.00000",0)
   CALL FldAdd("APPfMonatJN","TXT;1",0)
   CALL FldAdd("PflMonatFakt","NUM;999.00000",0)
   CALL FldAdd("CodeGRSP","NUM;000000.",1)
   CALL MarkMain("lfdnr")
   SAVE FILE "GEKONDM"
   CALL Server("UPDFIELD","PflegeZW")
   CALL Server("UPDSTATUS","Erzeuge Feldinhalt")
   UPDATE PflegeZW.GEKONDM = 12
   END UPDATE 
   UPDATE QuickCode.gekondm = STR$ (CodeMA.GEKONDM,"000000") + STR$ (CodeGE.gekondm,"000000") + STR$ (CodeVA.gekondm,"000000")
   END UPDATE 
   IF RECCOUNT ("GEKONDM") > 0 THEN 
     INDEX lfdnr
     SELECT LAST 
     WHILE lfdnr > SER ("GEKONDM",1)
     WEND 
     SELECT FIRST LOCK 
     WHILE NOT EOF ("GEKONDM")
       IF lfdnr < 1 THEN 
         lfdnr = SER ("GEKONDM",1)
       END IF 
       QCodeGEVA$ = STR$ (Codege.gekondm,"000000") + STR$ (Codeva.gekondm,"000000")
       IF EXISTS (QCodeGEVA$,QCodeGEVA.gekondm) THEN 
         QCodeGEVA.gekondm = STR$ (Codege.gekondm,"000000") + STR$ (Codeva.gekondm,"000000")
         SELECT KEY QCodeGEVA.gekondm FILE "Vprodukt" INDEX QCodeGEVA.vprodukt
         Gesellschaft.gekondm = gesellschaft.vprodukt
         codevp.gekondm = codevp.vprodukt
         Sparte.gekondm = sparte.vprodukt
         Kurzname.gekondm = kurzname.vprodukt
       ELSE 
         codevp.gekondm = 0
       END IF 
       STORE 
       SELECT NEXT LOCK 
     WEND 
     REMOVE FROM FILE "gekondm" WHERE codevp.gekondm = 0
     SELECT FIRST LOCK 
     WHILE NOT EOF ("GEKONDM")
       lfdnr$ = STR$ (lfdnr.GEKONDM,"0000000")
       weiter% = - 1
       CALL Server("UPDFIELD","PrÅfung auf verwndete Gesellschaften und Sparten!")
       CALL Server("UPDSTATUS",lfdnr$)
       codege% = codege.gekondm
       codeva% = codeva.gekondm
       IF NOT EXISTS (codege.gekondm,codege.vprodukt) AND weiter% = - 1 THEN 
         REMOVE FROM FILE "gekondm" WHERE codege.gekondm = codege%
         IF RECCOUNT ("gekondm") > 0 THEN 
           SELECT FIRST LOCK 
         ELSE 
           SELECT LAST 
         END IF 
         weiter% = 0
       END IF 
       IF NOT EXISTS (codeva.gekondm,codeva.vprodukt) AND weiter% = - 1 THEN 
         REMOVE FROM FILE "gekondm" WHERE codeva.gekondm = codeva%
         SELECT FIRST LOCK 
         weiter% = 0
       END IF 
       QCodeGEVA$ = STR$ (Codege.gekondm,"000000") + STR$ (Codeva.gekondm,"000000")
       IF NOT EXISTS (QCodeGEVA$,QCodeGEVA.vprodukt) AND weiter% = - 1 THEN 
         REMOVE FROM FILE "gekondm" WHERE QCodeGEVA.gekondm = QCodeGEVA$
         SELECT FIRST LOCK 
         weiter% = 0
       END IF 
       IF weiter% <> 0 THEN SELECT NEXT LOCK 
     WEND 
   END IF 
 
   CALL DFile(3,"VKOND" + _fpw$)
   FILE "VKOND"
   CALL FldAdd("StornoResGezJN","TXT;1",0)
   CALL FldAdd("StornoResGezJV","TXT;1",0)
   SAVE FILE "VKOND"
   IF RECCOUNT ("VKOND") = 0 THEN 
     CALL Server("UPDFILE","Konditionsdatei")
     CALL Server("UPDFIELD","")
     CALL Server("UPDSTATUS","Anpassung an neue Abrechnungsstruktur")
     REM CALL VKONDAkt()
   END IF 
   FILE "VKOND"
   CALL MarkMain("CodeVK")
   SAVE FILE "VKOND"
   
   IF RECCOUNT ("VKOND") > 0 THEN 
     INDEX CodeVK
     SELECT LAST 
     WHILE CodeVK > SER ("VKOND",1)
     WEND 
     SELECT FIRST LOCK 
     WHILE NOT EOF ("VKOND") AND CodeVK < 0
       IF Codevk < 1 THEN 
         codevk = SER ("vkond",1)
         STORE 
       END IF 
       SELECT NEXT LOCK 
     WEND 
   END IF 


   IF EXISTS (_ppath$ + "Buchung1.sbf") THEN 
     CALL DFile(3,"KVERTRAG" + _fpw$)
     CALL DFile(3,"BUCHUNG1" + _fpw$)
     FILE "BUCHUNG1"
     CALL FldAdd("Datum","DAT;0d.mm.yyyy",1)
 
     CALL FldAdd("Gesamtbetrag","NUM;,9999999.00",0)
     CALL FldAdd("Betrag","NUM;,9999999.00",0)
     CALL FldAdd("SR","NUM;,9999999.00",0)
     CALL FldAdd("Bewertungssumme","NUM;,999999999999.00",0)
     CALL FldAdd("gezahlt","NUM;,9999999.00",0)
 
     CALL FldAdd("QuickCode","TXT;14",1)
     CALL FldAdd("ExpAG","TXT;1",1)
     CALL FldAdd("Umrechnung","NUM;,99999999.000000",0)
     CALL FldAdd("CodeW","NUM;000000.",1)
     CALL FldAdd("Waehrung","TXT;6",0)
     CALL FldAdd("WaehrungBezeich","TXT;30",0)
 
     CALL FldAdd("GesamtbetragEU","NUM;,9999999.00",0)
     CALL FldAdd("BetragEU","NUM;,9999999.00",0)
     CALL FldAdd("SREU","NUM;,9999999.00",0)
     CALL FldAdd("BewertungssumEU","NUM;,999999999.00",0)
     CALL FldAdd("gezahltEU","NUM;,9999999.00",0)
     CALL FldAdd("CodeBUMON","TXT;14",1)
     CALL FldAdd("SRAuszahlung","DAT;0d.mm.yyyy",0)
     CALL FldAdd("VS_Beginn","DAT;0d.mm.yyyy",0)
     CALL FldAdd("KÅndigung","DAT;0d.mm.yyyy",0)
     CALL FldAdd("FÑlligkeit","DAT;0d.mm.yyyy",0)
     CALL FldAdd("gezahlt_am","DAT;0d.mm.yyyy",0)
     CALL FldAdd("VTCodeMA","NUM;000000.",1)
     CALL FldAdd("Ausgabeauf","NUM;999.00",0)
     CALL FldAdd("CodeAZ","NUM;000000.",1)
     CALL FldAdd("Bewertung2","NUM;,999999999999.00",0)
     CALL FldAdd("Bewertung2EU","NUM;,999999999999.00",0)
     CALL FldAdd("QCodeMAPROD","TXT;96",1)
     CALL FldAdd("VSumme","NUM;,999999999999.00",0)
     CALL FldAdd("BeitragBrut","NUM;,999999999.00",0)
     CALL FldAdd("BeitragNet","NUM;,999999999.00",0)
     CALL FldAdd("ZW","NMI;99",0)
     CALL FldAdd("VSummeEU","NUM;,999999999999.00",0)
     CALL FldAdd("BeitragBrutEU","NUM;,999999999.00",0)
     CALL FldAdd("BeitragNetEU","NUM;,999999999.00",0)
     CALL FldAdd("MWST","NUM;999.00",0)
     CALL FldAdd("JahresBBrut","NUM;,999999999.00",0)
     CALL FldAdd("JahresBNet","NUM;,999999999.00",0)
     CALL FldAdd("JahresBBrutEU","NUM;,999999999.00",0)
     CALL FldAdd("JahresBNetEU","NUM;,999999999.00",0)
     CALL FldAdd("APJN","TXT;1",0)
     CALL FldAdd("CourtJN","TXT;1",0)
     CALL FldAdd("PflegeJN","TXT;1",0)
     CALL FldAdd("SRJN","TXT;1",0)
     CALL FldAdd("APProzente","NUM;999.0000",0)
     CALL FldAdd("CourtProzente","NUM;999.0000",0)
     CALL FldAdd("PflegProzente","NUM;999.0000",0)
     CALL FldAdd("SRProzente","NUM;999.0000",0)
     CALL FldAdd("ProvBasiswert","NUM;,999999999.00",0)
     CALL FldAdd("KundEinzahlung","NUM;,999999999.00",0)
     CALL FldAdd("KundEinzahluEU","NUM;,999999999.00",0)
     CALL FldAdd("Agentur","TXT;100",0)
     CALL FldAdd("EinheitenEU","NUM;,9999999999.0000",0)
     CALL FldAdd("Einheiten","NUM;,9999999999.0000",0)
     CALL FldAdd("Buchungstext","TXT;100",0)
     CALL FldAdd("Antragsnr","TXT;30",0)
     CALL FldAdd("vs_nr","TXT;30",0)
     CALL FldAdd("UnterVermNr","TXT;8",0)
     CALL FldAdd("AFSKLOE","NUM;0",1)
     CALL FldAdd("BUDAY","NMI;00",1)
     CALL FldAdd("StorWarnJN","TXT;1",1)
     CALL FldAdd("StorWarnDatGes","DAT;0d.mm.yyyy",0)
     CALL FldAdd("StorWarnDatMA","DAT;0d.mm.yyyy",0)
     CALL FldAdd("StorWarnGrund","TXT;400",0)
     CALL FldAdd("StorWarnMasn","TXT;400",0)
     CALL FldAdd("StorWarnErg","TXT;100",0)
     CALL FldAdd("Vorschujn","NUM;0.",1)
     CALL FldAdd("FS24Satz_ID","TXT;14",1)
     CALL FldAdd("NettoEU","NUM;,9999999999.00",0)
     CALL FldAdd("VSVjn","TXT;1",0)
     CALL FldAdd("VSV","NUM;,9999999999.00",0)
     CALL FldAdd("nurEinh","TXT;1",0)
     CALL FldAdd("EuroproEinh","NUM;,999999999.00",0)
     CALL FldAdd("DynamikPjn","TXT;1",0)
     CALL FldAdd("DynamikProz","NUM;999.0000",0)
     CALL FldAdd("Betreujn","TXT;1",0)
     CALL FldAdd("BetreuProz","NUM;999.0000",0)
     CALL FldAdd("MWSTBetragEu","NUM;,999999999.00",0)
     CALL FldAdd("Kostenstelle","TXT;8",1)
     CALL FldAdd("CodeMAGR","NUM;000000.",1)
     CALL FldAdd("CodeAGDIR","NUM;000000.",1)
     CALL FldAdd("DebitorKto","TXT;8",1)
     CALL FldAdd("KreditorKto","TXT;8",1)
     CALL FldAdd("MWSTProz","NUM;999.00",0)
     CALL FldAdd("VSVProz","NUM;999.00",0)
     CALL FldAdd("QCodeMAVT","TXT;12",0)
     CALL FldAdd("gebuchtJN","NMI;00",0)
     CALL FldAdd("gebuchtDat","DAT;0d.mm.yyyy",0)
     CALL FldAdd("gebuchtJNDAT","TXT;9",0)
     CALL FldAdd("gebuchtJNMADAT","TXT;15",0)
     CALL FldAdd("KreditJN","TXT;1",0)
     CALL FldAdd("LeadsJN","TXT;1",0)
     CALL FldAdd("CodeEingGE","NUM;000000.",1)
     CALL FldAdd("EingereichtBei","TXT;50",0)
     CALL MarkMain("CodeBU")
     SAVE FILE "BUCHUNG1"
 
     CALL KVCheck(20)
 
     FILE "Buchung1"
     INDEX codebu.buchung1
     SELECT LAST 
     WHILE codebu.buchung1 > SER ("Buchung1",1)
     WEND 
     REM UPDATE QuickCode.BUCHUNG1 = STR$ (CodeMA.BUCHUNG1,"000000") + DATE$ (Datum.BUCHUNG1,"yyyymm0d"):
     REM sreu.buchung1 = sr.buchung1 / umrechnung.buchung1:
     REM betrageu.buchung1 = betrag.buchung1 / umrechnung.buchung1
     REM END UPDATE 
     CALL Server("UPDFILE","öberprÅfung auf WÑhrung")
     CALL Server("UPDFIELD"," ")
     CALL Server("UPDSTATUS"," ")
 
 
     FILE "stamm"
     SELECT FIRST 
     euro1% = umrechnung.stamm
     codew1% = codew.stamm
     waehrung1$ = waehrung.stamm
     wbez1$ = waehrung.stamm
 
     FILE "BUCHUNG1"
     INDEX CodeBU.BUCHUNG1
     IF RECCOUNT ("buchung1") > 0 THEN 
       SELECT FIRST FILE "buchung1"
       ok% = - 1
       WHILE ok% = - 1 AND NOT EOF ("buchung1")
         IF BetragEU.buchung1 > 0 THEN 
           ok% = 0
         ELSE 
           SELECT NEXT FILE "buchung1"
         END IF 
       WEND 
       IF NettoEU.buchung1 = 0 AND BetragEU.buchung1 > 0 THEN 
         UPDATE NettoEU.buchung1 = BetragEU.buchung1 WHERE MWSTBetragEu.buchung1 = 0
         END UPDATE 
       END IF 
     END IF 
     IF RECCOUNT ("BUCHUNG1") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     i% = 0
     zanz% = RECCOUNT ("BUCHUNG1")
     zanz1% = zanz%
     IF GAFSK$ LIKE "TRUE" THEN zanz1% = 0
     b$ = LTRIM$ ( STR$ (zanz%,",99999999"))
 
     SELECT LAST FILE "buchung1"
     IF QCodeMAVT.buchung1 = "" THEN 
       IF RECCOUNT ("BUCHUNG1") > 0 THEN 
         SELECT FIRST LOCK 
       ELSE 
         SELECT LAST 
       END IF 
       WHILE NOT EOF ("buchung1")
         i% = i% + 1
         IF QCodeMAVT.buchung1 = "" THEN 
           QCodeMAVT.buchung1 = STR$ (codema.buchung1,"000000") + STR$ (codevt.buchung1,"000000")
           STORE FILE "buchung1"
         END IF 
         SET STATUS STR$ (i%,",99999999") + "/" + b$
         SELECT NEXT LOCK FILE "buchung1"
       WEND 
     END IF 
 


     FILE "buchung1"
     INDEX codebu.BUCHUNG1
     IF RECCOUNT ("BUCHUNG1") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     i% = 0
     zanz% = RECCOUNT ("BUCHUNG1")
 
     i% = 0
     WHILE NOT EOF ("BUCHUNG1")
       i% = i% + 1
       SET STATUS STR$ (i%,",99999999") + " DatensÑtze in BUCHUNG angepasst"
       SELECT FIRST FILE "KVERTRAG" INDEX lfdnr.kvertrag
       SELECT KEY codevt.BUCHUNG1 FILE "KVERTRAG" INDEX lfdnr.kvertrag
       IF CodeEingGE.kvertrag > 0 THEN 
         CodeEingGE.BUCHUNG1 = CodeEingGE.kvertrag
         EingereichtBei.BUCHUNG1 = EingereichtBei.kvertrag
         STORE FILE "BUCHUNG1"
       END IF 
       SELECT NEXT LOCK FILE "BUCHUNG1" INDEX codebu.BUCHUNG1
     WEND 




     IF RECCOUNT ("BUCHUNG1") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     i% = 0
     zanz% = RECCOUNT ("BUCHUNG1")
     zanz1% = zanz%
     IF GAFSK$ LIKE "TRUE" THEN zanz1% = 0
     b$ = LTRIM$ ( STR$ (zanz%,",99999999"))
     REM GIndNeu% = - 1
     WHILE NOT EOF ("BUCHUNG1") AND GIndNeu% = - 1
       SELECT KEY codevt.buchung1 FILE "Kvertrag" INDEX lfdnr.kvertrag
       i% = i% + 1
       SET STATUS STR$ (i%,",99999999") + " BUCHUNG1 - DatensÑtze angepa·t von " + b$
       ok% = 0
       SELECT FIRST FILE "maadr" INDEX codema.maadr
       SELECT KEY codema.kvertrag FILE "maadr" INDEX codema.maadr
       IF umrechnung.buchung1 = 0 THEN umrechnung.buchung1 = 1
       IF QuickCode.BUCHUNG1 = "" THEN 
         QuickCode.BUCHUNG1 = STR$ (CodeMA.BUCHUNG1,"000000") + DATE$ (Datum.BUCHUNG1,"yyyymm0d")
         ok% = 1
       END IF 
       IF umrechnung.BUCHUNG1 < 0.0001 THEN 
         umrechnung.BUCHUNG1 = euro1%
         codew.BUCHUNG1 = codew1%
         waehrung.BUCHUNG1 = waehrung1$
         WaehrungBezeich.BUCHUNG1 = wbez1$
         ok% = 1
         CALL BU1DMEuro(euro1%)
       END IF 
       IF sreu.buchung1 <> 0 OR sr.buchung1 <> 0 THEN 
         sreu.buchung1 = sr.buchung1 / umrechnung.buchung1
         ok% = 1
       END IF 
       IF betrageu.buchung1 <> 0 OR betrag.buchung1 <> 0 THEN 
         betrageu.buchung1 = betrag.buchung1 / umrechnung.buchung1
         ok% = 1
       END IF 
       nn$ = Nachname.maadr + "," + Vorname.maadr
       IF VTAgentur.buchung1 <> nn$ THEN 
         VTAgentur.buchung1 = nn$
         ok% = 1
       END IF 
       IF MWSTProz.buchung1 = 0 AND NettoEU.buchung1 = 0 THEN 
         NettoEU.buchung1 = Betrageu.buchung1
         ok% = 1
       END IF 
 
       IF codew.buchung1 = 1 THEN 
         ok% = 1
         umrechnung.buchung1 = 1.955830
         euro1% = 1.955830
         CALL BU1DMEuro(euro1%)
       END IF 
       IF vtcodema.buchung1 < 1 AND codevt.buchung1 > 0 THEN 
         ok% = 1
         vtcodema.buchung1 = codema.kvertrag
       END IF 
       REM 07102002
       IF GAFSK$ LIKE "TRUE" THEN 
         IF vs_beginn.buchung1 <> VS_Beginn.kvertrag THEN 
           vs_beginn.buchung1 = VS_Beginn.kvertrag
           ok% = 1
         END IF 
       END IF 
       IF codevt.buchung1 < 1 THEN 
         ok% = 1
         vtcodema.buchung1 = codema.buchung1
       END IF 
       IF QCodeMAPROD.buchung1 = "" THEN 
         QCodeMAPROD.buchung1 = STR$ (CodeMA.buchung1,"000000") + VSNRPack$(Gesellschaft.buchung1) + VSNRPack$(Sparte.buchung1)
         ok% = 1
       END IF 
       IF agentur.buchung1 = "" THEN 
         IF codema.buchung1 > 0 THEN 
           ok% = 1
           SELECT KEY codema.buchung1 FILE "maadr" INDEX codema.maadr
           agentur.buchung1 = LEFT$ ( LTRIM$ (nachname.maadr) + ", " + LTRIM$ (vorname.maadr) + ", " + LTRIM$ (Agenturnr.maadr) + "Stufe:" + STR$ (stufe.maadr,"000"),100)
         END IF 
       END IF 
       IF BeitragBrut.buchung1 = 0 THEN 
         vsumme.buchung1 = vsumme.kvertrag
         vsummeEU.buchung1 = vsumme.kvertrag / umrechnung.buchung1
         BeitragBrut.buchung1 = Beitrag.kvertrag
         BeitragNet.buchung1 = NettoBeitrag.kvertrag
         BeitragBrutEu.buchung1 = Beitrag.kvertrag / umrechnung.buchung1
         BeitragNetEu.buchung1 = NettoBeitrag.kvertrag / umrechnung.buchung1
         zw.buchung1 = zw.kvertrag
         mwst.buchung1 = mwst.kvertrag
         sreu.buchung1 = sr.buchung1 / umrechnung.buchung1
         betrageu.buchung1 = betrag.buchung1 / umrechnung.buchung1
         VS_Beginn.buchung1 = VS_Beginn.kvertrag
         IF zw.buchung1 > 0 THEN 
           JahresBBrut.buchung1 = BeitragBrut.buchung1 * zw.buchung1
           JahresBNet.buchung1 = BeitragNet.buchung1 * zw.buchung1
           JahresBBrut.buchung1 = JahresBBrut.buchung1 / umrechnung.buchung1
           JahresBNet.buchung1 = JahresBNet.buchung1 / umrechnung.buchung1
         ELSE 
           JahresBBrut.buchung1 = BeitragBrut.buchung1
           JahresBNet.buchung1 = BeitragNet.buchung1
           JahresBBrut.buchung1 = JahresBBrut.buchung1 / umrechnung.buchung1
           JahresBNet.buchung1 = JahresBNet.buchung1 / umrechnung.buchung1
         END IF 
         ok% = 1
       END IF 
       IF buday.buchung1 < 1 THEN 
         ok% = 1
         buday.buchung1 = VAL ( LEFT$ ( DATE$ (Datum.buchung1,"0d.mm.yyyy"),2))
       END IF 
       IF EXISTS (codevt.buchung1,lfdnr.kvertrag) THEN 
         ok% = 1
         SELECT KEY codevt.buchung1 FILE "KVERTRAG" INDEX lfdnr.kvertrag
         antragsnr.buchung1 = Antragsnr.kvertrag
         vs_nr.buchung1 = vs_nr.kvertrag
       END IF 
       IF ok% = 1 THEN STORE FILE "BUCHUNG1"
       SELECT NEXT LOCK 
     WEND 
 
     CALL KVCheck(21)
 
 
     IF GAFSK$ LIKE "TRUE" THEN 
       MOUSE OFF 
       FILE "buchung1"
       INDEX codeaz.buchung1
       FILE "zeingan1"
       INDEX codevt.zeingan1
       SELECT FIRST FILE "zeingan1" INDEX codevt.zeingan1
       i% = 0
       j% = RECCOUNT ("Zeingan1")
       k% = 0
       WHILE NOT EOF ("Zeingan1") AND codevt.zeingan1 < 1
          i% = i% + 1
          codeaz1% = codeaz.zeingan1
          SET STATUS LTRIM$ ( STR$ (i%,",999999")) + " von " + LTRIM$ ( STR$ (j%,",999999")) + " geprÅft, davon korrigiert " + LTRIM$ ( STR$ (k%,",999999"))
          IF codevt.zeingan1 < 1 THEN 
            IF EXISTS (codeaz.zeingan1,codeaz.buchung1) THEN 
              k% = k% + 1
              SELECT FIRST FILE "buchung1" INDEX codeaz.buchung1
              SELECT KEY codeaz1% LOCK FILE "buchung1" INDEX codeaz.buchung1
              WHILE NOT EOF ("Buchung1") AND codeaz.buchung1 = codeaz1%
                AFSKLOE.buchung1 = 1
                STORE FILE "buchung1"
                SELECT NEXT LOCK FILE "buchung1" INDEX codeaz.buchung1
              WEND 
              
            END IF 
          END IF 
        WEND 
        REMOVE FROM FILE "Buchung1" WHERE AFSKLOE.buchung1 = 1
        REMOVE FROM FILE "zeingan1" WHERE codevt.zeingan1 < 1
        MOUSE ON 
     END IF 
     FILE "buchung1"
     CALL FldAdd("Sparte","TXT;60",1)
     CALL FldAdd("QCodeMAVT","TXT;12",1)
     CALL FldAdd("gebuchtJN","NMI;00",1)
     CALL FldAdd("gebuchtDat","DAT;0d.mm.yyyy",1)
     CALL FldAdd("gebuchtJNDAT","TXT;9",1)
     CALL FldAdd("gebuchtJNMADAT","TXT;15",1)
     SAVE FILE "buchung1"
     datei$ = "buchung1"
     FILE datei$
     INDEX gebuchtJNMADAT.datei$
     SELECT LAST FILE datei$
     IF gebuchtJNMADAT.datei$ = "" THEN 
       CALL FldAdd("gebuchtJN","NMI;00",0)
       REM CALL FldAdd("gebuchtDat","DAT;0d.mm.yyyy",1)
       CALL FldAdd("gebuchtJNDAT","TXT;9",0)
       CALL FldAdd("gebuchtJNMADAT","TXT;15",0)
       SAVE FILE datei$
       
       FILE datei$
       INDEX codebu.datei$
       IF RECCOUNT (datei$) > 1 THEN 
         SELECT FIRST LOCK FILE datei$ INDEX codebu.datei$
       ELSE 
         SELECT LAST FILE datei$ INDEX codebu.datei$
       END IF 
       i% = 0
       j% = RECCOUNT (datei$)
       WHILE NOT EOF (datei$)
         i% = i% + 1
         SET STATUS STR$ (i%,",999999999") + "/" + STR$ (j%,",999999999")
         IF gebuchtjn.datei$ <> 1 THEN gebuchtjn.datei$ = 0
         gebuchtJNDat.datei$ = STR$ (gebuchtjn.datei$,"0") + DATE$ (datum.datei$,"yyyymm0d")
         gebuchtJNMADat.datei$ = STR$ (gebuchtjn.datei$,"0") + STR$ (Codema.datei$,"000000") + DATE$ (datum.datei$,"yyyymm0d")
         STORE FILE datei$
         SELECT NEXT LOCK FILE datei$ INDEX codebu.datei$
       WEND 
       CALL FldAdd("gebuchtJN","NMI;00",1)
       REM CALL FldAdd("gebuchtDat","DAT;0d.mm.yyyy",1)
       CALL FldAdd("gebuchtJNDAT","TXT;9",1)
       CALL FldAdd("gebuchtJNMADAT","TXT;15",1)
       SAVE FILE datei$
     END IF 

   END IF 
 
   CALL DFile(3,"BUCHUNG" + _fpw$)
   FILE "BUCHUNG"
   CALL FldAdd("Datum","DAT;0d.mm.yyyy",1)
   CALL FldAdd("CodeKU","NUM;000000.",1)
   CALL FldAdd("Volumen","NUM;,9999999.00",0)' -- WÑhrungsanzeige entfernt
   CALL FldAdd("Gesamtbetrag","NUM;,9999999.00",0)
   CALL FldAdd("Betrag","NUM;,9999999.00",0)
   CALL FldAdd("SR","NUM;,9999999.00",0)
   CALL FldAdd("Bewertungssumme","NUM;,999999999999.00",0)
   CALL FldAdd("gezahlt","NUM;,9999999.00",0)
   CALL FldAdd("gezahlt_am","DAT;0d.mm.yyyy",0)
   CALL FldAdd("Provision","TXT;1",1)
   CALL FldAdd("SRgezahlt","TXT;1",0)
   CALL FldAdd("QuickCode","TXT;14",1)
   CALL FldAdd("Mahnung","TXT;1",1)
   CALL FldAdd("Sparte","TXT;60",0)
   CALL FldAdd("Einheiten","NUM;,9999999999.0000",0)
   CALL FldAdd("VTAgentur","TXT;100",0)
   CALL FldAdd("Umrechnung","NUM;,99999999.000000",0)
   CALL FldAdd("CodeW","NUM;000000.",1)
   CALL FldAdd("Waehrung","TXT;6",0)
   CALL FldAdd("WaehrungBezeich","TXT;30",0)
   CALL FldAdd("GesamtbetragEU","NUM;,9999999.00",0)
   CALL FldAdd("BetragEU","NUM;,9999999.00",0)
   CALL FldAdd("SREU","NUM;,9999999.00",0)
   CALL FldAdd("BewertungssumEU","NUM;,999999999.00",0)
   CALL FldAdd("gezahltEU","NUM;,9999999.00",0)
   CALL FldAdd("ExpAG","TXT;1",1)
   CALL FldAdd("CodeBUMON","TXT;14",1)
   CALL FldAdd("FÑlligkeit","DAT;0d.mm.yyyy",0)
   CALL FldAdd("SRAuszahlung","DAT;0d.mm.yyyy",0)
   CALL FldAdd("VS_Beginn","DAT;0d.mm.yyyy",0)
   CALL FldAdd("KÅndigung","DAT;0d.mm.yyyy",0)
   CALL FldAdd("VTCodeMA","NUM;000000.",1)
   CALL FldAdd("Ausgabeauf","NUM;999.00",0)
   CALL FldAdd("CodeAZ","NUM;000000.",1)
   CALL FldAdd("Bewertung2","NUM;,999999999999.00",0)
   CALL FldAdd("Bewertung2EU","NUM;,999999999999.00",0)
   CALL FldAdd("QCodeMAPROD","TXT;96",1)
   CALL FldAdd("VSumme","NUM;,999999999999.00",0)
   CALL FldAdd("BeitragBrut","NUM;,999999999.00",0)
   CALL FldAdd("BeitragNet","NUM;,999999999.00",0)
   CALL FldAdd("ZW","NMI;99",0)
   CALL FldAdd("VSummeEU","NUM;,999999999999.00",0)
   CALL FldAdd("BeitragBrutEU","NUM;,999999999.00",0)
   CALL FldAdd("BeitragNetEU","NUM;,999999999.00",0)
   CALL FldAdd("MWST","NUM;999.00",0)
   CALL FldAdd("JahresBBrut","NUM;,999999999.00",0)
   CALL FldAdd("JahresBNet","NUM;,999999999.00",0)
   CALL FldAdd("JahresBBrutEU","NUM;,999999999.00",0)
   CALL FldAdd("JahresBNetEU","NUM;,999999999.00",0)
   CALL FldAdd("APJN","TXT;1",0)
   CALL FldAdd("CourtJN","TXT;1",0)
   CALL FldAdd("PflegeJN","TXT;1",0)
   CALL FldAdd("SRJN","TXT;1",0)
   CALL FldAdd("APProzente","NUM;999.0000",0)
   CALL FldAdd("CourtProzente","NUM;999.0000",0)
   CALL FldAdd("PflegProzente","NUM;999.0000",0)
   CALL FldAdd("SRProzente","NUM;999.0000",0)
   CALL FldAdd("ProvBasiswert","NUM;,999999999.00",0)
   CALL FldAdd("Agentur","TXT;100",0)
   CALL FldAdd("EinheitenEU","NUM;,9999999999.0000",0)
   CALL FldAdd("Buchungstext","TXT;100",0)
   CALL FldAdd("KundEinzahlung","NUM;,999999999.00",0)
   CALL FldAdd("KundEinzahluEU","NUM;,999999999.00",0)
   CALL FldAdd("Antragsnr","TXT;30",0)
   CALL FldAdd("vs_nr","TXT;30",0)
   CALL FldAdd("UnterVermNr","TXT;8",0)
   CALL FldAdd("StorWarnJN","TXT;1",1)
   CALL FldAdd("StorWarnDatGes","DAT;0d.mm.yyyy",0)
   CALL FldAdd("StorWarnDatMA","DAT;0d.mm.yyyy",0)
   CALL FldAdd("StorWarnGrund","TXT;400",0)
   CALL FldAdd("StorWarnMasn","TXT;400",0)
   CALL FldAdd("StorWarnErg","TXT;100",0)
   CALL FldAdd("NettoEU","NUM;,9999999999.00",0)
   CALL FldAdd("MWSTBetragEu","NUM;,999999999.00",0)
   CALL FldAdd("Kostenstelle","TXT;8",1)
   CALL FldAdd("CodeMAGR","NUM;000000.",1)
   CALL FldAdd("CodeAGDIR","NUM;000000.",1)
   CALL FldAdd("DebitorKto","TXT;8",1)
   CALL FldAdd("KreditorKto","TXT;8",1)
   CALL FldAdd("MWSTProz","NUM;999.00",0)
   CALL FldAdd("VSVProz","NUM;999.00",0)
   CALL FldAdd("QCodeMAVT","TXT;12",0)
   CALL FldAdd("gebuchtJN","NMI;00",0)
   CALL FldAdd("gebuchtDat","DAT;0d.mm.yyyy",0)
   CALL FldAdd("gebuchtJNDAT","TXT;9",0)
   CALL FldAdd("gebuchtJNMADAT","TXT;15",0)
   CALL FldAdd("KreditJN","TXT;1",0)
   CALL FldAdd("LeadsJN","TXT;1",0)
     CALL FldAdd("CodeEingGE","NUM;000000.",1)
     CALL FldAdd("EingereichtBei","TXT;50",0)
   CALL MarkMain("CodeBU")
   SAVE FILE "BUCHUNG"
 
   CALL KVCheck(21)
 
 
     FILE "buchung"
     INDEX CodeBU.Buchung
     SELECT LAST 
     WHILE CodeBU.Buchung > SER ("BUCHUNG",1)
     WEND 
 
     SELECT LAST FILE "buchung"
     IF QCodeMAVT.buchung = "" THEN 
       IF RECCOUNT ("BUCHUNG") > 0 THEN 
         SELECT FIRST LOCK 
       ELSE 
         SELECT LAST 
       END IF 
       i% = 0
       xb% = RECCOUNT ("buchung")
       b$ = STR$ (xb%,",99999999")
       WHILE NOT EOF ("buchung")
         i% = i% + 1
         IF QCodeMAVT.buchung = "" THEN 
           QCodeMAVT.buchung = STR$ (codema.buchung,"000000") + STR$ (codevt.buchung,"000000")
           STORE FILE "buchung"
         END IF 
         SET STATUS STR$ (i%,",99999999") + "/" + b$
         SELECT NEXT LOCK FILE "buchung"
       WEND 
     END IF 

     IF RECCOUNT ("BUCHUNG") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     i% = 0
     zanz% = RECCOUNT ("BUCHUNG")
 
     FILE "BUCHUNG"
     INDEX codebu.BUCHUNG
     IF RECCOUNT ("BUCHUNG") > 1 THEN 
       SELECT FIRST LOCK 
       i% = 0
       WHILE NOT EOF ("BUCHUNG")
         i% = i% + 1
         SET STATUS STR$ (i%,",99999999") + " DatensÑtze in BUCHUNG angepasst"
         SELECT FIRST FILE "KVERTRAG" INDEX lfdnr.kvertrag
         SELECT KEY codevt.BUCHUNG FILE "KVERTRAG" INDEX lfdnr.kvertrag
         IF CodeEingGE.kvertrag > 0 THEN 
           CodeEingGE.BUCHUNG = CodeEingGE.kvertrag
           EingereichtBei.BUCHUNG = EingereichtBei.kvertrag
           STORE FILE "BUCHUNG"
         END IF 
         SELECT NEXT LOCK FILE "BUCHUNG" INDEX codebu.BUCHUNG
       WEND 
     END IF 
 


 
   CALL Server("UPDFILE","Anpassung von Indexfeldern in der Buchungsdatei - Stufe 1, dauert etwas lÑnger ...")
   IF GIndNeu% = - 1 THEN 
     UPDATE QuickCode.BUCHUNG = STR$ (CodeMA.BUCHUNG,"000000") + DATE$ (Datum.BUCHUNG,"yyyymm0d"):
     sreu.buchung = sr.buchung / umrechnung.buchung:
     betrageu.buchung = betrag.buchung / umrechnung.buchung
     END UPDATE 
   END IF 
   tra$ = ReadConfig$("PROVIS","MAHNUNG")
   IF UCASE$ (tra$) = "FALSE" THEN 
     REM 15052003 UPDATE mahnung.buchung = ""
     REM 15052003 END UPDATE 
   END IF 
   IF RECCOUNT ("BUCHUNG") > 0 THEN 
     INDEX QuickCode.BUCHUNG
     SELECT FIRST 
     IF QuickCode.BUCHUNG = "" THEN 
       CALL Server("UPDFIELD","QuickCode")
       CALL Server("UPDSTATUS","Erzeuge Feldinhalt fÅr " + LTRIM$ ( STR$ ( RECCOUNT ("BUCHUNG"),"9999999")) + " DatensÑtze")
       UPDATE QuickCode.BUCHUNG = STR$ (CodeMA.BUCHUNG,"000000") + DATE$ (Datum.BUCHUNG,"yymmdd")
       END UPDATE 
     END IF 
     tra$ = ReadConfig$("PROVIS","MAHNUNG")
     IF UCASE$ (tra$) = "FALSE" THEN 
       CALL Server("UPDFILE","Anpassung von Indexfeldern in der Buchungsdatei - Stufe 1, dauert etwas lÑnger ...")
       UPDATE mahnung.buchung = "n"
       END UPDATE 
     END IF 
 
     INDEX codebu.buchung
     SELECT FIRST LOCK 
     IF codebu.buchung < 1 THEN 
       i% = 0
       j% = RECCOUNT ("BUCHUNG")
       WHILE NOT EOF ("BUCHUNG")
         i% = i% + 1
         SET STATUS LTRIM$ ( STR$ (i%,",99999999")) + " von " + LTRIM$ ( STR$ (j%,",99999999")) + " DatensÑtze in Buchung bearbeitet"
         codebu$ = STR$ (codebu,"0000000")
         CALL Server("UPDFIELD","CodeBU prÅfen!")
         CALL Server("UPDSTATUS",codebu$)
         IF CodeBU < 1 THEN 
           CodeBU = SER ("BUCHUNG",1)
           STORE 
         END IF 
         SELECT NEXT LOCK 
       WEND 
     END IF 
 
 
   END IF 
 
     CALL Server("UPDFILE","öberprÅfung auf WÑhrung")
     CALL Server("UPDFIELD"," ")
     CALL Server("UPDSTATUS"," ")
 
   CALL KVCheck(22)
 
     FILE "stamm"
     SELECT FIRST 
     euro1% = umrechnung.stamm
     codew1% = codew.stamm
     waehrung1$ = waehrung.stamm
     wbez1$ = waehrung.stamm
 
     FILE "BUCHUNG"
     INDEX CodeBU.BUCHUNG
 
 
     IF RECCOUNT ("buchung") > 0 THEN 
       SELECT FIRST FILE "buchung"
       ok% = - 1
       WHILE ok% = - 1 AND NOT EOF ("buchung")
         IF BetragEU.buchung > 0 THEN 
           ok% = 0
         ELSE 
           SELECT NEXT FILE "buchung"
         END IF 
       WEND 
       IF NettoEU.buchung = 0 AND BetragEU.buchung > 0 THEN 
         UPDATE NettoEU.buchung = BetragEU.buchung WHERE MWSTBetragEu.buchung = 0
         END UPDATE 
       END IF 
     END IF 
 
 
 
 
     IF RECCOUNT ("BUCHUNG") > 0 THEN 
       SELECT FIRST LOCK 
     ELSE 
       SELECT LAST 
     END IF 
     i% = 0
     j% = RECCOUNT ("BUCHUNG")
     REM AND GIndNeu% = - 1
     WHILE NOT EOF ("BUCHUNG") AND GIndNeu% = - 1
 
       
       SELECT KEY codevt.buchung FILE "Kvertrag" INDEX lfdnr.kvertrag
       i% = i% + 1
       ok% = 0
       SET STATUS STR$ (i%,",999999") + " DatensÑtze angepa·t von " + STR$ (j%,",999999")
       SELECT FIRST FILE "maadr" INDEX codema.maadr
       SELECT KEY codema.kvertrag FILE "maadr" INDEX codema.maadr
       nn$ = Nachname.maadr + "," + Vorname.maadr
       IF VTAgentur.buchung <> nn$ THEN 
         VTAgentur.buchung = nn$
         ok% = 1
       END IF 
       IF umrechnung.BUCHUNG < 0.0001 THEN 
         umrechnung.BUCHUNG = euro1%
         codew.BUCHUNG = codew1%
         waehrung.BUCHUNG = waehrung1$
         WaehrungBezeich.BUCHUNG = wbez1$
         CALL BUDMEuro(euro1%)
         ok% = 1
       END IF 
       IF codew.buchung = 1 THEN 
         ok% = 1
         umrechnung.buchung = 1.955830
         euro1% = 1.955830
         CALL BU1DMEuro(euro1%)
       END IF 
       IF vtcodema.buchung < 1 AND codevt.buchung > 1 THEN 
         ok% = 1
         vtcodema.buchung = codema.kvertrag
       END IF 
       IF codevt.buchung < 1 THEN 
         ok% = 1
         vtcodema.buchung = codema.buchung
       END IF 
       IF QCodeMAPROD.buchung = "" THEN 
         QCodeMAPROD.buchung = STR$ (CodeMA.buchung,"000000") + VSNRPack$(Gesellschaft.buchung) + VSNRPack$(Sparte.buchung)
         QuickCode.BUCHUNG = STR$ (CodeMA.BUCHUNG,"000000") + DATE$ (Datum.BUCHUNG,"yyyymm0d")
         ok% = 1
       END IF 
               'CALL FldAdd("VSumme","NUM;,999999999999.00",0)
               'CALL FldAdd("BeitragBrut","NUM;,999999999.00",0)
               'CALL FldAdd("BeitragNet","NUM;,999999999.00",0)
               'CALL FldAdd("ZW","NMI;99",0)
               'CALL FldAdd("VSummeEU","NUM;,999999999999.00",0)
               'CALL FldAdd("BeitragBrutEU","NUM;,999999999.00",0)
               'CALL FldAdd("BeitragNetEU","NUM;,999999999.00",0)
               'CALL FldAdd("MWST","NUM;999.00",0)
               'CALL FldAdd("ProviAb","DAT;0d.mm.yyyy",0)
       IF agentur.buchung = "" THEN 
         IF codema.buchung > 0 THEN 
           ok% = 1
           SELECT KEY codema.buchung FILE "maadr" INDEX codema.maadr
           agentur.buchung = LEFT$ ( LTRIM$ (nachname.maadr) + ", " + LTRIM$ (vorname.maadr) + ", " + LTRIM$ (Agenturnr.maadr) + "Stufe:" + STR$ (stufe.maadr,"000"),100)
         END IF 
       END IF 
       IF BeitragBrut.buchung = 0 THEN 
         vsumme.buchung = vsumme.kvertrag
         vsummeEU.buchung = vsumme.kvertrag / umrechnung.buchung
         BeitragBrut.buchung = Beitrag.kvertrag
         BeitragNet.buchung = NettoBeitrag.kvertrag
         BeitragBrutEu.buchung = Beitrag.kvertrag / umrechnung.buchung
         BeitragNetEu.buchung = NettoBeitrag.kvertrag / umrechnung.buchung
         zw.buchung = zw.kvertrag
         mwst.buchung = mwst.kvertrag
         sreu.buchung = sr.buchung / umrechnung.buchung
         betrageu.buchung = betrag.buchung / umrechnung.buchung
         VS_Beginn.buchung = VS_Beginn.kvertrag
         IF zw.buchung > 0 THEN 
           JahresBBrut.buchung = BeitragBrut.buchung * zw.buchung
           JahresBNet.buchung = BeitragNet.buchung * zw.buchung
           JahresBBrut.buchung = JahresBBrut.buchung / umrechnung.buchung
           JahresBNet.buchung = JahresBNet.buchung / umrechnung.buchung
         ELSE 
           JahresBBrut.buchung = BeitragBrut.buchung
           JahresBNet.buchung = BeitragNet.buchung
           JahresBBrut.buchung = JahresBBrut.buchung / umrechnung.buchung
           JahresBNet.buchung = JahresBNet.buchung / umrechnung.buchung
         END IF 
         ok% = 1
       END IF 
       IF MWSTProz.buchung = 0 AND NettoEU.buchung = 0 THEN 
         NettoEU.buchung = Betrageu.buchung
         ok% = 1
       END IF 
       IF ok% = 1 THEN STORE FILE "BUCHUNG"
       SELECT NEXT LOCK 
     WEND 
     FILE "buchung"
     CALL FldAdd("Sparte","TXT;60",1)
     CALL FldAdd("QCodeMAVT","TXT;12",1)
     CALL FldAdd("gebuchtJN","NMI;00",1)
     CALL FldAdd("gebuchtDat","DAT;0d.mm.yyyy",1)
     CALL FldAdd("gebuchtJNDAT","TXT;9",1)
     CALL FldAdd("gebuchtJNMADAT","TXT;15",1)
     SAVE FILE "buchung"
     datei$ = "buchung"
     FILE datei$
     INDEX gebuchtJNMADAT.datei$
     SELECT LAST FILE datei$
     IF gebuchtJNMADAT.datei$ = "" THEN 
       CALL FldAdd("gebuchtJN","NMI;00",0)
       REM CALL FldAdd("gebuchtDat","DAT;0d.mm.yyyy",1)
       CALL FldAdd("gebuchtJNDAT","TXT;9",0)
       CALL FldAdd("gebuchtJNMADAT","TXT;15",0)
       SAVE FILE datei$
       
       FILE datei$
       INDEX codebu.datei$
       IF RECCOUNT (datei$) > 1 THEN 
         SELECT FIRST LOCK FILE datei$ INDEX codebu.datei$
       ELSE 
         SELECT LAST FILE datei$ INDEX codebu.datei$
       END IF 
       i% = 0
       j% = RECCOUNT (datei$)
       WHILE NOT EOF (datei$)
         i% = i% + 1
         SET STATUS STR$ (i%,",999999999") + "/" + STR$ (j%,",999999999")
         IF gebuchtjn.datei$ <> 1 THEN gebuchtjn.datei$ = 0
         gebuchtJNDat.datei$ = STR$ (gebuchtjn.datei$,"0") + DATE$ (datum.datei$,"yyyymm0d")
         gebuchtJNMADat.datei$ = STR$ (gebuchtjn.datei$,"0") + STR$ (Codema.datei$,"000000") + DATE$ (datum.datei$,"yyyymm0d")
         STORE FILE datei$
         SELECT NEXT LOCK FILE datei$ INDEX codebu.datei$
       WEND 
       CALL FldAdd("gebuchtJN","NMI;00",1)
       REM CALL FldAdd("gebuchtDat","DAT;0d.mm.yyyy",1)
       CALL FldAdd("gebuchtJNDAT","TXT;9",1)
       CALL FldAdd("gebuchtJNMADAT","TXT;15",1)
       SAVE FILE datei$
     END IF 
Ende25012000: 
 END IF 
 CALL KVCheck(23)
 





 REM -- Anpassungen fÅr Projekt IMMAK -------------------------------------------
 REM -- Anpassungen fÅr Projekt IMMAK -------------------------------------------
 IF EXISTS (_netpath$ + "IMMAK\webimpo.sbf") THEN 
   CALL DFile(2,"IMMAK\webimpo" + _fpw$)
   FILE "webimpo"
   CALL FldAdd("ImmoZentral","TXT;1",0)
   CALL FldAdd("ImmoOptional","TXT;1",0)
   SAVE FILE "webimpo"
 END IF 
 IF EXISTS (_netpath$ + "IMMAK\Anfrage.sbf") THEN 
 
   CALL DFile(2,"OFFICE\" + "aktionen" + _fpw$)
   dat$ = "Akquise"
   IF OPEN (dat$) THEN CLOSE FILE dat$
   CALL DFile(2,"OFFICE\" + dat$ + _fpw$)
   FILE "AKQUISE"
   INDEX codeku.akquise
   SELECT FIRST LOCK 
   j% = RECCOUNT ("AKQUISE")
   i% = 0
   WHILE NOT EOF ("AKQUISE")
     i% = i% + 1
     IF codema.akquise > 0 THEN 
       codema% = codema.akquise
     ELSE 
       codema% = 1
     END IF 
     codema.akquise = codema%
     CALL QuickStore("akquise")
     SET STATUS "von IMMAK - Anpassung Termine " + STR$ (i%,",999999") + "/" + STR$ (j%,",999999")
     SELECT NEXT LOCK FILE "AKQUISE" INDEX codeku.akquise
   WEND 



   REM -- Anpassung OBJEKTE.SBF --
 
   CALL DFile(2,"IMMAK\OBJEKTE" + _fpw$)
   FILE "OBJEKTE"
   CALL FldUpdate("Lage1","TXT;200")
   CALL FldUpdate("Lage2","TXT;200")
   CALL FldUpdate("Art","TXT;200")
   CALL FldUpdate("Branche","TXT;200")
   CALL FldUpdate("Erschlie·ung","TXT;200")
   CALL FldUpdate("Stra·e","TXT;50")
   CALL FldUpdate("Ort","TXT;50")
   CALL FldUpdate("Ortsteil","TXT;50")
   CALL FldUpdate("Etage","TXT;4")
   CALL FldUpdate("ôFeinfach","TXT;35")
   CALL FldUpdate("ôFmittel","TXT;35")
   CALL FldUpdate("ôFgut","TXT;35")
   CALL FldUpdate("ôFmonatlich","TXT;35")
   CALL FldUpdate("ôFAbbau","TXT;35")
   CALL FldUpdate("ôFAbbauAb","TXT;35")
   CALL FldUpdate("Beziehbarbis","TXT;10")
   CALL FldUpdate("Baubeginn","TXT;10")
   CALL FldUpdate("Fertigstellung","TXT;10")
   CALL FldUpdate("Mietbeginn","TXT;10")
   CALL FldAdd("Fahrstuhl","TXT;1",1)
   CALL FldUpdate("BundesstrEntf","NUM;999.99")
   CALL FldUpdate("AutobahnEntf","NUM;999.99")
   CALL FldUpdate("BahnhofEntf","NUM;999.99")
   CALL FldAdd("PNotiz1","TXT;20",0)
   CALL FldAdd("PNotiz2","TXT;20",0)
   CALL FldAdd("PNotiz3","TXT;20",0)
   CALL FldAdd("AbEtage","TXT;20",0)
   CALL FldAdd("ABGallgemein","TXT;1",1)
   CALL FldAdd("ABGBranche","TXT;1",1)
   CALL FldAdd("ABGFlÑchen","TXT;1",1)
   CALL FldAdd("ABGPreise","TXT;1",1)
   CALL FldAdd("ABGErschlie·ung","TXT;1",1)
   CALL FldAdd("ABGOrt","TXT;1",1)
   CALL FldAdd("ABGOrtsteil","TXT;1",1)
   CALL FldAdd("ABGStra·e","TXT;1",1)
   CALL FldAdd("ABGStichwort","TXT;1",1)
   CALL FldAdd("AAMietint","TXT;1",1)
   CALL FldAdd("AAKaufint","TXT;1",1)
   CALL FldAdd("ABGKaufint","TXT;1",1)
   CALL FldAdd("ABGMietint","TXT;1",1)
   CALL FldAdd("Preism2Kauf","NUM;,999999.00",0)
   CALL FldAdd("ABGNotiz","TXT;L400 R",1)
   CALL FldAdd("ABGPLZ","TXT;1",1)
   CALL FldAdd("ABGStUND","TXT;1",1)
   CALL FldAdd("ABGStODER","TXT;1",1)
   CALL FldAdd("Bodenrichtwert","TXT;100",0)
   CALL FldAdd("Flur","TXT;100",0)
   CALL FldAdd("FlurstÅck","TXT;100",0)
   CALL FldAdd("Gemarkung","TXT;100",0)
   CALL FldAdd("HeadLine","TXT;100",0)
   CALL FldAdd("Nutzungsart","TXT;100",0)
   CALL FldAdd("Bebauung","TXT;100",0)
   CALL FldAdd("Geschosszahl","TXT;100",0)
   CALL FldAdd("Dachform","TXT;100",0)
   CALL FldAdd("Dachneigung","TXT;100",0)
   CALL FldAdd("Firsthîhe","TXT;100",0)
   CALL FldAdd("Traufhîhe","TXT;100",0)
   CALL FldAdd("Maklercourtage","NUM;,999999.00",0)
   CALL FldAdd("LageB","TXT;4000 R",0)
   CALL FldAdd("Telefon2","TXT;100",0)
   CALL FldAdd("Miteigentumer","TXT;4000 R",0)
   CALL FldAdd("Sonstiges","TXT;4000 R",0)
   CALL FldAdd("GrundflÑche","NUM;,999999999.",0)
   CALL FldAdd("vermietetam","TXT;20",0)
   CALL FldAdd("vermietet","TXT;1",0)
   CALL FldAdd("noverkauf","TXT;1",0)
   CALL FldAdd("noVermarktWWW","TXT;1",0)
   CALL FldAdd("Laengengr","TXT;20",0)
   CALL FldAdd("Breitengr","TXT;20",0)
   CALL FldAdd("ImportID","NUM;000000.",0)
   REM Objekt_erledigt
   CALL FldAdd("Objekt_erledigt","TXT;1",0)
   CALL FldAdd("CourtEur","NUM;,999999.00",0)
   REM  KIGA, Schule, Autobahn, Busverbindung, Bahn, Flughafen, Stadtteile, Einkaufsmîglichkeiten, Gesundheitswesen, Sonstiges
   CALL FldAdd("KIGA","TXT;4000 R",0)
   CALL FldAdd("Schule","TXT;4000 R",0)
   CALL FldAdd("Auto","TXT;4000 R",0)
   CALL FldAdd("Bus","TXT;4000 R",0)
   CALL FldAdd("Bahn","TXT;4000 R",0)
   CALL FldAdd("Flughafen","TXT;4000 R",0)
   CALL FldAdd("Statteile","TXT;4000 R",0)
   CALL FldAdd("Einkauf","TXT;4000 R",0)
   CALL FldAdd("Gesundheit","TXT;4000 R",0)
   CALL FldAdd("Sonstiges","TXT;4000 R",0)
   CALL FldAdd("ObjektderWoche","TXT;1",0)
   CALL FldAdd("Gescho·zahl","NUM;,9999.",0)
   CALL FldAdd("ImScout","TXT;1",0)
   CALL FldAdd("ImRhein","TXT;1",0)
   CALL FldAdd("ImImwelt","TXT;1",0)
   CALL FldAdd("ImImnet","TXT;1",0)
   CALL FldAdd("Hausnr","TXT;10",0)
   CALL FldAdd("Projektierung","TXT;1",0)
   CALL FldAdd("ImmoWelt","TXT;1",0)
   CALL FldAdd("ImmoNexus","TXT;1",0)
   CALL FldAdd("ImmoPool","TXT;1",0)
   CALL FldAdd("ImmoZentral","TXT;1",0)
   CALL FldAdd("ImmoOptional","TXT;1",0)
   CALL FldAdd("OnlineDat","DAT;0d.mm.yyyy",0)
   SAVE FILE "objekte"
   datei$ = "objekte"
   FILE datei$
   INDEX codeob
   IF RECCOUNT (datei$) > 2 THEN 
     j% = RECCOUNT (datei$)
     k% = 0
     SELECT FIRST LOCK 
     WHILE NOT EOF (datei$)
       i% = i% + 1
       IF NOT EXISTS (codeku.datei$,codeku.adressen) THEN 
         SELECT REMOVE FILE datei$
         k% = k% + 1
         i% = 1
         SELECT FIRST LOCK FILE datei$
       ELSE 
         SELECT NEXT LOCK FILE datei$
       END IF 
       SET STATUS STR$ (i%,"999999") + " von " + STR$ (j%,"999999") + " geprÅft / korrigiert:" + STR$ (i%,"999999") + " in Datei: " + datei$
     WEND 
   END IF 
   REM -- Anpassung ANFRAGE.SBF --
 
   CALL DFile(2,"IMMAK\ANFRAGE" + _fpw$)
   FILE "ANFRAGE"
   CALL FldUpdate("Lage1","TXT;200")
   CALL FldUpdate("Lage2","TXT;200")
   CALL FldUpdate("Art","TXT;200")
   CALL FldUpdate("Branche","TXT;200")
   CALL FldUpdate("Erschlie·ung","TXT;200")
   CALL FldUpdate("Stra·e","TXT;50")
   CALL FldUpdate("Ort","TXT;50")
   CALL FldUpdate("Ortsteil","TXT;50")
   CALL FldUpdate("Etage","TXT;4")
   CALL FldUpdate("ôFeinfach","TXT;35")
   CALL FldUpdate("ôFmittel","TXT;35")
   CALL FldUpdate("ôFgut","TXT;35")
   CALL FldUpdate("ôFmonatlich","TXT;35")
   CALL FldUpdate("ôFAbbau","TXT;35")
   CALL FldUpdate("ôFAbbauAb","TXT;35")
   CALL FldUpdate("Beziehbarbis","TXT;10")
   CALL FldUpdate("Baubeginn","TXT;10")
   CALL FldUpdate("Fertigstellung","TXT;10")
   CALL FldUpdate("Mietbeginn","TXT;10")
   CALL FldAdd("Fahrstuhl","TXT;1",1)
   CALL FldUpdate("BundesstrEntf","NUM;999.99")
   CALL FldUpdate("AutobahnEntf","NUM;999.99")
   CALL FldUpdate("BahnhofEntf","NUM;999.99")
   CALL FldAdd("PNotiz1","TXT;20",0)
   CALL FldAdd("PNotiz2","TXT;20",0)
   CALL FldAdd("PNotiz3","TXT;20",0)
   CALL FldAdd("AbEtage","TXT;20",0)
   CALL FldAdd("maxGrundstpreis","NUM;,999999999.00",0)
   CALL FldAdd("minGrundstpreis","NUM;,999999999.00",0)
   CALL FldAdd("maxGrundstprm2","NUM;,999999999.00",0)
   CALL FldAdd("minGrundstprm2","NUM;,999999999.00",0)
   CALL FldAdd("AAMietint","TXT;1",1)
   CALL FldAdd("AAKaufint","TXT;1",1)
   CALL FldAdd("ABGKaufint","TXT;1",1)
   CALL FldAdd("ABGMietint","TXT;1",1)
   CALL FldAdd("minGrundstflÑch","NUM;,999999999.00",0)
   CALL FldAdd("maxGrundstflÑch","NUM;,999999999.00",0)
   CALL FldAdd("ABGNotiz","TXT;L400R",1)
   CALL FldAdd("ABGPLZ","TXT;1",1)
   CALL FldAdd("ABGStUND","TXT;1",1)
   CALL FldAdd("ABGStODER","TXT;1",1)
   CALL FldAdd("unterbreitetam","TXT;20",0)
   CALL FldAdd("erledigtam","TXT;20",0)
   CALL FldAdd("ABGart","TXT;1",0)
   CALL FldAdd("ABGLageort","TXT;1",0)
   CALL FldAdd("ABGLageQual","TXT;1",0)
   CALL FldAdd("ABGAnzRaum","TXT;1",0)
   CALL FldAdd("Hausnr","TXT;10",0)
   CALL FldAdd("ObjektderWoche","TXT;1",0)
   CALL FldAdd("Gescho·zahl","NUM;,9999.",0)
   CALL FldAdd("minRÑume","NUM;,99999.",0)
   CALL FldAdd("maxRÑume","NUM;,9999.",0)
 
   SAVE FILE "anfrage"
 
   datei$ = "anfrage"
   FILE datei$
   INDEX codeob
   IF RECCOUNT (datei$) > 2 THEN 
     j% = RECCOUNT (datei$)
     k% = 0
     SELECT FIRST LOCK 
     WHILE NOT EOF (datei$)
       i% = i% + 1
       IF NOT EXISTS (codeku.datei$,codeku.adressen) THEN 
         SELECT REMOVE FILE datei$
         k% = k% + 1
         i% = 1
         SELECT FIRST LOCK FILE datei$
       ELSE 
         SELECT NEXT LOCK FILE datei$
       END IF 
       SET STATUS STR$ (i%,"999999") + " von " + STR$ (j%,"999999") + " geprÅft / korrigiert:" + STR$ (i%,"999999") + " in Datei: " + datei$
     WEND 
   END IF 
 
   FILE "akquise"
   INDEX codeaq.akquise
   IF RECCOUNT ("akquise") > 2 THEN 
     i% = 0
     j% = RECCOUNT ("akquise")
     SELECT FIRST LOCK 
     WHILE NOT EOF ("akquise")
       i% = i% + 1
       SET STATUS STR$ (i%,",999999") + " von " + STR$ (j%,",999999") + " Terminen geprÅft"
       sok% = 0
       IF NOT EXISTS (codeanfrage.akquise,codeob.anfrage) THEN 
         codeanfrage.akquise = 0
         sok% = - 1
       END IF 
       IF NOT EXISTS (codeobjekt.akquise,codeob.objekte) THEN 
         codeobjekt.akquise = 0
         sok% = - 1
       END IF 
       IF sok% = - 1 THEN 
         STORE FILE "akquise"
       END IF 
       SELECT NEXT LOCK FILE "akquise"
     WEND 
   END IF 
 END IF 
 
 REM -- Ende IMMAK-Update --------------------------------------------  
 REM -- Ende IMMAK-Update --------------------------------------------
 
 
afsk130420031:  
 IF GAFSK$ LIKE "TRUE" THEN 
   CALL DFile(3,"VPGEKOND" + _fpw$)
   CALL DFile(3,"BUCHUNG1" + _fpw$)
   CALL DFile(3,"VKOND" + _fpw$)
   CALL DFile(3,"GEKOND" + _fpw$)
   CALL DFile(3,"KVERTRAG" + _fpw$)
   CALL DFile(3,"KVFAEL" + _fpw$)
   DIM KVKond$( RECCOUNT ("VPGEKOND"))
   FILE "KVERTRAG"
   INDEX lfdnr.kvertrag
   IF RECCOUNT ("KVERTRAG") > 0 THEN 
     SELECT FIRST LOCK FILE "KVERTRAG" INDEX lfdnr.kvertrag
   ELSE 
     SELECT LAST FILE "KVERTRAG" INDEX lfdnr.kvertrag
   END IF 
   ii% = 0
   jj% = RECCOUNT ("KVERTRAG")
   WHILE NOT EOF ("KVERTRAG")
     ii% = ii% + 1
     SET STATUS STR$ (ii%) + " in KVERTRAG geprÅft von " + STR$ (jj%)
     codevt1% = lfdnr.kvertrag
     IF EXISTS (codevp.kvertrag,codevp.vpgekond) THEN 
                   a% = 0
                   gefunden% = 0
                   fehl% = 0
                   SELECT FIRST FILE "VPGEKOND" INDEX codevp.VPGEKOND
                   SELECT KEY codevp.kvertrag FILE "VPGEKOND" INDEX codevp.VPGEKOND
                   WHILE NOT EOF ("VPGEKOND") AND codevp.VPGEKOND = codevp.kvertrag
                     
                     ok% = - 1
                     gefunden% = gefunden% + 1
                     IF bwvon.VPGEKOND > 0 THEN 
                       IF VS_Beginn.kvertrag < bwvon.VPGEKOND THEN 
                         ok% = 0
                       END IF 
                     END IF 
                     IF bwbis.VPGEKOND > 0 THEN 
                       IF VS_Beginn.kvertrag > bwbis.VPGEKOND THEN 
                         ok% = 0
                       END IF 
                     END IF 
                     IF ok% = 0 THEN 
                       fehl% = fehl% + 1
                       GOTO afsnextko13042003
                     END IF 
                     IF ok% THEN 
                       KVKond$(a%) = "BWVon:" + DATE$ (bwvon.VPGEKOND,"0d.mm.yyyy") + " "
                       IF bwbis.VPGEKOND > 0 THEN 
                         KVKond$(a%) = KVKond$(a%) + "BWBis:" + DATE$ (bwbis.VPGEKOND,"0d.mm.yyyy") + " "
                       END IF 
 
                       IF courtagejn.VPGEKOND = "j" AND CoAnzBeitr.VPGEKOND > 0 THEN 
                         KVKond$(a%) = KVKond$(a%) + "Cortage Anzahl BeitrÑge:" + LTRIM$ ( STR$ (CoAnzBeitr.VPGEKOND,"9999.00")) + " "
                       END IF 
                       KVKond$(a%) = KVKond$(a%) + SPACE$ (100) + STR$ (codekey.VPGEKOND,"000000")
                       IF bwstart% >= bwvon.vpgekond THEN 
                         IF bwbis.vpgekond > 0 THEN 
                           IF bwstart% <= bwbis.vpgekond THEN prompt$ = KVKond$(a%)
                         ELSE 
                           prompt$ = KVKond$(a%)
                         END IF 
                       END IF 
                       a% = a% + 1
                     END IF 
afsnextko13042003:                     
                     SELECT NEXT FILE "VPGEKOND" INDEX codevp.VPGEKOND
                   WEND 
                   IF a% = 0 AND fehl% > 0 THEN 
                     req% = 0
                   ELSE 
                     KVKond$(a%) = ""
                     prompt$ = KVKond$(0)
                     req% = 1
                   END IF 
                   codekey% = 0
                   IF req% = 1 THEN 
                     CodeKey% = VAL ( RIGHT$ (prompt$,6))
                   END IF 
                   SELECT FIRST FILE "VPGEKOND" INDEX codekey.vpgekond
                   IF codekey% > 0 THEN 
                     SELECT KEY codekey% FILE "VPGEKOND" INDEX codekey.vpgekond
                     SELECT KEY codevt1% LOCK FILE "KVERTRAG" INDEX lfdnr.KVERTRAG
                     REM CALL Fehler("KVERTRAG","")
                     IF AFSKPAUJN.vpgekond LIKE "j" AND req% = 1 THEN 
                       AFSKPAUJN.kvertrag = "j"
                       AFSKPAUEUR.kvertrag = AFSKPAUEUR.vpgekond
                       REM QAFSKPAUDAT.kvertrag = "j" + DATE$ (AFSKPAUDAT.kvertrag,"yyyymm0d")
                       IF AFSKPAUDAT.kvertrag < 1 THEN 
                         QAFSKPAUDAT.kvertrag = AFSKPAUJN.kvertrag + "00000000"
                       ELSE 
                         QAFSKPAUDAT.kvertrag = AFSKPAUJN.kvertrag + DATE$ (AFSKPAUDAT.kvertrag,"yyyymm0d")
                       END IF 
                       STORE FILE "KVERTRAG"
                       UNLOCK CURRENT FILE "KVERTRAG"
                     ELSE 
                       IF AFSKPAUDAT.kvertrag < 1 THEN 
                         AFSKPAUJN.kvertrag = "n"
                         AFSKPAUEUR.kvertrag = 0
                         QAFSKPAUDAT.kvertrag = "n00000000"
                       END IF 
                     END IF 
                   END IF 

     END IF 
     SELECT NEXT LOCK FILE "KVERTRAG" INDEX lfdnr.kvertrag
   WEND 
   
   GOTO end200720051
   REM jetzt die Anpassungen fÅr Maklerbetreuungspauschale
   REM  QAFSKPAUMADAT
   FILE "KVERTRAG"
   INDEX lfdnr.kvertrag
   SELECT FIRST LOCK FILE "KVERTRAG" INDEX lfdnr.kvertrag
   ii% = 0
   jj% = RECCOUNT ("KVERTRAG")
   kk% = 0
   WHILE NOT EOF ("KVERTRAG")
     ii% = ii% + 1
     SET STATUS LTRIM$ ( STR$ (ii%,",99999999")) + " in KVERTRAG geprÅft auf Fixverg. von " + LTRIM$ ( STR$ (jj%,",99999999")) + " neu gefunden " + LTRIM$ ( STR$ (kk%,",99999999"))
     ok% = - 1
     IF LTRIM$ (QAFSKPAUMADAT.kvertrag) <> "" THEN ok% = 0
     IF CodeVStatus.kvertrag <> 1 THEN ok% = 0
     IF codeko.kvertrag < 1 THEN ok% = 0
     IF AFSKPauschDat.kvertrag < 1 THEN AFSKPauschDat.kvertrag = 0
     IF AFSKPauschDat.kvertrag > 0 THEN ok% = 0
     IF CodeVStatus.kvertrag = 1 AND ok% = - 1 THEN 
       IF EXISTS (codeko.kvertrag,codevk.vkond) THEN 
         SELECT FIRST FILE "vkond" INDEX codevk.vkond
         SELECT KEY codeko.kvertrag FILE "vkond" INDEX codevk.vkond
         IF EXISTS (codeko.vkond,lfdnr.gekond) THEN 
           SELECT FIRST FILE "GEKOND" INDEX lfdnr.gekond
           SELECT KEY codeko.vkond FILE "GEKOND" INDEX lfdnr.gekond
           IF AFSKPauschJN.gekond <> "j" THEN ok% = 0
         ELSE 
           ok% = 0
         END IF 
       ELSE 
         ok% = 0
       END IF 
     END IF 

     IF ok% = - 1 THEN 
       kk% = kk% + 1
       QAFSKPAUMADAT.kvertrag = "j00000000"
       AFSKPauschJN.kvertrag = "j"
       AFSKPausch.kvertrag = AFSKPausch.gekond
       STORE FILE "kvertrag"
       UNLOCK CURRENT FILE "kvertrag"
     END IF 
     SELECT NEXT LOCK FILE "KVERTRAG" INDEX lfdnr.kvertrag
   WEND 

 END IF 

end200720051: 
 CALL Server("UNLOADUPDATE","")
 CALL WriteConfig(_projekt$,"UPDATE","FALSE")
 IF _projekt$ LIKE "PROVIS" THEN 
   IF RECCOUNT ("KVERTRAG") > 0 THEN 
     CALL KVCheck(24)
     CALL StatistRefr(0)
   END IF 
 END IF 
 CALL Fehler("Update beendet!","Das Programm mu· neu gestartet werden!")
 CALL EXIT()
 END SUB 
 
 
 
 
 '      *********************************************
 '      ** Routinen fÅr Updates und Installationen **
 '      *********************************************
 
 
 
 ' Feldanpassung
 ' =======================================================================
 ' Zweck:       Anpassung des Feldformates
 ' Aufruf:      CALL FldUpdate(feldname$,newformat$)
 ' Beispiel:    CALL FldUpdate("Nachname","TXT;50")
 ' Hinweis:     - VerÑnderungen kînnen nur an der aktuellen Datei
 '                vorgenommen werden
 '              - alle énderungen mÅssen abschlie·end mit 
 '                SAVE FILE "filename" gesichert werden
 '              - die Umbenennung von Feldern ist nicht mîglich
 ' -----------------------------------------------------------------------
 ' 01.09.93/FA
 
SUB FldUpdate(Feldname$,NewFormat$)
 CALL GaugeUpdate()
 CALL Server("UPDFILE", FILE )
 CALL Server("UPDFIELD",Feldname$)
 SET STATUS "prÅfen Datei " + FILE + " Feld " + Feldname$
 IndexTyp$ = FIELDINFO$ (Feldname$,3)
 IF IndexTyp$ LIKE "IX*" THEN REMOVE INDEX Feldname$$
 MODIFY Feldname$$,Feldname$ + ";" + NewFormat$
 IF IndexTyp$ = "IXD" THEN 
   CALL Server("UPDSTATUS","Indexanpassung")
   CREATE INDEX ON Feldname$$
 END IF 
 IF IndexTyp$ = "IXU" THEN 
   CALL Server("UPDSTATUS","Indexanpassung")
   CREATE INDEX ON Feldname$$ UNIQUE 
 END IF 
 END SUB 
 
SUB FldRen(Feldname$,NewName$,NewFormat$,IndexType%)
 CALL GaugeUpdate()
 CALL Server("UPDFILE", FILE )
 CALL Server("UPDFIELD",Feldname$)
 ON ERROR GOTO ENDFldRen 
 IndexTyp$ = FIELDINFO$ (Feldname$,3)
 IF IndexTyp$ LIKE "IX*" THEN REMOVE INDEX Feldname$$
 MODIFY Feldname$$,NewName$ + ";" + NewFormat$
 IF IndexTyp$ = "IXD" THEN 
   CALL Server("UPDSTATUS","Indexanpassung")
   CREATE INDEX ON NewName$$
 END IF 
 IF IndexTyp$ = "IXU" THEN 
   CALL Server("UPDSTATUS","Indexanpassung")
   CREATE INDEX ON NewName$$ UNIQUE 
 END IF 
ENDFldRen: 
 CALL FldAdd(NewName$,NewFormat$,IndexType%)
 END SUB 
  
 
 
 ' FeldergÑnzung
 ' =======================================================================
 ' Zweck:       fÅgt ein neues Feld an die aktuelle Datei an
 ' Aufruf:      CALL FldAdd(feldname$,newformat$,IndexType%
 '
 '              IndexType%      0 = kein Index
 '                              1 = Mehrfachindex
 '                              2 = SchlÅsselindex
 '
 ' Beispiel:    CALL FldAdd("Notiz","TXT;4000",0)
 ' Hinweis:     - alle énderungen mÅssen abschlie·end mit 
 '                SAVE FILE "filename" gesichert werden
 ' -----------------------------------------------------------------------
 ' 01.09.93/FA
 
SUB FldAdd(Feldname$,NewFormat$,IndexType%)
 CALL GaugeUpdate()
 CALL Server("UPDFILE", FILE )
 CALL Server("UPDFIELD",Feldname$)
 CALL Server("UPDSTATUS","prÅfen")
 SET STATUS "prÅfen Datei " + FILE + " Feld " + Feldname$
 ON ERROR GOTO TrapFileFind
 tsfound% = 0
 a$ = FIELDINFO$ (FeldName$,0)
 tsfound% = 1
TrapFileFind: 
 IF test% = 0 THEN ON ERROR GOTO ErrorHandler ELSE ON ERROR 
 IF tsfound% = 0 THEN 
   REM ** Feld neu erstellen
   ADD Feldname$ + ";" + NewFormat$ + ";1;1"
   SELECT CASE IndexType%
   CASE 1
     CREATE INDEX ON Feldname$$
   CASE 2
     CREATE INDEX ON Feldname$$ UNIQUE 
   END SELECT 
 ELSE 
   REM ** Feld auf FormatÑnderungen testen und anpassen
   oldindex% = 0
   IF GIndNeu% = - 1 THEN 
     IF FIELDINFO$ (feldname$,3) LIKE "IX*" THEN oldindex% = 1
   END IF 
   IF FIELDINFO$ (feldname$,3) LIKE "IX*" AND IndexType% = 0 THEN 
     CALL Server("UPDSTATUS","Indexlîschung")
     REMOVE INDEX Feldname$$
   END IF 
   ok% = 1
   NewForm% = 0
   NewIndex% = 0
   cFormat$ = TRIM$ ( FIELDINFO$ (Feldname$,0) + ";" + FIELDINFO$ (Feldname$,4))
   IF UCASE$ (cformat$) <> UCASE$ (NewFormat$) THEN 
     ok% = 0
     NewForm% = 1
   END IF 
   IndexType$ = FIELDINFO$ (feldname$,3)
   IF (IndexType$ = "IXD" AND IndexType% = 2) OR (IndexType$ = "IXU" AND IndexType% = 1) THEN 
     ok% = 0
     NewIndex% = 1
   END IF 
   IF FIELDINFO$ (feldname$,3) LIKE "" AND IndexType% <> 0 THEN 
     NewIndex% = 1
     ok% = 0
   END IF 
   IF oldindex% = 1 THEN 
     ok% = 0
     NewForm% = 1
   END IF 
   IF ok% = 0 THEN 
     IF NewForm% = 1 AND IndexType$ LIKE "IX*" THEN 
       CALL Server("UPDSTATUS","Indexlîschung")
       REMOVE INDEX Feldname$$
       df$ = FILE 
       SAVE FILE df$
     END IF 
     IF NewForm% = 1 THEN 
       CALL Server("UPDSTATUS","Formatanpassung")
       MODIFY Feldname$$,Feldname$ + ";" + NewFormat$
       CALL Server("UPDSTATUS","Indexanpassung")
       SELECT CASE IndexType%
       CASE 1
         CREATE INDEX ON Feldname$$
       CASE 2
         CREATE INDEX ON Feldname$$ UNIQUE 
       END SELECT 
       ok% = 1
     END IF 
   END IF 
   IF ok% = 0 THEN 
     IF NewIndex% = 1 THEN 
       IF IndexType$ LIKE "IX*" THEN 
         CALL Server("UPDSTATUS","Indexlîschung")
         REMOVE INDEX Feldname$$
       END IF 
       CALL Server("UPDSTATUS","Indexanpassung")
       SELECT CASE IndexType%
       CASE 1
         CREATE INDEX ON Feldname$$
       CASE 2
         CREATE INDEX ON Feldname$$ UNIQUE 
       END SELECT 
       ok% = 1
     END IF 
   END IF 
 END IF 
 df$ = FILE 
 
 
 
 SAVE FILE df$
 END SUB 
 
  
 
 
 
 ' Feld fÅr XCHANGE als MAIN markieren
 ' =======================================================================
  
SUB MarkMain(FieldName$)
 REM ** Originaleintrag aus XCHANGE -> MODIFY findex$$,findex$ + ";" + FieldType$ + ";" + dFormat$,"COM MAIN"
 IF FIELDINFO$ (FieldName$,8) <> "MAIN" THEN 
   CALL Server("UPDFILE", FILE )
   CALL Server("UPDFIELD",FieldName$)
   CALL Server("UPDSTATUS","fÅr Datenaustausch markieren")
   tIndex$ = FIELDINFO$ (FieldName$,3)
   IF tIndex$ <> "" THEN REMOVE INDEX Fieldname$$
   FieldType$ = FIELDINFO$ (FieldName$,0)
   dFormat$ = FIELDINFO$ (FieldName$,4)
   MODIFY FieldName$$,FieldName$ + ";" + FieldType$ + ";" + dFormat$,"COM MAIN"
   IF tIndex$ <> "" THEN 
     CALL Server("UPDSTATUS","Index neu erstellen")
     CREATE INDEX ON FieldName$$
   END IF 
 END IF 
 END SUB 
  
  
 ' Gaugeupdate fÅr Updateprozeduren
 ' =======================================================================
 
SUB GaugeUpdate()
 Changes% = Changes% + 1
 cproz% = INT ((100 / ChangesMax%) * Changes%)
 IF cproz% < 0 THEN cproz% = 0
 IF cproz% > 100 THEN cproz% = 100
 CALL Server("UPDGAUGE", LTRIM$ ( STR$ (cproz%,"999")))
 END SUB 
 
 
 ' SUPERVIS - Pa·wîrter verschlÅsseln
 ' =======================================================================
 
SUB PWUpdate()
 FILE "SUPERVIS"
 INDEX CodeMA
 SELECT FIRST LOCK 
 WHILE NOT EOF ("SUPERVIS")
   IF KÅrzel <> "XX" THEN 
     Pa·wort = CALL ("crypt",Pa·wort)
     KÅrzel = "XX"
     STORE FILE "SUPERVIS"
   END IF 
   SELECT NEXT LOCK FILE "SUPERVIS" INDEX CodeMA
 WEND 
 END SUB 
  
 
  
 
 
 
 
SUB UmsFuel1ab()
 cfile$ = FILE 
 MOUSE OFF 
 CALL DFile(2,"OFFICE\adressen" + _fpw$)
 CALL DFile(2,"OFFICE\akquise" + _fpw$)
 CALL DFile(2,"OFFICE\telefon" + _fpw$)
 CALL DFile(3,"MASTER" + _fpw$)
 CALL DFile(3,"UMSATZ" + _fpw$)
 CALL DFile(3,"schein" + _fpw$)
 CALL DFile(3,"ARTPROV" + _fpw$)
 CALL DFile(3,"VERTRETE" + _fpw$)
 CALL DFile(3,"PROVISIO" + _fpw$)
 CALL DFile(3,"floskel" + _fpw$)
 CALL DFile(3,"einzprov" + _fpw$)
 FILE "adressen"
 INDEX codeku.adressen
 SELECT FIRST 
 FILE "master"
 INDEX codeku.master
 SELECT FIRST 
 FILE "umsatz"
 INDEX QuickCodekuJahr.umsatz
 SELECT FIRST 
 SET STATUS "Lîschen der alten UmsÑtze"
 REMOVE FROM FILE "umsatz"
 FILE "provisio"
 INDEX QuickCodeMAJahr.provisio
 SELECT FIRST 
 SET STATUS "Lîschen der alten Provisionen"
 REMOVE FROM FILE "provisio"
 FILE "einzprov"
 INDEX Codems.einzprov
 SELECT FIRST 
 SET STATUS "Lîschen der alten Einzel-Provisionen"
 REMOVE FROM FILE "einzprov"
 FILE "vertrete"
 INDEX codema.vertrete
 SELECT FIRST 
 SET STATUS "RÅcksetzen der Provisionsgesamtfelder"
 UPDATE ReGesGes = 0:GutGesGes = 0:AngGesGes = 0:LieGesGes = 0:AufGesGes = 0:BesGesGes = 0:ProGesGes = 0
 END UPDATE 
 UPDATE ReGesGesEU = 0:GutGesGesEU = 0:AngGesGesEU = 0:LieGesGesEU = 0:AufGesGesEU = 0:BesGesGesEU = 0:ProGesGesEU = 0
 END UPDATE 
 SET STATUS ""
 FILE "adressen"
 INDEX nachname.adressen
 IF NOT EOF ("adressen") THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 codeku% = codeku.adressen
 nachname$ = nachname.adressen
 WHILE NOT EOF ("adressen")
   IF EXISTS (codeku%,codeku.master) THEN 
     SET STATUS "Berechne UmsÑtze fÅr Adresse: " + nachname$
     FILE "master"
     INDEX codeku.master
     SELECT FIRST 
     SELECT KEY codeku% LOCK FILE "master" INDEX codeku.master
     AngGesGes% = 0
     ReGesGes% = 0
     LieGesGes% = 0
     AufGesGes% = 0
     BesGesGes% = 0
     GutGesGes% = 0
 
     AngGesGesEU% = 0
     ReGesGesEU% = 0
     LieGesGesEU% = 0
     AufGesGesEU% = 0
     BesGesGesEU% = 0
     GutGesGesEU% = 0
     WHILE NOT EOF ("master") AND codeku.master = codeku%
       codems% = codems.master
       FILE "schein"
       INDEX codems.schein
       SELECT FIRST 
       SELECT KEY codems% FILE "schein" INDEX codems.schein
       FILE "master"
       CALL ProvFuelGes(codems%)
       FILE "master"
       SELECT KEY codems% LOCK FILE "master" INDEX codems.master
       datum$ = DATE$ (datum.master,"yyyymmdd")
       jahr$ = LEFT$ (datum$,4)
       monat$ = MID$ (datum$,5,2)
       mo% = VAL (monat$)
       art% = art.master
       gesbrutto% = gesBrutto.master
       gesbruttoEU% = gesBruttoEU.master
 
       quickKuJahr$ = STR$ (codeku%,"000000") + jahr$
       BuchBrutto.master = GesBrutto.master
       BuchBruttoEU.master = GesBruttoEU.master
       BuchUms.master = "Y"
       BuchDatum.master = Datum.master
       BuchProv.master = ProvisDM.master
       BuchProvEU.master = ProvisEU.master
       BuchCodeMA.master = CodeMA.master
       STORE FILE "master"
       FILE "umsatz"
       INDEX QuickCodekuJahr.umsatz
       SELECT FIRST 
       IF EXISTS (quickKuJahr$,QuickCodekuJahr.umsatz) THEN 
         SELECT KEY quickKuJahr$ LOCK FILE "umsatz" INDEX QuickCodekuJahr.umsatz
       ELSE 
         BLANK FILE "umsatz"
         CodeUm.umsatz = SER ("umsatz",1)
         codeku.umsatz = codeku%
         jahr.umsatz = VAL (jahr$)
         QuickCodekuJahr.umsatz = STR$ (codeku%,"000000") + jahr$
         STORE FILE "umsatz"
         SELECT FIRST INDEX QuickCodekuJahr.umsatz
         SELECT KEY quickKuJahr$ LOCK FILE "umsatz" INDEX QuickCodekuJahr.umsatz
       END IF 
       SELECT CASE art%
         CASE 1
           MSArt$ = "Angebote"
           mo% = VAL (monat$)
           IF mo% = 0 THEN mo% = 1
           feld$ = "Ang" + STR$ (mo%,"00")
           feld$$ = feld$$ + gesbrutto%
           AngGesJahr.umsatz = AngGesJahr.umsatz + gesbrutto%
           AngGesGes% = AngGesGes% + gesbrutto%
 
           feldEU$ = "Ang" + STR$ (mo%,"00") + "EU"
           feldEU$$ = feldEU$$ + gesbruttoEU%
           AngGesJahrEU.umsatz = AngGesJahrEU.umsatz + gesbruttoEU%
           AngGesGesEU% = AngGesGesEU% + gesbruttoEU%
           CALL QuickStore("UMSATZ")
         CASE 2
           MSArt$ = "Rechnungen"
           mo% = VAL (monat$)
           IF mo% = 0 THEN mo% = 1
           feld$ = "Rec" + STR$ (mo%,"00")
           feld$$ = feld$$ + gesbrutto%
           ReGesJahr.umsatz = REGesJahr.umsatz + gesbrutto%
           ReGesGes% = ReGesGes% + gesbrutto%
 
           feldEU$ = "Rec" + STR$ (mo%,"00") + "EU"
           feldEU$$ = feldEU$$ + gesbruttoEU%
           ReGesJahrEU.umsatz = REGesJahrEU.umsatz + gesbruttoEU%
           ReGesGesEU% = ReGesGesEU% + gesbruttoEU%
           CALL QuickStore("UMSATZ")
         CASE 3
           MSArt$ = "Lieferscheine"
           mo% = VAL (monat$)
           IF mo% = 0 THEN mo% = 1
           feld$ = "Lie" + STR$ (mo%,"00")
           feld$$ = feld$$ + gesbrutto%
           LieGesJahr.umsatz = LieGesJahr.umsatz + gesbrutto%
           LieGesGes% = LieGesGes% + gesbrutto%
 
           feldEU$ = "Lie" + STR$ (mo%,"00") + "EU"
           feldEU$$ = feldEU$$ + gesbruttoEU%
           LieGesJahrEU.umsatz = LieGesJahrEU.umsatz + gesbruttoEU%
           LieGesGesEU% = LieGesGesEU% + gesbruttoEU%
           CALL QuickStore("UMSATZ")
         CASE 4
           MSArt$ = "AuftrÑge"
           IF mo% = 0 THEN mo% = 1
           feld$ = "Auf" + STR$ (mo%,"00")
           feld$$ = feld$$ + gesbrutto%
           AufGesJahr.umsatz = AufGesJahr.umsatz + gesbrutto%
           AufGesGes% = AufGesGes% + gesbrutto%
 
           feldEU$ = "Auf" + STR$ (mo%,"00") + "EU"
           feldEU$$ = feldEU$$ + gesbruttoEU%
           AufGesJahrEU.umsatz = AufGesJahrEU.umsatz + gesbruttoEU%
           AufGesGesEU% = AufGesGesEU% + gesbruttoEU%
           CALL QuickStore("UMSATZ")
         CASE 5
           MSArt$ = "Bestellungen"
           IF mo% = 0 THEN mo% = 1
           feld$ = "Bes" + STR$ (mo%,"00")
           feld$$ = feld$$ + gesbrutto%
           BesGesJahr.umsatz = BesGesJahr.umsatz + gesbrutto%
           BesGesGes% = BesGesGes% + gesbrutto%
 
           feldEU$ = "Bes" + STR$ (mo%,"00") + "EU"
           feldEU$$ = feldEU$$ + gesbruttoEU%
           BesGesJahrEU.umsatz = BesGesJahrEU.umsatz + gesbruttoEU%
           BesGesGesEU% = BesGesGesEU% + gesbruttoEU%
           CALL QuickStore("UMSATZ")
         CASE 7
           MSArt$ = "Gutschriften"
           IF mo% = 0 THEN mo% = 1
           feld$ = "Gut" + STR$ (mo%,"00")
           feld$$ = feld$$ + gesbrutto%
           GutGesJahr.umsatz = GutGesJahr.umsatz + gesbrutto%
           GutGesGes% = GutGesGes% + gesbrutto%
 
           feldEU$ = "Gut" + STR$ (mo%,"00") + "EU"
           feldEU$$ = feldEU$$ + gesbruttoEU%
           GutGesJahrEU.umsatz = GutGesJahrEU.umsatz + gesbruttoEU%
           GutGesGesEU% = GutGesGesEU% + gesbruttoEU%
           CALL QuickStore("UMSATZ")
       END SELECT 
       FILE "master"
     SELECT NEXT LOCK INDEX codeku.master
     WEND 
   END IF 
 
 FILE "adressen"
 INDEX nachname.adressen
 SELECT KEY codeku% LOCK FILE "adressen" INDEX codeku.adressen
 AngGesGes.adressen = AngGesGes%
 ReGesGes.adressen = ReGesGes%
 LieGesGes.adressen = LieGesGes%
 AufGesGes.adressen = AufGesGes%
 BesGesGes.adressen = BesGesGes%
 GutGesGes.adressen = GutGesGes%
 
 AngGesGesEU.adressen = AngGesGesEU%
 ReGesGesEU.adressen = ReGesGesEU%
 LieGesGesEU.adressen = LieGesGesEU%
 AufGesGesEU.adressen = AufGesGesEU%
 BesGesGesEU.adressen = BesGesGesEU%
 GutGesGesEU.adressen = GutGesGesEU%
 STORE FILE "adressen"
 
 SELECT NEXT INDEX nachname.adressen
 SET STATUS "Berechne UmsÑtze fÅr Adresse: " + nachname.adressen
 codeku% = codeku.adressen
 nachname$ = nachname.adressen
 WEND 
 SET STATUS "Berechnung der UmsÑtze beendet!"
 FILE cfile$
 MOUSE ON 
 END SUB 
 
 
 
 
 
 
 
SUB reorgkv(pfad$,orig$,kopie$,leerd$,dpfad$)
 REM CALL Fehler("reorgkv0","")
 MOUSE OFF 
 IF EXISTS (pfad$ + kopie$ + ".sbf") THEN 
   DELETE pfad$ + kopie$ + ".*"
 END IF 
 FILE orig$
 ON ERROR GOTO errkvreo1
 tex$ = "Reoganisiere " + orig$ + " nach " + kopie$
 REQUEST tex$,"",2
 SET STATUS "Reoganisiere " + orig$ + " nach " + kopie$
 REORGANIZE FILE orig$ TO pfad$ + kopie$ + ".sbf"
 tex$ = orig$ + " nach " + pfad$ + kopie$ + " kopiert!"
 REQUEST tex$,"",2
 ON ERROR GOTO errkvreo2
 FILE kopie$
 CLOSE FILE orig$
 IF EXISTS (pfad$ + orig$ + ".sbf") THEN 
   DELETE pfad$ + orig$ + ".*"
   tex$ = orig$ + " gelîscht!"
   REQUEST tex$,"",2
 END IF 
 ON ERROR GOTO errkvreo3
 test$ = pfad$ + leerd$ + _fpw$
 OPEN FILE SHARE ,0pfad$ + leerd$ + _fpw$
 REMOVE FROM FILE leerd$
 REORGANIZE FILE leerd$ TO pfad$ + orig$ + ".SBF"
 REQUEST "Leeres Original erstellt","",2
 ON ERROR GOTO errkvreo4
 FILE kopie$
 SELECT FIRST 
 REM SELECT KEY 5730 FILE "VORGANG" INDEX Codevt.VORGANG
 ixkuktoz% = FILEINFO (kopie$,1)
 DIM ixkukto$(ixkuktoz%)
 FILLARRAY ixkukto$,1
 i% = 0
 k% = RECCOUNT (kopie$)
 WHILE NOT EOF (kopie$)
   
   i% = i% + 1
   
   SET STATUS STR$ (i%,",999999") + " DatensÑtze von " + STR$ (k%,",999999") + " kopiert"
   CALL Server("UPDSTATUS", STR$ (i%,",999999") + " DatensÑtze von " + STR$ (k%,",999999") + " kopiert")

   
   BLANK FILE orig$
   aaaaa% = CopyRecord%(kopie$,orig$)
   REM FOR j% = 0 TO ixkuktoz% - 1
     REM feld1$ = ixkukto$(j%) + "." + orig$
     REM feld2$ = ixkukto$(j%) + "." + kopie$
     REM IF feld1$ LIKE "AGSperr*" THEN 
     REM ELSE 
       REM feld1$$ = feld2$$
     REM END IF 
   REM NEXT j%
   STORE FILE orig$
   REM CALL Fehler("alt: " + STR$ (lfdnr.kopie$,"000000"),"neu: " + STR$ (lfdnr.orig$,"000000"))
   FILE kopie$
   SELECT NEXT FILE kopie$
 WEND 
 CLOSE FILE kopie$
 GOTO endkvreo10
errkvreo1: 
 CALL Fehler("Bei der Komplettreoganisation der Datei ist ein Fehler aufgetreten!","")
 GOTO endkvreo10
errkvreo2: 
 CALL Fehler("Beim Lîschen der Originaldatei ist etwas schiefgegangen!","")
 GOTO endkvreo10
errkvreo3: 
 CALL Fehler("Beim reorganisieren der Leerdatei zur Originaldatei ist etwas schiefgegangen","")
 GOTO endkvreo10
errkvreo4: 
 CALL Fehler("Beim Kopieren der einzelnen DatensÑtze (aus der Kopiedatei in die Originaldatei) ist ein Fehler aufgetreten!","")
 CLOSE FILE kopie$
 CLOSE FILE orig$
 DELETE pfad$ + orig$ + ".*"
 IF orig$ LIKE "Adr*" THEN 
   IF EXISTS (dpfad$ + "\Adressen.sb!") THEN DELETE dpfad$ + "\Adressen.sb!"
   COPY dpfad$ + "\A*.*" TO _netpath$ + "OFFICE\"
 END IF 
 IF orig$ LIKE "KVER*" THEN 
   IF EXISTS (dpfad$ + "\kvertrag.sb!") THEN DELETE dpfad$ + "\kvertrag.sb!"
   COPY dpfad$ + "\K*.*" TO _netpath$ + "PROVIS\"
 END IF 
 IF orig$ LIKE "VPROD*" THEN 
   IF EXISTS (dpfad$ + "\vprodukt.sb!") THEN DELETE dpfad$ + "\vprodukt.sb!"
   COPY dpfad$ + "\vprod*.*" TO _netpath$ + "PROVIS\"
 END IF 
 GOTO endkvreo10
endkvreo10: 
 ON ERROR GOTO ErrorHandler
 END SUB 
  
 
 
SUB UpdADRKorr()
 CALL DFile(2,"OFFICE\ADRESSEN" + _fpw$)
 FILE "ADRESSEN"
 INDEX codeku.adressen
 SELECT FIRST 
 codekuold% = 0
 i% = 0
 f% = 0
 t% = 0
 d% = 0
 WHILE NOT EOF ("ADRESSEN")
   i% = i% + 1
   SET STATUS STR$ (i%,"99999") + " Adressen geprÅft    " + STR$ (d%,"99999") + " doppelte   " + STR$ (f%,"99999") + " doppelte gelîscht  " + STR$ (t%,"99999") + " umgewiesen"
   IF codekuold% = codeku.adressen THEN 
     d% = d% + 1
     IF nachname$ = nachname.adressen THEN 
       IF Kundennummer.adressen LIKE "verloren" THEN 
         f% = f% + 1
         SELECT REMOVE 
       ELSE 
         SELECT PREVIOUS LOCK 
         IF Kundennummer.adressen LIKE "verloren" THEN 
           f% = f% + 1
           SELECT REMOVE 
         ELSE 
           SELECT NEXT LOCK 
           SELECT REMOVE 
           f% = f% + 1
         END IF 
       END IF 
     ELSE 
       t% = t% + 1
       codeku.adressen = SER ("ADRESSEN",1)
       STORE FILE "adressen"
       UNLOCK CURRENT FILE "ADRESSEN"
     END IF 
     
     SELECT FIRST LOCK 
     SELECT KEY codekuold% LOCK FILE "Adressen" INDEX codeku.adressen
     codekuold% = 0
   ELSE 
     codekuold% = codeku.adressen
     nachname$ = nachname.adressen
   END IF 
   SELECT NEXT LOCK 
 WEND 
 END SUB 
 
 
 REM *******************************************************************************************************************************************************************************
 REM *    Struktur von Dateien auslesen
 REM *******************************************************************************************************************************************************************************

SUB StruDat(datei$)
  IF PROGRAMFILE ("TMPSTR99") THEN CLOSE PROGRAMFILE "TMPSTR99"
  IF EXISTS ("TMPSTR99.SBP") THEN DELETE "TMPSTR99.SBP"
  OPEN "TMPSTR99.SBP" FOR OUTPUT 
  ? " SUB TMPSTR99()"
 
 feldanz% = FILEINFO (datei$,1)
 DIM felder$(feldanz%)
 DIM feldtyp$(feldanz%)
 DIM feldindex$(feldanz%)
 DIM feldanzeig$(feldanz%)
 FILLARRAY felder$,1
 FOR i% = 0 TO feldanz% - 1
   feldtyp$(i%) = FIELDINFO$ (felder$(i%),0)
   feldindex$(i%) = FIELDINFO$ (felder$(i%),3)
   feldanzeig$(i%) = FIELDINFO$ (felder$(i%),4)
   IF feldindex$(i%) LIKE "I*" THEN 
     ind$ = "1"
   ELSE 
     ind$ = "0"
   END IF 
   befstring$ = "CALL FldAdd(" + CHR$ (34) + felder$(i%) + CHR$ (34) + "," + CHR$ (34) + feldtyp$(i%) + ";" + feldanzeig$(i%) + CHR$ (34) + "," + ind$ + ")"
   ? befstring$
 NEXT i%
 ? "SAVE FILE " + CHR$ (34) + datei$ + CHR$ (34)
 ? "END SUB"
 CLOSE OUTPUT 
 REM CALL Fehler("TMPSTR99","")
 REM ? "AAAA"
 LOAD "TMPSTR99.SBP", NEW 
 CALL TMPSTR99()
 CLOSE PROGRAMFILE "TMPSTR99"
 END SUB 
 
 
  
SUB KVCheck(p%)
  IF p% < 0 THEN 
     cfile1$ = FILE 
     FILE "KVERTRAG"
     INDEX lfdnr.KVERTRAG
     SELECT FIRST 
     CALL Fehler("Reorg KV " + STR$ (p%,"999") + " " + cfile1$,"lfdnr: " + STR$ (lfdnr.kvertrag,"000000"))
     FILE cfile1$
   END IF 
 END SUB 



SUB DokAnpName(date1$)
 REM CALL Fehler(date1$,"")
 FILE date1$
 INDEX codedok.date1$
 IF RECCOUNT (date1$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 i% = 0
 k% = RECCOUNT (date1$)
 WHILE NOT EOF (date1$)
   i% = i% + 1
   ok% = 0
   IF LTRIM$ (DateiOld.date1$) = "" AND LEFT$ (Dateiname.date1$,1) = "\" THEN 
     DateiOld.date1$ = Dateiname.date1$
     DateiRes.date1$ = Dateiname.date1$
     dd$ = UCASE$ (Dateiname.date1$)
     pfad$ = MID$ ( UCASE$ (_netpath$),3)
     l1% = 0
     l1% = LEN (pfad$)
     pos% = 0
     pos% = INSTR (dd$,pfad$)
     IF pos% > 0 THEN 
       dateiname$ = MID$ (dd$,pos% + l1%)
       REM CALL Fehler(dateiname$,dd$)
       Dateiname.date1$ = dateiname$
       ok% = 1
     ELSE 
       t1% = INSTR (4,dd$,"\")
       zw1$ = MID$ (dd$,t1%)
       Dateiname.date1$ = zw1$
       ok% = 1
     END IF 
   END IF 
   SET STATUS LTRIM$ ( STR$ (i%,",999999")) + " Dokumente geprÅft von " + LTRIM$ ( STR$ (k%,",999999"))
   IF date1$ LIKE "Dokument" THEN 
     IF gruppe.dokument LIKE "Antrags-/Vertragsdokument" THEN 
       gruppe.dokument = "VertrÑge"
       ok% = 1
     END IF 
   END IF 
   IF ok% = 1 THEN 
     IF LEFT$ (Dateiname.date1$,1) = "\" THEN Dateiname.date1$ = MID$ (Dateiname.date1$,2)
     IF RIGHT$ (Dateiname.date1$,1) = "\" THEN 
       l% = LEN (Dateiname.date1$)
       Dateiname.date1$ = LEFT$ (Dateiname.date1$,l% - 1)
     END IF 
     STORE FILE date1$
   END IF 
   SELECT NEXT LOCK FILE date1$ INDEX codedok.date1$
 WEND 
 END SUB 

SUB DokAnpDir(dat$)
 ON ERROR GOTO ErrorHandler
 MOUSE OFF 
 FILE dat$
 INDEX codedok.dat$
 IF RECCOUNT (dat$) > 0 THEN 
   SELECT FIRST LOCK 
 ELSE 
   SELECT LAST 
 END IF 
 i% = 0
 j% = RECCOUNT (dat$)
 WHILE NOT EOF (dat$)
   i% = i% + 1
   SET STATUS LTRIM$ ( STR$ (i%,",999999999")) + "/" + LTRIM$ ( STR$ (j%,",999999999")) + " in Datei " + dat$ + " bearbeitet"
   jamo$ = LEFT$ ( DATE$ (erstellt_am.dat$,"yyyymm0d"),6)
   jamotest$ = "*\" + jamo$ + "\*"
   IF Dateiname.dat$ LIKE jamotest$ THEN 
     REM Anpassung schon erfolgt,deshalb ab zum nÑchsten Datensatz
     DateiOld.dat$ = ""
     DateiRes.dat$ = ""
     STORE FILE dat$
     GOTO dnam200601241
     REM dnam200601241
   ELSE 
     IF dat$ LIKE "dokkv" THEN 
     ELSE 
       
     END IF 
   END IF 
   IF Dateiname.dat$ = "" THEN GOTO dnam200601241
   codedok% = codedok.dat$
   codedok$ = LTRIM$ ( STR$ (codedok%,"9999999"))
   Dateiname$ = dateiname.dat$
   DateinameLong$ = _netpath$ + Dateiname$
   
   IF dokpass.dat$ <> "" OR dokpass1.dat$ <> "" THEN 
     DateinameLong1$ = DateinameLong$
     ll% = LEN (DateinameLong$)
     DateinameLong$ = LEFT$ (DateinameLong1$,ll% - 3)
     DateinameLong$ = DateinameLong$ + "ENC"
   END IF 
   IF NOT EXISTS (DateinameLong$) THEN 
     dat$ = UCASE$ (dat$)
     pos% = - 1
     posold% = 1
     REM CALL Fehler("Position des letzten \ feststellen",codedok$)
     WHILE pos% <> 0
       pos% = INSTR (posold%,Dateiname$,"\")
       IF pos% > 0 THEN posold% = pos% + 1
     WEND 
     lenge% = LEN (Dateiname$)
     DatnamNew1$ = LEFT$ (Dateiname$,posold% - 1)
     ri% = lenge% - posold% + 1
     DatnamNew2$ = RIGHT$ (Dateiname$,ri%)
     codedoktest% = VAL (DatnamNew2$)
     REM CALL Fehler(Dateiname$,DatnamNew2$)
     DatnamNew0$ = DatnamNew1$ + jamo$ + "\" + DatnamNew2$
     DatnamNKompl$ = _netpath$ + DatnamNew0$
     IF dokpass.dat$ <> "" OR dokpass1.dat$ <> "" THEN 
       DatnamNKompl1$ = DatnamNKompl$
       ll% = LEN (DatnamNKompl1$)
       DatnamNKompl$ = LEFT$ (DatnamNKompl1$,ll% - 3)
       DatnamNKompl$ = DatnamNKompl$ + "ENC"
     END IF 
 
     IF NOT EXISTS (DatnamNKompl$) THEN 
       GOTO dnam200601241
     END IF 
     dateiname.dat$ = DatnamNew0$
     STORE FILE dat$
     GOTO dnam200601241
   END IF 
   DateiOld.dat$ = Dateiname$
   DateiRes.dat$ = Dateiname$
   pos% = - 1
   posold% = 1
   REM CALL Fehler("Position des letzten \ feststellen",codedok$)
   WHILE pos% <> 0
     pos% = INSTR (posold%,Dateiname$,"\")
     IF pos% > 0 THEN posold% = pos% + 1
   WEND 
   lenge% = LEN (Dateiname$)
   DatnamNew1$ = LEFT$ (Dateiname$,posold% - 1)
   DatnamNew2$ = RIGHT$ (Dateiname$,lenge% - posold% + 1)
   DatnamNew0$ = DatnamNew1$ + jamo$ + "\" + DatnamNew2$
   DatnamNKompl$ = _netpath$ + DatnamNew0$
   DirNew$ = _netpath$ + DatnamNew1$ + jamo$ + "\"
   DirNew1$ = _netpath$ + DatnamNew1$ + jamo$
   IF dokpass.dat$ <> "" OR dokpass1.dat$ <> "" THEN 
     DatnamNKompl1$ = DatnamNKompl$
     ll% = LEN (DatnamNKompl1$)
     DatnamNKompl$ = LEFT$ (DatnamNKompl1$,ll% - 3)
     DatnamNKompl$ = DatnamNKompl$ + "ENC"
   END IF 
   REM CALL Fehler(DateinameLong$,DatnamNKompl$)
   req% = 0
   ON ERROR GOTO dnam200601242
   MAKE DIRECTORY DirNew1$
dnam200601242: 
   ON ERROR GOTO dnam200601241
dnam200601242: 
   COPY DateinameLong$ TO DatnamNKompl$
dnam200601244: 
   IF EXISTS (DatnamNKompl$) THEN 
     dateiname.dat$ = DatnamNew0$
     STORE FILE dat$
     DELETE DateinameLong$
   ELSE 
     req% = req% + 1
     WAIT FOR 1
     REQUEST "Die Datei wurde noch nicht vollstÑndig kopiert!","",2
     IF req% < 20 THEN GOTO dnam200601244
   END IF 
   ON ERROR GOTO ErrorHandler
dnam200601241: 
   SELECT NEXT LOCK FILE dat$
 WEND 
 END SUB 


SUB DokKor(dat$)
 FILE dat$
 INDEX codedok.dat$
 SELECT FIRST LOCK 
 i% = 0
 j% = RECCOUNT (dat$)
 
 WHILE NOT EOF (dat$)
   i% = i% + 1
   SET STATUS LTRIM$ ( STR$ (i%,",999999999")) + "/" + LTRIM$ ( STR$ (j%,",999999999")) + " in Datei " + dat$ + " bearbeitet"
   jamo$ = LEFT$ ( DATE$ (erstellt_am.dat$,"yyyymm0d"),6)
   jamotest$ = "*\" + jamo$ + "\*"
   IF Dateiname.dat$ LIKE jamotest$ THEN 
   ELSE 
     Dateiname$ = dateiname.dat$
     dat$ = UCASE$ (dat$)
     pos% = - 1
     posold% = 1
     REM CALL Fehler("Position des letzten \ feststellen",codedok$)
     WHILE pos% <> 0
       pos% = INSTR (posold%,Dateiname$,"\")
       IF pos% > 0 THEN posold% = pos% + 1
     WEND 
     lenge% = LEN (Dateiname$)
     DatnamNew1$ = LEFT$ (Dateiname$,posold% - 1)
     ri% = lenge% - posold% + 1
     DatnamNew2$ = RIGHT$ (Dateiname$,ri%)
     codedoktest% = VAL (DatnamNew2$)
     REM CALL Fehler(Dateiname$,DatnamNew2$)
 
     IF Dateiname.dat$ LIKE "*VERTR.DOK*" THEN 
       IF codedoktest% > 0 AND EXISTS (codedoktest%,codedok.dokkv) THEN 
         SELECT FIRST FILE "dokkv" INDEX codedok.dokkv
         SELECT KEY codedoktest% FILE "dokkv" INDEX codedok.dokkv
         dateiname.dat$ = Dateiname.dokkv
         STORE FILE dat$
       END IF 
     END IF 
 
     IF Dateiname.dat$ LIKE "*GEADR.DOK*" THEN 
       IF codedoktest% > 0 AND EXISTS (codedoktest%,codedok.dokge) THEN 
         SELECT FIRST FILE "dokge" INDEX codedok.dokge
         SELECT KEY codedoktest% FILE "dokge" INDEX codedok.dokge
         dateiname.dat$ = Dateiname.dokge
         STORE FILE dat$
       END IF 
     END IF 
 
     IF Dateiname.dat$ LIKE "*MAADR.DOK*" THEN 
       IF codedoktest% > 0 AND EXISTS (codedoktest%,codedok.dokma) THEN 
         SELECT FIRST FILE "dokma" INDEX codedok.dokma
         SELECT KEY codedoktest% FILE "dokma" INDEX codedok.dokma
         dateiname.dat$ = Dateiname.dokma
         STORE FILE dat$
       END IF 
     END IF 
 
 
   END IF 
   SELECT NEXT LOCK FILE dat$
 WEND 
 
 END SUB 


 REM Termine erzeugen fÅr VorgÑnge, zu denen kein Termin existiert
SUB VorgAkqui(codevg%,GMACodeMA1%,Gcodeak%)
 codeku% = codeku.vorgang
 codeaq% = codeaq.vorgang
 codeak% = Gcodeak%
 IF NOT OPEN ("Aktionen") THEN CALL DFile(2,"OFFICE\aktionen" + _fpw$)
 FILE "Aktionen"
 INDEX codeak.aktionen
 IF NOT OPEN ("akquise") THEN CALL DFile(2,"OFFICE\akquise" + _fpw$)
 FILE "Akquise"
 INDEX codeaq.akquise
 IF NOT OPEN ("adressen") THEN CALL DFile(2,"OFFICE\adressen" + _fpw$)
 FILE "Adressen"
 INDEX codeku.adressen
 IF NOT OPEN ("kvertrag") THEN CALL DFile(3,"kvertrag" + _fpw$)
 FILE "KVERTRAG"
 INDEX lfdnr.kvertrag
 IF NOT OPEN ("sparten") THEN CALL DFile(3,"sparten" + _fpw$)
 FILE "sparten"
 INDEX codeva.sparten
 IF NOT OPEN ("geadr") THEN CALL DFile(3,"geadr" + _fpw$)
 FILE "geadr"
 INDEX codege.geadr
 IF NOT OPEN ("maadr") THEN CALL DFile(3,"maadr" + _fpw$)
 FILE "maadr"
 INDEX codema.maadr
 GAdrDat$ = "ADRESSEN"
 GAkquiDat$ = "AKQUISE"
 FILE "vorgang"
 INDEX codevg.vorgang
 
 IF codeaq% > 0 AND EXISTS (codeaq%,codeaq.akquise) THEN GOTO e200910171
 
     REM SELECT KEY codevt% FILE "Kvertrag" INDEX lfdnr.kvertrag
     SELECT FIRST FILE "Supervis" INDEX codema.supervis
     SELECT KEY GMACodeMA1% FILE "Supervis" INDEX codema.supervis
     codevt% = codevt.vorgang
     IF NOT EXISTS (codevt%,lfdnr.kvertrag) THEN GOTO e221020092
     SELECT FIRST FILE "KVERTRAG" INDEX lfdnr.kvertrag
     SELECT KEY codevt% FILE "KVERTRAG" INDEX lfdnr.kvertrag
     codeku% = codeku.kvertrag
     SELECT FIRST FILE GAdrDat$ INDEX codeku.GAdrDat$
     SELECT KEY codeku% FILE GAdrDat$ INDEX codeku.GAdrDat$
     nachn$ = NachName.supervis
     codege% = codege.kvertrag
     codeva% = Codeva.kvertrag
     codema% = codema.kvertrag
     ges$ = ""
     sparte$ = ""
     mitarb$ = ""
     IF EXISTS (codege%,codege.geadr) THEN 
       SELECT FIRST FILE "Geadr" INDEX codege.geadr
       SELECT KEY codege% FILE "Geadr" INDEX codege.geadr
       ges$ = Gesellschaft.geadr
     END IF 
     IF EXISTS (codeva%,codeva.sparten) THEN 
       SELECT FIRST FILE "sparten" INDEX codeva.sparten
       SELECT KEY codeva% FILE "sparten" INDEX codeva.sparten
       sparte$ = Sparte.sparten
     END IF 
     IF EXISTS (codema%,codema.maadr) THEN 
       SELECT FIRST FILE "maadr" INDEX codema.maadr
       SELECT KEY codema% FILE "maadr" INDEX codema.maadr
       mitarb$ = nachname.maadr
     END IF 
     _vcodema% = GMACodeMA1%
     SELECT KEY GMACodeMA1% LOCK FILE "supervis" INDEX codema.supervis
     IF NOT EXISTS (codeaq.vorgang,codeaq.GAkquiDat$) OR codeaq.vorgang < 1 THEN 
       AnzTermine.supervis = AnzTermine.supervis + 1
       IF erledigt.Vorgang LIKE "j" THEN 
         AnzTermineErl.supervis = AnzTermineErl.supervis + 1
       ELSE 
         AnzTermineUnErl.supervis = AnzTermineUnErl.supervis + 1
       END IF 
       STORE FILE "Supervis"
       UNLOCK CURRENT FILE "Supervis"
       UNLOCK FILE "supervis"
     END IF 
 
     namsup$ = Nachname.supervis
     aneu% = 0
     FILE GAkquiDat$
     IF NOT EXISTS (codeaq.vorgang,codeaq.GAkquiDat$) OR codeaq.vorgang < 1 THEN 
       aneu% = - 1
       BLANK FILE GAkquiDat$
       codeaq% = SER (GAkquiDat$,1)
       CodeAQ.GAkquiDat$ = codeaq%
       GErledTermin$ = erledigt.Vorgang
       Terminnr.GAkquiDat$ = AnzTermine.supervis
       codema.GAkquiDat$ = GMACodeMA1%
       Bearbeiter.GAkquiDat$ = namsup$
 
       STORE FILE GAkquiDat$
       UNLOCK CURRENT FILE GAkquiDat$
       UNLOCK FILE GAkquiDat$
       SELECT KEY codevg% LOCK FILE "Vorgang" INDEX codevg.vorgang
       codeaq.vorgang = codeaq%
       STORE FILE "Vorgang"
       UNLOCK CURRENT FILE "vorgang"
       UNLOCK FILE "vorgang"
     END IF 
     codeaq% = codeaq.vorgang
     SELECT FIRST FILE "Akquise" INDEX codeaq.akquise
     SELECT KEY codeaq% FILE "Akquise" INDEX codeaq.akquise
     tt$ = erledigt_termin.GAkquiDat$
     IF erledigt_termin.GAkquiDat$ LIKE "j" THEN 
       IF EXISTS (codeaq.GAkquiDat$,codeaq.tvorlage) THEN 
         codeaq% = codeaq.GAkquiDat$
         REMOVE FROM FILE "Tvorlage" WHERE codeaq.tvorlage = Codeaq%
       END IF 
     END IF 
     SELECT KEY codeaq% LOCK FILE GAkquiDat$ INDEX codeaq.GAkquiDat$
       IF aneu% = 0 THEN GErledTermin$ = erledigt_Termin.GAkquiDat$
       datum.GAkquiDat$ = Datum.vorgang
       REM CodeMA.GAkquiDat$ = GMACodeMA1%
       REM bearbeiter.GAkquiDat$ = Namsup$
       codeku.GAkquiDat$ = codeku%
       nachname.GAkquiDat$ = LEFT$ ( TRIM$ (nachname.GAdrDat$) + "," + TRIM$ (vorname.GadrDat$),100)
       IF Termin.vorgang < 1 THEN 
         Termin.GAkquiDat$ = TODAY + 2
       ELSE 
         Termin.GAkquiDat$ = Termin.vorgang
       END IF 
       Notizv$ = LEFT$ (Kurznotiz.vorgang) + CHR$ (13) + CHR$ (10)
       Notizv$ = Notizv$ + "Vertragsnachbearbeitung zum VERTRAG: " + VS_NR.Kvertrag + CHR$ (13) + CHR$ (10)
       IF ges$ <> "" THEN 
         Notizv$ = Notizv$ + "GESELLSCH.: " + ges$ + CHR$ (13) + CHR$ (10)
       END IF 
       IF sparte$ <> "" THEN 
         Notizv$ = Notizv$ + "SPARTE: " + Sparte$ + CHR$ (13) + CHR$ (10)
       END IF 
       IF mitarb$ <> "" THEN 
         Notizv$ = Notizv$ + "AGENTUR: " + mitarb$ + CHR$ (13) + CHR$ (10)
       END IF 
       Notizv$ = Notizv$ + LEFT$ ( LTRIM$ (Beschreibung.vorgang),1500)
       IF schadenssumme.vorgang > 0 THEN 
         NUMBASE "999999999999.00"
         Notizv$ = LEFT$ (Notizv$ + CHR$ (13) + CHR$ (10) + "Schadenssumme: " + STR$ (Schadenssumme.vorgang,",99999999.99"),1500)
       END IF 
       IF zahlung1.vorgang <> 0 OR zahlung2.vorgang <> 0 OR zahlung3.vorgang <> 0 OR zahlung4.vorgang <> 0 OR zahlung5.vorgang <> 0 OR zahlung6.vorgang <> 0 OR zahlung7.vorgang <> 0 THEN 
         Notizv$ = LEFT$ (Notizv$ + CHR$ (13) + CHR$ (10) + "Teilzahlungen:" + CHR$ (13) + CHR$ (10),1500)
         IF zahlung1.vorgang <> 0 THEN 
           Notizv$ = LEFT$ (Notizv$ + LTRIM$ ( STR$ (zahlung1.vorgang,",99999999.00")),1500) + "/" + DATE$ (ZahlDat1.vorgang,"0d.mm.yyyy")
         END IF 
         IF zahlung2.vorgang <> 0 THEN 
           Notizv$ = LEFT$ (Notizv$ + "  " + LTRIM$ ( STR$ (zahlung2.vorgang,",99999999.00")),1500) + "/" + DATE$ (ZahlDat2.vorgang,"0d.mm.yyyy")
         END IF 
         IF zahlung3.vorgang <> 0 THEN 
           Notizv$ = LEFT$ (Notizv$ + "  " + LTRIM$ ( STR$ (zahlung3.vorgang,",99999999.00")),1500) + "/" + DATE$ (ZahlDat3.vorgang,"0d.mm.yyyy")
         END IF 
         IF zahlung4.vorgang <> 0 THEN 
           Notizv$ = LEFT$ (Notizv$ + "  " + LTRIM$ ( STR$ (zahlung4.vorgang,",99999999.00")),1500) + "/" + DATE$ (ZahlDat4.vorgang,"0d.mm.yyyy")
         END IF 
         IF zahlung5.vorgang <> 0 THEN 
           Notizv$ = LEFT$ (Notizv$ + "  " + LTRIM$ ( STR$ (zahlung5.vorgang,",99999999.00")),1500) + "/" + DATE$ (ZahlDat5.vorgang,"0d.mm.yyyy")
         END IF 
         IF zahlung6.vorgang <> 0 THEN 
           Notizv$ = LEFT$ (Notizv$ + "  " + LTRIM$ ( STR$ (zahlung6.vorgang,",99999999.00")),1500) + "/" + DATE$ (ZahlDat6.vorgang,"0d.mm.yyyy")
         END IF 
         IF zahlung7.vorgang <> 0 THEN 
           Notizv$ = LEFT$ (Notizv$ + "  " + LTRIM$ ( STR$ (zahlung7.vorgang,",99999999.00")),1500) + "/" + DATE$ (ZahlDat7.vorgang,"0d.mm.yyyy")
         END IF 
       END IF 
       IF gezahlt.vorgang > 0 THEN 
         Notizv$ = LEFT$ (Notizv$ + CHR$ (13) + CHR$ (10) + "gezahlt Summe: " + LTRIM$ ( STR$ (gezahlt.vorgang,",99999999.00")),1500)
       END IF 
       IF gezahlt_am.vorgang > 0 THEN 
         Notizv$ = LEFT$ (Notizv$ + CHR$ (13) + CHR$ (10) + "erledigt am: " + DATE$ (gezahlt_am,"0d.mm.yyyy"),1500)
       END IF 
       Notiz.GAkquiDat$ = LEFT$ (Notizv$,1500)
       GErledTermin$ = erledigt_Termin.GAkquiDat$
       erledigt_Termin.GAkquiDat$ = erledigt.Vorgang
       IF erledigt_Termin.GAkquiDat$ <> "j" THEN 
         IF Termin.vorgang > 0 THEN 
           ErDatum.GAkquiDat$ = Termin.vorgang - 1
         ELSE 
           ErDatum.GAkquiDat$ = Termin.GAkquidat$ - 1
         END IF 
         ErZeit.GAkquiDat$ = 9
       END IF 
       IF UCASE$ (erledigt.vorgang) <> "J" THEN erledigt_Termin.GAkquiDat$ = "n"
       CodeAK.GAkquiDat$ = codeak%
       QuickCodeMA.GAkquiDat$ = DATE$ (termin.GAkquiDat$,"0dmmyyyy") + STR$ (CodeMA.GAkquiDat$,"000000")
       QuickCodeKU.GAkquiDat$ = DATE$ (termin.GAkquiDat$,"0dmmyyyy") + STR$ (CodeKU.GAkquiDat$,"000000")
       QuickCodeAK.GAkquiDat$ = DATE$ (termin.GAkquiDat$,"0dmmyyyy") + STR$ (CodeAK.GAkquiDat$,"000000")
       QuickAKMA.GAkquiDat$ = DATE$ (termin.GAkquiDat$,"0dmmyyyy") + STR$ (codeak.GAkquiDat$,"000000") + STR$ (CodeMA.GAkquiDat$,"000000")
       CodeAKMA.GAkquiDat$ = STR$ (codeak.GAkquiDat$,"000000") + STR$ (CodeMA.GAkquiDat$,"000000")
       QuickKUDat.GAkquiDat$ = STR$ (CodeKU.GAkquiDat$,"000000") + UCASE$ (erledigt_Termin.GAkquiDat$) + DATE$ (termin.GAkquiDat$,"yyyymm0d")
       QuickMADat.GAkquiDat$ = STR$ (CodeMA.GAkquiDat$,"000000") + UCASE$ (erledigt_Termin.GAkquiDat$) + DATE$ (termin.GAkquiDat$,"yyyymm0d")
       QuickAKDat.GAkquiDat$ = STR$ (CodeAK.GAkquiDat$,"000000") + UCASE$ (erledigt_Termin.GAkquiDat$) + DATE$ (termin.GAkquiDat$,"yyyymm0d")
       QuickAKMADat.GAkquiDat$ = STR$ (codeak.GAkquiDat$,"000000") + STR$ (CodeMA.GAkquiDat$,"000000") + UCASE$ (erledigt_Termin.GAkquiDat$) + DATE$ (termin.GAkquiDat$,"yyyymm0d")
       QuickKuDatDiff.GAkquiDat$ = codeku * 1000000 + (1000000 - DAYS (termin))
       QuickAKTer.GAkquiDat$ = STR$ (CodeAK.GAkquiDat$,"000000") + DATE$ (termin.GAkquiDat$,"yyyymm0d")
       QuickMATer.GAkquiDat$ = STR$ (CodeMA.GAkquiDat$,"000000") + DATE$ (termin.GAkquiDat$,"yyyymm0d")
       QuickKUTer.GAkquiDat$ = STR$ (CodeKU.GAkquiDat$,"000000") + DATE$ (termin.GAkquiDat$,"yyyymm0d")
       QuickAKMATer.GAkquiDat$ = STR$ (codeak.GAkquiDat$,"000000") + STR$ (CodeMA.GAkquiDat$,"000000") + DATE$ (termin.GAkquiDat$,"yyyymm0d")
       IF Workstation% > 0 THEN Workstation.GAkquiDat$ = Workstation%
       IF Workstation% > 0 THEN QWoNo.GAkquiDat$ = STR$ (Workstation%,"000000") + STR$ (CodeAq.GAkquiDat$,"000000")
       RecStatus.GAkquiDat$ = "c"
       
       SELECT KEY CodeAK.GAkquiDat$ FILE "aktionen" INDEX CodeAK.aktionen
       MemberOf.GAkquiDat$ = MemberOf.aktionen
       Aktion.GAkquiDat$ = Bezeichnung.aktionen
       codeaq% = Codeaq.vorgang
       CALL MATimeStamp(GAkquiDat$)
       STORE FILE GAkquiDat$
       UNLOCK CURRENT FILE GAkquiDat$
       UNLOCK FILE GAkquiDat$
       IF GErledTermin$ <> erledigt_Termin.GAkquiDat$ THEN 
         SELECT FIRST FILE "supervis" INDEX codema.supervis
         SELECT KEY _vcodema% LOCK FILE "supervis" INDEX codema.supervis
         IF erledigt_Termin.GAkquiDat$ LIKE "j" THEN 
           AnzTermineErl.supervis = AnzTermineErl.supervis + 1
           AnzTermineUnErl.supervis = AnzTermineUnErl.supervis - 1
         ELSE 
           IF GErledTermin$ LIKE "j" THEN 
             AnzTermineErl.supervis = AnzTermineErl.supervis - 1
           END IF 
           AnzTermineUnErl.supervis = AnzTermineUnErl.supervis + 1
         END IF 
         STORE FILE "supervis"
         UNLOCK CURRENT FILE "supervis"
         UNLOCK FILE "supervis"
       END IF 
     IF erledigt_termin.GAkquiDat$ <> "j" AND ErDatum.GAkquiDat$ > 0 AND ErDatum.GAkquiDat$ >= TODAY THEN 
       IF NOT EXISTS (codeaq%,codeaq.tvorlage) THEN 
         BLANK FILE "TVORLAGE"
         CodeTV.TVORLAGE = SER ("TVORLAGE",1)
         codeaq.TVORLAGE = codeaq.GAkquiDat$
         codema.TVORLAGE = codema.GAkquiDat$
         Termin.TVORLAGE = termin.GAkquiDat$
         Uhrzeit.TVORLAGE = Uhrzeit.GAkquiDat$
         Datum.TVORLAGE = ERDATUM.GAkquiDat$
         Zeit.TVORLAGE = ErZeit.GAkquiDat$
         Notiz.TVORLAGE = Notiz.GAkquiDat$
         Ergebnis.TVORLAGE = Ergebnis.GAkquiDat$
         Nachname.TVORLAGE = Nachname.GAkquiDat$
         Bearbeiter.TVORLAGE = Bearbeiter.GAkquiDat$
         erledigt_Termin.tvorlage = erledigt_termin.GAkquiDat$
         DTVorlage.TVORLAGE = STR$ (CodeMA.GAkquiDat$,"000000") + DATE$ (ErDatum.GAkquiDat$,"yyyymm0d") + TIME$ (ErZeit.GAkquiDat$,"hhmm")
         IF Workstation% > 0 THEN Workstation.TVORLAGE = Workstation%
         IF Workstation% > 0 THEN QWoNo.TVORLAGE = STR$ (Workstation%,"000000") + STR$ (CodeTV.TVORLAGE,"000000")
         RecStatus.TVORLAGE = "c"
         STORE FILE "TVORLAGE"
         UNLOCK CURRENT FILE "tvorlage"
         UNLOCK FILE "tvorlage"
       ELSE 
         SELECT KEY codeaq% LOCK FILE "TVORLAGE" INDEX codeaq.tvorlage
         codema.TVORLAGE = codema.GAkquiDat$
         Termin.TVORLAGE = termin.GAkquiDat$
         Uhrzeit.TVORLAGE = Uhrzeit.GAkquiDat$
         Datum.TVORLAGE = ERDATUM.GAkquiDat$
         Zeit.TVORLAGE = ErZeit.GAkquiDat$
         Notiz.TVORLAGE = Notiz.GAkquiDat$
         Ergebnis.TVORLAGE = Ergebnis.GAkquiDat$
         Nachname.TVORLAGE = Nachname.GAkquiDat$
         Bearbeiter.TVORLAGE = Bearbeiter.GAkquiDat$
         erledigt_Termin.tvorlage = erledigt_termin.GAkquiDat$
         DTVorlage.TVORLAGE = STR$ (CodeMA.GAkquiDat$,"000000") + DATE$ (ErDatum.GAkquiDat$,"yyyymm0d") + TIME$ (ErZeit.GAkquiDat$,"hhmm")
         IF Workstation% > 0 THEN Workstation.TVORLAGE = Workstation%
         IF Workstation% > 0 THEN QWoNo.TVORLAGE = STR$ (Workstation%,"000000") + STR$ (CodeTV.TVORLAGE,"000000")
         RecStatus.TVORLAGE = "c"
         STORE FILE "TVORLAGE"
          UNLOCK CURRENT FILE "tvorlage"
          UNLOCK FILE "tvorlage"
       END IF 
     ELSE 
       IF erledigt_termin.GAkquiDat$ LIKE "j" THEN 
         IF EXISTS (codeaq.GAkquiDat$,codeaq.tvorlage) THEN 
           codeaq% = codeaq.GAkquiDat$
           REMOVE FROM FILE "Tvorlage" WHERE codeaq.tvorlage = Codeaq%
         END IF 
       END IF 
     END IF 
     IF GAkquiDat$ LIKE "AKQUISE" AND ErDatum.GAkquiDat$ < 1 THEN 
       IF EXISTS (codeaq.GAkquiDat$,codeaq.tvorlage) THEN 
         codeaq% = codeaq.GAkquiDat$
         REMOVE FROM FILE "Tvorlage" WHERE codeaq.tvorlage = Codeaq%
       END IF 
     END IF 
 
     
e200910171:  
 FILE "Vorgang"
 END SUB 
 

