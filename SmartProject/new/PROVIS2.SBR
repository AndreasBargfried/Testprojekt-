SBP

 '  Provisionsabrechnungssystem
 '  Copyright (c) 1992-1995 CoDIE Computer-Dienste
 '  Version 3.1 19.10.95
 '
 ' ==============================================================
 ' 24.06.94/FA - Protokollierung von Fehlern in Log-Datei
 ' 28.06.94/FA - BUGFIX: Laufzeitermittlung in PROVISION2 umgestellt
 ' 29.06.94/FA - BUGFIX: Bewertungszeitraumhandling ge„ndert
 ' 02.07.94/FA - erweitertes Checking/Logging fr Vertragsdaten w„hrend Abrechnung
 '             - REQUEST 25 durch "SPACE$-Dialoge" ersetzt
 ' 09.11.95/FA - Umstellung auf Remote-Zugriff

ÿÿmain()
 ÿ†ÿt
 ÿ•
 ÿ…
 ÿ…ÿÿ
 ÿ¡ÿOÿ÷("CLIB")ÿpÿ¨"CLIB.SBR",ÿ°
 ÿ½ CALL LIBInit("PROVIS","PROVIS Agentur",0,2)
 ÿ½ CALL LIBInit("PROVIS","SmartPROVIS F",1,3)
 ÿƒLIBInit("PROVIS","SmartPROVIS Plus",1,1)
 ÿ½ CALL LIBInit("PROVIS","assistant provis",0,1)
 _fpw$ÿ";paris"
 _help%ÿ0
 _debug%ÿ0
 ÿƒINIT()
 ÿ½ ** Maximale Anzahl Agenturen in FirstStep
 fsmax%ÿ6
 _formend%ÿ0
 Upd$ÿReadConfig$(_projekt$,"UPDATE")
 ÿ¡Upd$ÿ"TRUE"ÿp
ÿ¡ÿOÿ÷("UPDATE")ÿpÿ¨_netpath$ÿ"UPDATE.SBR",ÿ°
ÿƒDoUpdate()
 ÿ’ÿ¡
 ÿ½ SET DISPLAY ON 
 ÿØ_formend%ÿ0
ÿƒPROVIS()
ÿÂ"Programm wirklich beenden?","",130,req%
ÿ¡req%ÿ1ÿp_formend%ÿ1
 ÿÙ
 ÿƒEXIT()
 ÿ’ÿÿ
 
ÿÿINIT()
 ÿßÿe
 ÿÿcuvt%,cuivt%,cuko%,cuva%
 ÿÿMADRsub%,VERTRsub%,GEKONDsub%,GEKONDMsub%,BUCHUNGsub%,GEADRsub%,SPARTEsub%,ZBsub%,ZEINsub%
 ÿÿgekondtr%,letzteProvi%,Anschluss%,Calcdate$,cdate%
 ÿÿvertrprov%,vertrsr%,nextprovi%
 ÿÿGEKOND$(80),BSatz$(1),fehlnach$
 ÿÿRepType%
 ÿÿKopfzeile$,Fuázeile$
 ÿÿfsmax%,vform%
 ÿÿgezPauschale%,gezPflege%,gezAbschluá%,eingab$,viab%
 ÿÊÿÿÿ™_netpath$ÿ_projekt$ÿ"\"ÿ_projekt$ÿ".HLP"
 ÿ¡ÿJ(_netpath$ÿ"PROVIS\LISTPRO2.SBV")ÿpRepType%ÿ1ÿ^RepType%ÿ0
 ÿÊÿiÿ³
 ÿƒLOGIN()
 ÿƒLizensierung()
 ÿßÿe
 ÿ’ÿÿ

 
 '      ********************************************
 '      ** Routinen Formular "PROVIS" - Hauptmen **
 '      ********************************************

ÿÿPROVIS()
 _formend%ÿ0
 ÿ½ CALL Gauge(0,"")
 ÿØ_formend%ÿ0
PROVISsub%ÿ0
ÿ¡ÿœÿ"PROVIS"ÿp
ÿƒMNMAIN()
ÿÊÿŸtitle$ÿ" - Hauptbersicht"
ÿ´ÿœ"PROVIS"
ÿÊÿÿ³
ÿƒHideStartup()
ÿÊÿË"Hauptauswahl: W„hlen Sie die gewnschte Funktion!"
ÿ’ÿ¡
ÿ¬ÿ³
ÿßÿ³
ÿÏÿßÿÿ¥ÿÿ¬
ÿÉÿæPROVISsub%
ÿæ1
ÿƒADRESSEN()
ÿæ2
ÿƒMAADR()
ÿæ3
ÿƒGEADR()
ÿæ4
ÿƒVERTRINFO()
ÿæ5
ÿƒFRVERTR()
ÿæ6
ÿƒCODEVA()
ÿæ7
ÿƒBUCHUNG()
ÿæ8
ÿƒBMKurzbericht()
ÿæ9
ÿƒPROLIST()
ÿæ10
ÿƒSETUP()
ÿæ11
ÿƒCIMMAK()
ÿæ12
ÿƒOFFICE()
ÿæ13
ÿƒXCHANGE()
ÿæ15
ÿƒEINGANG()
ÿæ16
ÿƒGEKONDM()
ÿ’ÿÉ
 ÿÙ
 _formend%ÿ0
 ÿ’ÿÿ


 ' Vertragsinformationen
 ' =======================================================================

ÿÿVERTRINFO()
 ÿ¡disabled%("KVERTRAG")ÿpÿ’ÿÿ
 ÿ¡MNdisabled%("DATALOCK")ÿp
ÿƒFehler("Der Zugriff auf diese Funktion ist gesperrt!","Bitte rufen Sie die Vertragsverwaltung ber die Adreáverwaltung auf.")
ÿ’ÿÿ
 ÿ’ÿ¡
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(3,"vorgang"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿÊÿ¬ÿe
 ÿ™"KVERTRAG"
 _formend%ÿ0
 askonerror%ÿ0
 cuivt%ÿ0
 ÿØ_formend%ÿ0
ÿ¡ÿ>(ÿœ)ÿ"IVERTRAG"ÿp
ÿ´ÿœ"IVERTRAG"
ÿÊÿŸtitle$ÿ" - Vertragsinformationen"
ÿƒMNVERTRI()
ÿ£VS_NR.KVERTRAG
ÿ¡cuivt%ÿ0ÿp
ÿÉÿœÿ¥cuivt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿ^
ÿÉÿœÿ`
ÿ’ÿ¡
ÿÊÿË"Vertragsinformationen"
ÿœ
ÿ’ÿ¡
ÿßÿ³
ÿ¬ÿ³
VIsub%ÿ0
ÿƒVIUpdate()
ÿƒClearKBDBuffer()
ÿÏÿßÿÿ¥ÿÿ¬
ÿ½ ** Tastencodes
ÿk$
ÿÉÿæÿ.(k$)
ÿæCrsLeft%,PgUp%
ÿƒPSelectPrev()
ÿæCrsRight%,PgDn%
ÿƒPSelectNext()
ÿ’ÿÉ
 ÿÙ
 _formend%ÿ0
 ÿ’ÿÿ
 

 ' IVERTRAG Maskenupdate
 ' =======================================================================
 
ÿÿVIUpdate()
 ÿÉÿ¥CodeMA.kvertragÿ™"maadr"ÿ£CodeMA.maadr
 ÿ¡ÿC("MAADR")ÿpmaadr$ÿNachname.maadrÿ", "ÿÿ+(Vorname.MAADR,1)ÿ"."ÿ^maadr$ÿ"<keine Zuordnung>"
 ÿÉÿ¥CodeVA.kvertragÿ™"sparten"ÿ£CodeVA.sparten
 ÿ¡ÿC("SPARTEN")ÿpsparte$ÿSparte.spartenÿ^sparte$ÿ"<keine Zuordnung>"
 ÿÉÿ¥CodeGE.kvertragÿ™"GEADR"ÿ£CodeGE.geadr
 ÿ¡ÿC("GEADR")ÿpgeadr$ÿGesellschaft.geadrÿ^geadr$ÿ"<keine Zuordnung>"
 ÿ¡ProviAb.KVERTRAGÿ0ÿFremdvertrag.KVERTRAGÿ"j"ÿAltvertrag.KVERTRAGÿ"j"ÿp
provis$ÿ"S&tatus"
 ÿ^
provis$ÿ"&Abrechnung"
 ÿ’ÿ¡
 ÿ¡ProviAb.KVERTRAGÿ0ÿp
ÿÊÿœÿeFremdvertrag
ÿÊÿœÿeAltvertrag
 ÿ^
ÿÊÿœÿ³Fremdvertrag
ÿÊÿœÿ³Altvertrag
 ÿ’ÿ¡
 ÿÉÿ¥lfdnr.kvertragÿ™"VORGANG"ÿ£CodeVT.VORGANG
 ÿ¡ÿC("VORGANG")ÿpschaeden$ÿ"Nachbea&rb. ®"ÿ^schaeden$ÿ"Nachbea&rb."
 Zahlweise$ÿZW2Str$(ZW.KVERTRAG)
 Zahlart$ÿZahlart2Str$(Zahlart.KVERTRAG)
 ÿ™"KVERTRAG"
 ÿœ
 ÿ’ÿÿ


 ' Vertrag suchen (Info)
 ' =======================================================================
 ' 17.04.95/FA - Umstellung auf QUICKVSNR
 ' 10.05.95/FA - Umstellung auf FUNCTION GetVertrag%...

ÿÿVISuchen()
 cuvt%ÿlfdnr.KVERTRAG
 nvt%ÿGetVertrag%(lfdnr.KVERTRAG)
 ÿ¡nvt%ÿ0ÿpcuvt%ÿnvt%
 ÿÉÿœÿ¥cuvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿÊÿ£QuickVSNR.KVERTRAG
 ÿ£QuickVSNR.KVERTRAG
 ÿßÿ³
 ÿÊÿË"Bereit"
 ÿ’ÿÿ

 ÿ½ andi 26.10.95
ÿÿVISuchen1()
 viab%ÿ1
 cfile$ÿÿ™
 indab$ÿÿ£
 cuvt%ÿlfdnr.KVERTRAG
 akver1%ÿ1
 ÿ‰ÿñ"vsuch",0,0,175,166,title$,"MS Sans Serif",8
 ÿ|ÿñ"vsuch",9,6,6,24,22,2
 ÿ|ÿñ"vsuch",5,34,6,132,10,0,"Vertrag suchen"
 ÿ|ÿñ"vsuch",4,34,14,132,5,0,""
 ÿ|ÿñ"vsuch",5,34,22,132,26,0,"Bitte geben Sie an, ber welche Infor- mation Sie den Vertrag suchen m”chten"
 ÿ½ ADD DIALOG "vsuch",3,34,49,154,10,0,"alle Vertr„ge anzeigen",0,akVer1%
 ÿ|ÿñ"vsuch",5,34,45,175,26,0,"Standardsuche (schnell):"
 ÿ|ÿñ"vsuch",5,34,71,175,26,0,"erweiterte Suche (langsamer):"
 ÿ|ÿñ"vsuch",6,34,121,132,12,0,0,Eingabe$,20
 ÿ|ÿñ"vsuch",3,41,57,148,10,0,"Vertrags&nummer",1,akVer1%
 ÿ|ÿñ"vsuch",3,41,83,132,10,0,"KFZ-&Kennzeichen",2,akVer1%
 ÿ|ÿñ"vsuch",3,41,95,132,10,0,"KFZ-&Typ",3,akVer1%
 ÿ|ÿñ"vsuch",5,34,111,175,10,0,"&Suchbegriff:"
 ÿ½ ADD DIALOG "vsuch",4,26,102,190,38,0,"Bitte den Suchbegriff eingeben"
 ÿ|ÿñ"vsuch",1,28,145,55,14,1,"&Weiter",1,1
 ÿ|ÿñ"vsuch",1,87,145,55,14,0,"&Abbruch",0,0
 ÿñ"vsuch",req%
 ÿ¾ÿñ"vsuch"
 ÿ¡req%ÿ1ÿp
ÿ¡akver1%ÿ0ÿp
a%ÿVERTRSuch%(CodeKU.KVERTRAG,cuvt%)
ÿ¡a%ÿ0ÿpcuvt%ÿa%
ÿÉÿœÿ¥cuvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿ’ÿ¡
ÿ¡akver1%ÿ1ÿp
ÿ¡eingabe$ÿ""ÿp
eingab$ÿeingabe$
nvt%ÿGetVertrag%(lfdnr.KVERTRAG)
ÿ¡nvt%ÿ0ÿpcuvt%ÿnvt%
eingab$ÿ""
ÿ^
ÿƒFehler("Es wurde keine Vertragsnummer eingegeben!","Vertrag kann nicht gesucht werden!")
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡akver1%ÿ2ÿp
ÿ¡eingabe$ÿ""ÿp
eingab$ÿeingabe$
nvt%ÿGETKFZKe%(lfdnr.KVERTRAG)
ÿ¡nvt%ÿ0ÿpcuvt%ÿnvt%
eingab$ÿ""
ÿ^
ÿƒFehler("Es wurde kein Kennzeichen eingegeben!","Vertrag kann nicht gesucht werden!")
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡akver1%ÿ3ÿp
ÿ¡eingabe$ÿ""ÿp
eingab$ÿeingabe$
nvt%ÿGETKFZTyp%(lfdnr.KVERTRAG)
ÿ¡nvt%ÿ0ÿpcuvt%ÿnvt%
eingab$ÿ""
ÿ^
ÿƒFehler("Es wurde kein KFZ-Typ eingegeben!","Vertrag kann nicht gesucht werden!")
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿÉÿœÿ¥cuvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿœ
 ÿ™cfile$
 ÿ£indab$
 ÿÊÿË"Bereit"
 ÿ’ÿÿ


 ' Vertrag aus Infomodus heraus bearbeiten
 ' =======================================================================
 ' 18.09.95/FA - šbergang in KVERTRAG korrigiert

ÿÿVINFBearb()
 cuvt%ÿlfdnr.KVERTRAG
 ÿƒKVERTRAG()
 ÿ’ÿÿ
 

 ' Vertrag suchen (Info)
 ' =======================================================================
 ' 10.05.95/FA

ÿÿGetVertrag%(lfdnr%)
 ÿßÿe
 cfile$ÿÿ™
 cuvt%ÿlfdnr.KVERTRAG
 ÿ™"KVERTRAG"
 cindex$ÿÿ£
 ÿ¡lfdnr%ÿ0ÿp
VSNR$ÿ""
 ÿ^
ÿÉÿ¥lfdnr%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿ¡ÿC("KVERTRAG")ÿpVSNR$ÿVS_Nr.KVERTRAGÿ^VSNR$ÿ""
 ÿ’ÿ¡
 ÿ¡eingab$ÿ""ÿviab%ÿ1ÿp
ÿ‰ÿñ"DZ2",0,0,191,87,"Vertrag suchen...","MS Sans Serif",8
ÿ|ÿñ"DZ2",4,0,0,191,63,0,""
ÿ|ÿñ"DZ2",9,5,10,21,22,2
ÿ|ÿñ"DZ2",5,34,9,147,20,0,"Bitte geben Sie die Vertrags-/Policennummer des gesuchten Vertrages ein:"
ÿ|ÿñ"DZ2",5,34,33,87,10,0,"Vertrags-/Policennummer:"
ÿ|ÿñ"DZ2",6,34,44,148,12,0,0,VSNR$,50
ÿ|ÿñ"DZ2",1,36,67,55,15,1,"&OK",1,1
ÿ|ÿñ"DZ2",1,94,67,55,15,0,"&Abbrechen",0,0
ÿñ"DZ2",req%
ÿ¾ÿñ"DZ2"
 ÿ^
VSNR$ÿeingab$
req%ÿ1
 ÿ’ÿ¡
 ÿ¡req%ÿ0ÿVSNR$ÿ""ÿp
ÿ×Vertraege$(ÿA("KVERTRAG"))
ÿ×Auswahl$(1)
ÿ£QuickVSNR.KVERTRAG
ÿÉÿ`
tVSNR$ÿVSNRPack$(VSNR$)
ÿÉÿ¥tVSNR$ÿ™"KVERTRAG"ÿ£QuickVSNR.KVERTRAG
a%ÿ0
ÿØQuickVSNR.KVERTRAGÿtVSNR$ÿ"*"ÿÿOÿB("kvertrag")
ÿ¡VS_Beginn.KVERTRAGÿ
1ÿpvon$ÿ"__.__.__"ÿ^von$ÿÿ(VS_Beginn.KVERTRAG,"0d.mm.yy")
ÿ¡Kndigung.KVERTRAGÿ
1ÿpbis$ÿ"__.__.__"ÿ^bis$ÿÿ(Kndigung.KVERTRAG,"0d.mm.yy")
Vertraege$(a%)ÿÿK(VS_Nr.KVERTRAG,38)ÿÿ(9)ÿ"  "ÿvon$ÿ" - "ÿbis$ÿÿ'(6)ÿÿ(lfdnr.KVERTRAG,"000000")
ÿ¡a%ÿ0ÿpprompt$ÿVertraege$(0)
a%ÿa%ÿ1
ÿÉÿ±
ÿÙ
ÿ¡a%ÿ0ÿp
GetVertrag%ÿ0
ÿ^
ÿ¡a%ÿ1ÿp
ÿßÿ³
lok%ÿÿ1
ÿØlok%
	ÿ‰ÿñ"ZEINLIST",0,0,251,198,"Vertrag suchen...","MS Sans Serif",8
	ÿ|ÿñ"ZEINLIST",4,0,0,251,172,0,""
	ÿ|ÿñ"ZEINLIST",9,8,11,25,24,2
	ÿ|ÿñ"ZEINLIST",5,35,11,168,20,0,"Es wurden mehrere Vertr„ge mit gleicher oder „hnlicher Nummer gefunden."
	ÿ|ÿñ"ZEINLIST",5,35,31,205,20,0,"Bitte w„hlen Sie den von Ihnen gesuchten Vertrag aus. Mit 'Info' erhalten Sie weitere Angaben zum gew„hlten Vertrag."
	ÿ|ÿñ"ZEINLIST",5,35,58,198,10,0,"Vertrags-/Policennummer                       von          bis"
	ÿ|ÿñ"ZEINLIST",7,36,68,205,105,2ÿ128,2,Vertraege$,Auswahl$,prompt$
	ÿ|ÿñ"ZEINLIST",1,36,178,55,15,1,"&OK",1,1
	ÿ|ÿñ"ZEINLIST",1,96,178,55,15,0,"&Info",2,1
	ÿ|ÿñ"ZEINLIST",1,156,178,55,15,0,"&Abbrechen",0,0
	ÿñ"ZEINLIST",req%
	ÿ¾ÿñ"ZEINLIST"
	ÿÉÿæreq%
	ÿæ1
GetVertrag%ÿÿ0(ÿ-(Auswahl$(0),6))
lok%ÿ0
	ÿæ0
GetVertrag%ÿ0
lok%ÿ0
	ÿæ2
ÿƒVINFO(ÿ0(ÿ-(Auswahl$(0),6)))
prompt$ÿAuswahl$(0)
	ÿ’ÿÉ
ÿÙ
ÿ^
GetVertrag%ÿÿ0(ÿ-(Vertraege$(0),6))
ÿ’ÿ¡
ÿ’ÿ¡
ÿ™"KVERTRAG"
ÿÉÿ¥cuvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿÊÿ£cindex$
ÿ£cindex$
ÿÊÿË"Bereit"
ÿßÿ³
ÿ™cfile$
 ÿ^
GetVertrag%ÿ0
 ÿ’ÿ¡
 ÿ’ÿÿ


 ÿ½ andi 26.10.95
ÿÿGetVerab%(lfdnr%)
 ÿßÿe
 cfile$ÿÿ™
 codeku%ÿcodeku.kvertrag
 cuvt%ÿlfdnr.KVERTRAG
 ÿ™"KVERTRAG"
 cindex$ÿÿ£
 req%ÿ1
 VSNR$ÿeingab$
 ÿ¡req%ÿ0ÿVSNR$ÿ""ÿp
ÿ×Vertraege$(ÿA("KVERTRAG"))
ÿ×Auswahl$(1)
ÿ£QuickVSNR.KVERTRAG
ÿÉÿ`
tVSNR$ÿVSNRPack$(VSNR$)
ÿÉÿ¥tVSNR$ÿ™"KVERTRAG"ÿ£QuickVSNR.KVERTRAG
a%ÿ0
ÿØQuickVSNR.KVERTRAGÿtVSNR$ÿ"*"
ÿ¡VS_Beginn.KVERTRAGÿ
1ÿpvon$ÿ"__.__.__"ÿ^von$ÿÿ(VS_Beginn.KVERTRAG,"0d.mm.yy")
ÿ¡Kndigung.KVERTRAGÿ
1ÿpbis$ÿ"__.__.__"ÿ^bis$ÿÿ(Kndigung.KVERTRAG,"0d.mm.yy")
ÿ¡codeku.kvertragÿcodeku%ÿp
Vertraege$(a%)ÿÿK(VS_Nr.KVERTRAG,38)ÿÿ(9)ÿ"  "ÿvon$ÿ" - "ÿbis$ÿÿ'(6)ÿÿ(lfdnr.KVERTRAG,"000000")
ÿ¡a%ÿ0ÿpprompt$ÿVertraege$(0)
a%ÿa%ÿ1
ÿ’ÿ¡
ÿÉÿ±
ÿÙ
ÿ¡a%ÿ0ÿp
GetVerab%ÿ0
ÿ^
ÿ¡a%ÿ1ÿp
ÿßÿ³
lok%ÿÿ1
ÿØlok%
	ÿ‰ÿñ"ZEINLIST",0,0,251,198,"Vertrag suchen...","MS Sans Serif",8
	ÿ|ÿñ"ZEINLIST",4,0,0,251,172,0,""
	ÿ|ÿñ"ZEINLIST",9,8,11,25,24,2
	ÿ|ÿñ"ZEINLIST",5,35,11,168,20,0,"Es wurden mehrere Vertr„ge mit gleicher oder „hnlicher Nummer gefunden."
	ÿ|ÿñ"ZEINLIST",5,35,31,205,20,0,"Bitte w„hlen Sie den von Ihnen gesuchten Vertrag aus. Mit 'Info' erhalten Sie weitere Angaben zum gew„hlten Vertrag."
	ÿ|ÿñ"ZEINLIST",5,35,58,198,10,0,"Vertrags-/Policennummer                       von          bis"
	ÿ|ÿñ"ZEINLIST",7,36,68,205,105,2ÿ128,2,Vertraege$,Auswahl$,prompt$
	ÿ|ÿñ"ZEINLIST",1,36,178,55,15,1,"&OK",1,1
	ÿ|ÿñ"ZEINLIST",1,96,178,55,15,0,"&Info",2,1
	ÿ|ÿñ"ZEINLIST",1,156,178,55,15,0,"&Abbrechen",0,0
	ÿñ"ZEINLIST",req%
	ÿ¾ÿñ"ZEINLIST"
	ÿÉÿæreq%
	ÿæ1
GetVerab%ÿÿ0(ÿ-(Auswahl$(0),6))
lok%ÿ0
	ÿæ0
GetVerab%ÿ0
lok%ÿ0
	ÿæ2
ÿƒVINFO(ÿ0(ÿ-(Auswahl$(0),6)))
prompt$ÿAuswahl$(0)
	ÿ’ÿÉ
ÿÙ
ÿ^
GetVerab%ÿÿ0(ÿ-(Vertraege$(0),6))
ÿ’ÿ¡
ÿ’ÿ¡
ÿ™"KVERTRAG"
ÿÉÿ¥cuvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿÊÿ£cindex$
ÿ£cindex$
ÿÊÿË"Bereit"
ÿßÿ³
ÿ™cfile$
 ÿ^
GetVerab%ÿ0
 ÿ’ÿ¡
 ÿ’ÿÿ
 
ÿÿGETKFZKe%(lfdnr%)
 ÿßÿe
 cfile$ÿÿ™
 codeku%ÿcodeku.kvertrag
 cuvt%ÿlfdnr.KVERTRAG
 ÿ™"KVERTRAG"
 cindex$ÿÿ£
 req%ÿ1
 VSNR$ÿeingab$
 ÿ¡req%ÿ0ÿVSNR$ÿ""ÿp
ÿ×Vertraege$(ÿA("KVERTRAG"))
ÿ×Auswahl$(1)
ÿ¡viab%ÿ0ÿp
ÿ£codeku.KVERTRAG
ÿÉÿ`
tVSNR$ÿVSNRPack$(VSNR$)
ÿÉÿ¥codeku%ÿ™"KVERTRAG"ÿ£codeku.KVERTRAG
a%ÿ0
ÿØcodeku.KVERTRAGÿcodeku%ÿÿOÿB("kvertrag")
ÿ¡VS_Beginn.KVERTRAGÿ
1ÿpvon$ÿ"__.__.__"ÿ^von$ÿÿ(VS_Beginn.KVERTRAG,"0d.mm.yy")
ÿ¡Kndigung.KVERTRAGÿ
1ÿpbis$ÿ"__.__.__"ÿ^bis$ÿÿ(Kndigung.KVERTRAG,"0d.mm.yy")
ÿ¡QuickKennz.kvertragÿtvsnr$ÿ"*"ÿp
	Vertraege$(a%)ÿÿK(Kennzeichen.KVERTRAG,10)ÿ"  "ÿFabrikat.kvertragÿ"        "ÿvon$ÿ" - "ÿbis$ÿÿ'(20)ÿÿ(lfdnr.KVERTRAG,"000000")
	ÿ¡a%ÿ0ÿpprompt$ÿVertraege$(0)
	a%ÿa%ÿ1
ÿ’ÿ¡
ÿÉÿ±
ÿÙ
ÿ^
ÿ£QuickKennz.KVERTRAG
ÿÉÿ`
tVSNR$ÿVSNRPack$(VSNR$)
ÿÉÿ¥tvsnr$ÿ"*"ÿ™"KVERTRAG"ÿ£Kennzeichen.KVERTRAG
a%ÿ0
ÿØQuickKennz.KVERTRAGÿtvsnr$ÿ"*"ÿÿOÿB("kvertrag")
ÿ¡VS_Beginn.KVERTRAGÿ
1ÿpvon$ÿ"__.__.__"ÿ^von$ÿÿ(VS_Beginn.KVERTRAG,"0d.mm.yy")
ÿ¡Kndigung.KVERTRAGÿ
1ÿpbis$ÿ"__.__.__"ÿ^bis$ÿÿ(Kndigung.KVERTRAG,"0d.mm.yy")
ÿ¡kennzeichen.kvertragÿtvsnr$ÿ"*"ÿp
	Vertraege$(a%)ÿÿK(Kennzeichen.KVERTRAG,10)ÿ"  "ÿFabrikat.kvertragÿ"        "ÿvon$ÿ" - "ÿbis$ÿÿ'(20)ÿÿ(lfdnr.KVERTRAG,"000000")
	ÿ¡a%ÿ0ÿpprompt$ÿVertraege$(0)
	a%ÿa%ÿ1
ÿ’ÿ¡
ÿÉÿ±
ÿÙ
ÿ’ÿ¡
ÿ¡a%ÿ0ÿp
GETKFZKe%ÿ0
ÿ^
ÿ¡a%ÿ1ÿp
ÿßÿ³
lok%ÿÿ1
ÿØlok%
	ÿ‰ÿñ"ZEINLIST",0,0,251,198,"Vertrag suchen...","MS Sans Serif",8
	ÿ|ÿñ"ZEINLIST",4,0,0,251,172,0,""
	ÿ|ÿñ"ZEINLIST",9,8,11,25,24,2
	ÿ|ÿñ"ZEINLIST",5,35,11,168,20,0,"Es wurden mehrere Vertr„ge mit gleichem oder „hnlicher Nummer gefunden."
	ÿ|ÿñ"ZEINLIST",5,35,31,205,20,0,"Bitte w„hlen Sie den von Ihnen gesuchten Vertrag aus. Mit 'Info' erhalten Sie weitere Angaben zum gew„hlten Vertrag."
	ÿ|ÿñ"ZEINLIST",5,35,58,198,10,0,"Kennzeichen/Fabrikat                       von          bis"
	ÿ|ÿñ"ZEINLIST",7,36,68,205,105,2ÿ128,2,Vertraege$,Auswahl$,prompt$
	ÿ|ÿñ"ZEINLIST",1,36,178,55,15,1,"&OK",1,1
	ÿ|ÿñ"ZEINLIST",1,96,178,55,15,0,"&Info",2,1
	ÿ|ÿñ"ZEINLIST",1,156,178,55,15,0,"&Abbrechen",0,0
	ÿñ"ZEINLIST",req%
	ÿ¾ÿñ"ZEINLIST"
	ÿÉÿæreq%
	ÿæ1
GETKFZKe%ÿÿ0(ÿ-(Auswahl$(0),6))
lok%ÿ0
	ÿæ0
GETKFZKe%ÿ0
lok%ÿ0
	ÿæ2
ÿƒVINFO(ÿ0(ÿ-(Auswahl$(0),6)))
prompt$ÿAuswahl$(0)
	ÿ’ÿÉ
ÿÙ
ÿ^
GETKFZKe%ÿÿ0(ÿ-(Vertraege$(0),6))
ÿ’ÿ¡
ÿ’ÿ¡
ÿ™"KVERTRAG"
ÿÉÿ¥cuvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿÊÿ£cindex$
ÿ£cindex$
ÿÊÿË"Bereit"
ÿßÿ³
ÿ™cfile$
 ÿ^
GETKFZKe%ÿ0
 ÿ’ÿ¡
 ÿ’ÿÿ
 

ÿÿGETKFZTyp%(lfdnr%)
 ÿßÿe
 cfile$ÿÿ™
 codeku%ÿcodeku.kvertrag
 cuvt%ÿlfdnr.KVERTRAG
 ÿ™"KVERTRAG"
 cindex$ÿÿ£
 req%ÿ1
 VSNR$ÿeingab$
 ÿ¡req%ÿ0ÿVSNR$ÿ""ÿp
ÿ×Vertraege$(ÿA("KVERTRAG"))
ÿ×Auswahl$(1)
ÿ£CodeKU.KVERTRAG
ÿÉÿ`
tVSNR$ÿVSNRPack$(VSNR$)
ÿ¡viab%ÿ0ÿpÿÉÿ¥codeku%ÿ™"KVERTRAG"ÿ£codeku.KVERTRAG
a%ÿ0
ÿØcodeku.KVERTRAGÿcodeku%ÿÿOÿB("kvertrag")ÿviab%ÿ0
ÿ¡VS_Beginn.KVERTRAGÿ
1ÿpvon$ÿ"__.__.__"ÿ^von$ÿÿ(VS_Beginn.KVERTRAG,"0d.mm.yy")
ÿ¡Kndigung.KVERTRAGÿ
1ÿpbis$ÿ"__.__.__"ÿ^bis$ÿÿ(Kndigung.KVERTRAG,"0d.mm.yy")
ÿ¡Fabrikat.kvertragÿtvsnr$ÿ"*"ÿp
Vertraege$(a%)ÿÿK(Kennzeichen.KVERTRAG,10)ÿ"  "ÿFabrikat.kvertragÿ"        "ÿvon$ÿ" - "ÿbis$ÿÿ'(20)ÿÿ(lfdnr.KVERTRAG,"000000")
ÿ¡a%ÿ0ÿpprompt$ÿVertraege$(0)
a%ÿa%ÿ1
ÿ’ÿ¡
ÿÉÿ±
ÿÙ
ÿØÿOÿB("kvertrag")ÿviab%ÿ0
ÿ¡VS_Beginn.KVERTRAGÿ
1ÿpvon$ÿ"__.__.__"ÿ^von$ÿÿ(VS_Beginn.KVERTRAG,"0d.mm.yy")
ÿ¡Kndigung.KVERTRAGÿ
1ÿpbis$ÿ"__.__.__"ÿ^bis$ÿÿ(Kndigung.KVERTRAG,"0d.mm.yy")
ÿ¡Fabrikat.kvertragÿtvsnr$ÿ"*"ÿp
Vertraege$(a%)ÿÿK(Kennzeichen.KVERTRAG,10)ÿ"  "ÿFabrikat.kvertragÿ"        "ÿvon$ÿ" - "ÿbis$ÿÿ'(20)ÿÿ(lfdnr.KVERTRAG,"000000")
ÿ¡a%ÿ0ÿpprompt$ÿVertraege$(0)
a%ÿa%ÿ1
ÿ’ÿ¡
ÿÉÿ±
ÿÙ
ÿ¡a%ÿ0ÿp
GETKFZTyp%ÿ0
ÿ^
ÿ¡a%ÿ1ÿp
ÿßÿ³
lok%ÿÿ1
ÿØlok%
	ÿ‰ÿñ"ZEINLIST",0,0,251,198,"Vertrag suchen...","MS Sans Serif",8
	ÿ|ÿñ"ZEINLIST",4,0,0,251,172,0,""
	ÿ|ÿñ"ZEINLIST",9,8,11,25,24,2
	ÿ|ÿñ"ZEINLIST",5,35,11,168,20,0,"Es wurden mehrere Vertr„ge mit gleichem oder „hnlichen Namen gefunden."
	ÿ|ÿñ"ZEINLIST",5,35,31,205,20,0,"Bitte w„hlen Sie den von Ihnen gesuchten Vertrag aus. Mit 'Info' erhalten Sie weitere Angaben zum gew„hlten Vertrag."
	ÿ|ÿñ"ZEINLIST",5,35,58,198,10,0,"Kennzeichen/Fabrikat                       von          bis"
	ÿ|ÿñ"ZEINLIST",7,36,68,205,105,2ÿ128,2,Vertraege$,Auswahl$,prompt$
	ÿ|ÿñ"ZEINLIST",1,36,178,55,15,1,"&OK",1,1
	ÿ|ÿñ"ZEINLIST",1,96,178,55,15,0,"&Info",2,1
	ÿ|ÿñ"ZEINLIST",1,156,178,55,15,0,"&Abbrechen",0,0
	ÿñ"ZEINLIST",req%
	ÿ¾ÿñ"ZEINLIST"
	ÿÉÿæreq%
	ÿæ1
GETKFZTyp%ÿÿ0(ÿ-(Auswahl$(0),6))
lok%ÿ0
	ÿæ0
GETKFZTyp%ÿ0
lok%ÿ0
	ÿæ2
ÿƒVINFO(ÿ0(ÿ-(Auswahl$(0),6)))
prompt$ÿAuswahl$(0)
	ÿ’ÿÉ
ÿÙ
ÿ^
GETKFZTyp%ÿÿ0(ÿ-(Vertraege$(0),6))
ÿ’ÿ¡
ÿ’ÿ¡
ÿ™"KVERTRAG"
ÿÉÿ¥cuvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿÊÿ£cindex$
ÿ£cindex$
ÿÊÿË"Bereit"
ÿßÿ³
ÿ™cfile$
 ÿ^
GETKFZTyp%ÿ0
 ÿ’ÿ¡
 ÿ’ÿÿ
 



 ' Fremdvertr„ge
 ' =======================================================================
 
ÿÿFRVERTR()
 ÿ¡disabled%("FRVERTR")ÿpÿ’ÿÿ
 ÿ¡MNdisabled%("DATALOCK")ÿp
ÿƒFehler("Der Zugriff auf diese Funktion ist gesperrt!","Bitte rufen Sie die Vertragsverwaltung ber die Adreáverwaltung auf.")
ÿ’ÿÿ
 ÿ’ÿ¡
 ÿßÿe
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(3,"vorgang"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿÊÿË"Suche Fremdvertr„ge..."
 ÿ™"kvertrag"
 ÿ½ -- Fremdvertr„ge vorhanden
 ÿ¡ÿOÿJ("j",Fremdvertrag.KVERTRAG)ÿp
ÿÂ"Keine Fremdvertr„ge gefunden!","",0
_formend%ÿ1
 ÿ^
ÿÊÿË"Positionierung auf ersten Fremdvertrag..."
ÿÉÿĞFremdvertrag.kvertragÿ"j"
ÿ£Fremdvertrag.KVERTRAG
ÿÉÿœÿ`
_formend%ÿ0
 ÿ’ÿ¡
 ÿÊÿË"Bereit"
 ÿØ_formend%ÿ0
ÿ¡ÿ>(ÿœ)ÿ"IVERTRAG"ÿp
ÿ´ÿœ"IVERTRAG"
ÿÊÿœÿeoverv$
ÿƒMNFRVERTR()
ÿœ
ÿÊÿË"Fremdvertr„ge"
ÿ’ÿ¡

ÿƒVIUpdate()
ÿƒClearKBDBuffer()
ÿßÿ³
ÿÏÿßÿÿ¥ÿÿ¬
ÿk$
ÿÉÿæÿ.(k$)
ÿæCrsLeft%,PgUp%
ÿƒPSelectPrev()
ÿæCrsRight%,PgDn%
ÿƒPSelectNext()
ÿ’ÿÉ
 ÿÙ
 _formend%ÿ0
 ÿÉÿĞÿ™"kvertrag"
 ÿÊÿË"Bereit"
 ÿßÿ³
 ÿ’ÿÿ
 
 
 '      **************************************
 '      ** Routinen fr Formular "ADRESSEN" **  
 '      **************************************
 
ÿÿADRsub3()
 ÿƒKVERTRAG()
 ÿ’ÿÿ


 ' Vertragsbersicht fr aktuellen Kunden drucken Andi 21.9.95
 ' =======================================================================
 
ÿÿVLIST1()
 cuku%ÿCodeKU.ADRESSEN
 _Index$ÿÿ£
 ÿÉÿ¥CodeKU.ADRESSENÿ™"KVERTRAG"ÿ£CodeKU.KVERTRAG
 ÿ¡ÿC("KVERTRAG")ÿp
ÿ½ CALL LIST2(CodeKU.ADRESSEN)
ÿƒVertrUniRep(cuku%,0,0,0,4,0,0,0,1)
 ÿ^
ÿƒFehler("Es wurden noch keine Vertr„ge fr den aktuellen Kunden erfaát!","")
 ÿ’ÿ¡
 ÿ™"ADRESSEN"
 ÿÉÿ¥cuku%ÿ™"ADRESSEN"ÿ£CodeKU.ADRESSEN
 ÿÊÿ£nachname.adressen
 ÿ£nachname.adressen
 ÿ’ÿÿ


 
 ' Provisionsbersicht fr aktuellen Kunden
 ' =======================================================================
 
ÿÿVLIST3()
 cfile$ÿÿ™
 ÿ¡disabled%("KONTOUEBERSICHT")ÿpÿ’ÿÿ
 ÿƒDFile(3,"buchung"ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿ½ SET MENU OFF 
 ku%ÿCodeKU.ADRESSEN
 ÿ½ SELECT KEY ma% FILE "maadr" INDEX codema.maadr
 ÿ™"buchung"
 
 von$ÿcdat$
 bis$ÿcdat$
 allProv$ÿ"n"
 ÿ‰ÿñ"Konto1",0,0,221,165,title$,"MS Sans Serif",8
 ÿ|ÿñ"Konto1",9,6,7,24,22,2
 ÿ|ÿñ"Konto1",5,34,8,170,9,0,"Provisionsliste:"
 ÿ|ÿñ"Konto1",4,34,14,176,5,0,""
 ÿ|ÿñ"Konto1",5,34,22,175,16,0,"Bitte geben Sie ein, fr welchen Buchungszeitraum Sie eine šbersicht wnschen."
 ÿ|ÿñ"Konto1",5,34,40,175,32,0,"Wenn Sie keine Angaben zum Buchungszeitraum eintragen, werden alle Provisionen bzw. die Provisionen des vorgegebenen Zeitraumes aufgelistet."
 ÿ|ÿñ"Konto1",5,34,80,12,8,0,"von"
 ÿ|ÿñ"Konto1",6,53,79,45,11,0,0,von$,8
 ÿ|ÿñ"Konto1",5,102,80,12,8,0,"bis"
 ÿ|ÿñ"Konto1",6,116,79,45,11,0,0,bis$,8
 ÿ|ÿñ"Konto1",2,34,97,148,11,0,"alle berechneten Provisionen einbeziehen","j","n",allProv$
 ÿ|ÿñ"Konto1",5,44,108,167,25,0,"(es werden auch die Provisionen angezeigt, die wegen fehlender Zahlungsbeitr„ge in der Mahnlist sind)"
 ÿ|ÿñ"Konto1",1,50,144,55,15,1,"&Weiter",1,1
 ÿ|ÿñ"Konto1",1,110,144,55,15,0,"&Abbruch",0,0
 ÿñ"Konto1",req%
 ÿ¾ÿñ"Konto1"
 ÿßÿ³
 ÿ¡req%ÿ1ÿp
ÿßÿe
ÿ¡von$ÿ""ÿpvondat$ÿ"1.1.80"ÿ^vondat$ÿvon$
ÿ¡bis$ÿ""ÿpbisdat$ÿÿ(ÿQ)ÿ^bisdat$ÿbis$
ÿ¡RepType%ÿ0ÿp
ÿÁÿs"LISTPROV"
ÿÁÿ³Betrag.BUCHUNGÿU"SSumAgentur%",SR.BUCHUNGÿU"SSumStorno%",BetnGezahlt%ÿU"SSumNBez%",BetnDiff%ÿU"SGesSum%"
ÿ}ÿÁ
ÿÊÿÁÿí"F_REPORT"
ÿ¶ÿÁÿí
ÿ’ÿÁ
Header$ÿ"Kontobersicht "ÿnachname.maadr
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (bis "ÿÿ(ÿQ,"dd.mm.yy")ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (ab "ÿvon$ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (vom "ÿvon$ÿ" bis "ÿbis$ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (Gesamtbersicht)"
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
ÿCodeMA.MAADR,Betrag.BUCHUNGÿU"SumAgentur%",SR.BUCHUNGÿU"SumStorno%",BetnGezahlt%ÿU"SumNBez%",BetnDiff%ÿU"GesSum%"
ÿ€ÿCodeMA.MAADR
ÿÊÿÁÿí"H_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿCodeMA.MAADR
ÿÊÿÁÿí"F_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ‘ÿÁ
ÿ’ÿ
ÿDatum.BUCHUNG
ÿ€ÿDatum.BUCHUNG
ÿÊÿÁÿí"H_Datum.BUCH003"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿ^
ÿÁÿs"LISTPRO2"
ÿÁÿ³Volumen.BUCHUNGÿU"SSumVol%",Betrag.BUCHUNGÿU"SSumAgentur%",SR.BUCHUNGÿU"SSumStorno%",BetnGezahlt%ÿU"SSumNBez%",BetnDiff%ÿU"SGesSum%"
ÿ}ÿÁ
ÿÊÿÁÿí"F_REPORT"
ÿ¶ÿÁÿí
ÿ’ÿÁ
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
ÿCodeMA.MAADR,Betrag.BUCHUNGÿU"SumAgentur%",SR.BUCHUNGÿU"SumStorno%",Volumen.BUCHUNGÿU"SumVol%",BetnGezahlt%ÿU"SumNBez%",BetnDiff%ÿU"GesSum%"
ÿ€ÿCodeMA.MAADR
ÿÊÿÁÿí"H_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿCodeMA.MAADR
ÿÊÿÁÿí"F_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ‘ÿÁ
ÿ’ÿ
ÿDatum.BUCHUNG
ÿ€ÿDatum.BUCHUNG
ÿÊÿÁÿí"H_Datum.BUCH003"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿ’ÿ¡
ÿÊÿiÿe
ÿÊÿiÿáÿe
vondat%ÿÿ1(vondat$)
bisdat%ÿÿ1(bisdat$)
ÿ³ÿ_ÿwErrVLIST3
ÿ¡allProv$ÿ"j"ÿp
ÿÉ;
ÿĞCodeMA.BUCHUNGÿCodeMA.MAADRÿCodeKU.BUCHUNGÿku%ÿDatum.BUCHUNGÿÿ1(vondat$)ÿDatum.BUCHUNGÿ	ÿ1(bisdat$)
ÿµÿÁDatum.BUCHUNG
ÿqÿ~
ÿ^
ÿÉ;
ÿĞCodeMA.BUCHUNGÿCodeMA.MAADRÿCodeKU.BUCHUNGÿku%ÿDatum.BUCHUNGÿÿ1(vondat$)ÿDatum.BUCHUNGÿ	ÿ1(bisdat$)ÿmahnung.buchungÿ"j"
ÿµÿÁDatum.BUCHUNG
ÿqÿ~
ÿ’ÿ¡
ErrVLIST3: 
ÿ³ÿ_ÿwErrorHandler
 ÿ’ÿ¡
 ÿßÿ³
 ÿ™cfile$
 ÿ’ÿÿ


 ' Provisionsbersicht fr aktuellen Vertrag
 ' =======================================================================
ÿÿVLIST4()
 cfile$ÿÿ™
 ÿ¡disabled%("KONTOUEBERSICHT")ÿpÿ’ÿÿ
 ÿƒDFile(3,"buchung"ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿ½ SET MENU OFF 
 cv%ÿlfdnr.KVERTRAG
 ÿ™"buchung"

 von$ÿcdat$
 bis$ÿcdat$
 allProv$ÿ"n"
 ÿ‰ÿñ"Konto1",0,0,221,165,title$,"MS Sans Serif",8
 ÿ|ÿñ"Konto1",9,6,7,24,22,2
 ÿ|ÿñ"Konto1",5,34,8,170,9,0,"Provisionsliste:"
 ÿ|ÿñ"Konto1",4,34,14,176,5,0,""
 ÿ|ÿñ"Konto1",5,34,22,175,16,0,"Bitte geben Sie ein, fr welchen Buchungszeitraum Sie eine šbersicht wnschen."
 ÿ|ÿñ"Konto1",5,34,40,175,32,0,"Wenn Sie keine Angaben zum Buchungszeitraum eintragen, werden alle Provisionen bzw. die Provisionen des vorgegebenen Zeitraumes aufgelistet."
 ÿ|ÿñ"Konto1",5,34,80,12,8,0,"von"
 ÿ|ÿñ"Konto1",6,53,79,45,11,0,0,von$,8
 ÿ|ÿñ"Konto1",5,102,80,12,8,0,"bis"
 ÿ|ÿñ"Konto1",6,116,79,45,11,0,0,bis$,8
 ÿ|ÿñ"Konto1",2,34,97,148,11,0,"alle berechneten Provisionen einbeziehen","j","n",allProv$
 ÿ|ÿñ"Konto1",5,44,108,167,25,0,"(es werden auch die Provisionen angezeigt, die wegen fehlender Zahlungsbeitr„ge in der Mahnlist sind)"
 ÿ|ÿñ"Konto1",1,50,144,55,15,1,"&Weiter",1,1
 ÿ|ÿñ"Konto1",1,110,144,55,15,0,"&Abbruch",0,0
 ÿñ"Konto1",req%
 ÿ¾ÿñ"Konto1"
 ÿßÿ³
 ÿ¡req%ÿ1ÿp
ÿßÿe
ÿ¡von$ÿ""ÿpvondat$ÿ"1.1.80"ÿ^vondat$ÿvon$
ÿ¡bis$ÿ""ÿpbisdat$ÿÿ(ÿQ)ÿ^bisdat$ÿbis$
ÿ¡RepType%ÿ0ÿp
ÿÁÿs"LISTPROV"
ÿÁÿ³Betrag.BUCHUNGÿU"SSumAgentur%",SR.BUCHUNGÿU"SSumStorno%",BetnGezahlt%ÿU"SSumNBez%",BetnDiff%ÿU"SGesSum%"
ÿ}ÿÁ
ÿÊÿÁÿí"F_REPORT"
ÿ¶ÿÁÿí
ÿ’ÿÁ
Header$ÿ"Kontobersicht "ÿnachname.maadr
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (bis "ÿÿ(ÿQ,"dd.mm.yy")ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (ab "ÿvon$ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (vom "ÿvon$ÿ" bis "ÿbis$ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (Gesamtbersicht)"
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
ÿCodeMA.MAADR,Betrag.BUCHUNGÿU"SumAgentur%",SR.BUCHUNGÿU"SumStorno%",BetnGezahlt%ÿU"SumNBez%",BetnDiff%ÿU"GesSum%"
ÿ€ÿCodeMA.MAADR
ÿÊÿÁÿí"H_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿCodeMA.MAADR
ÿÊÿÁÿí"F_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ‘ÿÁ
ÿ’ÿ
ÿDatum.BUCHUNG
ÿ€ÿDatum.BUCHUNG
ÿÊÿÁÿí"H_Datum.BUCH003"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿ^
ÿÁÿs"LISTPRO2"
ÿÁÿ³Volumen.BUCHUNGÿU"SSumVol%",Betrag.BUCHUNGÿU"SSumAgentur%",SR.BUCHUNGÿU"SSumStorno%",BetnGezahlt%ÿU"SSumNBez%",BetnDiff%ÿU"SGesSum%"
ÿ}ÿÁ
ÿÊÿÁÿí"F_REPORT"
ÿ¶ÿÁÿí
ÿ’ÿÁ
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
ÿCodeMA.MAADR,Betrag.BUCHUNGÿU"SumAgentur%",SR.BUCHUNGÿU"SumStorno%",Volumen.BUCHUNGÿU"SumVol%",BetnGezahlt%ÿU"SumNBez%",BetnDiff%ÿU"GesSum%"
ÿ€ÿCodeMA.MAADR
ÿÊÿÁÿí"H_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿCodeMA.MAADR
ÿÊÿÁÿí"F_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ‘ÿÁ
ÿ’ÿ
ÿDatum.BUCHUNG
ÿ€ÿDatum.BUCHUNG
ÿÊÿÁÿí"H_Datum.BUCH003"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿ’ÿ¡
ÿÊÿiÿe
ÿÊÿiÿáÿe
vondat%ÿÿ1(vondat$)
bisdat%ÿÿ1(bisdat$)
ÿ³ÿ_ÿwErrVLIST4 
ÿ¡allProv$ÿ"j"ÿp
ÿÉ;
ÿĞCodeMA.BUCHUNGÿCodeMA.MAADRÿCodeVT.BUCHUNGÿcv%ÿDatum.BUCHUNGÿÿ1(vondat$)ÿDatum.BUCHUNGÿ	ÿ1(bisdat$)
ÿµÿÁDatum.BUCHUNG
ÿqÿ~
ÿ^
ÿÉ;
ÿĞCodeMA.BUCHUNGÿCodeMA.MAADRÿCodeVT.BUCHUNGÿcv%ÿDatum.BUCHUNGÿÿ1(vondat$)ÿDatum.BUCHUNGÿ	ÿ1(bisdat$)ÿmahnung.buchungÿ"j"
ÿµÿÁDatum.BUCHUNG
ÿqÿ~
ÿ’ÿ¡
ErrVLIST4: 
ÿ³ÿ_ÿwErrorHandler
 ÿ’ÿ¡
 ÿßÿ³
 ÿ™cfile$
 ÿ’ÿÿ


 '      ************************************
 '      ** Routinen fr Formular KVERTRAG **
 '      ************************************

ÿÿKVERTRAG()
 ÿ¡disabled%("KVERTRAG")ÿpÿ’ÿÿ
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(3,"vorgang"ÿ_fpw$)
 ÿƒDFile(3,"vkond"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 knr%ÿcodeku.adressen
 ÿ¡(ÿ("adressen")ÿÿ°("adressen"))ÿpÿƒFStore("adressen")
 ÿ™"KVERTRAG"
 _continue%ÿ1
 ÿ½ Andi 26.10.95
 _neu$ÿ"n"
 ÿÉÿ¥knr%ÿ™"KVERTRAG"ÿ£CodeKU.KVERTRAG
 ÿ¡ÿOÿC("KVERTRAG")ÿp
_continue%ÿ0
ÿÂ"Keine Vertr„ge fr "ÿnachname.adressenÿ" vorhanden!","Vertrag erfassen?",130,req%
ÿ¡req%ÿ1ÿp
_continue%ÿ1
vfound%ÿ0
ÿƒVERTRNeu()
_neu$ÿ"j"
ÿ’ÿ¡
 ÿ^
vfound%ÿÿ1
 ÿ’ÿ¡
 ÿ¡_continue%ÿ1ÿp
ÿ½ von Andi am 18.10.94 11.15
ÿ½ cuvt% = 0
_formend%ÿ0
ÿÊÿË"Vertragsverwaltung"
ÿ½ Andi 26.10.95
ÿ¡_neu$ÿ"n"ÿp
indab$ÿÿ£
aver%ÿVERTRSuch%(CodeKU.KVERTRAG,cuvt%)
ÿ¡aver%ÿ0ÿpÿÉÿœÿ¥aver%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿÊÿ£indab$
ÿ£indab$
ÿ¡aver%ÿ0ÿpÿ’ÿÿ
ÿ’ÿ¡
ÿØ_formend%ÿ0
ÿ½ DEBUG ASK 
vform%ÿ0
ÿÉÿ¥CodeVA.KVERTRAGÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
ÿ¡ÿC("SPARTEN")ÿpvform%ÿVertragsart.SPARTEN
VForm$ÿ"VERTRAG"
ÿ¡vform%ÿ0ÿpVForm$ÿVForm$ÿÿH(ÿ(vform%,"99"))
ÿ¡ÿ>(ÿœ)ÿÿ>(VForm$)ÿp
cuvt%ÿlfdnr.KVERTRAG
ÿÊÿŸtitle$ÿ" - Vertr„ge von: "ÿnachname.adressen
ÿ¡ÿJ(VForm$ÿ".SBV")ÿp
	ÿ¡ÿ>(ÿœ)ÿÿ>(VForm$)ÿpÿ´ÿœVForm$
ÿ^
	ÿ¡ÿ>(ÿœ)ÿ"VERTRAG"ÿpÿ´ÿœ"VERTRAG"
	vform%ÿ0
ÿ’ÿ¡
ÿ½ andi 26.10.95
ÿ¡_neu$ÿ"n"ÿaver%ÿ0ÿp
	cuvt%ÿaver%
	ÿÉÿœÿ¥cuvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
	aver%ÿ0
	_neu$ÿ""
ÿ’ÿ¡
ÿƒVERTRIntro()
ÿƒMNVERTR()
ÿ¬ÿ³
ÿ’ÿ¡
ÿßÿ³
ÿ¡vfound%ÿ0ÿpVERTRsub%ÿ0
vfound%ÿÿ1
ÿƒVERTRUpdate()
ÿƒClearKBDBuffer()
ÿ¡VERTRsub%ÿ99ÿpÿÏÿßÿÿ¥ÿÿ¬
 
ÿ½ ** Tastencodes
ÿk$
ÿÉÿæÿ.(k$)
ÿæCrsLeft%,PgUp%
ÿƒVERTRPrev()
ÿæCrsRight%,PgDn%
ÿƒVERTRNext()
ÿ’ÿÉ
 
ÿÉÿæVERTRsub%
ÿæ1
cuvt%ÿlfdnr.kvertrag
ÿƒVERTRSuchen1()
ÿæ3
cuvt%ÿlfdnr.KVERTRAG
ÿƒVorgang()
ÿæ99
ÿ¡ÿOdisabled%("VERTRBEARB")ÿp
	ÿßÿ³
	ÿÉÿæÿí
	ÿæ1
ÿÉÿævform%
ÿæ0
ÿ”VS_Nr.KVERTRAG,0
ÿæÿ^
ÿ”VS_Nr.KVERTRAG,0
ÿ’ÿÉ
	ÿæ2
ÿÉÿævform%
ÿæ2
ÿ”Vollinvalid.KVERTRAG,0
ÿæ5
ÿ”VS_Nr.KVERTRAG,0
ÿæ6,7,8
ÿ”Risiko.KVERTRAG,0
ÿæÿ^
ÿ”BUZ_Endalter.KVERTRAG,0
ÿ’ÿÉ
	ÿ’ÿÉ
ÿ’ÿ¡
ÿ’ÿÉ
cuvt%ÿlfdnr.KVERTRAG
ÿÙ
ÿ¡FileChanged%("KVERTRAG")ÿ1ÿpÿƒFStore("KVERTRAG")
ÿ’ÿ¡
 ÿ’ÿ¡
 cuivt%ÿlfdnr.KVERTRAG
 cuvt%ÿ0
 _formend%ÿ0
 ÿ’ÿÿ
 

 
 ' KVERTRAG Intro
 ' =======================================================================

ÿÿVERTRIntro()
 ÿ¡cuvt%ÿ0ÿp
ÿÉÿœÿ¥cuvt%ÿ£lfdnr.KVERTRAG
 ÿ^
ÿÉÿœÿ¥knr%ÿ™"KVERTRAG"ÿ£codeku.KVERTRAG
ÿ¡CodeKU.KVERTRAGÿknr%ÿp
ÿƒVERTRNeu()
ÿ^
ÿÉÿœÿ¥knr%ÿ™"KVERTRAG"ÿ£codeku.KVERTRAG
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿÊÿ£CodeKU.KVERTRAG
 cuvt%ÿlfdnr.KVERTRAG
 ÿ£codeku.KVERTRAG
 ÿœ
 ÿ’ÿÿ


 ' KVERTRAG Neu
 ' =======================================================================
 ' 21.09.95/FA - Korrektur fr Neuerfassungen
 
ÿÿVERTRNeu()
 ÿ¡disabled%("VERTRNeu")ÿpÿ’ÿÿ
 ÿßÿe
 cfile$ÿÿ™
 ÿ×Sparten$(ÿA("SPARTEN")ÿ1)
 Sparten$(0)ÿ"<keine Zuordnung>"ÿÿ'(80)ÿ"000000"
 cfile$ÿÿ™
 ÿ™"SPARTEN"
 ÿ£CodeVA.SPARTEN
 ÿÉÿ`
 a%ÿ1
 ÿØÿOÿB("SPARTEN")
Sparten$(a%)ÿSparte.SPARTENÿÿ'(80)ÿÿ(CodeVA.SPARTEN,"000000")
a%ÿa%ÿ1
ÿÉÿ±
 ÿÙ
 Auswahl$ÿSparten$(0)
 ÿ‰ÿñ"VTNEU",0,0,185,77,"Vertrag neu","MS Sans Serif",8
 ÿ|ÿñ"VTNEU",4,0,0,185,52,0,""
 ÿ|ÿñ"VTNEU",9,4,8,24,24,2
 ÿ|ÿñ"VTNEU",5,44,8,133,19,0,"Bitte w„hlen Sie Sparte, fr die Sie den Vertrag erfassen wollen:"
 ÿ|ÿñ"VTNEU",8,44,32,134,49,259,2,Auswahl$,Sparten$
 ÿ|ÿñ"VTNEU",1,35,57,55,15,1,"&OK",1,1
 ÿ|ÿñ"VTNEU",1,92,57,55,15,0,"&Abbrechen",0,1
 ÿñ"VTNEU",req%
 ÿ¾ÿñ"VTNEU"
 ÿ¡req%ÿ1ÿp
nsp%ÿÿ0(ÿ-(Auswahl$,6))
va%ÿ0
ÿÉÿ¥nsp%ÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
ÿ¡ÿC("SPARTEN")ÿpva%ÿVertragsart.SPARTEN
VForm$ÿ"VERTRAG"
ÿ¡va%ÿ0ÿpVForm$ÿVForm$ÿÿH(ÿ(va%,"99"))
ÿ¡ÿ>(ÿœ)ÿÿ>(VForm$)ÿp
titleab$ÿ" - Vertr„ge von: "ÿNachname.ADRESSENÿ", "
ÿ¡vorname.adressenÿ""ÿptitleab$ÿtitleab$ÿÿ+(Vorname.ADRESSEN,1)ÿ"."
ÿÊÿŸtitle$ÿtitleab$
ÿ¡ÿJ(VForm$ÿ".SBV")ÿp
ÿ´ÿœVForm$
ÿ^
ÿ´ÿœ"VERTRAG"
ÿ’ÿ¡
ÿ’ÿ¡
ÿ™"KVERTRAG"
ÿÿœ
ÿÊÿË"Datensatz neu angelegt..."
lfdnr%ÿÿI("KVERTRAG",1)
lfdnr.KVERTRAGÿlfdnr%
ÿÉÿ¥knr%ÿ™"adressen"ÿ£codeku.adressen
codeku.KVERTRAGÿknr%
letzteBearb ÿÿQ
CodeMV.KVERTRAGÿ0
codeGE.KVERTRAGÿ0
codeMA.KVERTRAGÿ0
codeVA.KVERTRAGÿÿ0(ÿ-(Auswahl$,6))
letzteBearb.KVERTRAGÿÿQ
Zahlart.KVERTRAGÿ1
ZW.KVERTRAGÿ12
cuvt%ÿ0
VERTRSub%ÿ99
ÿ½ andi 2.11.95
ÿƒFStore("KVERTRAG")
ÿÉÿ¥lfdnr%ÿáÿ™"KVERTRAG"ÿ£LFDNR.KVERTRAG
ÿƒVERTRUpdate()
 ÿ’ÿ¡
 ÿœ
 ÿ™cfile$
 ÿßÿ³
 ÿ’ÿÿ
 


 ' KVERTRAG Maskenupdate
 ' =======================================================================
 
ÿÿVERTRUpdate()
 ÿÉÿ¥CodeMA.kvertragÿ™"maadr"ÿ£CodeMA.maadr
 ÿ¡ÿC("MAADR")ÿpmaadr$ÿNachname.maadrÿ", "ÿÿ+(Vorname.MAADR,1)ÿ"."ÿ^maadr$ÿ"<keine Zuordnung>"
 ÿÉÿ¥CodeVA.kvertragÿ™"sparten"ÿ£CodeVA.sparten
 ÿ¡ÿC("SPARTEN")ÿpsparte$ÿSparte.spartenÿ^sparte$ÿ"<keine Zuordnung>"
 ÿÉÿ¥CodeGE.kvertragÿ™"GEADR"ÿ£CodeGE.geadr
 ÿ¡ÿC("GEADR")ÿpgeadr$ÿGesellschaft.geadrÿ^geadr$ÿ"<keine Zuordnung>"
 ÿ¡ProviAb.KVERTRAGÿ0ÿFremdvertrag.KVERTRAGÿ"j"ÿAltvertrag.KVERTRAGÿ"j"ÿp
provis$ÿ"S&tatus"
 ÿ^
provis$ÿ"&Abrechnung"
 ÿ’ÿ¡
 ÿ¡ProviAb.KVERTRAGÿ0ÿp
ÿÊÿœÿeFremdvertrag
ÿÊÿœÿeAltvertrag
 ÿ^
ÿÊÿœÿ³Fremdvertrag
ÿÊÿœÿ³Altvertrag
 ÿ’ÿ¡
 ÿ¡ÿJ(lfdnr.KVERTRAG,CodeVT.VORGANG)ÿpschaeden$ÿ"Nachbea&rb. ®"ÿ^schaeden$ÿ"Nachbea&rb."
 ÿ½ -- Status fr VORGANG.SBF in Statuszeile anzeigen --
 NBSumme%ÿ0
 NBunerledig%ÿ0
 cfile$ÿÿ™
 ÿ™"VORGANG"
 ÿ£CodeVT.VORGANG
 ÿÉÿ`
 ÿÉÿ¥lfdnr.KVERTRAGÿ™"VORGANG"ÿ£CodeVT.VORGANG
 ÿØCodeVT.VORGANGÿlfdnr.KVERTRAGÿÿOÿB("VORGANG")
NBSumme%ÿNBSumme%ÿ1
ÿ¡erledigt.VORGANGÿ"j"ÿpNBunerledigt%ÿNBunerledigt%ÿ1
ÿÉÿ±ÿ™"VORGANG"ÿ£CodeVT.VORGANG
 ÿÙ
 smsg$ÿ"Vorg„nge in Nachbearbeitung: "ÿÿH(ÿ(NBSumme%,"999999"))
 ÿ¡NBunerledigt%ÿ0ÿp
smsg$ÿsmsg$ÿ" (davon "ÿÿH(ÿ(NBSumme%,"999999"))ÿ" unerledigt)"
 ÿ’ÿ¡
 ÿÊÿËsmsg$
 ÿ™cfile$
 ÿ¡CodeKO.KVERTRAGÿ0ÿp
ÿÊÿœÿ³kond$
 ÿ^
ÿÊÿœÿekond$
 ÿ’ÿ¡
 Zahlweise$ÿZW2Str$(ZW.KVERTRAG)
 Zahlart$ÿZahlart2Str$(Zahlart.KVERTRAG)
 ÿ¡ÿOMNdisabled%("VERTRDEAKTIVIEREN")ÿProviAb.KVERTRAGÿ0ÿpÿ¬3,3,1ÿ^ÿ¬3,3,0
 ÿ¡ÿOMNdisabled%("VERTRSTORNO")ÿProviAb.KVERTRAGÿ0ÿpÿ¬3,4,1ÿ^ÿ¬3,4,0
 ÿ™"KVERTRAG"
 ÿ½ SET INDEX CodeKU.KVERTRAG
 ÿ½ INDEX CodeKU.KVERTRAG
 cuvt%ÿlfdnr.KVERTRAG
 ÿƒVERTRSync()
 ÿœ
 ÿ’ÿÿ

ÿÿKZW()
 ÿ™"KVERTRAG"
 cvt%ÿlfdnr.KVERTRAG
 ÿ¡ÿ("KVERTRAG")ÿÿ°("KVERTRAG")ÿpÿƒFStore("KVERTRAG")
 ÿÉÿ¥cvt%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿ¡ZW.KVERTRAGÿ12ÿp
ZW.KVERTRAGÿ4
 ÿ^
ÿ¡ZW.KVERTRAGÿ4ÿp
ZW.KVERTRAGÿ2
ÿ^
ÿ¡ZW.KVERTRAGÿ2ÿp
ZW.KVERTRAGÿ1
ÿ^
ÿ¡ZW.KVERTRAGÿ1ÿp
	ZW.KVERTRAGÿ0
ÿ^
	ÿ¡ZW.KVERTRAGÿ0ÿp
ZW.KVERTRAGÿ12
	ÿ^
ÿ½ -- Nullwerte korrigieren
ZW.KVERTRAGÿ12
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿƒQuickStore("KVERTRAG")
 ÿÉÿœÿ¥cvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿ’ÿÿ

ÿÿKZA()
 ÿ™"KVERTRAG"
 cvt%ÿlfdnr.KVERTRAG
 ÿ¡ÿ("KVERTRAG")ÿÿ°("KVERTRAG")ÿpÿƒFStore("KVERTRAG")
 ÿÉÿ¥cvt%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿ¡Zahlart.KVERTRAGÿ1ÿp
Zahlart.KVERTRAGÿ2
 ÿ^
ÿ¡Zahlart.KVERTRAGÿ2ÿp
Zahlart.KVERTRAGÿ3
ÿ^
ÿ¡Zahlart.KVERTRAGÿ3ÿp
Zahlart.KVERTRAGÿ4
ÿ^
ÿ¡Zahlart.KVERTRAGÿ4ÿp
	Zahlart.KVERTRAGÿ1
ÿ^
	ÿ½ -- Null-Werte korrigieren
	Zahlart.KVERTRAGÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿƒQuickStore("KVERTRAG")
 ÿÉÿœÿ¥cvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿ’ÿÿ



 ' KVERTRAG Kopieren
 ' =======================================================================
 
ÿÿVERTRKopieren()
 ÿ¡disabled%("VERTRNeu")ÿpÿ’ÿÿ
 ÿ™"KVERTRAG"
 ÿÂ"Wollen Sie den Vertrag kopieren?","",130,req%
 ÿ¡req%ÿ1ÿpÿ’ÿÿ
 ÿˆÿazw,bewertungssumme,VS_NR,VS_Dauer,KD_Nr,CodeGE,CodeVA,CodeMA,Geburtstag,CodeKU,Beitrag,tarif,Zahlart,VSumme,Volumen,zvp1Name,zvp2Name,zvp3Name,zvp4Name,zvp5Name,zvp1Geb,zvp2Geb,zvp3Geb,zvp4Geb,zvp5Geb
 notiz$ÿnotiz
 ÿ
 lfdnr%ÿÿI("KVERTRAG",1)
 lfdnr.KVERTRAGÿlfdnr%
 ÿˆÿqzw,bewertungssumme,VS_NR,VS_Dauer,KD_Nr,CodeGE,CodeVA,CodeMA,Geburtstag,CodeKU,Beitrag,tarif,Zahlart,VSumme,Volumen,zvp1Name,zvp2Name,zvp3Name,zvp4Name,zvp5Name,zvp1Geb,zvp2Geb,zvp3Geb,zvp4Geb,zvp5Geb
 notizÿnotiz$
 ÿƒFStore("KVERTRAG")
 ÿÉÿ¥lfdnr%ÿ™"KVERTRAG"ÿ£lfdnr.kvertrag
 knr%ÿcodeku.kvertrag
 ÿ£codeku.kvertrag
 ÿœ
 ÿßÿ³
 ÿ”VS_NR.KVERTRAG,0
 ÿ’ÿÿ
 
ÿÿVERTRSichern()
 ÿ½ ********** ToDo: Sperrung im Netzwerk testen
 ÿ¡ÿOÿ("KVERTRAG")ÿÿOÿ°("KVERTRAG")ÿp
tvn%ÿlfdnr.KVERTRAG
ÿÉÿ¥tvn%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
letzteBearb.KVERTRAGÿÿQ
 ÿ’ÿ¡
 ÿƒQuickStore("KVERTRAG")
 ÿ’ÿÿ

 ' KVERTRAG Suchen (kundenbezogen)
 ' =======================================================================
 
ÿÿVERTRSuchen()
 cuvt%ÿlfdnr.KVERTRAG
 a%ÿVERTRSuch%(CodeKU.KVERTRAG,cuvt%)
 ÿ¡a%ÿ0ÿpcuvt%ÿa%
 ÿÉÿœÿ¥cuvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿœ
 ÿÊÿË"Bereit"
 ÿ’ÿÿ

 ' KVERTRAG Suchen (kundenbezogen) mit Auswahl nach Vertragsnummer/KFZKennz/ KFZTyp/
 ' ================================================================================= 
ÿÿVERTRSuchen1()
 viab%ÿ0
 cfile$ÿÿ™
 indab$ÿÿ£
 cuvt%ÿlfdnr.KVERTRAG
 akver1%ÿ0
 ÿ‰ÿñ"vsuch",0,0,175,166,title$,"MS Sans Serif",8
 ÿ|ÿñ"vsuch",9,6,6,24,22,2
 ÿ|ÿñ"vsuch",5,34,6,132,10,0,"Vertrag suchen"
 ÿ|ÿñ"vsuch",4,34,14,132,5,0,""
 ÿ|ÿñ"vsuch",5,34,22,132,26,0,"Bitte geben Sie an, ber welche Infor- mation Sie den Vertrag suchen m”chten"
 ÿ½ ADD DIALOG "vsuch",3,34,49,154,10,0,"alle Vertr„ge anzeigen",0,akVer1%
 ÿ|ÿñ"vsuch",5,34,42,175,26,0,"Standardsuche (schnell):"
 ÿ|ÿñ"vsuch",5,34,75,175,26,0,"erweiterte Suche (langsamer):"
 ÿ|ÿñ"vsuch",6,34,121,132,12,0,0,Eingabe$,20
 ÿ|ÿñ"vsuch",3,41,51,154,10,0,"alle Vertr„ge anzeigen",0,akVer1%
 ÿ|ÿñ"vsuch",3,41,63,148,10,0,"Vertrags&nummer",1,akVer1%
 ÿ|ÿñ"vsuch",3,41,84,132,10,0,"KFZ-&Kennzeichen",2,akVer1%
 ÿ|ÿñ"vsuch",3,41,96,132,10,0,"KFZ-&Typ",3,akVer1%
 ÿ|ÿñ"vsuch",5,34,111,175,10,0,"&Suchbegriff:"
 ÿ½ ADD DIALOG "vsuch",4,26,102,190,38,0,"Bitte den Suchbegriff eingeben"
 ÿ|ÿñ"vsuch",1,28,145,55,14,1,"&Weiter",1,1
 ÿ|ÿñ"vsuch",1,87,145,55,14,0,"&Abbruch",0,0
 ÿñ"vsuch",req%
 ÿ¾ÿñ"vsuch"
 ÿ¡req%ÿ1ÿp
ÿ¡akver1%ÿ0ÿp
a%ÿVERTRSuch%(CodeKU.KVERTRAG,cuvt%)
ÿ¡a%ÿ0ÿpcuvt%ÿa%
ÿÉÿœÿ¥cuvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿ’ÿ¡
ÿ¡akver1%ÿ1ÿp
ÿ¡eingabe$ÿ""ÿp
eingab$ÿeingabe$
nvt%ÿGetVerab%(lfdnr.KVERTRAG)
ÿ¡nvt%ÿ0ÿpcuvt%ÿnvt%
eingab$ÿ""
ÿ^
ÿƒFehler("Es wurde keine Vertragsnummer eingegeben!","Vertrag kann nicht gesucht werden!")
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡akver1%ÿ2ÿp
ÿ¡eingabe$ÿ""ÿp
eingab$ÿeingabe$
nvt%ÿGETKFZKe%(lfdnr.KVERTRAG)
ÿ¡nvt%ÿ0ÿpcuvt%ÿnvt%
eingab$ÿ""
ÿ^
ÿƒFehler("Es wurde kein Kennzeichen eingegeben!","Vertrag kann nicht gesucht werden!")
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡akver1%ÿ3ÿp
ÿ¡eingabe$ÿ""ÿp
eingab$ÿeingabe$
nvt%ÿGETKFZTyp%(lfdnr.KVERTRAG)
ÿ¡nvt%ÿ0ÿpcuvt%ÿnvt%
eingab$ÿ""
ÿ^
ÿƒFehler("Es wurde kein KFZ-Typ eingegeben!","Vertrag kann nicht gesucht werden!")
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿÉÿœÿ¥cuvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿ¡akver1%ÿ1ÿnvt%ÿ0ÿp
ÿœ2
 ÿ^
ÿœ
 ÿ’ÿ¡
 ÿ™cfile$
 ÿ£indab$
 ÿÊÿË"Bereit"
 ÿ’ÿÿ
 
 ' KVERTRAG Suchen (kundenbezogen)
 ' =======================================================================
 
ÿÿVERTRSuch%(kunr%,prompt%)
 cfile$ÿÿ™
 vt%ÿlfdnr.KVERTRAG
 ÿ¡ÿJ(kunr%,CodeKU.KVERTRAG)ÿp
ÿÊÿË"Vertragsdatei wird durchsucht..."
ÿ×Auswahl$(1)
ÿ×VListe$(ÿA("KVERTRAG"))
ÿ™"KVERTRAG"
ÿ£CodeKU.KVERTRAG
ÿÉÿ`
ÿÉÿ¥kunr%
a%ÿ0
ÿØÿOÿB("KVERTRAG")ÿkunr%ÿCodeKU.KVERTRAG
ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
ÿÉÿ¥CodeVA.KVERTRAGÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
ÿÉÿ¥CodeMA.KVERTRAGÿ™"MAADR"ÿ£CodeMA.MAADR
tGesellschaft$ÿÿ¡(ÿC("GEADR"),ÿH(ÿ+(Gesellschaft.GEADR,10)),"<keine Zuordnung>")
tSparte$ÿÿ¡(ÿC("SPARTEN"),Sparte.SPARTEN,"<keine Zuordnung>")
tAgentur$ÿÿ¡(ÿC("MAADR"),ÿH(ÿ+(Nachname.MAADR,10))ÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".","<keine Zuordnung>")
tDatum$ÿÿ¡(VS_Beginn.KVERTRAGÿ0,ÿ(VS_Beginn.KVERTRAG,"dd.mm.yy"),"__.__.__")
abzusatz$ÿ""
ÿ¡kennzeichen.kvertragÿ""ÿfabrikatÿ""ÿp
abzusatz$ÿ",("ÿÿF(kennzeichen.kvertrag)ÿ","ÿÿF(fabrikat.kvertrag)ÿ")"
ÿ’ÿ¡
ÿ¡zvp1name.kvertragÿ""ÿpabzusatz$ÿ",mitvers.:"ÿÿH(zvp1name.kvertrag)

VListe$(a%)ÿtGesellschaft$ÿ", "ÿtSparte$ÿ", "ÿtDatum$ÿabzusatz$ÿ","ÿtAgentur$ÿÿ'(80)ÿÿ(lfdnr.KVERTRAG,"000000")
ÿ½ andi 2.11.95 
ÿ½ Original IF lfdnr.KVERTRAG = prompt% THEN prompt$ = VListe$(a%)
ÿ¡prompt$ÿ""ÿp
prompt$ÿVListe$(0)
ÿ^
ÿ¡lfdnr.KVERTRAGÿprompt%ÿpprompt$ÿVListe$(a%)
ÿ’ÿ¡
a%ÿa%ÿ1
ÿÉÿ±ÿ™"KVERTRAG"ÿ£CodeKU.KVERTRAG
ÿÙ
ÿ‰ÿñ"GETVERTRAG",0,0,346,156,"Vertragsbersicht","MS Sans Serif",8
ÿ|ÿñ"GETVERTRAG",4,0,0,346,132,0,""
ÿ|ÿñ"GETVERTRAG",9,6,11,23,22,2
ÿ|ÿñ"GETVERTRAG",5,36,13,202,11,0,"Bitte w„hlen Sie den Vertrag, den Sie bearbeiten m”chten:"
ÿ|ÿñ"GETVERTRAG",5,36,25,202,11,0,"Gesellschaft, Sparte, Beginn, Agentur"
ÿ|ÿñ"GETVERTRAG",7,36,37,303,95,2,2,VListe$,Auswahl$,prompt$
ÿ|ÿñ"GETVERTRAG",1,110,135,55,15,1,"&OK",1,1
ÿ|ÿñ"GETVERTRAG",1,167,135,55,15,0,"&Abbrechen",0,0
ÿÊÿË"Bitte w„hlen Sie einen Vertrag aus..."
ÿñ"GETVERTRAG",req%
ÿÊÿË"Bereit"
ÿ¾ÿñ"GETVERTRAG"
ÿ¡req%ÿ1ÿp
VERTRSuch%ÿÿ0(ÿ-(Auswahl$(0),6))
ÿ^
VERTRSuch%ÿ0
ÿ’ÿ¡
 ÿ^
ÿÂ"keine Vertr„ge fr angegebenen Kunden gefunden!"
VERTRSuch%ÿ0
 ÿ’ÿ¡
 ÿ™cfile$
 ÿÉÿ¥vt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿ’ÿÿ
 



 ' KVERTRAG Eintrag zurck
 ' =======================================================================

ÿÿVERTRPrev()
 ÿ¡ÿ("KVERTRAG")ÿÿ°("KVERTRAG")ÿpÿƒFStore("KVERTRAG")
 cunr%ÿlfdnr.KVERTRAG
 ÿÉÿœÿgÿ™"KVERTRAG"ÿ£codeku.KVERTRAG
 ÿ¡codeku.KVERTRAGÿknr%ÿp
ÿÂ"Dateianfang erreicht!","",2
ÿÉÿœÿ¥cunr%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿ’ÿ¡
 ÿœ
 ÿ’ÿÿ


 ' KVERTRAG Eintrag vor
 ' =======================================================================

ÿÿVERTRNext()
 ÿ¡ÿ("KVERTRAG")ÿÿ°("KVERTRAG")ÿpÿƒFStore("KVERTRAG")
 cunr%ÿlfdnr.KVERTRAG
 ÿÉÿœÿ±ÿ£codeku.KVERTRAG
 ÿ¡codeku.KVERTRAGÿknr%ÿp
ÿÂ"Dateiende erreicht!","",2
ÿÉÿœÿ¥cunr%ÿ£lfdnr.KVERTRAG
 ÿ’ÿ¡
 ÿœ
 ÿ’ÿÿ


 ' KVERTRAG l”schen
 ' =======================================================================

ÿÿVERTRLoeschen()
 ÿ¡disabled%("VERTRLoeschen")ÿpÿ’ÿÿ
 cuvt%ÿlfdnr.KVERTRAG
 ÿÂ"Soll der aktuelle Vertrag gel”scht werden?","(VS-Nr.: "ÿVS_Nr.KVERTRAGÿ")",135,req%
 ÿ¡req%ÿ1ÿp
ÿßÿe
ÿÉÿ¥cuvt%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿ¡ÿC("KVERTRAG")ÿp
ÿÉÿ¾
ÿÂ"Vertrag wurde gel”scht!","",0
ÿÉÿœÿ¥knr%ÿ™"KVERTRAG"ÿ£codeku.KVERTRAG
ÿ¡CodeKU.KVERTRAGÿknr%ÿp
ÿÂ"Es sind keine weiteren Vertr„ge fr","diesen Kunden vorhanden!",0
_formend%ÿ1
ÿ’ÿ¡
ÿ^
ÿƒFehler("Vertrag l”schen:","Fehler bei Datenbankpositionierung!")
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿœ
 ÿßÿ³
 ÿ’ÿÿ
 


 ' KVERTRAG Zusatz
 ' =======================================================================

ÿÿVERTRZusatz()
 ÿœ2
 ÿ’ÿÿ
 

 
 ' Vertragsbersicht fr aktuellen Kunden drucken
 ' =======================================================================
 
ÿÿVLIST2()
 ÿƒLIST2(CodeKU.KVERTRAG)
 ÿ’ÿÿ

 
 
 ' QuickCode-Erzeugung fr Versicherungsnummer
 ' =======================================================================
 
ÿÿVSNRPack$(VSNR$)
 tVSNR$ÿ""
 ÿ›a%ÿ1ÿqÿ/(VSNR$)
tC$ÿÿ>(ÿ,(VSNR$,a%,1))
ÿÉÿætC$
ÿæ"A"ÿq"Z","0"ÿq"9"
tVSNR$ÿtVSNR$ÿtC$
ÿ’ÿÉ
 ÿ±a%
 VSNRPack$ÿtVSNR$
 ÿ’ÿÿ


 ' Vertragsinformationen anzeigen
 ' =======================================================================
 
ÿÿVINFO(lfdnr%)
 ÿßÿe
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 cvt%ÿlfdnr.KVERTRAG
 cfile$ÿÿ™
 ÿ™"KVERTRAG"
 cindex$ÿÿ£
 ÿßÿe
 ÿÉÿ¥lfdnr%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿ¡ÿC("KVERTRAG")ÿp
ÿÉÿ¥CodeKU.KVERTRAGÿ™"ADRESSEN"ÿ£CodeKU.ADRESSEN
ÿ¡ÿC("ADRESSEN")ÿp
Kunde$ÿNachname.ADRESSENÿ", "ÿVorname.ADRESSEN
ÿ^
Kunde$ÿ"<keine Zuordnung>"
ÿ’ÿ¡
ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
ÿ¡ÿC("GEADR")ÿp
Gesellschaft$ÿGesellschaft.GEADR
ÿ^
Gesellschaft$ÿ"<keine Zuordnung>"
ÿ’ÿ¡
ÿÉÿ¥CodeVA.KVERTRAGÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
ÿ¡ÿC("SPARTEN")ÿp
Sparte$ÿSparte.SPARTEN
ÿ^
Sparte$ÿ"<keine Zuordnung>"
ÿ’ÿ¡
ÿ¡VS_Beginn.KVERTRAGÿ0ÿp
von$ÿÿ(VS_Beginn.KVERTRAG,"0d.mm.yyyy")
ÿ^
von$ÿ"__.__.____"
ÿ’ÿ¡
ÿ¡Kndigung.KVERTRAGÿ0ÿp
bis$ÿÿ(Kndigung.KVERTRAG,"0d.mm.yyyy")
ÿ^
bis$ÿ"__.__.____"
ÿ’ÿ¡
Vertrag$ÿVS_Nr.KVERTRAG
VStatus$ÿ"zur Zeit nicht verfgbar"
ÿ‰ÿñ"VINFO",0,0,265,141,"Vertragsinfo","MS Sans Serif",8
ÿ|ÿñ"VINFO",4,0,0,265,112,0,""
ÿ|ÿñ"VINFO",9,5,9,24,25,4
ÿ|ÿñ"VINFO",5,33,9,140,11,0,"Informationen zum Vertrag "ÿVS_Nr.KVERTRAGÿ"        +++"
ÿ|ÿñ"VINFO",5,33,24,49,10,0,"Kunde:"
ÿ|ÿñ"VINFO",5,88,24,174,10,128,Kunde$
ÿ|ÿñ"VINFO",5,33,34,49,10,0,"Gesellschaft:"
ÿ|ÿñ"VINFO",5,88,34,173,10,128,Gesellschaft$
ÿ|ÿñ"VINFO",5,33,44,48,10,0,"Sparte:"
ÿ|ÿñ"VINFO",5,88,44,173,10,128,Sparte$
ÿ|ÿñ"VINFO",5,33,54,45,9,0,"Laufzeit:"
ÿ|ÿñ"VINFO",5,88,54,173,10,0,"vom "ÿvon$ÿ" bis "ÿbis$
ÿ|ÿñ"VINFO",4,33,70,226,35,0,"Status"
ÿ|ÿñ"VINFO",5,36,80,220,19,0,VStatus$
ÿ|ÿñ"VINFO",1,100,118,57,16,1,"&OK",1,1
ÿñ"VINFO",req%
ÿ¾ÿñ"VINFO"
 ÿ^
ÿ½ CALL Fehler("Der angegebene Vertrag konnte nicht gefunden werden!","")
ÿÂ"Vertrag nicht gefunden!"
 ÿ’ÿ¡
 ÿ™"KVERTRAG"
 ÿÉÿ¥cvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿÊÿ£cindex$
 ÿ£cindex$
 ÿ™cfile$
 ÿßÿ³
 ÿ’ÿÿ


 ' Gesamtbeitrag fr Geb„udeversicherung berechnen
 ' =======================================================================

ÿÿGebGesamt()
 cfile$ÿÿ™
 ÿ™"KVERTRAG"
 ok%ÿ0
 ÿ½ -- Berechnung bei leeren Feldern unterdrcken (zur manuellen Eingabe
 ÿ½ -- des Gesamtbeitrages
 ÿ¡F_Beitrag.KVERTRAGÿ0ÿpok%ÿÿ1
 ÿ¡FKBU_Beitrag.KVERTRAGÿ0ÿpok%ÿÿ1
 ÿ¡LW_Beitrag.KVERTRAGÿ0ÿpok%ÿÿ1
 ÿ¡LWKBU_Beitrag.KVERTRAGÿ0ÿpok%ÿÿ1
 ÿ¡ST_Beitrag.KVERTRAGÿ0ÿpok%ÿÿ1
 ÿ¡STKBU_Beitrag.KVERTRAGÿ0ÿpok%ÿÿ1
 ÿ¡ED_Beitrag.KVERTRAGÿ0ÿpok%ÿÿ1
 ÿ¡EDVANDA_Beitrag.KVERTRAGÿ0ÿpok%ÿÿ1
 ÿ¡EDKBU_Beitrag.KVERTRAGÿ0ÿpok%ÿÿ1
 ÿ¡ok%ÿp
Gesamtbeitrag ÿF_Beitrag ÿFKBU_Beitrag ÿLW_Beitrag ÿLWKBU_Beitrag ÿST_Beitrag ÿSTKBU_Beitrag ÿED_Beitrag ÿEDVANDA_Beitrag ÿEDKBU_Beitrag
ÿœ
 ÿ’ÿ¡
 ÿ™cfile$
 ÿ’ÿÿ



 '      ******************************************
 '      ** Routinen fr Vertragsnachbearbeitung **
 '      ******************************************
 
ÿÿVorgang()
 ÿ¡disabled%("VORGANG")ÿpÿ’ÿÿ
 ÿƒDFile(3,"VORGANG"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 cuvt%ÿlfdnr.KVERTRAG
 ÿ™"vorgang"
 ÿÉÿ¥cuvt%ÿ£CodeVT.VORGANG
 _continue%ÿ1
 ÿ¡ÿOÿC("VORGANG")ÿp
_continue%ÿ0
ÿÂ"Es wurden noch keine Vorg„nge fr diesen Vertrag erfaát!","Erfassung fortsetzen?",130,req%
ÿ¡req%ÿ1ÿp
_continue%ÿ1
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡_continue%ÿ1ÿp
_formend%ÿ0
ÿØ_formend%ÿ0
FORMsub%ÿ0
ÿ¡ÿ>(ÿœ)ÿ"VORGANG"ÿp
ÿÊÿŸtitle$ÿ" - Nachbearbeitung"
ÿ´ÿœ"VORGANG"
ÿƒVorgangIntro()
ÿƒMNVORGANG()
ÿ¬ÿ³
ÿÊÿË"Vertragsnachbearbeitung"
ÿ’ÿ¡
ÿœ
ÿßÿ³
ÿ¡FORMsub%ÿ99ÿpÿÏÿßÿÿ¥ÿÿ¬
ÿÉÿæFORMsub%
ÿæ1
ÿƒVorgangSuchen()
ÿæ99
ÿ”Datum.VORGANG,0
ÿ’ÿÉ
FORMsub%ÿ0
ÿÙ
 ÿ’ÿ¡
 _formend%ÿ0
 ÿÉÿ¥cuvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 cuvg%ÿ0
 ÿ™"KVERTRAG"
 ÿ’ÿÿ
 
 
 ' VORGANG Intro
 ' =======================================================================
 
ÿÿVorgangIntro()
 ÿ™"VORGANG"
 ÿ£CodeVT.VORGANG
 ÿÉÿ¥cuvt%ÿ™"VORGANG"ÿ£CodeVT
 ÿ¡ÿOÿC("VORGANG")ÿp
ÿƒVorgangNeu()
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿœ
 ÿ’ÿÿ
 
 
 ' Vorgang Neu
 ' =======================================================================
 
ÿÿVorgangNeu()
 ÿ¡ÿ°("VORGANG")ÿÿ("VORGANG")ÿpÿƒFStore("VORGANG")
 ÿÿœ
 ÿÊÿË"Datensatz neu angelegt..."
 Datum.VORGANGÿÿQ
 CodeVG.VORGANGÿÿI("VORGANG",1)
 CodeVT.VORGANGÿcuvt%
 CodeMA.VORGANGÿCodeMA.KVERTRAG
 ÿœ
 ÿ’ÿÿ
 

 ' Vorgang Sichern
 ' =======================================================================
 
ÿÿVorgangSichern()
 ÿ¡Kurznotiz.VORGANGÿ""ÿp
ÿƒFStore("VORGANG")
 ÿ^
ÿƒFehler("Bitte geben Sie eine vollst„ndige Beschreibung des Vorganges ein!","")
 ÿ’ÿ¡
 ÿ’ÿÿ
 

 ' VORGANG Eintrag zurck
 ' =======================================================================
 
ÿÿVorgangPrev()
 ÿ¡ÿ("VORGANG")ÿÿ°("VORGANG")ÿpÿƒFStore("VORGANG")
 cuvg%ÿCodeVG.VORGANG
 ÿÉÿœÿgÿ£CodeVT.VORGANG
 ÿ¡CodeVT.VORGANGÿcuvt%ÿp
ÿÂ"Dateianfang erreicht!","",2
ÿÉÿœÿ¥cuvg%ÿ£CodeVG.VORGANG
 ÿ’ÿ¡
 ÿœ
 ÿ’ÿÿ
 
 
 ' Vorgang Eintrag vor
 ' =======================================================================
 
ÿÿVorgangNext()
 ÿ¡ÿ("VORGANG")ÿÿ°("VORGANG")ÿpÿƒFStore("VORGANG")
 cuvg%ÿCodeVG.VORGANG
 ÿÉÿœÿ±ÿ£CodeVT.VORGANG
 ÿ¡CodeVT.VORGANGÿcuvt%ÿp
ÿÂ"Dateiende erreicht!","",2
ÿÉÿœÿ¥cuvg%ÿ£CodeVG.VORGANG
 ÿ’ÿ¡
 ÿœ
 ÿ’ÿÿ
 

 ' VORGANG l”schen
 ' =======================================================================
 
ÿÿVorgangLoeschen()
 ÿ¡disabled%("VorgangLoeschen")ÿpÿ’ÿÿ
 cuvg%ÿCodeVG.VORGANG
 ÿÂ"Vorgang wirklich l”schen?","",135,req%
 ÿ¡req%ÿ1ÿp
ÿÉÿ¥cuvg%ÿáÿ™"VORGANG"ÿ£CodeVG.VORGANG
ÿÉÿ¾
ÿÉÿ¥cuvt%ÿ™"VORGANG"ÿ£CodeVT.VORGANG
ÿ¡ÿOÿC("VORGANG")ÿp
ÿƒFehler("Keine weiteren Daten vorhanden!","")
_formend%ÿ1
ÿ’ÿ¡
ÿœ
 ÿ’ÿ¡
 ÿœ
 ÿ’ÿÿ
 

 ' Vorgang Suchen
 ' =======================================================================
 ' 12.09.95/FA - neue Variante/Umstellung REQ25 auf Dialogauswahl
 
ÿÿVorgangSuchen()
 a%ÿVORGSuchen%(CodeVT.VORGANG)
 ÿ¡a%ÿ0ÿp
ÿÉÿœÿ¥a%ÿ™"VORGANG"ÿ£CodeVG.VORGANG
ÿœ
 ÿ’ÿ¡
 ÿ’ÿÿ
 

 ' Vorg„nge aus Vorgangsdatei suchen
 ' =======================================================================
 ' 12.09.95/FA
 
ÿÿVORGSuchen%(vnr%)
 ÿßÿe
 cfile$ÿÿ™
 cvorg%ÿCodeVG.VORGANG
 ÿ™"VORGANG"
 ÿ£QuickCode.VORGANG
 sq$ÿÿ(vnr%,"000000")ÿ"000000"
 ÿÉÿ`
 ÿÉÿ¥sq$ÿ™"VORGANG"ÿ£QuickCode.VORGANG
 ÿ×VORGListe$(ÿA("VORGANG"))
 ÿ×Auswahl$(0)
 a%ÿ0
 ÿØCodeVT.VORGANGÿvnr%ÿÿOÿB("VORGANG")
VORGListe$(a%)ÿÿ(Datum,"dd.mm.yy")ÿ" ["ÿÿ¡(erledigt ÿ"j","j","n")ÿ"] "ÿÿ¡(ÿ/(Beschreibung)ÿ30,ÿ+(Beschreibung,30)ÿ"...",Beschreibung)ÿÿ'(80)ÿÿ(CodeVG,"000000")
ÿ¡CodeVG ÿcvorg%ÿpprompt$ÿVORGListe$(a%)
a%ÿa%ÿ1
ÿÉÿ±
 ÿÙ
 ÿ‰ÿñ"VORGSU",0,0,216,168,title$,"MS Sans Serif",8
 ÿ|ÿñ"VORGSU",9,4,9,22,22,2
 ÿ|ÿñ"VORGSU",5,28,9,178,10,0,"Liste aller bekannten Vorg„nge zum aktuellen Vertrag"
 ÿ|ÿñ"VORGSU",4,28,19,178,5,0,""
 ÿ|ÿñ"VORGSU",5,28,27,178,20,0,"Bitte w„hlen Sie aus der Liste den Vorgang aus, den Sie bearbeiten m”chten:"
 ÿ|ÿñ"VORGSU",7,28,50,178,89,0,2,VORGListe$,Auswahl$,prompt$
 ÿ|ÿñ"VORGSU",1,49,147,55,15,1,"&OK",1,1
 ÿ|ÿñ"VORGSU",1,106,147,55,15,0,"&Abbrechen",0,0
 ÿñ"VORGSU",req%
 ÿ¾ÿñ"VORGSU"
 ÿ¡req%ÿ1ÿp
VORGSuchen%ÿÿ0(ÿ-(Auswahl$(0),6))
 ÿ^
VORGSuchen%ÿ0
 ÿ’ÿ¡
 ÿ™cfile$
 ÿÉÿ¥cvorg%ÿ™"VORGANG"ÿ£CodeVG.VORGANG
 ÿßÿ³
 ÿ’ÿÿ


 ' Liste aller Vorg„nge des aktuellen Vertrages ausgeben
 ' =======================================================================
 ' 12.09.95/FA
 
ÿÿVORGDruck()
 ÿßÿe
 cfile$ÿÿ™
 cvnr%ÿCodeVT.VORGANG
 cvg%ÿCodeVG.VORGANG
 ÿÁÿs"BVORGANG"
 ÿ€ÿÁ
ÿÊÿÁÿí"H_REPORT"
ÿ¶ÿÁÿí
 ÿ’ÿÁ
 ÿCodeVG.VORGANG
 ÿ€ÿCodeVG.VORGANG
ÿÊÿÁÿí"H_CodeVG.VOR002"
ÿ¶ÿÁÿí
 ÿ’ÿ
 ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
 ÿ’ÿÉ
 ÿÊÿiÿe
 ÿÊÿiÿáÿe
 ÿ³ÿ_ÿwErrVorgDruck
 ÿÉ;
ÿĞCodeVT.VORGANGÿlfdNr.KVERTRAGÿCodeKU.KVERTRAGÿCodeKU.ADRESSENÿCodeVA.KVERTRAGÿCodeVA.SPARTENÿCodeGE.KVERTRAGÿCodeGE.GEADRÿCodeVT.VORGANGÿcvnr%
ÿµÿÁDatum.VORGANG
ÿqÿ~
ErrVorgDruck: 
 ÿ¡test%ÿ0ÿpÿ³ÿ_ÿwErrorHandler ÿ^ÿ³ÿ_
 ÿ™cfile$
 ÿÉÿœÿ¥cvg%ÿ™"VORGANG"ÿ£CodeVG.VORGANG
 ÿßÿ³
 ÿ’ÿÿ
 

 ' GEKOND Vorgang ???
 ' =======================================================================
 
ÿÿTIVORGANG()
 cuvg%ÿCodeVG.VORGANG
 _formend%ÿ1
 ÿ’ÿÿ



 '      **************************
 '      ** Provisionsberechnung **
 '      **************************


 ' Vertrag in Verprovisionierung aufnehmen
 ' ========================================================================

ÿÿPROVISION()
 ÿ¡disabled%("PROVISION")ÿpÿ’ÿÿ
 cfile$ÿÿ™
 cuvt%ÿlfdnr.KVERTRAG
 ÿ¡ÿ("KVERTRAG")ÿÿ°("KVERTRAG")ÿpÿƒFStore("KVERTRAG")
 ÿ¡ProviAb ÿ0ÿFremdvertrag.KVERTRAGÿ"j"ÿAltvertrag.KVERTRAGÿ"j"ÿp
ÿÉÿ¥cuvt%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿ¡test%ÿ0ÿp
ÿ‰ÿñ"STORNO",0,0,242,148,"Vertragsstatus","MS Sans Serif",8
ÿ|ÿñ"STORNO",4,0,0,242,148,0,""
ÿ|ÿñ"STORNO",9,8,12,20,21,2
ÿ|ÿñ"STORNO",5,43,14,67,10,0,"verprovisioniert seit:"
ÿ|ÿñ"STORNO",6,112,12,41,12,0,0,ProviAB.KVERTRAG,10
ÿ|ÿñ"STORNO",4,43,30,120,114,0," Stornierung/Vertragsende "
ÿ|ÿñ"STORNO",3,50,44,108,10,0,"Vertrag nicht storniert",0,storno.kvertrag
ÿ|ÿñ"STORNO",3,50,58,108,10,0,"vollst. Rckbuchung",1,storno.kvertrag
ÿ|ÿñ"STORNO",3,50,72,108,10,0,"anteilige Rckbuchung",2,storno.kvertrag
ÿ|ÿñ"STORNO",3,50,99,98,10,0,"ohne Rckbuchung",3,storno.kvertrag
ÿ|ÿñ"STORNO",5,61,86,23,10,0,"Anteil:"
ÿ|ÿñ"STORNO",6,87,84,41,11,0,0,StornoAnteil.KVERTRAG,20
ÿ|ÿñ"STORNO",5,131,86,22,9,0,"%"
ÿ|ÿñ"STORNO",5,50,115,25,9,0,"Datum:"
ÿ|ÿñ"STORNO",6,78,113,43,12,0,0,Kndigung.KVERTRAG,10
ÿ|ÿñ"STORNO",2,50,130,44,10,0,"vorzeitig?","j","n",vorzeitig.KVERTRAG
ÿ½ ADD DIALOG "STORNO",1,167,56,70,15,0,"Stornierung",2,1
ÿ|ÿñ"STORNO",1,167,113,70,15,1,"&OK",1,1
ÿ|ÿñ"STORNO",1,167,129,70,15,0,"&Abbrechen",0,0
ÿñ"STORNO",req%
ÿ¾ÿñ"STORNO"
ÿ¡req%ÿ1ÿp
ÿ¡ProviAb.KVERTRAGÿ
1ÿp
	ÿßÿe
	ÿÊÿË"Vertrag wird aus Provisionsabrechnung entfernt"
	ÿ¡ÿJ(cuvt%,CodeVT.VKOND)ÿpÿ¾ÿaÿ™"VKOND"ÿĞCodeVT.VKONDÿcuvt%
	CodeKO.KVERTRAGÿ0
	Kondition.KVERTRAGÿ0
	ÿÊÿË"Bereit"
ÿ’ÿ¡
ÿƒFStore("KVERTRAG")
ÿ’ÿ¡
ÿ^
ÿƒVStat()
ÿ’ÿ¡
 ÿ^
ÿƒDFile(3,"gekond"ÿ_fpw$)
ÿƒDFile(3,"vkond"ÿ_fpw$)
ok%ÿ1
ÿ¡Bewertungssumme.KVERTRAGÿ	0ÿp
ok%ÿ0
ÿƒFehler("Vertrag kann noch nicht verprovisioniert werden!","Bitte geben Sie die Bewertungssumme ein.")
ÿ’ÿ¡
ÿ¡Beitrag.KVERTRAGÿ	0ÿp
ÿƒFehler("Vertrag kann noch nicht verprovisioniert werden!","Bitte geben Sie den Beitrag ein.")
ok%ÿ0
ÿ’ÿ¡
ÿ¡CodeGE.KVERTRAGÿ0ÿp
ÿƒFehler("Vertrag kann noch nicht verprovisioniert werden!","Bitte w„hlen Sie eine Gesellschaft aus.")
ok%ÿ0
ÿ’ÿ¡
ÿ¡CodeMA.KVERTRAGÿ0ÿp
ÿƒFehler("Vertrag kann noch nicht verprovisioniert werden!","Bitte w„hlen Sie eine Agentur aus.")
ok%ÿ0
ÿ’ÿ¡
ÿ¡CodeVA.KVERTRAGÿ0ÿp
ÿƒFehler("Vertrag kann noch nicht verprovisioniert werden!","Bitte w„hlen Sie eine Sparte aus.")
ok%ÿ0
ÿ’ÿ¡
ÿ¡ÿ1(VS_Beginn.KVERTRAG)ÿ0ÿp
ok%ÿ0
ÿƒFehler("Vertrag kann noch nicht verprovisioniert werden!","Bitte geben Sie den Vertragsbeginn an.")
ÿ’ÿ¡
ÿ¡ok%ÿ1ÿp
ÿÂ"Vertrag in monatliche Abrechnung bernehmen?","",130,erg%
ÿ¡erg%ÿ1ÿp
ProviAb$ÿÿ(ÿQ,"dd.mm.yy")
ZahlungJN$ÿ"n"
ÿ‰ÿñ"SETPROVI",0,0,201,132,title$,"MS Sans Serif",8
ÿ|ÿñ"SETPROVI",4,0,0,201,109,0,""
ÿ|ÿñ"SETPROVI",9,7,10,20,20,2
ÿ|ÿñ"SETPROVI",5,30,11,162,26,0,"Bitte geben Sie an, ab wann der Vertrag innerhalb der monatlichen Provisionsberechnung bercksichtigt werden soll."
ÿ|ÿñ"SETPROVI",6,90,40,42,12,0,0,ProviAb$,10
ÿ|ÿñ"SETPROVI",5,30,42,56,8,0,"Berechnung ab:"
ÿ|ÿñ"SETPROVI",5,30,64,160,24,0,"Sollen die Provisionen fr diesen Vertrag abh„ngig von den Zahlungseing„ngen der Gesellschaften ausgezahlt werden?"
ÿ|ÿñ"SETPROVI",2,30,91,143,14,0,"Zahlungseing„nge &prfen","j","n",ZahlungJN$
ÿ|ÿñ"SETPROVI",1,40,113,55,15,1,"&OK",1,1
ÿ|ÿñ"SETPROVI",1,100,113,55,15,0,"&Abbrechen",0,0
ÿñ"SETPROVI",req%
ÿ¾ÿñÿt
ÿ¡req%ÿ1ÿp
	bwbezug$ÿReadConfig$("PROVIS","Bewertungszeitraum")
	ÿ¡bwbezug$ÿ"leer"ÿbwbezug$ÿ"Provisionierungsbeginn"ÿp
BWStart$ÿProviAb$
	ÿ^
BWStart$ÿÿ(VS_Beginn.KVERTRAG,"dd.mm.yy")
	ÿ’ÿ¡
	ÿ¡DateOK%(BWStart$)ÿp
kond%ÿGetKond%(cuvt%,ÿ1(BWStart$),0)
ÿ¡kond%ÿ0ÿp
ÿ¡ÿJ(cuvt%,CodeVT.VKOND)ÿpÿ¾ÿaÿ™"VKOND"ÿĞCodeVT.VKONDÿcuvt%
ÿƒFehler(fehlnach$,"")
ÿÉÿ¥cuvt%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ProviAb.kvertragÿ0
CodeKO.KVERTRAGÿ0
ÿ½ kondition.KVERTRAG = SelKond%
ÿƒFStore("KVERTRAG")
 
ÿ½ ### ToDo: Fehlerliste anzeigen
ÿ^
doprov%ÿEditKond%(kond%)
ÿ¡doprov%ÿ1ÿp
ÿÉÿ¥cuvt%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ProviAb.kvertragÿÿ1(ProviAb$)
Check.KVERTRAGÿZahlungJN$
CodeKO.KVERTRAGÿkond%
ÿ½ kondition.KVERTRAG = SelKond%
ÿÂ"Vertrag wird ab sofort in die Provisionierung","mit einbezogen!",2
ÿƒFStore("KVERTRAG")
ÿ^
ÿÉÿ¥cuvt%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ProviAb.kvertragÿ0
CodeKO.KVERTRAGÿ0
ÿ¡ÿJ(cuvt%,CodeVT.VKOND)ÿpÿ¾ÿaÿ™"VKOND"ÿĞCodeVT.VKONDÿcuvt%
ÿ½ kondition.KVERTRAG = SelKond%
ÿƒFStore("KVERTRAG")
ÿƒFehler("Auswahl abgebrochen!","")
ÿ’ÿ¡
ÿ’ÿ¡
	ÿ^
ÿƒFehler("Datum im falschen Format!","Bitte geben Sie das Datum in der Form 'tt.mm.jj' ein.")
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ™cfile$
 ÿßÿ³
 ÿ’ÿÿ

 ' Status eines Vertrages anzeigen und „ndern
 ' =======================================================================
 ' 05.09.95/FA

ÿÿVStatus(vnr%)
 ÿ¡disabled%("VERTRSTATUS")ÿpÿ’ÿÿ
 ÿßÿe
 cuv%ÿlfdnr.KVERTRAG
 cfile$ÿÿ™
 ÿƒDFile(3,"BUCHUNG"ÿ_fpw$)
 ÿÉÿ¥vnr%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿ¡ÿC("KVERTRAG")ÿp
ÿ½ -- Stornoreserve ermitteln --
sr%ÿGetSR%(vnr%)
ÿ‰ÿñ"VSTATUS",0,0,296,133,"Vertragsstatus","MS Sans Serif",8
ÿ¡Storno.KVERTRAGÿ0ÿp
Storno$ÿÿH(ÿ(Kndigung,"dd.mm.yyyy"))
ÿ¡vorzeitig.KVERTRAGÿ"j"ÿp
Storno$ÿStorno$ÿÿ(13)ÿ"(vorzeitig)"
ÿ’ÿ¡
ÿ^
Storno$ÿ"nicht gekndigt"
ÿ’ÿ¡
ÿ|ÿñ"VSTATUS",9,6,8,20,22,4
ÿ|ÿñ"VSTATUS",4,35,3,192,19,0,""
ÿ|ÿñ"VSTATUS",5,37,10,169,9,0,"Status des Vertrages "ÿVS_NR.KVERTRAG
ÿ|ÿñ"VSTATUS",5,37,24,69,10,0,"verprovisioniert seit:"
ÿ|ÿñ"VSTATUS",5,148,24,65,11,0,ÿ¡(ProviAb.KVERTRAGÿ0,ÿH(ÿ(ProviAb.KVERTRAG,"dd.mm.yyyy")),"nicht aktiviert")
ÿ|ÿñ"VSTATUS",5,37,34,73,10,0,"letzte Bearbeitung am:"
ÿ|ÿñ"VSTATUS",5,148,34,73,10,0,ÿH(ÿ(letzteBearb.KVERTRAG,"dd.mm.yyyy"))
ÿ|ÿñ"VSTATUS",5,37,44,111,10,0,"letzte Provisionszahlung:"
ÿ|ÿñ"VSTATUS",5,148,44,65,11,0,ÿ¡(letzteProvi.KVERTRAGÿ0,ÿH(ÿ(letzteProvi.KVERTRAG,"dd.mm.yyyy")),"keine Angaben")
ÿ|ÿñ"VSTATUS",5,37,54,111,10,0,"Stornoreserve:"
ÿ|ÿñ"VSTATUS",5,148,54,65,11,0,ÿH(ÿ(GetSR%(vnr%),",9999999.00"))
ÿ|ÿñ"VSTATUS",5,37,64,73,10,0,"Stornierung:"
ÿ|ÿñ"VSTATUS",5,148,64,65,20,0,Storno$
ÿ|ÿñ"VSTATUS",4,35,85,192,19,0,""
ÿ|ÿñ"VSTATUS",5,37,92,85,10,0,"Zahlungeingangskontrolle"
ÿ|ÿñ"VSTATUS",5,37,106,111,10,0,"Prfung der Zahlungseing„nge:"
ÿ|ÿñ"VSTATUS",5,147,106,70,10,0,ÿ¡(check.KVERTRAGÿ"j","aktiviert","deaktiviert")
ÿ|ÿñ"VSTATUS",5,37,116,104,9,0,"zahlbare Provision:"
ÿ|ÿñ"VSTATUS",5,147,116,66,11,0,ÿH(ÿ(Pool.KVERTRAG,",9999999.00"))
ÿ|ÿñ"VSTATUS",1,235,6,55,15,1,"&OK",1,1
ÿ|ÿñ"VSTATUS",1,235,23,55,15,0,"&Abbrechen",0,0
ÿ¡ÿOMNdisabled%("VERTRDEAKTIVIEREN")ÿProviAb.KVERTRAGÿ0ÿp
ÿ|ÿñ"VSTATUS",1,235,46,55,15,0,"&Deaktivieren",3,1
ÿ’ÿ¡
ÿ¡ÿOMNdisabled%("VERTRSTORNO")ÿProviAb.KVERTRAGÿ0ÿp
ÿ|ÿñ"VSTATUS",1,235,63,55,15,0,"&Stornieren",4,1
ÿ’ÿ¡
ÿñ"VSTATUS",req%
ÿ¾ÿñ"VSTATUS"
ÿÉÿæreq%
ÿæ3
ÿƒVERTRDeak()
ÿæ4
ÿƒVERTRStorno()
ÿ’ÿÉ
 ÿ^
ÿÂ"nicht gefunden"
 ÿ’ÿ¡
 ÿ™cfile$
 ÿÉÿœÿ¥cuv%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿ¡ÿœÿ""ÿpÿœ
 ÿßÿ³
 ÿ’ÿÿ

 ' Vertrag aus Abrechnung nehmen
 ' =======================================================================
 ' 06.09.95/FA
 
ÿÿVERTRDeak()
 ÿ‰ÿñ"VDEAKTIV",0,0,235,132,title$,"MS Sans Serif",8
 ÿ|ÿñ"VDEAKTIV",9,9,12,22,24,2
 ÿ|ÿñ"VDEAKTIV",5,40,11,186,9,0,"Vertrag deaktivieren"
 ÿ|ÿñ"VDEAKTIV",4,40,20,186,5,0,""
 ÿ|ÿñ"VDEAKTIV",5,40,28,185,22,0,"Mit dieser Funktion k”nnen Sie einen Vertrag aus der Provisionsabrechnung herausnehmen."
 ÿ|ÿñ"VDEAKTIV",5,40,51,185,18,0,"Klicken Sie auf "ÿÿ(34)ÿ"Ja"ÿÿ(34)ÿ", wenn der Vertrag nicht mehr bei der Provisionsberechnung bercksichtigt werden soll."
 ÿ|ÿñ"VDEAKTIV",5,40,70,184,27,0,"Fhren Sie gegebenenfalls eine Korrekturbuchung durch, um bereits gezahlte Provisionen aus der Buchungsdatei zu entfernen."
 ÿ|ÿñ"VDEAKTIV",1,58,107,55,15,0,"&Ja",1,1
 ÿ|ÿñ"VDEAKTIV",1,116,107,55,15,1,"&Nein",0,0
 ÿñ"VDEAKTIV",req%
 ÿ¾ÿñ"VDEAKTIV"
 ÿ¡req%ÿ1ÿp
tvn%ÿlfdnr.KVERTRAG
ÿÉÿ¥tvn%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ProviAb.KVERTRAGÿ0
ÿƒQuickStore("KVERTRAG")
ÿÊÿË"Vertrag wurde deaktiviert"
 ÿ^
ÿÊÿË"Bereit"
 ÿ’ÿ¡
 ÿ’ÿÿ
 
 ' Vertrag stornieren
 ' =======================================================================
 ' 08.09.95/FA

ÿÿVERTRStorno()
 vnr%ÿlfdnr.KVERTRAG
 cfile$ÿÿ™
 ÿßÿe
 ÿƒDFile(3,"buchung"ÿ_fpw$)
 ÿƒDFile(3,"buchtemp"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿßÿ³
 ÿ¡Storno.KVERTRAGÿ1ÿStorno.KVERTRAGÿ2ÿp
ÿ‰ÿñ"STORNO",0,0,189,87,title$,"MS Sans Serif",8
ÿ|ÿñ"STORNO",9,6,7,22,22,3
ÿ|ÿñ"STORNO",5,32,8,145,10,0,"Der aktuelle Vertrag wurde bereits storniert!"
ÿ|ÿñ"STORNO",5,32,19,149,48,0,"Falls Sie nderungen an den Stornodaten vornehmen wollen, bearbeiten Sie bitte die entsprechenden Buchungss„tze in der Buchungsdatei (Funktion Nachbearbeitung von Buchungss„tzen)."
ÿ|ÿñ"STORNO",1,66,65,55,15,1,"&OK",0,0
ÿñ"STORNO",req%
ÿ¾ÿñ"STORNO"
 ÿ^
ÿÉÿ¥vnr%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿ‰ÿñ"STORNO",0,0,192,162,title$,"MS Sans Serif",8
ÿ|ÿñ"STORNO",4,0,0,192,138,0,""
ÿ|ÿñ"STORNO",9,8,14,20,21,2
ÿ|ÿñ"STORNO",5,33,14,63,10,0,"Vertrag stornieren"
ÿ|ÿñ"STORNO",4,33,21,151,5,0,""
ÿ|ÿñ"STORNO",5,33,30,149,16,0,"Bitte geben Sie an, ob und wie der Vertrag storniert werden soll."
ÿ|ÿñ"STORNO",3,33,54,108,10,0,"Vertrag nicht stornieren",0,storno.kvertrag
ÿ|ÿñ"STORNO",3,33,66,108,10,0,"vollst„ndige Rckbuchung",1,storno.kvertrag
ÿ|ÿñ"STORNO",3,33,78,108,10,0,"anteilige Rckbuchung",2,storno.kvertrag
ÿ|ÿñ"STORNO",3,33,102,98,10,0,"ohne Rckbuchung",3,storno.kvertrag
ÿ|ÿñ"STORNO",5,42,90,23,10,0,"Anteil:"
ÿ|ÿñ"STORNO",6,67,89,22,11,0,0,StornoAnteil.KVERTRAG,20
 
ÿ|ÿñ"STORNO",5,93,90,22,9,0,"% "
ÿ½ ADD DIALOG "STORNO",5,93,90,22,9,0,"% oder"
ÿ½ ADD DIALOG "STORNO",6,121,89,50,11,0,0,StornoBetrag.KVERTRAG,20
ÿ½ ADD DIALOG "STORNO",5,174,90,12,9,0,"DM"
 
ÿ|ÿñ"STORNO",5,34,121,25,10,0,"Datum:"
ÿ|ÿñ"STORNO",6,61,120,43,11,0,0,Kndigung.KVERTRAG,10
ÿ|ÿñ"STORNO",2,113,120,44,11,0,"vorzeitig?","j","n",vorzeitig.KVERTRAG
ÿ|ÿñ"STORNO",1,37,142,55,15,1,"&OK",1,1
ÿ|ÿñ"STORNO",1,96,142,55,15,0,"&Abbrechen",0,0
ÿñ"STORNO",req%
ÿ¾ÿñ"STORNO"
ÿ¡req%ÿ1ÿp
ÿßÿe
ÿ¡Kndigung.KVERTRAGÿ
1ÿpKndigung.KVERTRAGÿÿQ
ÿƒQuickStore("KVERTRAG")
ÿ¡Storno.KVERTRAGÿ1ÿStorno.KVERTRAGÿ2ÿp
ÿÊÿË"Stornobuchung wird durchgefhrt..."
ÿ¾ÿaÿ™"BUCHTEMP"
ÿ½ - Provisionen in Datei BUCHTEMP bernehmen
ÿ™"BUCHUNG"
ÿ£CodeVT.BUCHUNG
ÿÉÿ`
ÿÉÿ¥vnr%ÿ™"BUCHUNG"ÿ£CodeVT.BUCHUNG
ÿØCodeVT.BUCHUNGÿvnr%ÿÿOÿB("BUCHUNG")
	ÿÊÿË"Stornobuchung wird durchgefhrt...(Zahlung vom "ÿÿ(Datum.BUCHUNG,"dd.mm.yy")ÿ")"
	ÿÿ™"BUCHTEMP"
	CodeBU.BUCHTEMPÿÿI("BUCHTEMP",1)
	CodeVT.BUCHTEMPÿCodeVT.BUCHUNG
	CodeMA.BUCHTEMPÿCodeMA.BUCHUNG
	QuickCode.BUCHTEMPÿCodeMA.BUCHTEMPÿ1000000ÿCodeVT.BUCHTEMP
	ÿ¡Storno.KVERTRAGÿ1ÿp
Betrag.BUCHTEMPÿBetrag.BUCHUNG
	ÿ’ÿ¡
	ÿ¡Storno.KVERTRAGÿ2ÿp
Betrag.BUCHTEMPÿBetrag.Buchungÿ100ÿStornoAnteil.KVERTRAG
	ÿ’ÿ¡
	ÿƒQuickStore("BUCHTEMP")
	ÿÉÿ±ÿ™"BUCHUNG"ÿ£CodeVT.BUCHUNG
ÿÙ
ÿ½ - Summen aus BUCHTEMP bilden
ÿ¡ÿA("BUCHTEMP")ÿ0ÿp
	ÿ™"BUCHTEMP"
	ÿ£QuickCode.BUCHTEMP
	ÿÉÿ`
	ÿØÿOÿB("BUCHTEMP")
quickcode%ÿQuickCode.BUCHTEMP
summe%ÿ0
ÿÉÿ¥CodeMA.BUCHTEMPÿ™"MAADR"ÿ£CodeMA.MAADR
ÿÊÿË"Stornobuchung wird durchgefhrt...(Agentur "ÿNachname.MAADRÿ", "ÿVorname.MAADRÿ")"
ÿØQuickCode.BUCHTEMPÿquickcode%ÿÿOÿB("BUCHTEMP")
Summe%ÿSumme%ÿBetrag.BUCHTEMP
ÿÉÿ±ÿ™"BUCHTEMP"ÿ£QuickCode.BUCHTEMP
ÿÙ
ÿ¡summe%ÿ0ÿp
ÿÉÿ¥CodeKU.KVERTRAGÿ™"ADRESSEN"ÿ£CodeKU.ADRESSEN
ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
ÿÉÿ¥CodeVA.KVERTRAGÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
ÿÿ™"BUCHUNG"
CodeBU.BUCHUNGÿÿI("BUCHUNG",1)
Betrag.BUCHUNGÿ0ÿSumme%
Nachname.BUCHUNGÿNachname.ADRESSEN
Vorname.ADRESSENÿVorname.ADRESSEN
Sparte.BUCHUNGÿSparte.SPARTEN
Gesellschaft.BUCHUNGÿGesellschaft.GEADR
VS_Beginn.BUCHUNGÿVS_Beginn.KVERTRAG
Bewertungssumme.BUCHUNGÿBewertungssumme.KVERTRAG
Buchungstext.BUCHUNGÿ"Stornorckbuchung zum Vertrag "ÿVS_NR.KVERTRAG
CodeMA.BUCHUNGÿCodeMA.MAADR
CodeKU.BUCHUNGÿCodeKU.KVERTRAG
CodeVT.BUCHUNGÿlfdnr.KVERTRAG
Datum.BUCHUNGÿKndigung.KVERTRAG
ÿƒQuickStore("BUCHUNG")
ÿ’ÿ¡
ÿ¾ÿaÿ™"BUCHTEMP"ÿĞQuickCode.BUCHTEMPÿQuickCode%
ÿÉÿ`
	ÿÙ
ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ™cfile$
 ÿÊÿË"Bereit"
 ÿ¡ÿœÿ""ÿpÿœ
 ÿßÿ³
 ÿ’ÿÿ
 

 ' vorhandene Stornoreserve fr einen Vertrag ermitteln
 ' wird z.Zt. nur von VStatus() benutzt
 ' =======================================================================
 ' 05.09.95/FA
 
ÿÿGetSR%(vnr%)
 cfile$ÿÿ™
 ÿßÿe
 ÿ¡ÿJ(vnr%,CodeVT.BUCHUNG)ÿp
ÿ™"BUCHUNG"
ÿ£CodeVT.BUCHUNG
ÿÉÿ`
sr%ÿ0
ÿÉÿ¥lfdnr.KVERTRAGÿ™"BUCHUNG"ÿ£CodeVT.BUCHUNG
ÿØCodeVT.BUCHUNGÿlfdnr.KVERTRAGÿÿOÿB("BUCHUNG")
ÿ¡SRgezahlt.BUCHUNGÿ"j"ÿSR.BUCHUNGÿ0ÿp
sr%ÿsr%ÿSR.BUCHUNG
ÿ’ÿ¡
ÿÉÿ±ÿ™"BUCHUNG"ÿ£CodeVT.BUCHUNG
ÿÙ
GetSR%ÿsr%
 ÿ^
GetSR%ÿ0
 ÿ’ÿ¡
 ÿ™cfile$
 ÿßÿ³
 ÿ’ÿÿ


ÿÿVertrKond()
 doprov%ÿEditKond%(CodeKO.KVERTRAG)
 ÿ’ÿÿ

ÿÿEditKond%(kond%)
 _kond%ÿkond%
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"vkond"ÿ_fpw$)
 ÿ×Auswahl$(1)
 ÿ×KondList$(100)
 changing%ÿ1
 ÿØchanging%ÿ1
ok%ÿ1
ÿ›a%ÿ0ÿq100
Kondlist$(a%)ÿ""
ÿ±a%
a%ÿ0
ÿØok%ÿ1
ÿÉÿ¥_kond%ÿ™"VKOND"ÿ£CodeVK.VKOND
ÿÉÿ¥CodeKO.VKONDÿ™"GEKOND"ÿ£lfdnr.GEKOND
ÿÉÿ¥CodeMA.GEKONDÿ™"MAADR"ÿ£CodeMA.MAADR
ListItem$ÿ""
ÿ¡APjn.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Abschluáprovision "ÿÿ(AP.GEKOND,",999.00")
ÿ¡CourtageJN.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Courtage "ÿÿ(Courtage.GEKOND,",999.00")
ÿ¡PflegeJN.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Pflege "ÿÿ(PflegeProvi.GEKOND,",999.00")
ÿ¡VDjn.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Abschluá (LZ)"
ÿ¡TZjn.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Teilzahlung"
ÿ¡PauschaleJN.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Pauschale "ÿÿ(Pauschale.GEKOND,",99999.00")
KondList$(a%)ÿÿ(a%ÿ1,"999")ÿ". "ÿNachname.MAADRÿ", "ÿVorname.MAADRÿListItem$ÿÿ'(120)ÿÿ(CodeVK.VKOND,"000000")
ÿ¡n„chsteKond.VKONDÿ0ÿp
_kond%ÿn„chsteKond.VKOND
a%ÿa%ÿ1
ÿ^
ok%ÿ0
ÿ’ÿ¡
ÿÙ
ÿ½ FOR a% = 1 TO 10
ÿ½   KondList$(a%) = STR$ (a%,"999") + ". " + KondList$(0)
ÿ½ NEXT a%
prompt$ÿKondList$(0)
ÿ‰ÿñ"KONDLIST",0,0,317,160,"Konditionsbersicht","MS Sans Serif",8
ÿ|ÿñ"KONDLIST",4,0,0,316,137,0,""
ÿ|ÿñ"KONDLIST",9,9,11,21,21,2
ÿ|ÿñ"KONDLIST",5,44,15,150,10,0,"Konditionsbersicht fr den aktuellen Vertrag:"
ÿ|ÿñ"KONDLIST",5,44,29,262,18,0,"Best„tigen Sie mit "ÿÿ(34)ÿ"OK"ÿÿ(34)ÿ" die Richtigkeit der gefundenen Konditonen oder w„hlen Sie die richtigen Konditionen aus."
ÿ|ÿñ"KONDLIST",5,44,49,256,23,0,"Um eine der angezeigten Konditionen zu „ndern, w„hlen Sie mit der Maus eine Kondition aus und klicken anschlieáend auf die Schaltfl„che "ÿÿ(34)ÿ"ndern"ÿÿ(34)ÿ"."
ÿ|ÿñ"KONDLIST",7,44,78,262,49,2,2,KondList$,Auswahl$,prompt$
ÿ|ÿñ"KONDLIST",1,71,142,55,15,0,"&ndern",2,1
ÿ|ÿñ"KONDLIST",1,129,142,55,15,1,"&OK",1,1
ÿ|ÿñ"KONDLIST",1,187,142,55,15,0,"&Abbrechen",0,0
ÿñ"KONDLIST",req%
ÿ¾ÿñ"KONDLIST"
ÿ¡req%ÿ1ÿp
EditKond%ÿ1
changing%ÿ0
ÿ’ÿ¡
ÿ¡req%ÿ0ÿp
EditKond%ÿ0
changing%ÿ0
ÿ’ÿ¡
ÿ¡req%ÿ2ÿpÿƒChangeKond(ÿ0(ÿ-(Auswahl$(0),6)))
_kond%ÿkond%
 ÿÙ
 ÿ’ÿÿ
 
ÿÿChangeKond(ckond%)
 ÿ½ REQUEST STR$ (ckond%,"000000")
 ÿ×KondFound$(ÿA("GEKOND"))
 ÿ×Auswahl$(1)
 ÿÉÿ¥ckond%ÿáÿ™"VKOND"ÿ£CodeVK.VKOND
 ÿÉÿ¥CodeKO.VKONDÿ™"GEKOND"ÿ£lfdnr.GEKOND
 ÿÉÿ¥CodeMA.GEKONDÿ™"MAADR"ÿ£CodeMA.MAADR
 _cuko%ÿlfdnr.GEKOND
 geadr%ÿCodeGE.GEKOND
 sparte%ÿCodeVA.GEKOND
 ma%ÿCodeMA.GEKOND
 ÿ™"GEKOND"
 ÿ£QuickCode.GEKOND
 scode$ÿÿ(ma%,"000000")ÿÿ(geadr%,"000000")ÿÿ(sparte%,"000000")
 ÿÉÿ`
 ÿÉÿ¥scode$ÿ™"GEKOND"ÿ£QuickCode.GEKOND
 a%ÿ0
 prompt$ÿ""
 ÿØQuickCode.GEKONDÿscode$ÿÿOÿB("GEKOND")
ÿ¡BWvon.GEKONDÿ
1ÿpBWvon$ÿ"__.__.__"ÿ^BWvon$ÿÿ(BWvon.GEKOND,"0d.mm.yy")
ÿ¡BWbis.GEKONDÿ
1ÿpBWbis$ÿ"__.__.__"ÿ^BWbis$ÿÿ(BWbis.GEKOND,"0d.mm.yy")
ListItem$ÿ""
ÿ¡APjn.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Abschluáprovision "ÿÿ(AP.GEKOND,",999.00")
ÿ¡CourtageJN.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Courtage "ÿÿ(Courtage.GEKOND,",999.00")
ÿ¡PflegeJN.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Pflege "ÿÿ(PflegeProvi.GEKOND,",999.00")
ÿ¡VDjn.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Abschluá (LZ)"
ÿ¡TZjn.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Teilzahlung"
ÿ¡PauschaleJN.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Pauschale "ÿÿ(Pauschale.GEKOND,",99999.00")
KondFound$(a%)ÿBWvon$ÿ"-"ÿBWbis$ÿListItem$ÿÿ'(120)ÿÿ(lfdnr.GEKOND,"000000")
ÿ¡lfdnr.GEKONDÿ_cuko%ÿpprompt$ÿKondFound$(a%)
a%ÿa%ÿ1
ÿÉÿ±ÿ™"GEKOND"ÿ£QuickCode.GEKOND
 ÿÙ
 ÿ¡prompt$ÿ""ÿpprompt$ÿKondFound$(0)
 ÿ¡a%ÿ0ÿpa%ÿa%ÿ1
 ÿÉÿ¥geadr%ÿ™"GEADR"ÿ£CodeGE.GEADR
 ÿÉÿ¥sparte%ÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 ÿ‰ÿñ"SELGEKOND",0,0,326,251,"Konditionsauswahl: "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ"., "ÿGesellschaft.GEADRÿ"/"ÿSparte.SPARTEN,"MS Sans Serif",8
 ÿ|ÿñ"SELGEKOND",4,0,0,325,220,0,""
 ÿ|ÿñ"SELGEKOND",9,9,16,21,25,2
 ÿ|ÿñ"SELGEKOND",5,38,16,205,10,0,"W„hlen Sie die Kondition aus, die Sie bernehmen m”chten:"
 ÿ|ÿñ"SELGEKOND",5,40,31,130,9,0,"Bewertungszeitraum, Kondition"
 ÿ|ÿñ"SELGEKOND",7,40,42,279,169,2,2,KondFound$,Auswahl$,prompt$
 ÿ|ÿñ"SELGEKOND",1,94,227,58,17,1,"&OK",1,1
 ÿ|ÿñ"SELGEKOND",1,154,227,60,17,0,"&Abbrechen",0,0
 ÿñ"SELGEKOND",req%
 ÿ¾ÿñ"SELGEKOND"
 ÿ¡req%ÿ1ÿp
CodeKO.VKONDÿÿ0(ÿ-(Auswahl$(0),6))
ÿÌÿ™"VKOND"
 ÿ’ÿ¡
 ÿ’ÿÿ
 
 



 ' KVERTRAG Konditionen prfen
 ' =======================================================================
ÿÿKonditionOK%(vertrag%,ProviAb%)
 ÿßÿe
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿÊÿË"Prfung der Konditionen"
 ÿ×FehlerListe$(40)
 FehlerIndex%ÿ0
 cfile$ÿÿ™
 ÿÉÿ¥vertrag%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 _cuvt%ÿlfdnr.KVERTRAG
 codema%ÿCodeMA.kvertrag
 codege%ÿCodeGE.kvertrag
 codeva%ÿCodeVA.kvertrag
 KonditionOK%ÿ0
 ÿØCodeMA%ÿ0
ÿ™"GEKOND"
ÿ½ ### Andi Anfang
ÿÉÿĞ
ÿ£QuickCode.gekond:ÿ½ Fred
ÿÉÿ`
ÿ½ ### Andi Ende
SCode$ÿÿ(CodeMA%,"000000")ÿÿ(CodeGE%,"000000")ÿÿ(CodeVA%,"000000")
ÿÉÿ¥codema%ÿ™"maadr"ÿ£CodeMA.MAADR
ÿÉÿ¥SCode$ÿ™"gekond"ÿ£QuickCode.gekond
ÿ¡ÿC("GEKOND")ÿp
ÿØnotfound%ÿ1ÿQuickCode.GEKONDÿSCode$
ÿ½ -- Bewertungszeitraum ermitteln ----------------------------------------
ÿ¡ÿ1(BWvon.GEKOND)ÿ
1ÿpBWvon%ÿÿ1("1.1.80")ÿ^BWvon%ÿÿ1(BWvon.GEKOND)
ÿ¡ÿ1(BWbis.GEKOND)ÿ
1ÿpBWbis%ÿÿ1("31.12.1999")ÿ^BWbis%ÿÿ1(BWbis.GEKOND)
ÿ¡ProviAb%ÿBWvon%ÿProviAb%ÿ	BWbis%ÿp
	notfound%ÿ0
ÿ^
	ÿÉÿ±ÿ™"gekond"ÿ£QuickCode.GEKOND
ÿ’ÿ¡
ÿÙ
ÿ¡notfound%ÿ1ÿp
FehlerListe$(FehlerIndex%)ÿ"keine Kondition fr gesuchten Zeitraum/"ÿNachname.maadr
FehlerIndex%ÿFehlerIndex%ÿ1
ÿ’ÿ¡
ÿ^
FehlerListe$(FehlerIndex%)ÿ"keine passende Kondition gefunden/"ÿNachname.maadr
FehlerIndex%ÿFehlerIndex%ÿ1
ÿ’ÿ¡
ÿ¡CodeMA.MAADRÿVorg„nger.MAADRÿp
CodeMA%ÿ0
ÿ^
CodeMA%ÿVorg„nger.MAADR
ÿ’ÿ¡
 ÿÙ
 ÿ¡FehlerIndex%ÿ0ÿp
ÿ‰ÿñ"KONDPRUEF",0,0,350,144,"Fehlerliste","MS Sans Serif",8
ÿ|ÿñ"KONDPRUEF",9,6,6,20,21,1
ÿ|ÿñ"KONDPRUEF",5,33,8,213,9,0,"Bei der Prfung der Konditionen sind folgende Fehler aufgetreten:"
ÿ|ÿñ"KONDPRUEF",7,33,23,310,100,0,0,FehlerListe$,Auswahl$
ÿ|ÿñ"KONDPRUEF",1,156,124,55,15,1,"&OK",0,0
ÿñ"KONDPRUEF"
ÿ¾ÿñ"KONDPRUEF"
KonditionOK%ÿ0
 ÿ^
KonditionOK%ÿÿ1
 ÿ’ÿ¡
 ÿÊÿË"Bereit"
 ÿ™cfile$
 ÿßÿe
 ÿ’ÿÿ
 

 ' Kondition fr Vertrag ausw„hlen
 ' ========================================================================
 
ÿÿKondAuswahl%(CodeVT%,ProviAb%)
 cfile$ÿÿ™
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 KONDIND%ÿ0
 ÿÉÿ¥CodeVT%ÿ™"kvertrag"ÿ£lfdnr.kvertrag
 CodeMA%ÿCodeMA.kvertrag
 CodeGE%ÿCodeGE.kvertrag
 CodeVA%ÿCodeVA.kvertrag
 SCode$ÿÿ(CodeMA%,"000000")ÿÿ(CodeGE%,"000000")ÿÿ(CodeVA%,"000000")
 ÿ™"gekond"
 ÿ£QuickCode.gekond
 ÿÉÿ`
 ÿÉÿ¥SCode$ÿ™"gekond"ÿ£QuickCode.gekond
 ÿØ(QuickCode.gekondÿSCode$)ÿ(KONDIND%ÿ
80)ÿÿOÿB("gekond")

ÿ½ -- Bewertungszeitraum testen --

ÿ¡ÿ1(BWvon.GEKOND)ÿ
1ÿpBWvon%ÿÿ1("1.1.80")ÿ^BWvon%ÿÿ1(BWvon.GEKOND)
ÿ¡ÿ1(BWbis.GEKOND)ÿ
1ÿpBWbis%ÿÿ1("31.12.99")ÿ^BWbis%ÿÿ1(BWbis.GEKOND)
ÿ¡ProviAb%ÿBWvon%ÿProviAb%ÿ	BWbis%ÿp
ListItem$ÿ""
ÿ¡APjn.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Abschluáprovision "ÿÿ(AP.GEKOND,",999.00")
ÿ¡CourtageJN.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Courtage "ÿÿ(Courtage.GEKOND,",999.00")
ÿ¡PflegeJN.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Pflege "ÿÿ(PflegeProvi.GEKOND,",999.00")
ÿ¡VDjn.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Abschluá (LZ)"
ÿ¡TZjn.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Teilzahlung"
ÿ¡PauschaleJN.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Pauschale "ÿÿ(Pauschale.GEKOND,",99999.00")
GEKOND$(KONDIND%)ÿListItem$ÿÿ'(120)ÿÿ(lfdnr.gekond,"000000")
KONDIND%ÿKONDIND%ÿ1
ÿ’ÿ¡
ÿÉÿ±ÿ™"gekond"ÿ£QuickCode.gekond

 ÿÙ
 ÿ¡KONDIND%ÿ0ÿp
ÿ‰ÿñ"KONDSEL",0,0,314,134,"Konditionen","MS Sans Serif",8
ÿ|ÿñ"KONDSEL",9,5,3,19,22,3
ÿ|ÿñ"KONDSEL",5,34,3,182,8,0,"W„hlen Sie aus der nachfolgenden Liste die"
ÿ|ÿñ"KONDSEL",5,34,12,196,10,0,"Kondition aus, mit der der Vertrag provisioniert werden soll:"
ÿ|ÿñ"KONDSEL",7,34,24,272,81,2,0,GEKOND$,Auswahl$
ÿ|ÿñ"KONDSEL",1,110,110,48,16,1,"&OK",1,1
ÿ|ÿñ"KONDSEL",1,162,110,51,16,0,"&Abbrechen",0,0
ÿñ"KONDSEL",req%
ÿ¾ÿñ"KONDSEL"
ÿ¡req%ÿ1ÿp
KondAuswahl%ÿÿ0(ÿ-(Auswahl$(0),6))
ÿ^
KondAuswahl%ÿ0
ÿ’ÿ¡
 ÿ^
KondAuswahl%ÿ0
 ÿ’ÿ¡
 ÿ™cfile$
 ÿÊÿË"Bereit"
 ÿ’ÿÿ


 

 ' Auswahl Gesellschaft
 ' =======================================================================
 ' 13.07.94/FA - in SUB ge„ndert

ÿÿSGeadr()
 ÿ¡ÿ°("kvertrag")ÿÿ("kvertrag")ÿpÿƒFStore("kvertrag")
 cuge%ÿCodeGE.kvertrag
 cuvt%ÿlfdnr.kvertrag
 ÿÉÿ¥vcodema%ÿ™"SUPERVIS"ÿ£CodeMA.supervis
 ÿ¡ProviAb ÿ1ÿMNdisabled%("SUPERVISOR")ÿp
ÿÂ"Die Gesellschaft kann nach erfolgter Provisionierung","nicht mehr ge„ndert werden!",0
 ÿ^
rep%ÿGetCodeGE%(cuge%)
ÿ¡rep%ÿ0ÿp
ÿßÿe
ÿÉÿ¥cuvt%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
CodeGE.kvertragÿrep%
ÿƒFStore("KVERTRAG")
ÿÉÿœÿ¥cuvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿœ
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿßÿ³
 ÿ’ÿÿ
 

 ' Auswahl Sparte
 ' =======================================================================
 ' 13.07.94/FA - in SUB ge„ndert

ÿÿSCodeva()
 ÿ¡ÿ°("kvertrag")ÿÿ("kvertrag")ÿpÿƒFStore("kvertrag")
 ÿÉÿ¥vcodema%ÿ™"SUPERVIS"ÿ£CodeMA.supervis
 ÿ¡ProviAb ÿ1ÿMNdisabled%("SUPERVISOR")ÿp
ÿÂ"Die Sparte kann nach erfolgter Provisionierung","nicht mehr ge„ndert werden!",0
 ÿ^
cuva%ÿCodeVA.kvertrag
cuvt%ÿlfdnr.kvertrag
rep%ÿGetCodeVA%(cuva%)
ÿ¡rep%ÿ0ÿp
ÿßÿe
ÿÉÿ¥cuvt%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
CodeVA.kvertragÿrep%
ÿƒFStore("KVERTRAG")
ÿÉÿœÿ¥cuvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿœ
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿßÿ³
 ÿ’ÿÿ


 ' Auswahl Agentur 
 ' =======================================================================
 ' 13.07.94/FA - in SUB ge„ndert

ÿÿSMaadr()
 ÿ¡ÿ°("kvertrag")ÿÿ("kvertrag")ÿpÿƒFStore("kvertrag")
 ÿÉÿ¥vcodema%ÿ™"SUPERVIS"ÿ£CodeMA.supervis
 ÿ¡ProviAb ÿ1ÿMNdisabled%("SUPERVISOR")ÿp
ÿÂ"Die Agentur kann nach erfolgter Provisionierung","nicht mehr ge„ndert werden!",0
 ÿ^
cuma%ÿCodeMA.kvertrag
cuvt%ÿlfdnr.kvertrag
_cuma%ÿGetCodeMA%(cuma%)
ÿ¡_cuma%ÿ0ÿp
ÿßÿe
ÿÉÿ¥cuvt%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
CodeMA.kvertragÿ_cuma%
ÿƒFStore("KVERTRAG")
ÿÉÿœÿ¥cuvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿœ
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿßÿ³
 ÿ’ÿÿ


 '      ********************************************************
 '      ** Routinen fr Formular "GEADR" - Gesellschaftsdaten ** 
 '      ********************************************************

ÿÿGEADR()
 ÿ¡disabled%("GEADR")ÿpÿ’ÿÿ
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿ™"GEADR"
 _formend%ÿ0
 ÿØ_formend%ÿ0
ÿ¡ÿ>(ÿœ)ÿ"GEADR"ÿp
ÿÊÿŸtitle$ÿ" - Gesellschaften"
ÿ´ÿœ"GEADR"
ÿƒGEADRIntro()
ÿƒMNGEADR()
ÿÊÿË"Gesellschaften"
ÿ’ÿ¡
ÿ¬ÿ³
ÿßÿ³
GEADRsub%ÿ0
ÿƒClearKBDBuffer()
ÿœ
ÿ¡GEADRsub%ÿ99ÿpÿÏÿ¥ÿÿ¬ÿÿß
ÿ½ ** Tastaturabfrage
ÿk$
ÿÉÿæÿ.(k$)
ÿæCrsLeft%,PgUp%
ÿƒPSelectPrev()
ÿæCrsRight%,PgDn%
ÿƒPSelectNext()
ÿ’ÿÉ
ÿÉÿæGEADRsub%
ÿæ1
ÿƒLIST4()
ÿæ99
ÿ¡ÿA("geadr")ÿ0ÿpÿƒGEADRNeu()
ÿ¡ÿíÿ1ÿp
ÿ”gesellschaft.geadr,0
ÿ^
ÿ”b1.geadr,0
ÿ’ÿ¡
ÿ’ÿÉ
 ÿÙ
 _formend%ÿ0
 ÿ’ÿÿ


 ' GEADR Intro
 ' =======================================================================

ÿÿGEADRIntro()
 ÿ£Gesellschaft.geadr
 ÿ¡cuge%ÿ0ÿp
ÿÉÿ¥cuge%ÿ™"geadr"ÿ£CodeGE.geadr
 ÿ^
ÿÉÿ`
 ÿ’ÿ¡
 ÿœ
 ÿ£gesellschaft.geadr
 ÿ’ÿÿ


 ' GEADR Neu
 ' =======================================================================

ÿÿGEADRNeu()
 ÿ¡gesellschaft.geadrÿ""ÿpÿƒFStore(ÿ™)
 ÿ
 ÿÊÿË"Datensatz neu angelegt..."
 CodeGE.geadrÿÿI("geadr",1)
 ÿœ
 GEADRsub%ÿ99
 ÿ’ÿÿ


 ' GEADR Suchen
 ' =======================================================================

ÿÿGEADRSuchen()
 cuge%ÿcodege.geadr
 ÿ¡(ÿ("geadr")ÿÿ°("geadr"))ÿgesellschaft.geadrÿ""ÿpÿƒFStore("GEADR")
 rep%ÿGetCodeGE%(cuge%)
 ÿ¡rep%ÿ0ÿpcuge%ÿrep%
 ÿÉÿ¥cuge%ÿ£codege.geadr
 ÿÊÿ£Gesellschaft.geadr
 ÿ£gesellschaft.geadr
 ÿßÿ³
 ÿœ
 ÿ’ÿÿ

 
ÿÿGEADRSichern()
 ÿƒFStore("GEADR")
 ÿ”ÿ’
 ÿ’ÿÿ

ÿÿGetCodeGE%(prompt%)
 ÿ×Gesellschaften$(ÿA("GEADR")ÿ1)
 ÿ×Auswahl$(1)
 cfile$ÿÿ™
 _pos%ÿCodeGE.GEADR
 ÿ™"GEADR"
 ÿ£Gesellschaft.GEADR
 ÿÉÿ`
 Gesellschaften$(0)ÿ"<keine Zuordnung>"ÿÿ'(120)ÿ"000000"
 a%ÿ1
 prompt$ÿ""
 ÿßÿe
 ÿØÿOÿB("GEADR")
Gesellschaften$(a%)ÿGesellschaft.GEADRÿÿ'(120)ÿÿ(CodeGE.GEADR,"000000")
ÿ¡CodeGE.GEADRÿprompt%ÿpprompt$ÿGesellschaften$(a%)
ÿÉÿ±
a%ÿa%ÿ1
 ÿÙ
 ÿ‰ÿñ"MASUCH",0,0,208,188,"Gesellschaftsbersicht","MS Sans Serif",8
 ÿ|ÿñ"MASUCH",4,0,0,208,163,0,""
 ÿ|ÿñ"MASUCH",9,9,11,21,21,2
 ÿ|ÿñ"MASUCH",5,37,11,151,10,0,"Bitte w„hlen Sie aus der folgenden Liste aus:"
 ÿ|ÿñ"MASUCH",7,37,27,164,129,0,2,Gesellschaften$,Auswahl$,prompt$
 ÿ|ÿñ"MASUCH",1,46,168,55,15,1,"&OK",1,1
 ÿ|ÿñ"MASUCH",1,103,168,55,15,0,"&Abbrechen",0,0
 ÿßÿ³
 ÿñ"MASUCH",req%
 ÿ¾ÿñ"MASUCH"
 ÿ¡req%ÿ1ÿp
GetCodeGE%ÿÿ0(ÿ-(Auswahl$(0),6))
 ÿ^
GetCodeGE%ÿ0
 ÿ’ÿ¡
 ÿÉÿ¥_pos%ÿ™"GEADR"ÿ£CodeGE.GEADR
 ÿ™cfile$
 ÿ’ÿÿ


ÿÿGEADRLoeschen()
 ÿ¡disabled%("GEADRLOESCHEN")ÿpÿ’ÿÿ
 ÿßÿe
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"gekondm"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(3,"buchung"ÿ_fpw$)
 cuge%ÿCodeGE.GEADR
 Dateien$ÿ""
 ok%ÿ1
 ÿ¡ÿJ(cuge%,CodeGE.KVERTRAG)ÿp
ok%ÿ0
Dateien$ÿDateien$ÿ", Vertr„ge"
 ÿ’ÿ¡
 ÿ¡ÿJ(cuge%,CodeGE.GEKOND)ÿp
ok%ÿ0
Dateien$ÿDateien$ÿ", Konditionen"
 ÿ’ÿ¡
 ÿ¡ÿJ(cuge%,CodeGE.GEKONDM)ÿp
ok%ÿ0
Dateien$ÿDateien$ÿ", Musterkonditionen"
 ÿ’ÿ¡
 ÿßÿ³
 ÿ¡ok%ÿ0ÿp
Dateien$ÿÿ-(Dateien$,ÿ/(Dateien$)ÿ2)
ÿƒFehler("L”schen nicht m”glich!","Es existieren Verknpfungen zu den Dateien: "ÿDateien$ÿ".")
ÿÊÿË"Datensatz konnte nicht gel”scht werden"
 ÿ^
ÿßÿe
ÿÂ"Wollen Sie die Gesellschaft "ÿGesellschaft.GEADRÿ" l”schen?","",135,req%
ÿ¡req%ÿ1ÿp
ÿÉÿ¥cuge%ÿáÿ™"GEADR"ÿ£CodeGE.GEADR
ÿÉÿ¾
ÿÊÿË"Datensatz wurde gel”scht"
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿœ
 ÿßÿ³
 ÿ’ÿÿ




 ' Mahnliste fr fehlende Zahlungseing„nge
 ' ====================================================================== 

ÿÿMAHNLIST()
 ÿßÿe
 ÿ¡disabled%("MAHNLIST")ÿpÿ’ÿÿ
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 cuge%ÿCodeGE.GEADR
 ÿ×Gesellschaft$(ÿA("GEADR"))
 a%ÿ0
 ÿ™"GEADR"
 ÿ£CodeGE.GEADR
 prompt$ÿ"ZZZZZZZ"
 ÿÉÿ`
 ÿØÿOÿB("GEADR")
Gesellschaft$(a%)ÿGesellschaft.GEADRÿÿ'(120)ÿÿ(CodeGE.GEADR,"000000")
ÿ¡ÿœÿ"*geadr*"ÿp
ÿ¡CodeGE.GEADRÿcuge%ÿpprompt$ÿGesellschaft$(a%)
opt%ÿ2
ÿ^
opt%ÿ1
ÿ¡Gesellschaft$(a%)ÿ
prompt$ÿpprompt$ÿGesellschaft$(a%)
ÿ’ÿ¡
a%ÿa%ÿ1
ÿÉÿ±
 ÿÙ
 Auswahl$ÿprompt$
 ÿßÿ³
 ÿ‰ÿñ"GELIST",0,0,195,136,title$,"MS Sans Serif",8
 ÿ|ÿñ"GELIST",4,0,0,195,111,0,""
 ÿ|ÿñ"GELIST",9,5,10,20,23,2
 ÿ|ÿñ"GELIST",5,30,11,158,24,0,"Ausgabe der Mahnliste"
 ÿ|ÿñ"GELIST",5,30,24,156,26,0,"Bitte w„hlen Sie aus, ob Sie die Daten einer einzelnen oder aller Gesellschaften ausgeben wollen."
 ÿ|ÿñ"GELIST",5,30,54,44,10,0,"Ausgabe fr"
 ÿ|ÿñ"GELIST",3,30,64,98,12,0,"alle Gesellschaften",1,opt%
 ÿ|ÿñ"GELIST",3,30,76,154,12,0,"einzelne Gesellschaft",2,opt%
 ÿ|ÿñ"GELIST",8,40,90,145,50,259,2,Auswahl$,Gesellschaft$
 ÿ|ÿñ"GELIST",1,40,113,55,15,1,"&OK",1,1
 ÿ|ÿñ"GELIST",1,96,113,55,15,0,"&Abbrechen",0,0
 ÿñ"GELIST",req%
 ÿ¾ÿñ"GELIST"
 ÿ¡req%ÿ1ÿp
ÿßÿe
ÿÁÿs"BMAHN1"
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
ÿGesellschaft.GEADR,Pool.KVERTRAGÿU"PoolSumme%"
ÿ€ÿGesellschaft.GEADR
ÿÊÿÁÿí"H_Gesellscha002"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿGesellschaft.GEADR
ÿÊÿÁÿí"F_Gesellscha002"
ÿ¶ÿÁÿí
ÿ‘ÿÁ
ÿ’ÿ
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿÊÿiÿ³
ÿÊÿiÿáÿe
ÿ³ÿ_ÿwErrorMAHNLIST
ÿ¡opt%ÿ1ÿp
ÿÉ;
ÿĞCodeKU.KVERTRAGÿCodeKU.ADRESSENÿCodeVA.KVERTRAGÿCodeVA.SPARTENÿCodeGE.KVERTRAGÿCodeGE.GEADRÿCodeMA.KVERTRAGÿCodeMA.MAADRÿPool.KVERTRAGÿ
0ÿCheck.KVERTRAGÿ"j"
ÿµÿÁKunde$,Sparte.SPARTEN
ÿqÿ~
ÿ^
ÿÉ;
ÿĞCodeKU.KVERTRAGÿCodeKU.ADRESSENÿCodeVA.KVERTRAGÿCodeVA.SPARTENÿCodeGE.KVERTRAGÿCodeGE.GEADRÿCodeMA.KVERTRAGÿCodeMA.MAADRÿPool.KVERTRAGÿ
0ÿCheck.KVERTRAGÿ"j"ÿCodeGE.KVERTRAGÿÿ0(ÿ-(Auswahl$,6))
ÿµÿÁKunde$,Sparte.SPARTEN
ÿqÿ~
ÿ’ÿ¡
 ÿ’ÿ¡
ErrorMAHNLIST: 
 ÿ¡test%ÿ0ÿpÿ³ÿ_ÿwErrorHandler ÿ^ÿ³ÿ_
 ÿÉÿ¥cuge%ÿ™"GEADR"ÿ£CodeGE.GEADR
 ÿœ
 ÿßÿ³
 ÿ’ÿÿ


 '      ************************************************
 '      ** Routinen fr Formular "GEKOND" Konditionen **
 '      ************************************************

ÿÿGEKOND()
 ÿ¡disabled%("GEKOND")ÿpÿ’ÿÿ
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿ™"gekond"
 ÿ£QuickCode.GEKOND
 ÿÉÿ¥ÿ(cuma%,"000000")ÿ£QuickCode.GEKOND
 _continue%ÿ1
 ÿ¡CodeMA.GEKONDÿcuma%ÿp
_continue%ÿ0
ÿÂ"Es wurden noch keine Konditionen fr "ÿnachname.maadrÿ" erfaát!","Konditionen erfassen?",130,req%
ÿ¡req%ÿ1ÿp
_continue%ÿ1
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡_continue%ÿ1ÿp
_formend%ÿ0
ÿØ_formend%ÿ0
GEKONDsub%ÿ0
ÿ¡ÿ>(ÿœ)ÿ"GEKOND"ÿp
ÿÊÿŸtitle$ÿ" - Konditionen"
ÿ´ÿœ"gekond"
ÿƒGEKONDIntro()
ÿƒMNGEKOND()
ÿ¬ÿ³
ÿÊÿË"Konditionsverwaltung"
ÿ’ÿ¡
ÿßÿ³
ÿƒClearKBDBuffer()
ÿƒGEKONDUpdate()
ÿ¡GEKONDsub%ÿ99ÿpÿÏÿßÿÿ¥ÿÿ¬

ÿ½ ** Tastaturabfrage
ÿk$
ÿÉÿæÿ.(k$)
ÿæCrsLeft%,PgUp%
ÿƒGEKONDPrev()
ÿæCrsRight%,PgDn%
ÿƒGEKONDNext()
ÿ’ÿÉ
 
ÿÉÿæGEKONDsub%
ÿæ1
ÿƒGEKONDSuchen()
ÿæ99
ÿ¡ÿíÿ1ÿpÿ”BWvon.gekond,0
ÿ¡ÿíÿ2ÿpÿ”TZ0.gekond,0
ÿ’ÿÉ
GEKONDsub%ÿ0
ÿÙ
 ÿ’ÿ¡
 _formend%ÿ0
 ÿ™"maadr"
 cuko%ÿ0
 ÿ’ÿÿ


 ' GEKOND Intro
 ' =======================================================================

ÿÿGEKONDIntro()
 ÿ™"gekond"
 ÿ£QuickCode.GEKOND
 ÿÉÿ`
 scode$ÿÿ(cuma%,"000000")ÿ"000000"
 ÿÉÿœÿ¥scode$ÿ™"GEKOND"ÿ£QuickCode.GEKOND
 ÿ¡cuma%ÿCodeMA.gekondÿp
ÿƒGEKONDNeu()
 ÿ^
ÿ¡cuko%ÿ0ÿp
ÿÉÿœÿ¥cuko%ÿ™"GEKOND"ÿ£lfdnr.GEKOND
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿÊÿ£QuickCode.GEKOND
 ÿ£QuickCode.GEKOND
 ÿœ
 ÿ’ÿÿ

ÿÿGEKONDUpdate()
 ÿÉÿ¥CodeGE.GEKONDÿ™"GEADR"ÿ£CodeGE.GEADR
 ÿÉÿ¥CodeVA.GEKONDÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 ÿÉÿ¥CodeMA.GEKONDÿ™"MAADR"ÿ£CodeMA.MAADR
 Gesellschaft$ÿÿ¡(ÿC("GEADR"),Gesellschaft.GEADR,"<keine Zuordnung>")
 Sparte$ÿÿ¡(ÿC("SPARTEN"),Sparte.SPARTEN,"<keine Zuordnung>")
 Agentur$ÿNachname.MAADRÿ", "ÿVorname.MAADR
 ÿœ
 ÿ’ÿÿ



 ' GEKOND Neu
 ' =======================================================================

ÿÿGEKONDNeu()
 ÿ¡ÿ°("gekond")ÿÿ("gekond")ÿpÿƒFStore("gekond")
 ÿ™"GEKOND"
 ÿÿœ
 ÿÊÿË"Datensatz neu angelegt..."
 lfdnr.gekondÿÿI("gekond",1)
 codema.gekondÿcuma%
 ÿƒGEKONDUpdate()
 ÿÉÿ¥cuma%ÿ™"maadr"ÿ£codema.maadr
 GEKONDsub%ÿ99
 ÿœ
 ÿ’ÿÿ


 ' GEKOND Eintrag zurck
 ' =======================================================================

ÿÿGEKONDPrev()
 ÿ™"GEKOND"
 ÿ¡ÿ("GEKOND")ÿÿ°("GEKOND")ÿpÿƒFStore("GEKOND")
 cuko%ÿlfdnr.gekond
 ÿÊÿ£QuickCode.GEKOND
 ÿÉÿœÿgÿ£QuickCode.gekond
 ÿ¡(codema.gekondÿcuma%)ÿgekondtr%ÿ0ÿp
ÿÂ"Keine weiteren Konditionen!","",2
ÿÉÿœÿ¥cuko%ÿ£lfdnr.gekond
 ÿ’ÿ¡
 ÿœ
 ÿ’ÿÿ


 ' GEKOND Eintrag vor
 ' =======================================================================

ÿÿGEKONDNext()
 ÿ™"GEKOND"
 ÿ¡ÿ("GEKOND")ÿÿ°("GEKOND")ÿpÿƒFStore("GEKOND")
 cuko%ÿlfdnr.gekond
 ÿÊÿ£QuickCode.GEKOND
 ÿÉÿœÿ±ÿ£QuickCode.GEKOND
 ÿ¡(codema.gekondÿcuma%)ÿgekondtr%ÿ0ÿp
ÿÂ"Keine weiteren Konditionen!","",2
ÿÉÿœÿ¥cuko%ÿ£lfdnr.gekond
 ÿ’ÿ¡
 ÿœ
 ÿ’ÿÿ


 ' GEKOND Suchen
 ' =======================================================================

ÿÿGEKONDSuchen()
 kond%ÿFindKond%(CodeMA.GEKOND)
 ÿ¡kond%ÿ0ÿp
ÿÉÿœÿ¥kond%ÿ£lfdnr.gekond
kuko%ÿkond%
 ÿ’ÿ¡
 ÿÊÿ£QuickCode.GEKOND
 ÿ£QuickCode.GEKOND
 ÿœ
 ÿ’ÿÿ

ÿÿGEKONDLoeschen()
 ÿ¡disabled%("GEKONDLOESCHEN")ÿpÿ’ÿÿ
 ÿ™"GEKOND"
 ÿßÿe
 ÿƒDFile(3,"vkond"ÿ_fpw$)
 cuko%ÿlfdnr.GEKOND
 Dateien$ÿ""
 ok%ÿ1
 ÿ¡ÿJ(cuko%,CodeKO.VKOND)ÿp
ok%ÿ0
Dateien$ÿDateien$ÿ", Vertr„ge"
 ÿ’ÿ¡
 ÿßÿ³
 ÿ¡ok%ÿ0ÿp
Dateien$ÿÿ-(Dateien$,ÿ/(Dateien$)ÿ2)
ÿƒFehler("L”schen nicht m”glich!","Es existieren Verknpfungen zu den Dateien: "ÿDateien$ÿ".")
ÿÊÿË"Datensatz konnte nicht gel”scht werden"
 ÿ^
ÿßÿe
ÿÂ"Wollen Sie die aktuelle Kondition wirklich l”schen?","",135,req%
ÿ¡req%ÿ1ÿp
ÿÉÿ¥cuko%ÿáÿ™"GEKOND"ÿ£lfdnr.GEKOND
ÿÉÿ¾ÿ™"GEKOND"
ÿÊÿË"Datensatz wurde gel”scht"
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿœ
 ÿßÿ³
 ÿ’ÿÿ
 
 
 
ÿÿFindKond%(ma%)
 cuge%ÿCodeGE.GEKOND
 cuva%ÿCodeVA.GEKOND
 cuko%ÿlfdnr.GEKOND
 cfile$ÿÿ™
 ÿ×LGesellsch$(ÿA("GEADR"))
 ÿ×LSparten$(ÿA("SPARTEN"))
 ÿ×AuswGEADR$(1)
 ÿ×AuswSPARTEN$(1)
 ÿ™"GEADR"
 ÿ£CodeGE.GEADR
 ÿÉÿ`
 a%ÿ0
 ÿØÿOÿB("GEADR")
LGesellsch$(a%)ÿGesellschaft.GEADRÿÿ'(120)ÿÿ(CodeGE.GEADR,"000000")
ÿ¡CodeGE.GEADRÿcuge%ÿpgprompt$ÿLGesellsch$(a%)
a%ÿa%ÿ1
ÿÉÿ±ÿ™"GEADR"ÿ£CodeGE.GEADR
 ÿÙ
 ÿ™"SPARTEN"
 ÿ£CodeVA.SPARTEN
 ÿÉÿ`
 a%ÿ0
 ÿØÿOÿB("SPARTEN")
LSparten$(a%)ÿSparte.SPARTENÿÿ'(120)ÿÿ(CodeVA.SPARTEN,"000000")
ÿ¡CodeVA.SPARTENÿcuva%ÿpsprompt$ÿLSparten$(a%)
a%ÿa%ÿ1
ÿÉÿ±ÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 ÿÙ
 ÿÉÿ¥ma%ÿ™"MAADR"ÿ£CodeMA.MAADR
 ÿ‰ÿñ"SELGEKOND",0,0,247,118,"Konditionsauswahl: "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".","MS Sans Serif",8
 ÿ|ÿñ"SELGEKOND",4,0,0,241,94,0,""
 ÿ|ÿñ"SELGEKOND",5,40,11,195,23,0,"Bitte w„hlen Sie die Gesellschaft und die Sparte aus, fr die Sie die Konditionen bearbeiten m”chten:"
 ÿ|ÿñ"SELGEKOND",9,6,12,20,21,2
 ÿ|ÿñ"SELGEKOND",5,40,31,46,10,0,"&Gesellschaft:"
 ÿ|ÿñ"SELGEKOND",8,40,41,192,99,259,2,gprompt$,LGesellsch$
 ÿ|ÿñ"SELGEKOND",5,40,63,72,10,0,"&Sparte:"
 ÿ|ÿñ"SELGEKOND",8,40,73,192,99,259,2,sprompt$,LSparten$
 ÿ|ÿñ"SELGEKOND",1,63,98,55,15,1,"&OK",1,1
 ÿ|ÿñ"SELGEKOND",1,123,98,55,15,0,"&Abbrechen",0,0
 ÿñ"SELGEKOND",req%
 ÿ¾ÿñ"SELGEKOND"
 ÿ¡req%ÿ1ÿp
geadr%ÿÿ0(ÿ-(gprompt$,6))
sparte%ÿÿ0(ÿ-(sprompt$,6))
ÿ×KondFound$(ÿA("GEKOND"))
ÿ×Auswahl$(1)
ÿ™"GEKOND"
ÿ£QuickCode.GEKOND
scode$ÿÿ(ma%,"000000")ÿÿ(geadr%,"000000")ÿÿ(sparte%,"000000")
ÿÉÿ`
ÿÉÿ¥scode$ÿ™"GEKOND"ÿ£QuickCode.GEKOND
a%ÿ0
ÿØQuickCode.GEKONDÿscode$ÿÿOÿB("GEKOND")
ÿ¡BWvon.GEKONDÿ
1ÿpBWvon$ÿ"__.__.__"ÿ^BWvon$ÿÿ(BWvon.GEKOND,"0d.mm.yy")
ÿ¡BWbis.GEKONDÿ
1ÿpBWbis$ÿ"__.__.__"ÿ^BWbis$ÿÿ(BWbis.GEKOND,"0d.mm.yy")
ListItem$ÿ""
ÿ¡APjn.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Abschluáprovision "ÿÿ(AP.GEKOND,",999.00")
ÿ¡CourtageJN.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Courtage "ÿÿ(Courtage.GEKOND,",999.00")
ÿ¡PflegeJN.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Pflege "ÿÿ(PflegeProvi.GEKOND,",999.00")
ÿ¡VDjn.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Abschluá (LZ)"
ÿ¡TZjn.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Teilzahlung"
ÿ¡PauschaleJN.gekondÿ"j"ÿpListItem$ÿListItem$ÿ"; Pauschale "ÿÿ(Pauschale.GEKOND,",99999.00")
KondFound$(a%)ÿBWvon$ÿ"-"ÿBWbis$ÿListItem$ÿÿ'(120)ÿÿ(lfdnr.GEKOND,"000000")
a%ÿa%ÿ1
ÿÉÿ±ÿ™"GEKOND"ÿ£QuickCode.GEKOND
ÿÙ
ÿ¡a%ÿ0ÿpa%ÿa%ÿ1
ÿÉÿ¥geadr%ÿ™"GEADR"ÿ£CodeGE.GEADR
ÿÉÿ¥sparte%ÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
ÿ‰ÿñ"SELGEKOND",0,0,326,251,"Konditionsauswahl: "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ"., "ÿGesellschaft.GEADRÿ"/"ÿSparte.SPARTEN,"MS Sans Serif",8
ÿ|ÿñ"SELGEKOND",4,0,0,325,220,0,""
ÿ|ÿñ"SELGEKOND",9,9,16,21,25,2
ÿ|ÿñ"SELGEKOND",5,38,16,193,10,0,"W„hlen Sie die Kondition aus, die Sie bearbeiten m”chten:"
ÿ|ÿñ"SELGEKOND",5,40,31,130,9,0,"Bewertungszeitraum, Kondition"
ÿ|ÿñ"SELGEKOND",7,40,42,279,169,2,2,KondFound$,Auswahl$,KondFound$(0)
ÿ|ÿñ"SELGEKOND",1,94,227,58,17,1,"&OK",1,1
ÿ|ÿñ"SELGEKOND",1,154,227,60,17,0,"&Abbrechen",0,0
ÿñ"SELGEKOND",req%
ÿ¾ÿñ"SELGEKOND"
ÿ¡req%ÿ1ÿp
FindKond%ÿÿ0(ÿ-(Auswahl$(0),6))
ÿ’ÿ¡
 ÿ^
FindKond%ÿ0
 ÿ’ÿ¡
 ÿ™cfile$
 ÿÉÿœÿ¥cuko%ÿ™"GEKOND"ÿ£lfdnr.GEKOND
 ÿ’ÿÿ




 ' QuickCode erzeugen (fr Transfer/18.11.93)
 ' =======================================================================
 
ÿÿGEKONDUpd()
 ÿßÿe
 ÿÊÿË"Mitarbeitercodes in Mitarbeiterdatei werden angepaát..."
 ÿ™"MAADR"
 ÿÍCodeMA.MAADRÿ1ÿĞCodeMA.MAADRÿ0
 ÿ’ÿÍ
 ÿÊÿË"Vorg„ngercodes in Mitarbeiterdatei werden angepaát..."
 ÿÍVorg„nger.MAADRÿ1ÿĞVorg„nger.MAADRÿ0
 ÿ’ÿÍ
 ÿÊÿË"Mitarbeitercodes in Konditionsdatei werden angepaát..."
 ÿ™"GEKOND"
 ÿÍCodeMA.GEKONDÿ1ÿĞCodeMA.GEKONDÿ0
 ÿ’ÿÍ
 ÿÊÿË"QuickCode fr Konditionsdatei wird neu generiert..."
 ÿÍQuickCode.GEKONDÿÿ(CodeMA.gekond,"000000")ÿÿ(CodeGE.gekond,"000000")ÿÿ(CodeVA.gekond,"000000")
 ÿ’ÿÍ
 ÿ™"kvertrag"
 ÿÊÿË"Vertragsdatei wird korrigiert..."
 ÿÍCodeMA.kvertragÿ1ÿĞcodeMA.kvertragÿ0
 ÿ’ÿÍ
 ÿßÿ³
 ÿÂ"Dateien wurden erfolgreich korrigiert!","",100
 ÿÊÿË"Bereit"
 ÿ’ÿÿ
 

 ' GEKOND TI ???
 ' =======================================================================

ÿÿTIGEKOND()
 cuko%ÿlfdnr.GEKOND
 _formend%ÿ1
 ÿ½ SELECT KEY cuko% FILE "GEKOND" INDEX lfdnr.GEKOND
 ÿ’ÿÿ
 


 ' Konditionen bernehmen
 ' =======================================================================

ÿÿGEKONDUebern()
 ÿƒDFile(3,"gekondm"ÿ_fpw$)
 cuko%ÿlfdnr.gekond
 von$ÿÿ(ÿQ,"dd.mm.yyyy")
 bis$ÿ""
 opt%ÿ1
 ÿ‰ÿñ"UEBERNAHME",0,0,251,216,"Datenbernahme","MS Sans Serif",8
 ÿ|ÿñ"UEBERNAHME",4,0,0,251,193,0,""
 ÿ|ÿñ"UEBERNAHME",9,6,14,22,22,2
 ÿ|ÿñ"UEBERNAHME",5,37,14,141,10,0,"Bitte w„hlen Sie aus, mit welcher Methode"
 ÿ|ÿñ"UEBERNAHME",5,37,24,149,9,0,"die Musterdaten bernommen werden sollen:"
 ÿ|ÿñ"UEBERNAHME",3,37,46,137,10,0,"alle &ersetzen",1,opt%
 ÿ|ÿñ"UEBERNAHME",3,37,86,137,11,0,"er&g„nzen",2,opt%
 ÿ|ÿñ"UEBERNAHME",3,37,124,138,12,0,"an&h„ngen",3,opt%
 ÿ|ÿñ"UEBERNAHME",5,48,57,196,11,0,"es werden alle bestehenden Konditionen gel”scht"
 ÿ|ÿñ"UEBERNAHME",5,48,67,195,10,0,"und durch die Daten der Musteragentur ersetzt"
 ÿ|ÿñ"UEBERNAHME",5,48,99,194,9,0,"bernimmt alle Konditionen der Musteragentur, fr die noch"
 ÿ|ÿñ"UEBERNAHME",5,48,109,194,10,0,"keine Daten in der Konditionsdatei vorhanden sind"
 ÿ|ÿñ"UEBERNAHME",5,48,137,195,10,0,"bernimmt alle Konditionen der Musteragentur, fr einen"
 ÿ|ÿñ"UEBERNAHME",5,48,147,195,9,0,"neuen Bewertungszeitraum"
 ÿ|ÿñ"UEBERNAHME",5,37,163,69,10,0,"Bewertungszeitraum:"
 ÿ|ÿñ"UEBERNAHME",6,66,176,41,12,0,0,von$,10
 ÿ|ÿñ"UEBERNAHME",6,132,176,41,12,0,0,bis$,10
 ÿ|ÿñ"UEBERNAHME",5,48,177,17,10,0,"&von:"
 ÿ|ÿñ"UEBERNAHME",5,114,177,17,10,0,"&bis:"
 ÿ|ÿñ"UEBERNAHME",1,65,196,55,15,1,"&OK",1,1
 ÿ|ÿñ"UEBERNAHME",1,123,196,55,15,0,"&Abbrechen",0,0
 ÿñ"UEBERNAHME",req%
 ÿ¾ÿñ"UEBERNAHME"
 ÿ¡req%ÿ1ÿp
ÿÂ"Die gew„hlte Funktion nimmt nderungen Ihrer Stammdaten vor!","Funktion fortsetzen?",130,req%
ÿ¡req%ÿ1ÿp
ÿßÿe
ÿ¡opt%ÿ1ÿp
ÿÊÿË"Konditionen werden gel”scht..."
ÿ¾ÿaÿ™"GEKOND"ÿĞCodeMA.GEKONDÿcuma%
ÿ’ÿ¡
ÿÊÿË"Datenbernahme..."
nrmax%ÿÿA("GEKONDM")
_a%ÿ0
_erg%ÿ0
ÿÉÿ`ÿ™"gekondm"ÿ£lfdnr.gekondm
ÿØÿOÿB("gekondm")
scode$ÿÿ(cuma%,"000000")ÿÿ(CodeGE.gekondm,"000000")ÿÿ(CodeVA.gekondm,"000000")
ÿÉÿ¥scode$ÿ™"GEKOND"ÿ£QuickCode.GEKOND
_a%ÿ_a%ÿ1
ÿ¡_erg%ÿ0ÿp
	ÿÊÿË"Datenbernahme... "ÿÿH(ÿ(_a%,"9999"))ÿ" von "ÿÿH(ÿ(nrmax%,"9999"))ÿ" geprft"
ÿ^
	ÿÊÿË"Datenbernahme... "ÿÿH(ÿ(_a%,"9999"))ÿ" von "ÿÿH(ÿ(nrmax%,"9999"))ÿ" geprft / "ÿÿH(ÿ(_erg%ÿ1,"9999"))ÿ" bernommen"
ÿ’ÿ¡
ÿ¡ÿOÿC("GEKOND")ÿopt%ÿ1ÿopt%ÿ3ÿp
	ÿ¡CodeGE.GEKONDMÿ0ÿCodeVA.GEKONDMÿ0ÿp
_erg%ÿ_erg%ÿ1
ÿÿ™"GEKOND"
CodeGE.gekondÿCodeGE.gekondm
CodeVA.gekondÿCodeVA.gekondm
CodeMA.gekondÿcuma%
BWvon.gekondÿvon$
BWbis.gekondÿbis$
VD1Dauer.gekondÿVD1Dauer.gekondm
VD1AP.gekondÿVD1AP.gekondm
VD1SR.gekondÿVD1SR.gekondm
VD1HZ.gekondÿVD1HZ.gekondm
VD2Dauer.gekondÿVD2Dauer.gekondm
VD2AP.gekondÿVD2AP.gekondm
VD2SR.gekondÿVD2SR.gekondm
VD2HZ.gekondÿVD2HZ.gekondm
VD3Dauer.gekondÿVD3Dauer.gekondm
VD3AP.gekondÿVD3AP.gekondm
VD3SR.gekondÿVD3SR.gekondm
VD3HZ.gekondÿVD3HZ.gekondm
VD4Dauer.gekondÿVD4Dauer.gekondm
VD4AP.gekondÿVD4AP.gekondm
VD4SR.gekondÿVD4SR.gekondm
VD4HZ.gekondÿVD4HZ.gekondm
VD5Dauer.gekondÿVD5Dauer.gekondm
VD5AP.gekondÿVD5AP.gekondm
VD5SR.gekondÿVD5SR.gekondm
VD5HZ.gekondÿVD5HZ.gekondm
AP.gekondÿAP.gekondm
Courtage.gekondÿCourtage.gekondm
CourtageZW.gekondÿCourtageZW.gekondm
CourtageZWjn.gekondÿCourtageZWjn.gekondm
SR.gekondÿSR.gekondm
Haftung.gekondÿHaftung.gekondm
PflegeProvi.gekondÿPflegeProvi.gekondm
PflegeZeit.gekondÿPflegeZeit.gekondm
PflegeZW.gekondÿPflegeZW.gekondm
Pauschale.gekondÿPauschale.gekondm
Formel.gekondÿFormel.gekondm
Dynamik.gekondÿDynamik.gekondm
Maximierung.gekondÿMaximierung.gekondm
BWjn.gekondÿBWjn.gekondm
VDjn.gekondÿVDjn.gekondm
TZjn.gekondÿTZjn.gekondm
PflegeJN.gekondÿPflegeJN.gekondm
PauschaleJN.gekondÿPauschaleJN.gekondm
FormelJN.gekondÿFormelJN.gekondm
DynamikJN.gekondÿDynamikJN.gekondm
MaximierungJN.gekondÿMaximierungJN.gekondm
APjn.gekondÿAPjn.gekondm
CourtageJN.gekondÿCourtageJN.gekondm
SRjn.gekondÿSRjn.gekondm
TZD0.gekondÿTZD0.gekondm
TZD1.gekondÿTZD1.gekondm
TZD2.gekondÿTZD2.gekondm
TZD3.gekondÿTZD3.gekondm
TZD4.gekondÿTZD4.gekondm
TZD5.gekondÿTZD5.gekondm
TZD6.gekondÿTZD6.gekondm
TZD7.gekondÿTZD7.gekondm
TZD8.gekondÿTZD8.gekondm
TZD9.gekondÿTZD9.gekondm
TZD10.gekondÿTZD10.gekondm
TZD11.gekondÿTZD11.gekondm
TZ0.gekondÿTZ0.gekondm
TZ1.gekondÿTZ1.gekondm
TZ2.gekondÿTZ2.gekondm
TZ3.gekondÿTZ3.gekondm
TZ4.gekondÿTZ4.gekondm
TZ5.gekondÿTZ5.gekondm
TZ6.gekondÿTZ6.gekondm
TZ7.gekondÿTZ7.gekondm
TZ8.gekondÿTZ8.gekondm
TZ9.gekondÿTZ9.gekondm
TZ10.gekondÿTZ10.gekondm
TZ11.gekondÿTZ11.gekondm
lfdnr.gekondÿÿI("gekond",1)
DPeriode.gekondÿDPeriode.gekondm
ÿƒQuickStore("GEKOND")
	ÿ’ÿ¡
ÿ’ÿ¡
ÿÉÿ±ÿ™"gekondm"ÿ£lfdnr.gekondm
ÿÙ
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿßÿ³
 ÿÉÿœÿ¥cuma%ÿ™"gekond"ÿ£CodeMA.gekond
 ÿœ
 ÿÊÿË"Bereit"
 ÿ’ÿÿ


 ' prozentuale Anpassung der aktuellen Kondition
 ' =======================================================================

ÿÿANPASSUNG()
 ÿ‰ÿñ"ANPASSUNG",0,0,177,94,"Anpassung","MS Sans Serif",8
 ÿ|ÿñ"ANPASSUNG",5,6,6,116,10,0,"Anpassung der aktuellen Kondition:"
 ÿ|ÿñ"ANPASSUNG",5,6,20,159,8,0,"Bitte geben Sie ein, auf welchen Prozentsatz die"
 ÿ|ÿñ"ANPASSUNG",5,6,30,150,8,0,"aktuelle Kondition angepaát werden soll."
 ÿ|ÿñ"ANPASSUNG",6,46,49,39,13,0,0,anp$,6
 ÿ|ÿñ"ANPASSUNG",5,6,49,38,11,0,"Anpassung:"
 ÿ|ÿñ"ANPASSUNG",5,86,52,7,8,0,"%"
 ÿ|ÿñ"ANPASSUNG",1,34,70,50,16,1,"&OK",1,1
 ÿ|ÿñ"ANPASSUNG",1,86,70,50,16,0,"&Abbruch",0,0
 ÿñ"ANPASSUNG",req%
 ÿ¾ÿñ"ANPASSUNG"
 anp%ÿÿ0(anp$)
 anp$ÿÿ(anp%)
 ÿ¡req%ÿ1ÿanp%ÿ0ÿp
_cuko%ÿlfdnr.GEKOND
ÿÉÿ¥_cuko%ÿáÿ™"GEKOND"ÿ£lfdnr.GEKOND
ÿßÿe
ÿÊÿË"WARTEN: Kondition wird angepaát..."
ÿ½ REQUEST "gew„hlter Anpassungswert:",anp$,0
ÿ¡VD1AP.gekondÿ0ÿpVD1AP.gekondÿ(VD1AP.gekondÿ100)ÿanp%
ÿ¡VD2AP.gekondÿ0ÿpVD2AP.gekondÿ(VD2AP.gekondÿ100)ÿanp%
ÿ¡VD3AP.gekondÿ0ÿpVD3AP.gekondÿ(VD3AP.gekondÿ100)ÿanp%
ÿ¡VD4AP.gekondÿ0ÿpVD4AP.gekondÿ(VD4AP.gekondÿ100)ÿanp%
ÿ¡VD5AP.gekondÿ0ÿpVD5AP.gekondÿ(VD5AP.gekondÿ100)ÿanp%
ÿ¡AP.gekondÿ0ÿpAP.gekondÿ(AP.gekondÿ100)ÿanp%
ÿ¡Courtage.gekondÿ0ÿpCourtage.gekondÿ(Courtage.gekondÿ100)ÿanp%
ÿ¡TZ0.gekondÿ0ÿpTZ0.gekondÿ(TZ0.gekondÿ100)ÿanp%
ÿ¡TZ1.gekondÿ0ÿpTZ1.gekondÿ(TZ1.gekondÿ100)ÿanp%
ÿ¡TZ2.gekondÿ0ÿpTZ2.gekondÿ(TZ2.gekondÿ100)ÿanp%
ÿ¡TZ3.gekondÿ0ÿpTZ3.gekondÿ(TZ3.gekondÿ100)ÿanp%
ÿ¡TZ4.gekondÿ0ÿpTZ4.gekondÿ(TZ4.gekondÿ100)ÿanp%
ÿ¡TZ5.gekondÿ0ÿpTZ5.gekondÿ(TZ5.gekondÿ100)ÿanp%
ÿ¡TZ6.gekondÿ0ÿpTZ6.gekondÿ(TZ6.gekondÿ100)ÿanp%
ÿ¡TZ7.gekondÿ0ÿpTZ7.gekondÿ(TZ7.gekondÿ100)ÿanp%
ÿ¡TZ8.gekondÿ0ÿpTZ8.gekondÿ(TZ8.gekondÿ100)ÿanp%
ÿ¡TZ9.gekondÿ0ÿpTZ9.gekondÿ(TZ9.gekondÿ100)ÿanp%
ÿ¡TZ10.gekondÿ0ÿpTZ10.gekondÿ(TZ10.gekondÿ100)ÿanp%
ÿ¡TZ11.gekondÿ0ÿpTZ11.gekondÿ(TZ11.gekondÿ100)ÿanp%
ÿ¡TZ12.gekondÿ0ÿpTZ12.gekondÿ(TZ12.gekondÿ100)ÿanp%
ÿ¡PflegeProvi.gekondÿ0ÿpPflegeProvi.gekondÿ(PflegeProvi.gekondÿ100)ÿanp%
ÿ¡Pauschale.gekondÿ0ÿpPauschale.gekondÿ(Pauschale.gekondÿ100)ÿanp%
ÿƒFStore("GEKOND")
ÿœ
ÿßÿ³
ÿÊÿË"Bereit"
 ÿ’ÿ¡
 ÿ’ÿÿ


 ' prozentuale Anpassung aller Kondition
 ' =======================================================================

ÿÿANPASSUNG2()
 cuma%ÿCodeMA.gekond
 cuko%ÿlfdnr.gekond
 ÿ‰ÿñ"ANPASSUNG",0,0,177,94,"Anpassung","MS Sans Serif",8
 ÿ|ÿñ"ANPASSUNG",5,6,6,116,10,0,"Anpassung aller Kondition:"
 ÿ|ÿñ"ANPASSUNG",5,6,20,159,8,0,"Bitte geben Sie ein, auf welchen Prozentsatz die"
 ÿ|ÿñ"ANPASSUNG",5,6,30,150,8,0,"Konditionen angepaát werden soll."
 ÿ|ÿñ"ANPASSUNG",6,46,49,39,13,0,0,anp$,6
 ÿ|ÿñ"ANPASSUNG",5,6,49,38,11,0,"Anpassung:"
 ÿ|ÿñ"ANPASSUNG",5,86,52,7,8,0,"%"
 ÿ|ÿñ"ANPASSUNG",1,34,70,50,16,1,"&OK",1,1
 ÿ|ÿñ"ANPASSUNG",1,86,70,50,16,0,"&Abbruch",0,0
 ÿñ"ANPASSUNG",req%
 ÿ¾ÿñ"ANPASSUNG"
 anp%ÿÿ0(anp$)
 anp$ÿÿ(anp%)
 ÿ¡req%ÿ1ÿanp%ÿ0ÿp
ÿ™"gekond"
ÿ£CodeMA.gekond
ÿÉÿ`ÿ™"GEKOND"
ÿÉÿ¥cuma%ÿáÿ™"gekond"ÿ£CodeMA.gekond
ÿØ(CodeMA.gekondÿcuma%)ÿ(ÿOÿB("gekond"))
ÿÊÿË"WARTEN: Kondition wird angepaát... "ÿÿ(lfdnr.GEKOND,"99999999")
ÿ¡VD1AP.gekondÿ0ÿpVD1AP.gekondÿ(VD1AP.gekondÿ100)ÿanp%
ÿ¡VD2AP.gekondÿ0ÿpVD2AP.gekondÿ(VD2AP.gekondÿ100)ÿanp%
ÿ¡VD3AP.gekondÿ0ÿpVD3AP.gekondÿ(VD3AP.gekondÿ100)ÿanp%
ÿ¡VD4AP.gekondÿ0ÿpVD4AP.gekondÿ(VD4AP.gekondÿ100)ÿanp%
ÿ¡VD5AP.gekondÿ0ÿpVD5AP.gekondÿ(VD5AP.gekondÿ100)ÿanp%
ÿ¡AP.gekondÿ0ÿpAP.gekondÿ(AP.gekondÿ100)ÿanp%
ÿ¡Courtage.gekondÿ0ÿpCourtage.gekondÿ(Courtage.gekondÿ100)ÿanp%
ÿ¡TZ0.gekondÿ0ÿpTZ0.gekondÿ(TZ0.gekondÿ100)ÿanp%
ÿ¡TZ1.gekondÿ0ÿpTZ1.gekondÿ(TZ1.gekondÿ100)ÿanp%
ÿ¡TZ2.gekondÿ0ÿpTZ2.gekondÿ(TZ2.gekondÿ100)ÿanp%
ÿ¡TZ3.gekondÿ0ÿpTZ3.gekondÿ(TZ3.gekondÿ100)ÿanp%
ÿ¡TZ4.gekondÿ0ÿpTZ4.gekondÿ(TZ4.gekondÿ100)ÿanp%
ÿ¡TZ5.gekondÿ0ÿpTZ5.gekondÿ(TZ5.gekondÿ100)ÿanp%
ÿ¡TZ6.gekondÿ0ÿpTZ6.gekondÿ(TZ6.gekondÿ100)ÿanp%
ÿ¡TZ7.gekondÿ0ÿpTZ7.gekondÿ(TZ7.gekondÿ100)ÿanp%
ÿ¡TZ8.gekondÿ0ÿpTZ8.gekondÿ(TZ8.gekondÿ100)ÿanp%
ÿ¡TZ9.gekondÿ0ÿpTZ9.gekondÿ(TZ9.gekondÿ100)ÿanp%
ÿ¡TZ10.gekondÿ0ÿpTZ10.gekondÿ(TZ10.gekondÿ100)ÿanp%
ÿ¡TZ11.gekondÿ0ÿpTZ11.gekondÿ(TZ11.gekondÿ100)ÿanp%
ÿ¡TZ12.gekondÿ0ÿpTZ12.gekondÿ(TZ12.gekondÿ100)ÿanp%
ÿ¡PflegeProvi.gekondÿ0ÿpPflegeProvi.gekondÿ(PflegeProvi.gekondÿ100)ÿanp%
ÿ¡Pauschale.gekondÿ0ÿpPauschale.gekondÿ(Pauschale.gekondÿ100)ÿanp%
ÿƒQuickStore("gekond")
ÿÉÿ±ÿáÿ™"gekond"ÿ£CodeMA.gekond
ÿÙ
 ÿ’ÿ¡
 ÿÉÿ¥cuko%ÿ™"gekond"ÿ£lfdnr.gekond
 ÿÊÿË"Bereit"
 ÿœ
 ÿßÿ³
 ÿ’ÿÿ
 

 ' Auswahl Gesellschaft (Konditionen)
 ' =======================================================================
 ' 31.07.94/FA - in Prozedur ge„ndert

ÿÿMASGeadr()
 ÿ¡ÿ°("gekond")ÿÿ("gekond")ÿpÿƒFStore("gekond")
 cuge%ÿCodeGE.gekond
 cuko%ÿlfdnr.gekond
 _cuge%ÿGetCodeGE%(cuge%)
 ÿ¡_cuge%ÿ0ÿp
ÿßÿe
ÿÉÿ¥cuko%ÿáÿ™"gekond"ÿ£lfdnr.gekond
CodeGE.gekondÿ_cuge%
ÿƒFStore("gekond")
ÿÉÿœÿ¥cuko%ÿ™"gekond"ÿ£lfdnr.gekond
ÿœ
 ÿ’ÿ¡
 ÿßÿ³
 ÿ’ÿÿ


 ' Auswahl Sparte (Konditionen)
 ' =======================================================================
 ' 31.07.94/FA - in Prozedur ge„ndert

ÿÿMASCodeva()
 ÿ¡ÿ°("gekond")ÿÿ("gekond")ÿpÿƒFStore("gekond")
 cuva%ÿCodeVA.gekond
 cuko%ÿlfdnr.gekond
 _cuva%ÿGetCodeVA%(cuva%)
 ÿ¡_cuva%ÿ0ÿp
ÿßÿe
ÿÉÿ¥cuko%ÿáÿ™"gekond"ÿ£lfdnr.gekond
CodeVA.gekondÿ_cuva%
ÿƒFStore("gekond")
ÿÉÿœÿ¥cuko%ÿ™"gekond"ÿ£lfdnr.gekond
ÿœ
 ÿ’ÿ¡
 ÿßÿ³
 ÿ’ÿÿ


 '      *********************************************************
 '      ** Routinen fr Formular "GEKONDM" - Musterkonditionen **
 '      *********************************************************

ÿÿGEKONDM()
 ÿ¡disabled%("GEKONDM")ÿpÿ’ÿÿ
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekondm"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿ™"gekondm"
 _formend%ÿ0
 ÿØ_formend%ÿ0
GEKONDMsub%ÿ0
ÿ¡ÿ>(ÿœ)ÿ"GEKONDM"ÿp
ÿÊÿŸtitle$ÿ" - Musterkonditionen"
ÿ´ÿœ"gekondm"
ÿƒGEKONDMIntro()
ÿƒMNGEKONDM()
ÿÊÿË"Musterkonditionen"
ÿ’ÿ¡
ÿßÿ³
ÿƒGEKONDMUpdate()
ÿƒClearKBDBuffer()
ÿ¡GEKONDMsub%ÿ99ÿpÿÏÿßÿÿ¥ÿÿ¬

ÿ½ ** Tastaturabfrage
ÿk$
ÿÉÿæÿ.(k$)
ÿæCrsLeft%,PgUp%
ÿƒGEKONDMPrev()
ÿæCrsRight%,PgDn%
ÿƒGEKONDMNext()
ÿ’ÿÉ
 
ÿÉÿæGEKONDMsub%
ÿæ1
ÿƒGEKONDMSuchen()
ÿæ99
ÿ¡ÿA("gekondm")ÿ0ÿpÿƒGEKONDMNeu()
ÿßÿ³
ÿ¡ÿíÿ1ÿpÿ”AP.gekondm,0
ÿ¡ÿíÿ2ÿpÿ”TZ0.gekondm,0
ÿ’ÿÉ
GEKONDMsub%ÿ0
 ÿÙ
 _formend%ÿ0
 cuko%ÿ0
 ÿ’ÿÿ

 ' GEKONDM Intro
 ' =======================================================================

ÿÿGEKONDMIntro()
 ÿ™"gekondm"
 ÿ£lfdnr.gekondm
 ÿÉÿœÿ`
 ÿœ
 ÿ’ÿÿ
 
ÿÿGEKONDMUpdate()
 ÿÉÿ¥CodeGE.GEKONDMÿ™"GEADR"ÿ£CodeGE.GEADR
 ÿÉÿ¥CodeVA.GEKONDMÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 Gesellschaft$ÿÿ¡(ÿC("GEADR"),Gesellschaft.GEADR,"<keine Zuordnung>")
 Sparte$ÿÿ¡(ÿC("SPARTEN"),Sparte.SPARTEN,"<keine Zuordnung>")
 ÿœ
 ÿ’ÿÿ

 
 ' GEKOND Neu
 ' =======================================================================

ÿÿGEKONDMNeu()
 ÿ¡ÿ("gekondm")ÿÿ°("gekondm")ÿpÿƒFStore("gekondm")
 ÿÿœ
 ÿÊÿË"Datensatz neu angelegt..."
 lfdnr.gekondmÿÿI("gekondm",1)
 ÿ½ Nummer 99 fr Musteragentur
 codema.gekondmÿ99
 GEKONDMsub%ÿ99
 ÿƒGEKONDMUpdate()
 ÿœ
 ÿ’ÿÿ

 ' GEKONDM Eintrag zurck
 ' =======================================================================
 
ÿÿGEKONDMPrev()
 ÿ¡ÿ("GEKONDM")ÿÿ°("GEKONDM")ÿpÿƒFStore("GEKONDM")
 cuko%ÿlfdnr.gekondm
 ÿÉÿœÿgÿ£lfdnr.gekondm
 ÿœ
 ÿ’ÿÿ
 
 
 ' GEKONDM Eintrag vor
 ' =======================================================================
 
ÿÿGEKONDMNext()
 ÿ¡ÿ("GEKONDM")ÿÿ°("GEKONDM")ÿpÿƒFStore("GEKONDM")
 cuko%ÿlfdnr.gekondm
 ÿÉÿœÿ±ÿ£lfdnr.GEKONDM
 ÿœ
 ÿ’ÿÿ
 

 ' GEKONDM suchen
 ' =======================================================================

ÿÿGEKONDMSuchen()
 cuko%ÿlfdnr.GEKONDM
 kond%ÿFindKondM%(lfdnr.GEKONDM)
 ÿ¡kond%ÿ0ÿp
cuko%ÿkond%
 ÿ’ÿ¡
 ÿÉÿœÿ¥cuko%ÿ™"GEKONDM"ÿ£lfdnr.GEKONDM
 ÿœ
 ÿ’ÿÿ

ÿÿFindKondM%(ko%)
 cuge%ÿCodeGE.GEKONDM
 cuva%ÿCodeVA.GEKONDM
 cuko%ÿlfdnr.GEKONDM
 ma%ÿCodeMA.GEKONDM
 cfile$ÿÿ™
 ÿ×LGesellsch$(ÿA("GEADR"))
 ÿ×LSparten$(ÿA("SPARTEN"))
 ÿ×AuswGEADR$(1)
 ÿ×AuswSPARTEN$(1)
 ÿ™"GEADR"
 ÿ£CodeGE.GEADR
 ÿÉÿ`
 a%ÿ0
 ÿØÿOÿB("GEADR")
LGesellsch$(a%)ÿGesellschaft.GEADRÿÿ'(120)ÿÿ(CodeGE.GEADR,"000000")
ÿ¡CodeGE.GEADRÿcuge%ÿpgprompt$ÿLGesellsch$(a%)
a%ÿa%ÿ1
ÿÉÿ±ÿ™"GEADR"ÿ£CodeGE.GEADR
 ÿÙ
 ÿ™"SPARTEN"
 ÿ£CodeVA.SPARTEN
 ÿÉÿ`
 a%ÿ0
 ÿØÿOÿB("SPARTEN")
LSparten$(a%)ÿSparte.SPARTENÿÿ'(120)ÿÿ(CodeVA.SPARTEN,"000000")
ÿ¡CodeVA.SPARTENÿcuva%ÿpsprompt$ÿLSparten$(a%)
a%ÿa%ÿ1
ÿÉÿ±ÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 ÿÙ
 ÿ‰ÿñ"SELGEKOND",0,0,247,118,"Konditionsauswahl: Musteragentur","MS Sans Serif",8
 ÿ|ÿñ"SELGEKOND",4,0,0,241,94,0,""
 ÿ|ÿñ"SELGEKOND",5,40,11,195,23,0,"Bitte w„hlen Sie die Gesellschaft und die Sparte aus, fr die Sie die Konditionen bearbeiten m”chten:"
 ÿ|ÿñ"SELGEKOND",9,6,12,20,21,2
 ÿ|ÿñ"SELGEKOND",5,40,31,46,10,0,"&Gesellschaft:"
 ÿ|ÿñ"SELGEKOND",8,40,41,192,99,259,2,gprompt$,LGesellsch$
 ÿ|ÿñ"SELGEKOND",5,40,63,72,10,0,"&Sparte:"
 ÿ|ÿñ"SELGEKOND",8,40,73,192,99,259,2,sprompt$,LSparten$
 ÿ|ÿñ"SELGEKOND",1,63,98,55,15,1,"&OK",1,1
 ÿ|ÿñ"SELGEKOND",1,123,98,55,15,0,"&Abbrechen",0,0
 ÿñ"SELGEKOND",req%
 ÿ¾ÿñ"SELGEKOND"
 ÿ¡req%ÿ1ÿp
geadr%ÿÿ0(ÿ-(gprompt$,6))
sparte%ÿÿ0(ÿ-(sprompt$,6))
ÿ×KondFound$(ÿA("GEKONDM"))
ÿ×Auswahl$(1)
ÿ™"GEKONDM"
ÿ£QuickCode.GEKONDM
scode$ÿÿ(ma%,"000000")ÿÿ(geadr%,"000000")ÿÿ(sparte%,"000000")
ÿÉÿ`
ÿÉÿ¥scode$ÿ™"GEKONDM"ÿ£QuickCode.GEKONDM
a%ÿ0
ÿØQuickCode.GEKONDMÿscode$ÿÿOÿB("GEKONDM")
ListItem$ÿ""
ÿ¡APjn.gekondmÿ"j"ÿpListItem$ÿListItem$ÿ"; Abschluáprovision "ÿÿ(AP.GEKONDM,",999.00")
ÿ¡CourtageJN.gekondmÿ"j"ÿpListItem$ÿListItem$ÿ"; Courtage "ÿÿ(Courtage.GEKONDM,",999.00")
ÿ¡PflegeJN.gekondmÿ"j"ÿpListItem$ÿListItem$ÿ"; Pflege "ÿÿ(PflegeProvi.GEKONDM,",999.00")
ÿ¡VDjn.gekondmÿ"j"ÿpListItem$ÿListItem$ÿ"; Abschluá (LZ)"
ÿ¡TZjn.gekondmÿ"j"ÿpListItem$ÿListItem$ÿ"; Teilzahlung"
ÿ¡PauschaleJN.gekondmÿ"j"ÿpListItem$ÿListItem$ÿ"; Pauschale "ÿÿ(Pauschale.GEKONDM,",99999.00")
KondFound$(a%)ÿBWvon$ÿ"-"ÿBWbis$ÿListItem$ÿÿ'(120)ÿÿ(lfdnr.GEKONDM,"000000")
a%ÿa%ÿ1
ÿÉÿ±ÿ™"GEKONDM"ÿ£QuickCode.GEKONDM
ÿÙ
ÿ¡a%ÿ0ÿpa%ÿa%ÿ1
ÿÉÿ¥geadr%ÿ™"GEADR"ÿ£CodeGE.GEADR
ÿÉÿ¥sparte%ÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
ÿ‰ÿñ"SELGEKOND",0,0,326,251,"Konditionsauswahl: "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ"., "ÿGesellschaft.GEADRÿ"/"ÿSparte.SPARTEN,"MS Sans Serif",8
ÿ|ÿñ"SELGEKOND",4,0,0,325,220,0,""
ÿ|ÿñ"SELGEKOND",9,9,16,21,25,2
ÿ|ÿñ"SELGEKOND",5,38,16,193,10,0,"W„hlen Sie die Kondition aus, die Sie bearbeiten m”chten:"
ÿ|ÿñ"SELGEKOND",5,40,31,130,9,0,"Bewertungszeitraum, Kondition"
ÿ|ÿñ"SELGEKOND",7,40,42,279,169,2,2,KondFound$,Auswahl$,KondFound$(0)
ÿ|ÿñ"SELGEKOND",1,94,227,58,17,1,"&OK",1,1
ÿ|ÿñ"SELGEKOND",1,154,227,60,17,0,"&Abbrechen",0,0
ÿñ"SELGEKOND",req%
ÿ¾ÿñ"SELGEKOND"
ÿ¡req%ÿ1ÿp
FindKondM%ÿÿ0(ÿ-(Auswahl$(0),6))
ÿ’ÿ¡
 ÿ^
FindKondM%ÿ0
 ÿ’ÿ¡
 ÿ™cfile$
 ÿÉÿœÿ¥cuko%ÿ™"GEKONDM"ÿ£lfdnr.GEKONDM
 ÿ’ÿÿ
 

ÿÿGEKONDMDel()
 ÿ¡disabled%("GEKONDMLOESCHEN")ÿpÿ’ÿÿ
 cuko%ÿlfdnr.GEKONDM
 ÿÂ"Wollen Sie die aktuelle Musterkondition wirklich l”schen?","",135,req%
 ÿ¡req%ÿ1ÿp
ÿÉÿ¥cuko%ÿáÿ™"GEKONDM"ÿ£lfdnr.GEKONDM
ÿÉÿ¾
ÿÊÿË"Datensatz wurde gel”scht"
 ÿ’ÿ¡
 ÿœ
 ÿßÿ³
 ÿ’ÿÿ


 
 ' Auswahl Gesellschaft (Konditionen)
 ' =======================================================================

ÿÿGEKONDMGeadr()
 ÿ¡ÿ°("gekondm")ÿÿ("gekondm")ÿpÿƒFStore("gekondm")
 cuge%ÿCodeGE.gekondm
 cuko%ÿlfdnr.gekondm
 _cuge%ÿGetCodeGE%(cuge%)
 ÿ¡_cuge%ÿ0ÿp
ÿßÿe
ÿÉÿ¥cuko%ÿáÿ™"gekondm"ÿ£lfdnr.gekondm
CodeGE.gekondmÿ_cuge%
ÿƒFStore("gekondm")
ÿÉÿœÿ¥cuko%ÿ™"gekondm"ÿ£lfdnr.gekondm
ÿœ
 ÿ’ÿ¡
 ÿßÿ³
 ÿ’ÿÿ

 
 ' Auswahl Sparte (Konditionen)
 ' =======================================================================

ÿÿGEKONDMSparte()
 ÿ¡ÿ°("gekondm")ÿÿ("gekondm")ÿpÿƒFStore("gekondm")
 cuva%ÿCodeVA.gekondm
 cuko%ÿlfdnr.gekondm
 _cuva%ÿGetCodeVA%(cuva%)
 ÿ¡_cuva%ÿ0ÿp
ÿßÿe
ÿÉÿ¥cuko%ÿáÿ™"gekondm"ÿ£lfdnr.gekondm
CodeVA.gekondmÿ_cuva%
ÿƒFStore("gekondm")
ÿÉÿœÿ¥cuko%ÿ™"gekondm"ÿ£lfdnr.gekondm
ÿœ
 ÿ’ÿ¡
 ÿßÿ³
 ÿ’ÿÿ
 

 ' prozentuale Anpassung der aktuellen Musterkondition
 ' =======================================================================

ÿÿANPASSUNGM()
 ÿ‰ÿñ"ANPASSUNG",0,0,177,94,"Anpassung","MS Sans Serif",8
 ÿ|ÿñ"ANPASSUNG",5,6,6,116,10,0,"Anpassung der aktuellen Kondition:"
 ÿ|ÿñ"ANPASSUNG",5,6,20,159,8,0,"Bitte geben Sie ein, auf welchen Prozentsatz die"
 ÿ|ÿñ"ANPASSUNG",5,6,30,150,8,0,"aktuelle Kondition angepaát werden soll."
 ÿ|ÿñ"ANPASSUNG",6,46,49,39,13,0,0,anp$,6
 ÿ|ÿñ"ANPASSUNG",5,6,49,38,11,0,"Anpassung:"
 ÿ|ÿñ"ANPASSUNG",5,86,52,7,8,0,"%"
 ÿ|ÿñ"ANPASSUNG",1,34,70,50,16,1,"&OK",1,1
 ÿ|ÿñ"ANPASSUNG",1,86,70,50,16,0,"&Abbruch",0,0
 ÿñ"ANPASSUNG",req%
 ÿ¾ÿñ"ANPASSUNG"
 anp%ÿÿ0(anp$)
 anp$ÿÿ(anp%)
 ÿ¡req%ÿ1ÿanp%ÿ0ÿp
ÿßÿe
ÿÊÿË"WARTEN: Kondition wird angepaát..."
ÿÂ"gew„hlter Anpassungswert:",anp$,0
ÿ¡VD1AP.gekondmÿ0ÿpVD1AP.gekondmÿ(VD1AP.gekondmÿ100)ÿanp%
ÿ¡VD2AP.gekondmÿ0ÿpVD2AP.gekondmÿ(VD2AP.gekondmÿ100)ÿanp%
ÿ¡VD3AP.gekondmÿ0ÿpVD3AP.gekondmÿ(VD3AP.gekondmÿ100)ÿanp%
ÿ¡VD4AP.gekondmÿ0ÿpVD4AP.gekondmÿ(VD4AP.gekondmÿ100)ÿanp%
ÿ¡VD5AP.gekondmÿ0ÿpVD5AP.gekondmÿ(VD5AP.gekondmÿ100)ÿanp%
ÿ¡AP.gekondmÿ0ÿpAP.gekondmÿ(AP.gekondmÿ100)ÿanp%
ÿ¡Courtage.gekondmÿ0ÿpCourtage.gekondmÿ(Courtage.gekondmÿ100)ÿanp%
ÿ¡TZ0.gekondmÿ0ÿpTZ0.gekondmÿ(TZ0.gekondmÿ100)ÿanp%
ÿ¡TZ1.gekondmÿ0ÿpTZ1.gekondmÿ(TZ1.gekondmÿ100)ÿanp%
ÿ¡TZ2.gekondmÿ0ÿpTZ2.gekondmÿ(TZ2.gekondmÿ100)ÿanp%
ÿ¡TZ3.gekondmÿ0ÿpTZ3.gekondmÿ(TZ3.gekondmÿ100)ÿanp%
ÿ¡TZ4.gekondmÿ0ÿpTZ4.gekondmÿ(TZ4.gekondmÿ100)ÿanp%
ÿ¡TZ5.gekondmÿ0ÿpTZ5.gekondmÿ(TZ5.gekondmÿ100)ÿanp%
ÿ¡PflegeProvi.gekondmÿ0ÿpPflegeProvi.gekondmÿ(PflegeProvi.gekondmÿ100)ÿanp%
ÿ¡Pauschale.gekondmÿ0ÿpPauschale.gekondmÿ(Pauschale.gekondmÿ100)ÿanp%
ÿœ
ÿßÿ³
ÿÊÿË"Bereit"
 ÿ’ÿ¡
 ÿ’ÿÿ
 
 


 '      ***********************************************************
 '      ** Routinen fr Formular "MAADR" - Mitarbeiter/Agenturen **
 '      ***********************************************************

ÿÿMAADR()
 ÿ¡disabled%("MAADR")ÿpÿ’ÿÿ
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 _formend%ÿ0
 ÿØ_formend%ÿ0
MADRsub%ÿ0
ÿ¡ÿ>(ÿœ)ÿ"MAADR"ÿp
ÿÊÿŸtitle$ÿ" - Agenturen"
ÿ´ÿœ"maadr"
ÿ¡title$ÿ"*Agentur*"ÿp
ÿÊÿœÿesp$
ÿÊÿœÿesn$
ÿÊÿœÿesuname$
ÿÊÿœÿekond$
ÿÊÿœÿeneu$
ÿ’ÿ¡
ÿƒMADRIntro()
ÿƒMNMADR()
ÿ¬ÿ³
ÿÊÿË"Agenturverwaltung"
ÿ’ÿ¡
ÿƒMADRUpdate()
ÿßÿ³
ÿœ

ÿƒClearKBDBuffer()
ÿœ
ÿ¡MADRsub%ÿ99ÿpÿÏÿ¥ÿÿ¬ÿÿß
ÿ½ ** Tastaturabfrage
ÿk$
ÿÉÿæÿ.(k$)
ÿæCrsLeft%,PgUp%
ÿƒMAADRPrev()
ÿæCrsRight%,PgDn%
ÿƒMAADRNext()
ÿ’ÿÉ
ÿÉÿæMADRsub%
ÿæ1
cuma%ÿCodeMA.maadr
ÿƒGEKOND()
ÿæ2
ÿƒLIST6()
ÿæ99
ÿ¡ÿA("maadr")ÿ0ÿpÿƒMADRNeu()
ÿ”Anrede.MAADR,0
ÿ’ÿÉ
MADRsub%ÿ0
 ÿÙ
 _formend%ÿ0
 cuma%ÿ0
 ÿ’ÿÿ


 ' MAADR Intro 
 ' =======================================================================

ÿÿMADRIntro()
 ÿ™"maadr"
 ÿ£Nachname.maadr
 ÿ¡title$ÿ"*Agentur*"ÿp
cuma%ÿÿ0(ReadConfig$("PROVIS","Agentur"))
ÿ¡cuma%ÿ0ÿp
ÿ×Agenturen$(50)
a%ÿ0
ÿ™"maadr"
ÿ£Nachname.MAADR
ÿÉÿ`
prompt$ÿNachname.MAADRÿ", "ÿVorname.MAADRÿÿ'(100)ÿ"("ÿÿ(CodeMA.MAADR,"000000")ÿ")"
ÿØÿOÿB("MAADR")
Agenturen$(a%)ÿNachname.MAADRÿ", "ÿVorname.MAADRÿÿ'(100)ÿ"("ÿÿ(CodeMA.MAADR,"000000")ÿ")"
a%ÿa%ÿ1
ÿÉÿ±
ÿÙ
ÿ×Auswahl$(50)
ÿ‰ÿñ"AGENTUR",0,0,258,214,"Agenturauswahl","MS Sans Serif",8
ÿ|ÿñ"AGENTUR",4,0,0,258,188,0,""
ÿ|ÿñ"AGENTUR",9,8,12,21,21,3
ÿ|ÿñ"AGENTUR",5,36,14,214,10,0,"Fr dieses Programm wurde die zu bearbeitende Agentur"
ÿ|ÿñ"AGENTUR",5,36,24,214,10,0,"noch nicht festgelegt."
ÿ|ÿñ"AGENTUR",5,36,40,214,8,0,"Bitte w„hlen Sie aus der unteren Liste die Agentur aus, die mit"
ÿ|ÿñ"AGENTUR",5,36,50,214,10,0,"diesem Programm bearbeitet werden soll."
ÿ|ÿñ"AGENTUR",5,36,64,214,11,0,"Eine nachtr„gliche nderung der Agentur ist nicht m”glich!"
ÿ|ÿñ"AGENTUR",5,36,80,37,10,0,"A&genturen:"
ÿ|ÿñ"AGENTUR",7,36,90,216,90,2,2,Agenturen$,Auswahl$,prompt$
ÿ|ÿñ"AGENTUR",1,66,192,55,14,1,"OK",1,1
ÿ|ÿñ"AGENTUR",1,125,192,53,14,0,"&Abbrechen",0,0
ÿñ"AGENTUR",req%
ÿ¾ÿñ"AGENTUR"
ÿ¡req%ÿ0ÿp
cuma%ÿÿ0(ÿ,(Auswahl$(0),ÿ/(Auswahl$(0))ÿ6,6))
ÿƒWriteConfig("PROVIS","Agentur",ÿ(cuma%,"000000"))
ÿ^
_formend%ÿ1
ÿ’ÿ¡
ÿ’ÿ¡
ÿÉÿœÿ¥cuma%ÿ™"maadr"ÿ£CodeMA.maadr
 ÿ^
ÿ¡cuma%ÿ0ÿpÿÉÿ¥cuma%ÿ™"MAADR"ÿ£CodeMA.MAADRÿ^ÿÉÿ`
 ÿ’ÿ¡
 ÿÊÿ£Nachname.maadr
 ÿ£Nachname.maadr
 ÿœ
 ÿ’ÿÿ


 ' MAADR Neu
 ' =======================================================================

ÿÿMADRNeu()
 ÿ™"maadr"
 ÿ¡Nachname.maadrÿ""ÿpÿƒFStore("maadr")
 ÿ¡title$ÿ"*SmartPROVIS F*"ÿp
ÿ¡ÿA("MAADR")ÿfsmax%ÿp
ÿƒFehler("In der FirstStep - Version k”nnen maximal "ÿÿH(ÿ(fsmax%,"99"))ÿ" Agenturen erfaát werden!","")
ÿ’ÿÿ
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ
 ÿÊÿË"Datensatz neu angelegt..."
 CodeMA.maadrÿÿI("maadr",1)
 MADRsub%ÿ99
 ÿƒMADRUpdate()
 ÿ’ÿÿ

ÿÿMAADRSperre()
 ÿƒDSSperre("CodeMA","MAADR")
 ÿ’ÿÿ


 ' MAADR Knopf/Feldbeschriftungen
 ' =======================================================================
 
ÿÿMADRUpdate()
 ÿ¡Vorg„nger.MAADRÿ0ÿp
cuma%ÿCodeMA.MAADR
ÿÉÿ¥Vorg„nger.MAADRÿ™"MAADR"ÿ£CodeMA.MAADR
vorgaenger$ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ"."
ÿÉÿ¥cuma%ÿ™"MAADR"ÿ£CodeMA.MAADR
 ÿ^
vorgaenger$ÿ"<keine Zuordnung>"
 ÿ’ÿ¡
 ÿ¡Kndigung.MAADRÿ0ÿp
kndg$ÿ"Kndi&gung ®"
 ÿ^
kndg$ÿ"Kndi&gung"
 ÿ’ÿ¡
 ÿ¡Sperre.MAADRÿ0ÿp
ÿ¡MNdisabled%("DATALOCK")ÿp
MAADRLock$ÿ"gesperrt"
ÿ^
ÿÉÿ¥Sperre.MAADRÿ™"SUPERVIS"ÿ£CodeMA.SUPERVIS
MAADRLock$ÿ"gesperrt durch "ÿName.SUPERVIS
ÿ’ÿ¡
ÿ¬2,6,2
 ÿ^
MAADRLock$ÿ"freier Zugriff"
ÿ¬2,6,1
 ÿ’ÿ¡
 ÿ’ÿÿ
 

 ' MAADR Suchen
 ' =======================================================================
 ' 02.07.94/FA - Requester durch "SPACE$-Dialog" ersetzt

ÿÿMADRSuchen()
 _cuma%ÿCodeMA.MAADR
 ÿ¡(ÿ("MAADR")ÿÿ°("MAADR"))ÿnachname.maadrÿ""ÿpÿƒFStore("MAADR")
 rep%ÿGetCodeMA%(_cuma%)
 ÿ¡rep%ÿ0ÿp
_cuma%ÿrep%
 ÿ’ÿ¡
 ÿÉÿ¥_cuma%ÿ™"MAADR"ÿ£CodeMA.MAADR
 ÿÊÿ£Nachname.MAADR
 ÿ£Nachname.MAADR
 ÿœ
 ÿ’ÿÿ
 
ÿÿGetCodeMA%(prompt%)
 ÿ×Agenturen$(ÿA("MAADR")ÿ1)
 ÿ×Auswahl$(1)
 cfile$ÿÿ™
 _pos%ÿCodeMA.MAADR
 ÿ™"MAADR"
 ÿ£Nachname.MAADR
 ÿÉÿ`
 Agenturen$(0)ÿ"<keine Zuordnung>"ÿÿ'(120)ÿ"000000"
 a%ÿ1
 prompt$ÿ""
 ÿßÿe
 ÿØÿOÿB("MAADR")
sok%ÿÿ1
ÿ¡MNdisabled%("DATALOCK")ÿp
ÿ¡Sperre.MAADRÿ0ÿSperre.MAADRÿvcodema%ÿpsok%ÿ0
ÿ’ÿ¡
ÿ¡sok%ÿp
Agenturen$(a%)ÿNachname.MAADRÿ", "ÿVorname.MAADRÿÿ'(120)ÿÿ(CodeMA.MAADR,"000000")
ÿ¡CodeMA.MAADRÿprompt%ÿpprompt$ÿAgenturen$(a%)
a%ÿa%ÿ1
ÿ’ÿ¡
ÿÉÿ±
 ÿÙ
 ÿ‰ÿñ"MASUCH",0,0,208,188,"Agentur-/Vermittlerbersicht","MS Sans Serif",8
 ÿ|ÿñ"MASUCH",4,0,0,208,163,0,""
 ÿ|ÿñ"MASUCH",9,9,11,21,21,2
 ÿ|ÿñ"MASUCH",5,37,11,151,10,0,"Bitte w„hlen Sie aus der folgenden Liste aus:"
 ÿ|ÿñ"MASUCH",7,37,27,164,129,0,2,Agenturen$,Auswahl$,prompt$
 ÿ|ÿñ"MASUCH",1,46,168,55,15,1,"&OK",1,1
 ÿ|ÿñ"MASUCH",1,103,168,55,15,0,"&Abbrechen",0,0
 ÿßÿ³
 ÿñ"MASUCH",req%
 ÿ¾ÿñ"MASUCH"
 ÿ¡req%ÿ1ÿp
GetCodeMA%ÿÿ0(ÿ-(Auswahl$(0),6))
 ÿ^
GetCodeMA%ÿ0
 ÿ’ÿ¡
 ÿÉÿ¥_pos%ÿ™"MAADR"ÿ£CodeMA.MAADR
 ÿ™cfile$
 ÿ’ÿÿ
 

ÿÿMAADRNext()
 ÿ¡FileChanged%("maadr")ÿ1ÿpÿƒFStore("maadr")
 ÿ™"MAADR"
 ÿÊÿ£Nachname.maadr
 ÿ£Nachname.maadr
 ÿƒPSelectNext()
 ÿœ
 ÿ’ÿÿ
 
ÿÿMAADRPrev()
 ÿ¡FileChanged%("maadr")ÿ1ÿpÿƒFStore("maadr")
 ÿ™"MAADR"
 ÿÊÿ£nachname.maadr
 ÿ£Nachname.maadr
 ÿƒPSelectPrev()
 ÿœ
 ÿ’ÿÿ

ÿÿMAADRLoeschen()
 ÿ¡disabled%("MAADRLOESCHEN")ÿpÿ’ÿÿ
 ÿßÿe
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 cuma%ÿCodeMA.MAADR
 Dateien$ÿ""
 ok%ÿ1
 ÿ¡ÿJ(cuma%,CodeMA.KVERTRAG)ÿp
ok%ÿ0
Dateien$ÿDateien$ÿ", Vertr„ge"
 ÿ’ÿ¡
 ÿ¡ÿJ(cuma%,CodeMA.GEKOND)ÿp
ok%ÿ0
Dateien$ÿDateien$ÿ", Konditionen"
 ÿ’ÿ¡
 ÿßÿ³
 ÿ¡ok%ÿ0ÿp
Dateien$ÿÿ-(Dateien$,ÿ/(Dateien$)ÿ2)
ÿƒFehler("L”schen nicht m”glich!","Es existieren Verknpfungen zu den Dateien: "ÿDateien$ÿ".")
ÿÊÿË"Datensatz konnte nicht gel”scht werden"
 ÿ^
ÿßÿe
ÿÂ"Wollen Sie die aktuelle Agentur wirklich l”schen?","",135,req%
ÿ¡req%ÿ1ÿp
ÿÉÿ¥cuma%ÿáÿ™"MAADR"ÿ£CodeMA.MAADR
ÿÉÿ¾
ÿÊÿË"Datensatz wurde gel”scht"
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿœ
 ÿßÿ³
 ÿœ
 ÿ’ÿÿ
 
 
 ' Mitarbeiter kndigen
 ' =======================================================================

ÿÿMAADRKnd()
 ÿßÿe
 ÿ×Agenturen$(ÿA("MAADR")ÿ1)
 Agenturen$(0)ÿ"<keine Zuordnung>"ÿÿ'(80)ÿ"000000"
 cfile$ÿÿ™
 ÿ™"MAADR"
 cuag%ÿCodeMA.MAADR
 Nachfolger%ÿNachfolger
 cindex$ÿÿ£
 ÿ£CodeMA
 ÿÉÿ`
 a%ÿ1
 prompt$ÿ""
 ÿØÿOÿB("MAADR")
Agenturen$(a%)ÿNachname ÿ", "ÿÿ+(Vorname,1)ÿÿ'(80)ÿÿ(CodeMA,"000000")
ÿ¡Nachfolger%ÿCodeMA ÿpprompt$ÿAgenturen$(a%)
ÿÉÿ±
a%ÿa%ÿ1
 ÿÙ
 ÿÉÿ¥cuma%ÿá
 ÿ¡Kndigung ÿ0ÿp
prompt$ÿAgenturen$(0)
opt%ÿ1
 ÿ^
ÿ¡prompt$ÿ""ÿp
prompt$ÿAgenturen$(0)
opt%ÿ1
ÿ^
opt%ÿ2
ÿ’ÿ¡
 ÿ’ÿ¡
 Auswahl$ÿprompt$
 Agentur$ÿNachname ÿ", "ÿÿ+(Vorname,1)
 ÿßÿ³
 ÿ‰ÿñ"KNDG",0,0,211,162,"Kndigung","MS Sans Serif",8
 ÿ|ÿñ"KNDG",4,0,0,211,140,0,""
 ÿ|ÿñ"KNDG",9,8,14,21,23,2
 ÿ|ÿñ"KNDG",5,35,13,172,25,0,"Bitte geben Sie nachfolgend alle Daten an, die zur ordnungsgem„áen Kndigung der aktuellen Agentur ben”tigt werden:"
 ÿ|ÿñ"KNDG",4,35,38,172,37,0,""
 ÿ|ÿñ"KNDG",5,40,47,54,11,0,"Agentur:"
 ÿ|ÿñ"KNDG",5,96,46,100,13,0,Agentur$
 ÿ|ÿñ"KNDG",5,40,58,51,10,0,"Kndigung ab:"
 ÿ|ÿñ"KNDG",6,96,57,41,12,0,0,Kndigung,20
 ÿ|ÿñ"KNDG",4,35,70,172,65,0,""
 ÿ|ÿñ"KNDG",5,40,79,159,13,0,"Weiterhin anfallende Provisionen..."
 ÿ|ÿñ"KNDG",3,40,91,55,11,0,"weiterzahlen",1,opt%
 ÿ|ÿñ"KNDG",3,40,103,147,11,0,"der nachfolgenden Agentur gutschreiben",2,opt%
 ÿ|ÿñ"KNDG",8,86,115,114,66,259,2,Auswahl$,Agenturen$
 ÿ|ÿñ"KNDG",5,51,116,27,8,0,"Agentur"
 ÿ|ÿñ"KNDG",1,50,145,55,15,0,"&OK",1,1
 ÿ|ÿñ"KNDG",1,106,145,55,15,0,"&Abbrechen",0,0
 ÿñ"KNDG",req%
 ÿ¾ÿñ"KNDG"
 ÿ¡req%ÿ1ÿp
ÿ¡Kndigung ÿ0ÿp
ÿ¡opt%ÿ1ÿpNachfolger ÿ0ÿ^Nachfolger ÿÿ0(ÿ-(Auswahl$,6))
ÿ^
Nachfolger ÿ0
ÿ’ÿ¡
ÿÌÿ™"MAADR"
 ÿ’ÿ¡
 ÿœ
 ÿßÿ³
 ÿ’ÿÿ




 ' Strukturaufbau Vorg„nger
 ' =======================================================================

ÿÿVorgaenger()
 ÿ¡disabled%("VORGAENGER")ÿpÿ’ÿÿ

 _cuma%ÿCodeMA.MAADR
 Vorg„nger%ÿVorg„nger.MAADR
 ÿ¡(ÿ("MAADR")ÿÿ°("MAADR"))ÿnachname.maadrÿ""ÿpÿƒFStore("MAADR")
 ÿ×Agenturen$(ÿA("MAADR"))
 ÿ×Auswahl$(1)
 ÿ™"MAADR"
 ÿ£Nachname.MAADR
 ÿÉÿ`
 a%ÿ0
 prompt$ÿ""
 ÿßÿe
 ÿØÿOÿB("MAADR")
Agenturen$(a%)ÿNachname.MAADRÿ", "ÿVorname.MAADRÿÿ'(120)ÿÿ(CodeMA.MAADR,"000000")
ÿ¡CodeMA.MAADRÿVorg„nger%ÿpprompt$ÿAgenturen$(a%)
ÿÉÿ±
a%ÿa%ÿ1
 ÿÙ
 ÿ‰ÿñ"MASUCH",0,0,208,188,"Strukturaufbau","MS Sans Serif",8
 ÿ|ÿñ"MASUCH",4,0,0,208,163,0,""
 ÿ|ÿñ"MASUCH",9,9,11,21,21,2
 ÿ|ÿñ"MASUCH",5,37,11,151,10,0,"Bitte w„hlen einen Vorg„nger aus:"
 ÿ|ÿñ"MASUCH",7,37,27,164,129,0,2,Agenturen$,Auswahl$,prompt$
 ÿ|ÿñ"MASUCH",1,46,168,55,15,1,"&OK",1,1
 ÿ|ÿñ"MASUCH",1,103,168,55,15,0,"&Abbrechen",0,0
 ÿßÿ³
 ÿñ"MASUCH",req%
 ÿ¾ÿñ"MASUCH"
 ÿ¡req%ÿ1ÿp
ÿÉÿ¥_cuma%ÿáÿ™"maadr"ÿ£CodeMA.maadr
Vorg„nger.maadrÿÿ0(ÿ-(Auswahl$(0),6))
ÿƒFStore("maadr")
 ÿ’ÿ¡
 ÿÉÿ¥_cuma%ÿ™"MAADR"ÿ£CodeMA.MAADR
 ÿÊÿ£Nachname.MAADR
 ÿ£Nachname.MAADR
 ÿœ
 ÿ’ÿÿ


 ' MAADRLIST Ausgabe einer šbersicht der Agenturen
 ' ====================================================================== 

ÿÿMAADRLIST()
 ÿßÿe
 ÿ¡disabled%("MAADRLIST")ÿpÿ’ÿÿ
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 cuma%ÿCodeMA.MAADR
 ÿ×Mitarbeiter$(ÿA("MAADR"))
 a%ÿ0
 ÿ™"MAADR"
 ÿ£CodeMA.MAADR
 prompt$ÿ"ZZZZZZZ"
 ÿÉÿ`
 ÿØÿOÿB("MAADR")
Mitarbeiter$(a%)ÿNachname.MAADRÿÿ¡(Vorname.MAADRÿ"",", "ÿVorname.MAADR,"")ÿÿ'(120)ÿÿ(CodeMA.MAADR,"000000")
ÿ¡ÿœÿ"*maadr*"ÿp
ÿ¡CodeMA.MAADRÿcuma%ÿpprompt$ÿMitarbeiter$(a%)
opt%ÿ2
ÿ^
opt%ÿ1
ÿ¡Mitarbeiter$(a%)ÿ
prompt$ÿpprompt$ÿMitarbeiter$(a%)
ÿ’ÿ¡
a%ÿa%ÿ1
ÿÉÿ±
 ÿÙ
 Auswahl$ÿprompt$
 ÿßÿ³
 ÿ‰ÿñ"MALIST",0,0,195,136,title$,"MS Sans Serif",8
 ÿ|ÿñ"MALIST",4,0,0,195,111,0,""
 ÿ|ÿñ"MALIST",9,5,10,20,23,2
 ÿ|ÿñ"MALIST",5,30,11,158,24,0,"Ausgabe der Mitarbeiter-/Agenturbersicht"
 ÿ|ÿñ"MALIST",5,30,24,156,26,0,"Bitte w„hlen Sie aus, ob Sie die Daten eines einzelnen oder aller Mitarbeiter ausgeben wollen."
 ÿ|ÿñ"MALIST",5,30,54,44,10,0,"Ausgabe fr"
 ÿ|ÿñ"MALIST",3,30,64,98,12,0,"alle Mitarbeiter/Agenturen",1,opt%
 ÿ|ÿñ"MALIST",3,30,76,154,12,0,"einzelner Mitarbeiter/einzelne Agentur",2,opt%
 ÿ|ÿñ"MALIST",8,40,90,145,50,259,2,Auswahl$,Mitarbeiter$
 ÿ|ÿñ"MALIST",1,40,113,55,15,1,"&OK",1,1
 ÿ|ÿñ"MALIST",1,96,113,55,15,0,"&Abbrechen",0,0
 ÿñ"MALIST",req%
 ÿ¾ÿñ"MALIST"
 ÿ¡req%ÿ1ÿp
ÿßÿe
ÿÁÿs"LMAADR"
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿÊÿiÿ³
ÿÊÿiÿáÿe
ÿ³ÿ_ÿwErrorMAADRLIST
ÿ¡opt%ÿ1ÿp
ÿÉ;
ÿµÿÁNachname.MAADR
ÿqÿ~
ÿ^
ÿÉ;
ÿµÿÁNachname.MAADR
ÿĞCodeMA.MAADRÿÿ0(ÿ-(Auswahl$,6))
ÿqÿ~
ÿ’ÿ¡
 ÿ’ÿ¡
ErrorMAADRLIST: 
 ÿ¡test%ÿ0ÿpÿ³ÿ_ÿwErrorHandler ÿ^ÿ³ÿ_
 ÿÉÿœÿ¥cuma%ÿ™"MAADR"ÿ£CodeMA.MAADR
 ÿœ
 ÿßÿ³
 ÿ’ÿÿ
 

 ' wird von MAADRLIST() genutzt
 ' ====================================================================== 

ÿÿGetVorg$(vorg%)
 ÿ¡vorg%ÿ0ÿvorg%ÿCodeMA.MAADRÿp
GetVorg$ÿ"kein Vorg„nger"
 ÿ^
cuma%ÿCodeMA.MAADR
ÿÉÿ¥vorg%ÿ™"MAADR"ÿ£CodeMA.MAADR
GetVorg$ÿNachname.MAADRÿÿ¡(Vorname.MAADRÿ"",", "ÿVorname.MAADR,"")
ÿÉÿ¥cuma%ÿ™"MAADR"ÿ£CodeMA.MAADR
 ÿ’ÿ¡
 ÿ’ÿÿ
 
 
 
 
 '      *************************************
 '      ** Routinen fr Formular "SPARTEN" **
 '      *************************************

ÿÿCODEVA()
 ÿ¡disabled%("SPARTEN")ÿpÿ’ÿÿ
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 _formend%ÿ0
 ÿØ_formend%ÿ0
ÿ¡ÿ>(ÿœ)ÿ"SPARTEN"ÿp
ÿÊÿŸtitle$ÿ" - Sparten"
ÿ´ÿœ"SPARTEN"
ÿ™"sparten"
ÿƒMNCODEVA()
ÿÊÿË"Sparten/Vertragsarten"
ÿ¬ÿ³
ÿ£sparte.sparten
ÿÉÿ`
ÿ’ÿ¡
ÿœ
ÿßÿ³
ÿ¡SPARTEsub%ÿ99ÿpÿÏÿßÿÿ¥ÿÿ¬
ÿÉÿæSPARTEsub%
ÿæ1
ÿƒLIST8()
ÿæ99
ÿ¡ÿA("sparten")ÿ0ÿpÿƒCODEVANeu()
ÿ”sparte.sparten,0
ÿ’ÿÉ
SPARTEsub%ÿ0
 ÿÙ
 ÿ¡sparte.spartenÿ""ÿpÿ¡ÿ°("SPARTEN")ÿÿ("SPARTEN")ÿpÿƒFStore("SPARTEN")
 _formend%ÿ0
 ÿ’ÿÿ
 

 ' SPARTEN Neu
 ' =======================================================================

ÿÿCODEVANeu()
 ÿ¡Sparte.spartenÿ""ÿpÿ¡ÿ°("sparten")ÿÿ("sparten")ÿpÿƒFStore("sparten")
 ÿ
 ÿÊÿË"Datensatz neu angelegt..."
 codeva.spartenÿÿI("sparten",1)
 ÿœ
 SPARTEsub%ÿ99
 ÿ’ÿÿ


 ' SPARTEN Suchen
 ' =======================================================================

ÿÿCODEVASuchen()
 ÿÊÿiÿ³
 ÿÊÿ£ÿt
 cuva%ÿcodeva.sparten
 ÿ¡ÿ("SPARTEN")ÿÿ°("SPARTEN")ÿpÿƒFStore("SPARTEN")
 rep%ÿGetCodeVA%(cuva%)
 ÿ¡rep%ÿ0ÿpcuva%ÿrep%
 ÿÉÿ¥cuva%ÿ£codeva.sparten
 ÿÊÿ£ÿt
 ÿ£sparte.sparten
 ÿœ
 ÿ’ÿÿ


 ' SPARTEN l”schen
 ' =======================================================================
 
ÿÿCODEVALoeschen()
 ÿ¡disabled%("SPARTENLOESCHEN")ÿpÿ’ÿÿ
 ÿßÿe
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"gekondm"ÿ_fpw$)
 cuva%ÿCodeVA.SPARTEN
 Dateien$ÿ""
 ok%ÿ1
 ÿ¡ÿJ(cuva%,CodeVA.KVERTRAG)ÿp
ok%ÿ0
Dateien$ÿDateien$ÿ", Vertr„ge"
 ÿ’ÿ¡
 ÿ¡ÿJ(cuva%,CodeVA.GEKOND)ÿp
ok%ÿ0
Dateien$ÿDateien$ÿ", Konditionen"
 ÿ’ÿ¡
 ÿ¡ÿJ(cuva%,CodeVA.GEKONDM)ÿp
ok%ÿ0
Dateien$ÿDateien$ÿ", Musterkonditionen"
 ÿ’ÿ¡
 ÿßÿ³
 ÿ¡ok%ÿ0ÿp
Dateien$ÿÿ-(Dateien$,ÿ/(Dateien$)ÿ2)
ÿƒFehler("L”schen nicht m”glich!","Es existieren Verknpfungen zu den Dateien: "ÿDateien$ÿ".")
ÿÊÿË"Datensatz konnte nicht gel”scht werden"
 ÿ^
ÿßÿe
ÿÂ"Wollen Sie die Sparte "ÿÿ(34)ÿsparte.SPARTENÿÿ(34)ÿ" wirklich l”schen?","",135,req%
ÿ¡req%ÿ1ÿp
ÿÉÿ¥cuva%ÿáÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
ÿÉÿ¾
ÿÊÿË"Datensatz wurde gel”scht"
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿœ
 ÿßÿ³
 ÿ’ÿÿ
 

ÿÿGetCodeVA%(prompt%)
 ÿ×Sparten$(ÿA("SPARTEN")ÿ1)
 ÿ×Auswahl$(1)
 cfile$ÿÿ™
 _pos%ÿCodeVA.SPARTEN
 ÿ™"SPARTEN"
 ÿ£Sparte.SPARTEN
 ÿÉÿ`
 Sparten$(0)ÿ"<keine Zuordnung>"ÿÿ'(55)ÿ"000000"
 a%ÿ1
 prompt$ÿ""
 ÿßÿe
 ÿØÿOÿB("SPARTEN")
Sparten$(a%)ÿSparte.SPARTENÿÿ'(50)ÿÿ(CodeVA.SPARTEN,"000000")
ÿ¡CodeVA.SPARTENÿprompt%ÿpprompt$ÿSparten$(a%)
ÿÉÿ±
a%ÿa%ÿ1
 ÿÙ
 ÿ‰ÿñ"MASUCH",0,0,208,188,"Spartenbersicht","MS Sans Serif",8
 ÿ|ÿñ"MASUCH",4,0,0,208,163,0,""
 ÿ|ÿñ"MASUCH",9,9,11,21,21,2
 ÿ|ÿñ"MASUCH",5,37,11,151,10,0,"Bitte w„hlen Sie aus der folgenden Liste aus:"
 ÿ|ÿñ"MASUCH",7,37,27,134,129,0,2,Sparten$,Auswahl$,prompt$
 ÿ|ÿñ"MASUCH",1,46,168,55,15,1,"&OK",1,1
 ÿ|ÿñ"MASUCH",1,103,168,55,15,0,"&Abbrechen",0,0
 ÿßÿ³
 ÿñ"MASUCH",req%
 ÿ¾ÿñ"MASUCH"
 ÿ¡req%ÿ1ÿp
GetCodeVA%ÿÿ0(ÿ-(Auswahl$(0),6))
 ÿ^
GetCodeVA%ÿ0
 ÿ’ÿ¡
 ÿÉÿ¥_pos%ÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 ÿ™cfile$
 ÿ’ÿÿ
 



 '      ***********************************
 '      ** Routinen fr Zahlungsabgleich **
 '      ***********************************
 
ÿÿEINGANG()
 ÿ¡disabled%("EINGANG")ÿpÿ’ÿÿ
 ÿƒDFile(3,"ZEINGANG"ÿ_fpw$)
 ÿƒDFile(3,"KVERTRAG"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿƒDFile(3,"GEADR"ÿ_fpw$)
 ÿƒDFile(3,"SPARTEN"ÿ_fpw$)
 ÿƒDFile(3,"MAADR"ÿ_fpw$)
 ÿ™"ZEINGANG"
 _formend%ÿ0
 ÿØ_formend%ÿ0
ÿ¡ÿ>(ÿœ)ÿ"EINGANG"ÿp
ÿÊÿŸtitle$ÿ" - Zahlungseing„nge"
ÿ´ÿœ"EINGANG"
ÿÊÿœÿeUebers$
ÿƒZEINIntro()
ÿƒMNEINGANG()
ÿÊÿË"Zahlungseing„nge"
ÿ’ÿ¡
ÿ¬ÿ³
ÿßÿ³
ZEINsub%ÿ0
ÿƒZEINUpdate()
ÿƒClearKBDBuffer()
ÿœ
ÿ¡ZEINsub%ÿ99ÿpÿÏÿ¥ÿÿ¬ÿÿß
ÿ½ ** Tastaturabfrage
ÿk$
ÿÉÿæÿ.(k$)
ÿæCrsLeft%,PgUp%
ÿƒPSelectPrev()
ÿæCrsRight%,PgDn%
ÿƒPSelectNext()
ÿ’ÿÉ
ÿÉÿæZEINsub%
ÿæ99
ÿ¡ÿA("ZEINGANG")ÿ0ÿpÿƒZEINNeu()
ÿ¡ÿíÿ1ÿp
ÿ”VS_Nr.ZEINGANG,0
ÿ’ÿ¡
ÿ’ÿÉ
 ÿÙ
 ÿ½ CALL ZEINBuchung( - 1)
 ÿƒZEINBuchung(0)
 _formend%ÿ0
 ÿ’ÿÿ


ÿÿZEINIntro()
 ÿßÿe
 ÿ™"ZEINGANG"
 ÿ£CodeAZ.ZEINGANG
 ÿÉÿœÿb
 ÿœ
 ÿ’ÿÿ

ÿÿZEINUpdate()
 ÿÉÿ¥CodeVT.ZEINGANGÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿÉÿ¥CodeMA.KVERTRAGÿ™"MAADR"ÿ£CodeMA.MAADR
 ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
 ÿÉÿ¥CodeVA.KVERTRAGÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 ÿÉÿ¥CodeKU.KVERTRAGÿ™"ADRESSEN"ÿ£CodeKU.ADRESSEN
 lGesellschaft$ÿGesellschaft.GEADR
 lAgentur$ÿNachname.MAADRÿ", "ÿVorname.MAADR
 lSparte$ÿSparte.SPARTEN
 lKunde$ÿNachname.ADRESSENÿ", "ÿVorname.ADRESSEN
 ÿœ
 ÿ’ÿÿ

ÿÿZEINNeu()
 ÿ¡ÿ°("ZEINGANG")ÿÿ("ZEINGANG")ÿpÿƒFStore("ZEINGANG")
 lVSNR$ÿVS_Nr.ZEINGANGÿ" ("ÿÿ(Datum.ZEINGANG,"dd.mm.yy")ÿ"/"ÿÿH(ÿ(Betrag.ZEINGANG,",999999999.00"))ÿ")"
 ÿ
 ÿÊÿË"Datensatz neu angelegt..."
 CodeAZ.ZEINGANGÿÿI("ZEINGANG",1)
 Datum.ZEINGANGÿÿ(ÿQ,"dd.mm.yy")
 lKunde$ÿ""
 lGesellschaft$ÿ""
 lSparte$ÿ""
 lAgentur$ÿ""
 ÿœ
 ZEINsub%ÿ99
 ÿ’ÿÿ
 
 ' Zahlungseingang sichern
 ' =======================================================================
 ' 19.09.95/FA automatischer Abglich mit Mahnliste
 
ÿÿZEINSichern()
 cuzein%ÿCodeAZ.ZEINGANG
 cuvnr%ÿCodeVT.ZEINGANG
 ÿÉÿ¥cuvnr%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿ¡Mahnung.KVERTRAGÿ"j"ÿp
ÿßÿe
ÿÊÿË"Abgleich mit Mahnliste..."
Pool.KVERTRAGÿPool.KVERTRAGÿBetrag.ZEINGANG
gebucht.ZEINGANGÿ"j"
ÿƒQuickStore("KVERTRAG")
ÿƒQuickStore("ZEINGANG")
ÿ¡Pool.KVERTRAGÿ0ÿp
ÿÉÿ¥cuvnr%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
Mahnung.KVERTRAGÿ"n"
ÿƒQuickStore("KVERTRAG")
ÿƒDFile(3,"BUCHUNG"ÿ_fpw$)
ÿÍMahnung.BUCHUNGÿ"n"ÿĞCodeVT.BUCHUNGÿcuvnr%ÿMahnung.BUCHUNGÿ"j"
ÿ’ÿÍ
ÿƒInfo("Alle Buchungen des Vertrages "ÿVS_NR.KVERTRAGÿ" konnten aus der Mahnliste entfernt werden.","")
ÿ^
ÿƒInfo("Zur Information:","Es fehlen noch "ÿÿH(ÿ(0ÿPool.KVERTRAG,",9999999.00"))ÿ" DM zur Auszahlung der in der Mahnliste enthaltenen Provisionen!")
ÿ’ÿ¡
ÿßÿ³
 ÿ^
ÿƒFStore("ZEINGANG")
 ÿ’ÿ¡
 ÿ’ÿÿ

ÿÿZEINTest()
 ÿßÿe
 ÿÊÿË"Prfung..."
 ÿ×Vertraege$(ÿA("KVERTRAG"))
 ÿ×Auswahl$(1)
 cfile$ÿÿ™
 ÿ™"KVERTRAG"
 ÿ£QuickVSNR.KVERTRAG
 ÿÉÿ`
 VSNR$ÿVS_Nr.ZEINGANG
 tVSNR$ÿVSNRPack$(VSNR$)
 ÿÉÿ¥tVSNR$ÿ™"KVERTRAG"ÿ£QuickVSNR.KVERTRAG
 a%ÿ0
 ÿØQuickVSNR.KVERTRAGÿtVSNR$ÿ"*"ÿÿOÿB("KVERTRAG")
ÿ¡VS_Beginn.KVERTRAGÿ
1ÿpvon$ÿ"__.__.__"ÿ^von$ÿÿ(VS_Beginn.KVERTRAG,"0d.mm.yy")
ÿ¡Kndigung.KVERTRAGÿ
1ÿpbis$ÿ"__.__.__"ÿ^bis$ÿÿ(Kndigung.KVERTRAG,"0d.mm.yy")
Vertraege$(a%)ÿÿK(VS_Nr.KVERTRAG,38)ÿÿ(9)ÿ"  "ÿvon$ÿ" - "ÿbis$ÿÿ'(6)ÿÿ(lfdnr.KVERTRAG,"000000")
ÿ¡a%ÿ0ÿpprompt$ÿVertraege$(0)
a%ÿa%ÿ1
ÿÉÿ±
 ÿÙ
 ÿ¡a%ÿ0ÿp
sel%ÿ0
 ÿ^
ÿ¡a%ÿ1ÿp
ÿßÿ³
ÿ‰ÿñ"ZEINLIST",0,0,251,198,title$,"MS Sans Serif",8
ÿ|ÿñ"ZEINLIST",4,0,0,251,172,0,""
ÿ|ÿñ"ZEINLIST",9,8,11,25,24,2
ÿ|ÿñ"ZEINLIST",5,35,11,168,20,0,"Es wurden mehrere Vertr„ge mit gleicher oder „hnlicher Nummer gefunden."
ÿ|ÿñ"ZEINLIST",5,35,31,168,20,0,"Bitte w„hlen Sie den Vertrag aus, fr den diese Zahlung gilt."
ÿ|ÿñ"ZEINLIST",5,35,58,198,10,0,"Vertrags-/Policennummer                       von          bis"
ÿ|ÿñ"ZEINLIST",7,36,68,205,105,2ÿ128,2,Vertraege$,Auswahl$,prompt$
ÿ|ÿñ"ZEINLIST",1,68,178,55,15,1,"&OK",1,1
ÿ|ÿñ"ZEINLIST",1,128,178,55,15,0,"&Abbrechen",0,0
ÿñ"ZEINLIST",req%
ÿ¾ÿñ"ZEINLIST"
ÿ¡req%ÿ1ÿp
sel%ÿÿ0(ÿ-(Auswahl$(0),6))
ÿ^
sel%ÿ0
ÿ’ÿ¡
ÿ^
sel%ÿÿ0(ÿ-(Vertraege$(0),6))
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡sel%ÿ0ÿp
ÿÉÿ¥sel%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
checked%ÿ0
ÿ¡check.KVERTRAGÿ"j"ÿp
ÿÉÿ¥CodeVA.KVERTRAGÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
VertrInfo$ÿgesellschaft.GEADRÿ"/"ÿSparte.Sparten
ÿÉÿ¥CodeKU.KVERTRAGÿ™"ADRESSEN"ÿ£COdeKU.ADRESSEN
Kunde$ÿNachname.ADRESSENÿ", "ÿVorname.ADRESSEN
ÿ‰ÿñ"CHECKEIN",0,0,222,125,title$,"MS Sans Serif",8
ÿ|ÿñ"CHECKEIN",4,0,0,222,100,0,""
ÿ|ÿñ"CHECKEIN",9,7,12,22,22,2
ÿ|ÿñ"CHECKEIN",5,34,13,180,22,0,"Der ausgew„hlte Vertrag wurde noch nicht fr die Zahlungseingangskontrolle aktiviert."
ÿ|ÿñ"CHECKEIN",5,34,36,28,12,0,"Vertrag:"
ÿ|ÿñ"CHECKEIN",5,66,36,149,11,0,VS_NR.KVERTRAG
ÿ|ÿñ"CHECKEIN",5,66,46,149,11,0,Kunde$
ÿ|ÿñ"CHECKEIN",5,66,56,147,11,0,VertrInfo$
ÿ|ÿñ"CHECKEIN",5,34,70,180,29,0,"M”chten Sie, daá alle berechneten Provisionen dieses Vertrages mit dem Zahlungseingang der Gesellschaft abgeglichen werden?"
ÿ|ÿñ"CHECKEIN",1,48,104,55,15,1,"&Ja",1,1
ÿ|ÿñ"CHECKEIN",1,107,104,55,15,0,"&Nein",0,0
ÿñ"CHECKEIN",req%
ÿ¾ÿñ"CHECKEIN"
ÿ¡req%ÿ1ÿp
checked%ÿÿ1
check.KVERTRAGÿ"j"
ÿ^
check.KVERTRAGÿ"n"
checked%ÿ0
ÿ’ÿ¡
ÿƒQuickStore("KVERTRAG")
ÿ^
checked%ÿÿ1
ÿ’ÿ¡
ÿ¡checked%ÿp
VS_NR.ZEINGANGÿVS_Nr.KVERTRAG
CodeVT.ZEINGANGÿsel%
CodeGE.ZEINGANGÿCodeGE.KVERTRAG
ÿƒZEINUpdate()
ÿœ
ÿ^
VS_NR.ZEINGANGÿ""
lGesellschaft$ÿ""
lAgentur$ÿ""
lSparte$ÿ""
lKunde$ÿ""
ÿ’ÿ¡
 ÿ^
ÿƒFehler("Es konnte kein Vertrag mit dieser Nummer gefunden werden!","Bitte geben Sie korrekte Vertragsnummer ein.")
 ÿ’ÿ¡
 ÿÊÿË"Bereit"
 ÿßÿ³
 ÿ™cfile$
 ÿ’ÿÿ
 

ÿÿZEINList1()
 ÿƒBETAINFO()
 ÿ’ÿÿ
 

 ' ZEINGANG Eintrag zurck
 ' =======================================================================
 
ÿÿZEINPrev()
 ÿ¡ÿ("ZEINGANG")ÿÿ°("ZEINGANG")ÿpÿƒFStore("ZEINGANG")
 cuaz%ÿCodeAZ.ZEINGANG
 ÿÉÿœÿg
 ÿ¡ÿB("ZEINGANG")ÿp
ÿÂ"Dateianfang erreicht!","",2
ÿÉÿœÿ¥cuaz%ÿ£CodeAZ.ZEINGANG
 ÿ’ÿ¡
 ÿœ
 ÿ’ÿÿ
 
 
 ' ZEINGANG vor
 ' =======================================================================
 
ÿÿZEINNext()
 ÿ¡ÿ("ZEINGANG")ÿÿ°("ZEINGANG")ÿpÿƒFStore("ZEINGANG")
 cuaz%ÿCodeAZ.ZEINGANG
 ÿÉÿœÿ±
 ÿ¡ÿB("ZEINGANG")ÿp
ÿÂ"Dateiende erreicht!","",2
ÿÉÿœÿ¥cuaz%ÿ£CodeAZ.ZEINGANG
 ÿ’ÿ¡
 ÿœ
 ÿ’ÿÿ


 ' ZEINGANG l”schen
 ' =======================================================================
 ' 05.09.95/FA - Korrektur des Vertragspools beim L”schen gebuchter
 '               Zahlungseing„nge
 
ÿÿZEINLoeschen()
 ÿ¡disabled%("ZEINLoeschen")ÿpÿ’ÿÿ
 cuaz%ÿCodeAZ.ZEINGANG
 ÿ¡gebucht.ZEINGANGÿ"j"ÿp
ÿÂ"Der Zahlungseingang wurde bereits verbucht!","Trotzdem l”schen?",135,req%
 ÿ^
ÿÂ"Datensatz wirklich l”schen?","",135,req%
 ÿ’ÿ¡
 ÿßÿe
 ÿ¡req%ÿ1ÿp
ÿÉÿ¥cuaz%ÿáÿ™"ZEINGANG"ÿ£CodeAZ.ZEINGANG
ÿ½ -- Vertragspool anpassen --
ÿ¡gebucht.ZEINGANGÿ"j"ÿp
ÿÉÿ¥CodeVT.ZEINGANGÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
Pool.KVERTRAGÿPool.KVERTRAGÿBetrag.ZEINGANG
ÿƒQuickStore("KVERTRAG")
ÿ’ÿ¡
ÿÉÿ¥cuaz%ÿáÿ™"ZEINGANG"ÿ£CodeAZ.ZEINGANG
ÿÉÿ¾ÿ™"ZEINGANG"
 ÿ^
ÿÉÿœÿ¥cuaz%ÿ™"ZEINGANG"ÿ£CodeAZ.ZEINGANG
 ÿ’ÿ¡
 ÿœ
 ÿßÿ³
 ÿ’ÿÿ
 

 ' Zahlungseingang suchen
 ' =======================================================================
 
ÿÿZEINSuchen()
 cuzein%ÿCodeAZ.ZEINGANG
 opt&%ÿÿ0(ReadConfig$("PROVIS","ZEINopt"))
 ÿ¡opt&%ÿ0ÿpopt&%ÿ1
 von$ÿReadConfig$("PROVIS","ZEINvon")
 ÿ¡von$ÿ"leer"ÿpvon$ÿ""
 bis$ÿReadConfig$("PROVIS","ZEINbis")
 ÿ¡bis$ÿ"leer"ÿpbis$ÿ""
 ÿ‰ÿñ"ZEINSUCH",0,0,228,164,"Zahlungseing„nge","MS Sans Serif",8
 ÿ|ÿñ"ZEINSUCH",4,0,0,228,139,0,""
 ÿ|ÿñ"ZEINSUCH",9,9,11,23,22,2
 ÿ|ÿñ"ZEINSUCH",5,38,10,182,22,0,"Bitte w„hlen Sie aus, mit welcher Methode Sie den gewnschten Buchungssatz suchen m”chten."
 ÿ|ÿñ"ZEINSUCH",5,38,30,184,24,0,"Sie k”nnen die zu durchsuchende Datenmenge durch die wahlfreie Angabe des Buchungsdatums einschr„nken."
 ÿ|ÿñ"ZEINSUCH",5,38,64,76,10,0,"Suche ber..."
 ÿ|ÿñ"ZEINSUCH",3,58,74,149,12,0,"Vertrags-/Policennummer",1,opt&%
 ÿ|ÿñ"ZEINSUCH",3,58,86,148,12,0,"Gesellschaft",2,opt&%
 ÿ|ÿñ"ZEINSUCH",5,38,107,96,9,0,"Buchungszeitraum (optional):"
 ÿ|ÿñ"ZEINSUCH",5,58,120,17,11,0,"vom"
 ÿ|ÿñ"ZEINSUCH",6,78,119,41,11,0,0,von$,20
 ÿ|ÿñ"ZEINSUCH",5,130,120,13,10,0,"bis"
 ÿ|ÿñ"ZEINSUCH",6,144,119,41,11,0,0,bis$,20
 ÿ|ÿñ"ZEINSUCH",1,54,143,55,15,1,"&OK",1,1
 ÿ|ÿñ"ZEINSUCH",1,112,143,55,15,0,"&Abbrechen",0,0
 ÿñ"ZEINSUCH",req%
 ÿ¾ÿñ"ZEINSUCH"
 ÿ¡req%ÿ1ÿp
ÿƒWriteConfig("PROVIS","ZEINvon",ÿ(ÿ1(von$),"dd.mm.yy"))
ÿƒWriteConfig("PROVIS","ZEINbis",ÿ(ÿ1(bis$),"dd.mm.yy"))
ÿƒWriteConfig("PROVIS","ZEINopt",ÿH(ÿ(opt&%)))
ok%ÿÿ1
ÿ¡opt&%ÿ1ÿp
ÿ‰ÿñ"DZ2",0,0,191,87,"Zahlungseing„nge","MS Sans Serif",8
ÿ|ÿñ"DZ2",4,0,0,191,63,0,""
ÿ|ÿñ"DZ2",9,5,10,21,22,2
ÿ|ÿñ"DZ2",5,34,9,147,20,0,"Bitte geben Sie die Vertrags-/Policennummer der gesuchten Buchungss„tze ein:"
ÿ|ÿñ"DZ2",5,34,33,87,10,0,"Vertrags-/Policennummer:"
ÿ|ÿñ"DZ2",6,34,44,148,12,0,0,VSNR$,50
ÿ|ÿñ"DZ2",1,36,67,55,15,1,"&OK",1,1
ÿ|ÿñ"DZ2",1,94,67,55,15,0,"&Abbrechen",0,0
ÿñ"DZ2",req2%
ÿ¾ÿñ"DZ2"
ÿ¡req2%ÿ0ÿVSNR$ÿ""ÿpok%ÿ0
ÿ^
suge%ÿGetCodeGE%(0)
ÿ¡suge%ÿ0ÿpok%ÿ0
ÿ’ÿ¡
ÿ¡ok%ÿp
ÿ½ -- Suche durchfhren
cfile$ÿÿ™
ÿ¡von$ÿ""ÿpvon%ÿÿ1("1.1.1980")ÿ^von%ÿÿ1(von$)
ÿ¡bis$ÿ""ÿpbis%ÿÿ1("31.12.2020")ÿ^bis%ÿÿ1(bis$)
ÿ×Auswahl$(1)
ÿ×Buchungen$(ÿA("ZEINGANG"))
ÿ™"ZEINGANG"
ÿßÿe
ÿ¡opt&%ÿ1ÿp
ÿ£QuickVSNR.ZEINGANG
ÿÉÿ`
sVSNR$ÿVSNRPack$(VSNR$)
ÿÉÿ¥sVSNR$ÿ™"ZEINGANG"ÿ£QuickVSNR.ZEINGANG
a%ÿ0
ÿØQuickVSNR.ZEINGANGÿsVSNR$ÿ"*"ÿÿOÿB("ZEINGANG")
	ÿ¡Datum.ZEINGANGÿvon%ÿDatum.ZEINGANGÿ	bis%ÿp
Buchungen$(a%)ÿÿK(VS_Nr.ZEINGANG,30)ÿÿ(9)ÿÿK(ÿ(Datum.ZEINGANG,"0d.mm.yy"),8)ÿÿ(9)ÿÿ'(5)ÿÿH(ÿ(Betrag.ZEINGANG,",99999999.00"))ÿÿ'(20)ÿÿ(CodeAZ.ZEINGANG,"000000")
a%ÿa%ÿ1
	ÿ’ÿ¡
	ÿÉÿ±ÿ™"ZEINGANG"ÿ£QuickVSNR.ZEINGANG
ÿÙ
ÿ^
ÿ£CodeGE.ZEINGANG
ÿÉÿ`
ÿÉÿ¥suge%ÿ™"ZEINGANG"ÿ£CodeGE.ZEINGANG
a%ÿ0
ÿØCodeGE.ZEINGANGÿsuge%ÿÿOÿB("ZEINGANG")
	ÿ¡Datum.ZEINGANGÿvon%ÿDatum.ZEINGANGÿ	bis%ÿp
Buchungen$(a%)ÿÿK(VS_Nr.ZEINGANG,30)ÿÿ(9)ÿÿK(ÿ(Datum.ZEINGANG,"0d.mm.yy"),8)ÿÿ(9)ÿÿ'(5)ÿÿH(ÿ(Betrag.ZEINGANG,",99999999.00"))ÿÿ'(20)ÿÿ(CodeAZ.ZEINGANG,"000000")
a%ÿa%ÿ1
	ÿ’ÿ¡
	ÿÉÿ±ÿ™"ZEINGANG"ÿ£CodeGE.ZEINGANG
ÿÙ
ÿ’ÿ¡
ÿ¡a%ÿ0ÿp
ÿ½ -- Prompt ermitteln
prompt$ÿBuchungen$(0)
ÿ›b%ÿ1ÿqa%ÿ1
	ÿ¡Buchungen$(b%)ÿ
prompt$ÿpprompt$ÿBuchungen$(b%)
ÿ±b%
ÿ¡opt&%ÿ1ÿp
	caption$ÿ"Suche ber Vertrags-/Policennummer..."
ÿ^
	caption$ÿ"Suche ber Gesellschaft..."
ÿ’ÿ¡
ÿßÿ³
ÿ‰ÿñ"DZ3",0,0,229,190,caption$,"MS Sans Serif",8
ÿ|ÿñ"DZ3",4,0,0,229,165,0,""
ÿ|ÿñ"DZ3",5,36,11,179,9,0,"Bitte w„hlen Sie den gesuchten Zahlungseingang aus:"
ÿ|ÿñ"DZ3",9,8,12,21,23,2
ÿ|ÿñ"DZ3",5,36,27,179,9,0,"Vertragsnummer                   Datum          Betrag"
ÿ|ÿñ"DZ3",7,36,40,180,117,130,2,Buchungen$,Auswahl$,prompt$
ÿ|ÿñ"DZ3",1,58,170,55,15,1,"&OK",1,1
ÿ|ÿñ"DZ3",1,116,170,55,15,0,"&Abbrechen",0,0
ÿñ"DZ3",req3%
ÿ¾ÿñ"DZ3"
ÿ¡req3%ÿ1ÿp
	cuzein%ÿÿ0(ÿ-(Auswahl$(0),6))
ÿ’ÿ¡
ÿ^
ÿƒFehler("Es konnten keine entsprechenden Zahlungseing„nge gefunden werden!","")
ÿ’ÿ¡
ÿ™cfile$
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿÉÿœÿ¥cuzein%ÿ™"ZEINGANG"ÿ£CodeAZ.ZEINGANG
 ÿœ
 ÿßÿ³
 ÿ’ÿÿ
 

 ' Aktivierung/Deaktivierung der Zahlungseingangskontrolle fr
 ' Vertr„ge eines festgelegten Zeitraumes
 ' =======================================================================
 ' 25.10.95/AB

ÿÿZEDeaktiv()
 ÿ¡disabled%("ZEINLoeschen")ÿpÿ’ÿÿ
 cfile$ÿÿ™
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 von$ÿcdat$
 bis$ÿcdat$
 akVer$ÿ"n"
 ÿ‰ÿñ"Vzur",0,0,221,162,title$,"MS Sans Serif",8
 ÿ|ÿñ"Vzur",9,6,6,24,22,2
 ÿ|ÿñ"Vzur",5,34,8,170,9,0,"nderung der Vertragsberwachung:"
 ÿ|ÿñ"Vzur",4,34,14,176,5,0,""
 ÿ|ÿñ"Vzur",5,34,22,175,33,0,"Bitte geben Sie ein, fr welchen Vertragsabschluá- zeitraum (Vertragsbeginn) Sie die Vertragsberwachung deaktivieren/aktivieren m”chten."
 ÿ|ÿñ"Vzur",5,45,63,12,8,0,"von"
 ÿ|ÿñ"Vzur",6,64,62,45,11,0,0,von$,8
 ÿ|ÿñ"Vzur",5,113,63,12,8,0,"bis"
 ÿ|ÿñ"Vzur",6,126,62,46,11,0,0,bis$,8
 ÿ|ÿñ"Vzur",5,34,85,175,33,0,"W„hlen Sie aus, ob die entsprechenden Vertr„ge aktiviert oder deaktiviert werden sollen."
 ÿ|ÿñ"Vzur",3,34,108,154,11,0,"Zahlungseingansberwachung deaktivieren","n",akVer$
 ÿ|ÿñ"Vzur",3,34,121,148,11,0,"Zahlungseingansberwachung aktivieren","j",akVer$
 ÿ|ÿñ"Vzur",1,53,141,55,15,1,"&Weiter",1,1
 ÿ|ÿñ"Vzur",1,113,141,55,15,0,"&Abbruch",0,0
 ÿñ"Vzur",req%
 ÿ¾ÿñ"Vzur"
 ÿßÿ³
 ÿ¡req%ÿ1ÿp
ÿßÿe
ÿ¡von$ÿ""ÿpvondat$ÿ"1.1.75"ÿ^vondat$ÿvon$
ÿ¡bis$ÿ""ÿpbisdat$ÿÿ(ÿQ)ÿ^bisdat$ÿbis$
ÿ™"Kvertrag"
ÿßÿe
ÿ¡akVer$ÿ"n"ÿp
ÿÊÿË"Zahlungseingangsberwachung deaktivieren"
ÿÍcheck.kvertragÿakver$ÿĞVS_Beginn.kvertragÿÿ1(vondat$)ÿVS_Beginn.kvertragÿ	ÿ1(bisdat$)
ÿ’ÿÍ
ÿ^
ÿÊÿË"Zahlungseingangsberwachung aktivieren"
ÿÍcheck.kvertragÿakver$ÿĞVS_Beginn.kvertragÿÿ1(vondat$)ÿVS_Beginn.kvertragÿ	ÿ1(bisdat$)
ÿ’ÿÍ
ÿ’ÿ¡
ÿÂ"Bearbeitung beendet!"
 ÿ’ÿ¡
 ÿßÿ³
 ÿ™cfile$
 ÿÊÿË""
 ÿ’ÿÿ
 
 



 ' Verrechnung der Zahlungseing„nge in der Vertragsdatei
 ' =======================================================================
 ' Parameter:   dask% - Abfrage vor Verrechnung anzeigen?
 '                 -1 = Abfrage anzeigen
 '                  0 = Abrechnung ohne Abfrage durchfhren
 
 
 
ÿÿZEINBuchung(dask%)
 ÿ½ CALL DFile(3,"ZEINGANG" + _fpw$)
 ÿßÿe
 ÿ™"ZEINGANG"
 ÿ£gebucht.ZEINGANG
 ÿÉÿ`
 ÿÉÿ¥""ÿ™"ZEINGANG"ÿ£gebucht.ZEINGANG
 ÿ¡ÿC("ZEINGANG")ÿp
ok%ÿÿ1
ÿ¡dask%ÿp
ÿ‰ÿñ"ZBuchung",0,0,255,107,"Zahlungseingang","MS Sans Serif",8
ÿ|ÿñ"ZBuchung",4,0,0,254,84,0,""
ÿ|ÿñ"ZBuchung",9,6,8,24,24,2
ÿ|ÿñ"ZBuchung",5,38,9,210,19,0,"Im Zahlungseingang befinden sich Buchungss„tze, die noch nicht verrechnet worden sind!"
ÿ|ÿñ"ZBuchung",5,38,28,210,34,0,"Sie k”nnen die Verrechnung jetzt oder zu einem sp„teren Zeitpunkt durchfhren lassen. Beim šbergehen der Verrechnung wird diese automatisch bei der n„chsten Provisionsrechnung durchgefhrt."
ÿ|ÿñ"ZBuchung",5,38,65,208,11,0,"Soll der Abgleich jetzt durchgefhrt werden?"
ÿ|ÿñ"ZBuchung",1,70,88,55,15,1,"&Ja",1,1
ÿ|ÿñ"ZBuchung",1,128,88,55,15,0,"&Nein",0,0
ÿñ"ZBuchung",req%
ÿ¾ÿñ"ZBuchung"
ÿ¡req%ÿ0ÿpok%ÿ0
ÿ’ÿ¡
ÿ¡ok%ÿp
ÿßÿe
ÿ™"ZEINGANG"
ÿ£gebucht.ZEINGANG
ÿÉÿ`ÿá
msg$ÿ"Buchungss„tze werden abgeglichen!"
ÿÊÿËmsg$
ÿƒServer("LOADMESSAGE","")
ÿƒServer("MESSAGE","Bitte warten!"ÿÿ(13)ÿ"Die Buchungsdatei wird mit der Vertragsdatei abgeglichen.")
lok%ÿÿ1
ÿØlok%
ÿÉÿ¥CodeVT.ZEINGANGÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
Pool.KVERTRAGÿPool.KVERTRAGÿBetrag.ZEINGANG
ÿƒQuickStore("KVERTRAG")
gebucht.ZEINGANGÿ"j"
ÿƒQuickStore("ZEINGANG")
ÿ½ SET INDEX gebucht.ZEINGANG
ÿ½ INDEX gebucht.ZEINGANG
ÿÉÿ¥""ÿáÿ™"ZEINGANG"ÿ£gebucht.ZEINGANG
ÿ¡ÿOÿC("ZEINGANG")ÿplok%ÿ0
ÿÙ
ÿƒServer("UNLOADMESSAGE","")
ÿÊÿË"Bereit"
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿßÿ³
 ÿ’ÿÿ
 
 




 '      **************************************
 '      ** Routinen fr Formular "BUCHUNG"  **
 '      ** (Zusatzbuchungen/Kontenkorrektur **
 '      **************************************
 '      13.10.94/FA
 
ÿÿZBUCHUNG()
 ÿ¡disabled%("ZBUCHUNG")ÿpÿ’ÿÿ
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"buchung"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 _formend%ÿ0
 ÿØ_formend%ÿ0
ZBsub%ÿ0
ÿ¡ÿ>(ÿœ)ÿ"BUCHUNG"ÿp
ÿÊÿŸtitle$ÿ" - Buchungsdatei"
ÿ´ÿœ"BUCHUNG"
ÿ™"BUCHUNG"
ÿ£CodeBU.BUCHUNG
ÿÉÿœÿb
ÿƒMNZBUCHUNG()
ÿ¬ÿ³
ÿÊÿË"Buchungsdatei"
ÿ’ÿ¡
ÿ½ CALL ZBUpdate()
ÿßÿ³
ÿÉÿ¥CodeMA.buchungÿ™"MAADR"ÿ£CodeMA.maadr
ÿ¡ÿC("MAADR")ÿpmaadr$ÿNachname.maadrÿ^maadr$ÿ"<keine Zuordnung>"
ÿœ
ÿƒClearKBDBuffer()
ÿ¡ZBsub%ÿ99ÿpÿÏÿßÿÿ¥ÿÿ¬
ÿk$
ÿÉÿæÿ.(k$)
ÿæCrsLeft%,PgUp%
ÿƒBUPrev()
ÿæCrsRight%,PgDn%
ÿƒBUNext()
ÿ’ÿÉ
ÿÉÿæZBsub%
ÿæ99
ÿ”Datum.BUCHUNG,0
ÿ’ÿÉ
ZBsub%ÿ0
 ÿÙ
 _formend%ÿ0
 ÿ’ÿÿ
 
ÿÿBUNeu()
 ÿ™"BUCHUNG"
 _cma%ÿCodeMA.BUCHUNG
 ÿ¡Buchungstext.BUCHUNGÿ""ÿp
ÿ¡ÿ°("BUCHUNG")ÿÿ("BUCHUNG")ÿpÿƒFStore("BUCHUNG")
 ÿ’ÿ¡
 _cma%ÿGetCodeMA%(_cma%)
 ÿ¡_cma%ÿ0ÿp
ÿ
ÿÊÿË"Datensatz neu angelegt..."
Buchungstext.BUCHUNGÿ"Zusatzbuchung:"
CodeMA.BUCHUNGÿ_cma%
CodeBU.buchungÿÿI("buchung",1)
datum.buchungÿÿQ
ÿƒFStore("BUCHUNG")
ZBsub%ÿ99
 ÿ’ÿ¡
 ÿœ
 ÿ’ÿÿ

ÿÿBUNext()
 ÿ¡FileChanged%("BUCHUNG")ÿ1ÿpÿƒFStore("BUCHUNG")
 ÿÊÿ£CodeBU.BUCHUNG
 ÿ£CodeBU.BUCHUNG
 ÿƒPSelectNext()
 ÿœ
 ÿ’ÿÿ
 
ÿÿBUPrev()
 ÿ¡FileChanged%("BUCHUNG")ÿ1ÿpÿƒFStore("BUCHUNG")
 ÿÊÿ£CodeBU.BUCHUNG
 ÿ£CodeBU.BUCHUNG
 ÿƒPSelectPrev()
 ÿœ
 ÿ’ÿÿ
 
ÿÿBUSichern()
 ÿƒFStore("BUCHUNG")
 ÿ’ÿÿ

ÿÿBULoeschen()
 ÿ¡disabled%("BULoeschen")ÿpÿ’ÿÿ
 cubu%ÿCodeBU.BUCHUNG
 ÿÂ"Buchungssatz wirklich l”schen?","",135,req%
 ÿ¡req%ÿ1ÿp
ÿÉÿ¥cubu%ÿáÿ™"BUCHUNG"ÿ£CodeBU.BUCHUNG
ÿÉÿ¾
ÿÉÿ±
ÿœ
 ÿ’ÿ¡
 ÿœ
 ÿ’ÿÿ
 
ÿÿBUSuchen()
 _cubu%ÿCodeBU.BUCHUNG
 bu%ÿFindBuchung%(CodeMA.BUCHUNG)
 ÿ¡bu%ÿ0ÿp
ÿÉÿ¥bu%ÿ™"BUCHUNG"ÿ£CodeBU.BUCHUNG
 ÿ’ÿ¡
 ÿ’ÿÿ

 ' Buchungen in Buchungsdatei suchen
 ' =======================================================================
 ' 11.09.95/FA - Umstellung auf QuickCode
 
ÿÿFindBuchung%(_ma%)
 cuge%ÿCodeMA.BUCHUNG
 cubu%ÿCodeBU.BUCHUNG
 von%ÿ0
 bis%ÿ0
 ÿ×LAgenturen$(ÿA("MAADR"))
 ÿ™"MAADR"
 ÿ£CodeMA.MAADR
 ÿÉÿ`
 a%ÿ0
 fprompt$ÿ"ZZZZZZZZZZZZZZ"
 aprompt$ÿ""
 ÿßÿe
 ÿØÿOÿB("MAADR")
LAgenturen$(a%)ÿNachname.MAADRÿ", "ÿVorname.MAADRÿÿ'(120)ÿÿ(CodeMA.MAADR,"000000")
ÿ¡CodeMA.MAADRÿ_ma%ÿpaprompt$ÿLAgenturen$(a%)
ÿ¡LAgenturen$(a%)ÿ
fprompt$ÿpfprompt$ÿLAgenturen$(a%)
a%ÿa%ÿ1
ÿÉÿ±ÿ™"MAADR"ÿ£CodeMA.MAADR
 ÿÙ
 ÿßÿ³
 ÿ¡aprompt$ÿ""ÿpAuswahl$ÿfprompt$ÿ^Auswahl$ÿaprompt$
 ÿ‰ÿñ"BUSU",0,0,248,173,"Buchungssatz suchen","MS Sans Serif",8
 ÿ|ÿñ"BUSU",4,0,0,248,148,0,""
 ÿ|ÿñ"BUSU",9,10,16,21,21,2
 ÿ|ÿñ"BUSU",5,43,16,194,10,0,"Bitte w„hlen Sie die Agentur und weitere Optionen aus:"
 ÿ|ÿñ"BUSU",5,43,30,194,24,0,"Mit der Schaltfl„che "ÿÿ(34)ÿ"Liste"ÿÿ(34)ÿ" k”nnen Sie einen Buchungssatz aus der letzten Ergebnisliste ausw„hlen."
 ÿ|ÿñ"BUSU",5,43,59,29,10,0,"Agentur:"
 ÿ|ÿñ"BUSU",8,43,71,142,68,256ÿ3,2,Auswahl$,LAgenturen$
 ÿ|ÿñ"BUSU",2,43,95,173,11,0,"nur Zusatzbuchungen suchen",1,0,opt%
 ÿ|ÿñ"BUSU",5,43,113,63,10,0,"Buchungszeitraum:"
 ÿ|ÿñ"BUSU",6,61,126,41,12,0,0,von$,10
 ÿ|ÿñ"BUSU",6,130,126,41,12,0,0,bis$,10
 ÿ|ÿñ"BUSU",5,43,128,17,10,0,"von:"
 ÿ|ÿñ"BUSU",5,115,128,14,10,0,"bis:"
 ÿ|ÿñ"BUSU",1,33,153,55,15,0,"&Liste",2,1
 ÿ|ÿñ"BUSU",1,90,153,55,15,1,"&OK",1,1
 ÿ|ÿñ"BUSU",1,147,153,55,15,0,"&Abbrechen",0,0
 ÿñ"BUSU",req%
 ÿ¾ÿñ"BUSU"
 ÿ¡req%ÿ1ÿp
ÿßÿe
ÿÊÿË"Suche Buchungss„tze..."
ÿÿBSatz$(ÿA("BUCHUNG"))
ÿ›a%ÿ0ÿqÿA("BUCHUNG"):BSatz$(a%)ÿ"":ÿ±a%
ÿ¡von$ÿ""ÿpvon%ÿÿ1("1.1.1980")ÿ^von%ÿÿ1(von$)
ÿ¡bis$ÿ""ÿpbis%ÿÿ1(ÿQ)ÿ^bis%ÿÿ1(bis$)
_ma%ÿÿ0(ÿ-(Auswahl$,6))
ÿÉÿ¥_ma%ÿ™"MAADR"ÿ£CodeMA.MAADR
caption$ÿ"Buchungss„tze von "ÿNachname.MAADRÿ", "ÿVorname.MAADR
ÿ™"BUCHUNG"
ÿ£QuickCode.BUCHUNG
ÿÉÿ`
qc$ÿÿ(_ma%,"000000")ÿÿ(von%,"yymmdd")
ÿÉÿ¥qc$ÿ™"BUCHUNG"ÿ£QuickCode.BUCHUNG
a%ÿ0
ÿØCodeMA.BUCHUNGÿ_ma%ÿDatum.BUCHUNGÿ	bis%ÿÿOÿB("BUCHUNG")
ok%ÿ1
ÿ¡opt%ÿ1ÿProvision.BUCHUNGÿ"j"ÿpok%ÿ0
ÿ¡ok%ÿ1ÿp
ÿÊÿË"Suche Buchungss„tze...("ÿÿH(ÿ(a%,"99999999"))ÿ" gefunden)"
BSatz$(a%)ÿÿ(Datum.BUCHUNG,"zd.mm.yy")ÿ"   "ÿÿH(ÿ(Betrag.BUCHUNG,"-,99999999.00"))ÿ"   "ÿBuchungstext.BUCHUNGÿÿ'(120)ÿÿ(CodeBU.BUCHUNG,"000000")
a%ÿa%ÿ1
ÿ’ÿ¡
ÿÉÿ±ÿ™"BUCHUNG"ÿ£QuickCode.BUCHUNG
ÿÙ
ÿ¡a%ÿ0ÿp
ÿƒFehler("Keine Buchungss„tze gefunden!","")
ÿ^
ÿßÿ³
ÿ‰ÿñ"BUliste",0,0,346,193,caption$,"MS Sans Serif",8
ÿ|ÿñ"BUliste",4,0,0,344,168,0,""
ÿ|ÿñ"BUliste",9,6,9,20,21,2
ÿ|ÿñ"BUliste",5,33,11,219,9,0,"Bitte w„hlen Sie den gewnschen Buchungssatz aus der Liste aus:"
ÿ|ÿñ"BULISTe",7,33,24,303,137,0,2,BSatz$,Auswahl$,BSatz$(0)
ÿ|ÿñ"BUliste",1,113,173,54,14,1,"&OK",1,1
ÿ|ÿñ"BUliste",1,172,173,55,14,0,"&Abbrechen",0,0
ÿñ"BUListe",req%
ÿ¾ÿñ"BULISTE"
ÿ¡req%ÿ1ÿp
_cubu%ÿÿ0(ÿ-(Auswahl$(0),6))
FindBuchung%ÿ_cubu%
ÿ^
FindBuchung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡req%ÿ2ÿp
ÿ¡BSatz$(0)ÿ""ÿp
ÿƒFehler("Keine Buchungss„tze in Ergebnisliste!","")
ÿ^
ÿ‰ÿñ"BUliste",0,0,366,193,"Auswahl Buchungssatz","MS Sans Serif",8
ÿ|ÿñ"BUliste",4,0,0,364,168,0,""
ÿ|ÿñ"BUliste",9,6,9,20,21,2
ÿ|ÿñ"BUliste",5,33,11,219,9,0,"Bitte w„hlen Sie den gewnschen Buchungssatz aus der Liste aus:"
ÿ|ÿñ"BULISTe",7,33,24,323,137,2,2,BSatz$,Auswahl$,BSatz$(0)
ÿ|ÿñ"BUliste",1,123,173,54,14,1,"&OK",1,1
ÿ|ÿñ"BUliste",1,182,173,55,14,0,"&Abbrechen",0,0
ÿñ"BUListe",req%
ÿ¾ÿñ"BULISTE"
ÿ¡req%ÿ1ÿp
_cubu%ÿÿ0(ÿ-(Auswahl$(0),6))
FindBuchung%ÿ_cubu%
ÿ^
FindBuchung%ÿ0
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ™"BUCHUNG"
 ÿ£CodeBU.BUCHUNG
 ÿÉÿ¥cubu%ÿ™"BUCHUNG"ÿ£CodeBU.BUCHUNG
 ÿßÿ³
 ÿ’ÿÿ
 
 


 '      *****************************************
 '      ** Routinen fr Programmteil "BUCHUNG" **
 '      *****************************************

ÿÿBUCHUNG()
 ÿ¡disabled%("BUCHUNG")ÿpÿ’ÿÿ
 ÿ¡title$ÿ"*Agentur*"ÿp
ÿƒFehler("Diese Funktion kann in der Agenturvariante nicht genutzt werden!","")
ÿ’ÿÿ
 ÿ’ÿ¡
 ÿÊÿË"Buchungen/Provisionierung"
 opt%ÿ1
 ÿ‰ÿñ"BUCHUNG",0,0,289,148,"Buchungsdatei/Provisionsrechnung","MS Sans Serif",8
 ÿ|ÿñ"BUCHUNG",9,8,8,22,22,2
 ÿ|ÿñ"BUCHUNG",5,35,9,124,10,0,"Bitte w„hlen Sie die Funktion, die Sie"
 ÿ|ÿñ"BUCHUNG",5,35,19,73,9,0,"durchfhren m”chten:"
 ÿ|ÿñ"BUCHUNG",4,35,29,168,62,0,""
 ÿ|ÿñ"BUCHUNG",5,39,39,70,9,0,"Buchungsfunktionen:"
 ÿ|ÿñ"BUCHUNG",4,35,89,168,52,0,""
 ÿ|ÿñ"BUCHUNG",5,39,99,67,10,0,"Listen/šbersichten:"
 ÿ|ÿñ"BUCHUNG",3,39,49,153,10,0,"monatliche Provisionsbuchung",1,opt%
 ÿ|ÿñ"BUCHUNG",3,39,59,153,10,0,"Korrekturbuchung",2,opt%
 ÿ|ÿñ"BUCHUNG",3,39,69,153,10,0,"Erfassung von zus„tzlichen Buchung",5,opt%
 ÿ|ÿñ"BUCHUNG",3,39,79,155,10,0,"Nachbearbeitung von Buchungss„tzen",9,opt%
 ÿ|ÿñ"BUCHUNG",3,39,109,153,10,0,"Ausgabe der Provisionsliste",6,opt%
 ÿ|ÿñ"BUCHUNG",3,39,119,153,10,0,"Kontenbersicht fr eine einzelne Agentur",3,opt%
 ÿ|ÿñ"BUCHUNG",3,39,129,153,10,0,"Kontenbersicht fr alle Agenturen",4,opt%
 ÿ|ÿñ"BUCHUNG",1,208,55,75,16,0,"&Kopf-/Fuázeile",2,0
 ÿ|ÿñ"BUCHUNG",1,208,75,74,15,0,"&Fehlerprotokoll",3,0
 ÿ|ÿñ"BUCHUNG",1,208,105,75,16,1,"&OK",1,1
 ÿ|ÿñ"BUCHUNG",1,208,125,74,15,0,"&Abbrechen",0,0
 ÿñ"BUCHUNG",req%
 ÿ¾ÿñ"BUCHUNG"
 ÿ¡req%ÿ1ÿp
ÿÉÿæopt%
ÿæ1
ÿƒPROVBUCHUNG()
ÿæ2
ÿƒBUKORREKTUR()
ÿæ3
ÿƒUEBERSAG1()
ÿæ4
ÿƒUEBERSAG2()
ÿæ5
ÿƒZUSATZBU()
ÿæ6
ÿƒPROVILIST()
ÿæ7
ÿƒDRCONFIG()
ÿæ8
ÿƒShowLog()
ÿæ9
ÿƒZBUCHUNG()
ÿ’ÿÉ
 ÿ’ÿ¡
 _formend%ÿ0
 ÿ¡req%ÿ2ÿpÿƒDRCONFIG()
 ÿ¡req%ÿ3ÿpÿƒShowLog()
 ÿÊÿŸtitle$ÿ" - Hauptbersicht"
 ÿÊÿË"Bereit"
 ÿ’ÿÿ
 

 ' Kopf- und Fuázeilen bearbeiten
 ' =======================================================================
 
ÿÿDRCONFIG()
 Kopfzeile$ÿ""
 ÿ›z%ÿ1ÿq10
in$ÿReadConfig$("PROVIS","Header"ÿÿH(ÿ(z%,"99")))
ÿ¡in$ÿ""ÿin$ÿ"leer"ÿp
ÿ¡Kopfzeile$ÿ""ÿp
Kopfzeile$ÿin$
ÿ^
Kopfzeile$ÿKopfzeile$ÿÿ(13)ÿÿ(10)ÿin$
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ±z%
 Fuázeile$ÿ""
 ÿ›z%ÿ1ÿq10
in$ÿReadConfig$("PROVIS","Footer"ÿÿH(ÿ(z%,"99")))
ÿ¡in$ÿ""ÿin$ÿ"leer"ÿp
ÿ¡Fuázeile$ÿ""ÿp
Fuázeile$ÿin$
ÿ^
Fuázeile$ÿFuázeile$ÿÿ(13)ÿÿ(10)ÿin$
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ±z%
 ÿ‰ÿñ"DRCONFIG",0,0,260,177,"Kopf-/Fuázeile bearbeiten","MS Sans Serif",8
 ÿ|ÿñ"DRCONFIG",9,5,11,20,22,2
 ÿ|ÿñ"DRCONFIG",5,33,14,213,9,0,"&Kopfzeile:"
 ÿ|ÿñ"DRCONFIG",6,33,25,220,67,68,2,Kopfzeile$,4000
 ÿ|ÿñ"DRCONFIG",5,33,100,213,9,0,"&Fuázeile:"
 ÿ|ÿñ"DRCONFIG",6,33,112,220,35,68,2,Fuázeile$,4000
 ÿ|ÿñ"DRCONFIG",1,140,158,55,14,0,"&OK",1,1
 ÿ|ÿñ"DRCONFIG",1,198,158,55,14,0,"&Abbrechen",0,0
 ÿñ"DRCONFIG",req%
 ÿ¾ÿñ"DRCONFIG"
 ÿ¡req%ÿ1ÿp
ÿßÿe
ok%ÿ1
start%ÿ1
ende%ÿ0
ÿØok%ÿ0
ende%ÿÿ?(start%,kopfzeile$,ÿ(13)ÿÿ(10))
ÿ¡ende%ÿ0ÿp
ÿƒWriteConfig("PROVIS","Header"ÿÿH(ÿ(ok%,"999")),ÿ,(Kopfzeile$,start%,ende%ÿstart%))
ok%ÿok%ÿ1
start%ÿende%ÿ2
ÿ^
ÿ¡start%ÿ
ÿ/(Kopfzeile$)ÿp
	ÿƒWriteConfig("PROVIS","Header"ÿÿH(ÿ(ok%,"999")),ÿ,(Kopfzeile$,start%,ÿ/(Kopfzeile$)ÿstart%ÿ1))
	ok%ÿok%ÿ1
ÿ’ÿ¡
ÿ›z%ÿok%ÿq10ÿk1
	ÿƒWriteConfig("PROVIS","Header"ÿÿH(ÿ(z%,"999")),"")
ÿ±z%
ok%ÿ0
ÿ’ÿ¡
ÿÙ
ok%ÿ1
start%ÿ1
ende%ÿ0
ÿØok%ÿ0
ende%ÿÿ?(start%,fuázeile$,ÿ(13)ÿÿ(10))
ÿ¡ende%ÿ0ÿp
ÿƒWriteConfig("PROVIS","Footer"ÿÿH(ÿ(ok%,"999")),ÿ,(Fuázeile$,start%,ende%ÿstart%))
ok%ÿok%ÿ1
start%ÿende%ÿ2
ÿ^
ÿ¡start%ÿ
ÿ/(Fuázeile$)ÿp
	ÿƒWriteConfig("PROVIS","Footer"ÿÿH(ÿ(ok%,"999")),ÿ,(Fuázeile$,start%,ÿ/(Fuázeile$)ÿstart%ÿ1))
	ok%ÿok%ÿ1
ÿ’ÿ¡
ÿ›z%ÿok%ÿq10ÿk1
	ÿƒWriteConfig("PROVIS","Footer"ÿÿH(ÿ(z%,"999")),"")
ÿ±z%
ok%ÿ0
ÿ’ÿ¡
ÿÙ
 ÿ’ÿ¡
 ÿßÿ³
 ÿ’ÿÿ
 

 ' Provisionsberechnung
 ' =======================================================================
 ' 27.04.93/FA - Anpassung an Netzwerk
 ' 07.07.93/FA - tempor„re Ver„nderungen fr TRANSER eingearbeitet
 ' 19.09.94/FA - Abbruch der Berechnung bei ProviAb>cdate%
 
ÿÿPROVBUCHUNG()
 ÿ¡disabled%("BUCHUNG6")ÿpÿ’ÿÿ
 ÿƒDFile(3,"buchung"ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(3,"vkond"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿ¡anschluss%ÿ0ÿp
CalcDate$ÿÿ(ÿQ,"dd.mm.yy")
ÿ‰ÿñ"STICHTAG",0,0,222,114,"Buchungsdatum","MS Sans Serif",8
ÿ|ÿñ"STICHTAG",4,0,0,222,91,0,""
ÿ|ÿñ"STICHTAG",9,6,9,23,24,2
ÿ|ÿñ"STICHTAG",5,31,15,183,10,0,"Bitte geben Sie an, fr welches Buchungsdatum"
ÿ|ÿñ"STICHTAG",5,31,25,183,10,0,"die Provisionsberechnung durchgefhrt werden soll:"
ÿ|ÿñ"STICHTAG",5,32,40,182,10,0,"(ohne nderung des Datums oder Weglassen"
ÿ|ÿñ"STICHTAG",5,31,50,182,10,0,"der Datumsangabe, wird das heutige Datum verwendet)"
ÿ|ÿñ"STICHTAG",6,94,72,42,12,0,0,CalcDate$,10
ÿ|ÿñ"STICHTAG",5,30,74,58,10,0,"Buchungsdatum:"
ÿ|ÿñ"STICHTAG",1,52,94,54,14,1,"&OK",1,1
ÿ|ÿñ"STICHTAG",1,109,94,54,14,0,"&Abbrechen",0,0
ÿñ"STICHTAG",req%
ÿ¾ÿñ"STICHTAG"
ÿ¡req%ÿ1ÿp
ÿ¡DateOK%(CalcDate$)ÿp
ok%ÿ1
ÿƒWriteConfig("PROVIS","letzteProvisionsrechnung",CalcDate$)
ÿ^
ok%ÿ0
ÿƒFehler("Falsche Datumsangabe!","Bitte geben Sie das Datum in der Form 'tt.mm.jj' ein.")
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ^
ok%ÿ1
 ÿ’ÿ¡
 ÿ¡ok%ÿ1ÿp
cdate%ÿÿ1(CalcDate$)
minimize$ÿReadINI$("PROVIS","minimize")
ÿ¡anschluss%ÿ0ÿp
ÿ¡minimize$ÿ"TRUE"ÿp
ÿÂ"PROVIS wird in den Hintergrund geschaltet!","Sie k”nnen w„hrend der Berechung andere Programme starten.",0
ÿÊÿÿÚ
ÿ’ÿ¡
ÿƒCreateLog()
ÿ’ÿ¡
ÿƒWriteLog("")
ÿƒWriteLog("=================================")
ÿƒWriteLog("Provisionsabrechnung vom "ÿÿ(cdate%,"dd.mm.yy"))
ÿƒWriteLog("=================================")
ÿƒWriteLog("")
ÿßÿe
ÿ™"kvertrag"
ÿ£ProviAb.kvertrag
ÿÉÿ`
_p1%ÿÿA("kvertrag")
_pd$ÿ"0"
_pd%ÿÿ1
_p2%ÿ0
ÿØÿOÿB("kvertrag")ÿProviAb.KVERTRAGÿ	cdate%

ÿ½ -----------------------------------------
ÿ½ -- Prozentbalken und Header aktualisieren
ÿ½ -----------------------------------------

ÿÊÿË"Bearbeite Vertrag "ÿÿH(ÿ(_p2%,"999999"))ÿ" von "ÿÿH(ÿ(_p1%,"999999"))
_pc%ÿÿ (100ÿ_p1%ÿ_p2%,0)
ÿ¡_pd%ÿ_pc%ÿp
_pd%ÿ_pc%
ÿ¡ÿåsys(11)ÿ36ÿÿåsys(12)ÿ36ÿp
	ÿ¡anschluss%ÿ0ÿp
ÿÊÿŸÿ(_pd%,"999")ÿ"%"
	ÿ^
ÿÊÿŸÿ(_pd%,"999")ÿ"% "ÿÿH(ÿ(ÿ5(cdate%),"99"))ÿ"/"ÿÿ-(ÿ(ÿ6(cdate%),"9999"),2)
	ÿ’ÿ¡
ÿ^
	ÿ¡anschluss%ÿ0ÿp
ÿÊÿŸtitle$ÿ" - Provisionsberechung: "ÿÿ(_pd%,"999")ÿ"% erledigt"
	ÿ^
ÿÊÿŸtitle$ÿ" - Provisionsberechung: "ÿÿ(_pd%,"999")ÿ"% "ÿÿH(ÿ(ÿ5(cdate%),"99"))ÿ"/"ÿÿ-(ÿ(ÿ6(cdate%),"9999"),2)
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡

ÿ½ --------------------------------------
ÿ½ -- CheckUp fr Vertragsprovisionierung
ÿ½ --------------------------------------

ok%ÿ1

ÿ¡ÿ1(Kndigung.KVERTRAG)ÿ1ÿÿ1(Kndigung.KVERTRAG)ÿ
cdate%ÿp
ok%ÿ0
ÿ¡_debug%ÿ1ÿpÿƒWriteLog("## Kndigung: "ÿÿ(lfdnr.KVERTRAG,"000000")ÿ", "ÿÿ(Kndigung.KVERTRAG,"dd.mm.yy"))
ÿ’ÿ¡
ÿ¡Storno.KVERTRAGÿ0ÿÿ1(Kndigung.KVERTRAG)ÿ
cdate%ÿpok%ÿ0
ÿ¡ÿ1(ProviAb.KVERTRAG)ÿ
1ÿpok%ÿ0
ÿ¡ÿ1(VS_Beginn.KVERTRAG)ÿ
1ÿpok%ÿ0
ÿ¡ÿ1(ProviAb.KVERTRAG)ÿcdate%ÿpok%ÿ0
ÿ¡cdate%ÿÿ1(letzteProvi.KVERTRAG)ÿ
27ÿp
ok%ÿ0
ÿ¡_debug%ÿ1ÿpÿƒWriteLog("## Zeitsperre: "ÿÿ(letzteProvi.KVERTRAG,"dd.mm.yy"))
ÿ’ÿ¡
ÿ¡CodeMA.KVERTRAGÿ
1ÿp
ÿƒWriteLog("!dem Vertrag wurde keine Agentur zugeordnet")
ÿƒAddLogInfo()
ok%ÿ0
ÿ’ÿ¡
ÿ¡CodeGE.KVERTRAGÿ
1ÿp
ÿƒWriteLog("!dem Vertrag wurde keine Gesellschaft zugeordnet")
ÿƒAddLogInfo()
ok%ÿ0
ÿ’ÿ¡
ÿ¡CodeVA.KVERTRAGÿ
1ÿp
ÿƒWriteLog("!dem Vertrag wurde keine Sparte zugeordnet")
ÿƒAddLogInfo()
ok%ÿ0
ÿ’ÿ¡
ÿ¡CodeKO.KVERTRAGÿ0ÿÿ1(ProviAb.KVERTRAG)ÿcdate%ÿp
ÿƒWriteLog("!der erwartete Eintrag in VKOND konnte nicht gefunden werden")
ÿƒAddLogInfo()
ok%ÿ0
ÿ’ÿ¡

ÿ½ ------------------------
ÿ½ -- Aufruf der Berechnung
ÿ½ ------------------------

ÿ¡ok%ÿ1ÿp
gezPflege%ÿ0
gezPauschale%ÿ0
gezAbschluá%ÿ0
ÿƒPROVISION2()
ÿ’ÿ¡
ÿÉÿ±ÿ™"KVERTRAG"ÿ£ProviAb.kvertrag
_p2%ÿ_p2%ÿ1
ÿÙ
ÿ¡ReadConfig$("PROVIS","SkipStorno")ÿ"TRUE"ÿp
ÿ½ 
ÿ^
ÿƒSRZahlung()
ÿ’ÿ¡
ÿ¡anschluss%ÿ0ÿp
ÿßÿ³
ÿÊÿÿx
ÿÊÿŸtitle$ÿ" - Buchung"
ÿÊÿË"Provisionsabrechnung beendet"
ÿƒCloseLog()
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ’ÿÿ
 

 ' Korrekturbuchung
 ' =======================================================================
 ' 27.10.93/FA - wahlweise Eingabe des Rechnungsbeginns

ÿÿBUKORREKTUR()
 ÿ¡disabled%("BUCHUNG6")ÿpÿ’ÿÿ
 Anschluss%ÿ1
 ÿÂ"Die Korrekturbuchung l”scht alle Buchungen und setzt","die Vertragsdatei zurck! Fortfahren?",135,req%
 ÿ¡req%ÿ1ÿp
CalcDate$ÿReadConfig$("PROVIS","KorrekturAb")
ÿ¡CalcDate$ÿ"leer"ÿpCalcDate$ÿ""
ÿ‰ÿñ"ANSCHLUSS",0,0,191,92,"Buchungskorrektur","MS Sans Serif",8
ÿ|ÿñ"ANSCHLUSS",4,0,0,191,68,0,""
ÿ|ÿñ"ANSCHLUSS",9,9,12,21,23,2
ÿ|ÿñ"ANSCHLUSS",5,38,12,144,20,0,"Bitte geben Sie ein, ab welchem Stichtag die Provisionen berechnet werden sollen:"
ÿ|ÿñ"ANSCHLUSS",5,38,42,33,10,0,"Stich&tag:"
ÿ|ÿñ"ANSCHLUSS",6,73,41,51,11,0,0,CalcDate$,20
ÿ|ÿñ"ANSCHLUSS",1,34,72,55,14,1,"&OK",1,1
ÿ|ÿñ"ANSCHLUSS",1,92,72,55,14,0,"&Abbrechen",0,0
ÿñ"ANSCHLUSS",req%
ÿ¾ÿñ"ANSCHLUSS"
ÿ¡req%ÿ1ÿp
ÿ¡DateOK%(CalcDate$)ÿp
ÿƒCreateLog()
ÿßÿe
ÿƒServer("LOADMESSAGE","")
ÿƒServer("MESSAGE","Bitte warten... Alle Provisionsbuchungen werden aus der Buchungsdatei gel”scht. (Dieser Vorgang kann bei gr”áeren Datenbest„nden einige Zeit in Anspruch nehmen.)")
ÿƒDFile(3,"buchung"ÿ_fpw$)
ÿƒDFile(3,"ZEINGANG"ÿ_fpw$)
ÿƒDFile(3,"gekond"ÿ_fpw$)
ÿƒDFile(3,"kvertrag"ÿ_fpw$)
ÿƒWriteConfig("PROVIS","KorrekturAb",CalcDate$)
ÿÊÿË"Buchungsdatei wird gel”scht..."
ÿ™"KVERTRAG"
ÿ½ SELECT FIRST FILE "KVERTRAG" INDEX ProviAB.KVERTRAG
startprovi%ÿProviAB.KVERTRAG
ÿ¾ÿaÿ™"BUCHUNG"ÿĞProvision.BUCHUNGÿ"j"
ÿ½ ** CALL Server("MESSAGE","Bitte warten..." + CHR$ (10) + CHR$ (13) + "Zahlungseingang wird gel”scht.")
ÿ½ ** REMOVE FROM FILE "ZEINGANG"
ÿƒServer("MESSAGE","Bitte warten..."ÿÿ(10)ÿÿ(13)ÿ"Die Vertragsdatei wird zurckgesetzt.")
ÿÊÿË"Vertragsdatei wird zurckgesetzt..."
ÿ™"KVERTRAG"
ÿÍletzteProvi ÿ0:gez_Abschluá.KVERTRAGÿ"":gez_Pauschale.KVERTRAGÿ"":TZRate.KVERTRAGÿ0:letztePflege.KVERTRAGÿ0:Pool.KVERTRAGÿ0:Mahnung.KVERTRAGÿ"n"
ÿ’ÿÍ
ÿƒBUKOPrep1()
ÿƒServer("UNLOADMESSAGE","")
ÿƒWriteLog(">>Korrekturbuchung ab Stichtag "ÿCalcDate$)
ÿ½ SET TODAY StartDatum$
cmonat%ÿÿ5(CalcDate$)
cjahr%ÿÿ6(CalcDate$)
ctag%ÿÿ3(CalcDate$)
ÿØÿ1(CalcDate$)ÿ
ÿQ
	ÿƒPROVBUCHUNG()
	cmonat%ÿcmonat%ÿ1
	ÿ¡cmonat%ÿ13ÿp
cmonat%ÿ1
cjahr%ÿcjahr%ÿ1
	ÿ’ÿ¡
	CalcDate$ÿÿ(ctag%,"00")ÿ"."ÿÿ(cmonat%,"00")ÿ"."ÿÿ(cjahr%,"0000")
ÿÙ
ÿßÿ³
ÿÊÿÿx
ÿÊÿË"Bereit"
ÿƒCloseLog()
ÿ^
ÿƒFehler("Falsches Datumsformat!","Das Datum muá in der Form 'tt.mm.jj' eingegeben werden.")
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ’ÿ¡
 Anschluss%ÿ0
 ÿ’ÿÿ

 ' Vorbereitung der Buchungskorrektur
 ' Aufbau der Vertragspools fr Zahlungseingangskontrolle
 ' =======================================================================

ÿÿBUKOPrep1()
 ÿ¡ÿA("ZEINGANG")ÿ
1ÿpÿ’ÿÿ
 ÿßÿe
 ÿÊÿË"Aufbau der Eingangskonten..."
 ÿƒServer("MESSAGE","Bitte warten..."ÿÿ(10)ÿÿ(13)ÿ"Die Eingangskonten werden neu aufgebaut.")
 ÿ™"ZEINGANG"
 ÿ£CodeVT.ZEINGANG
 ÿÉÿ`
 ÿÉÿ¥CodeVT.ZEINGANGÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 lv%ÿ0
 ÿØÿOÿB("ZEINGANG")
ÿ¡CodeVT.ZEINGANGÿlv%ÿp
ÿÊÿË"Aufbau der Eingangskonten...(Vertrag "ÿVS_NR.KVERTRAGÿ")"
ÿ¡lv%ÿ0ÿpÿƒQuickStore("KVERTRAG")
ÿÉÿ¥CodeVT.ZEINGANGÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
lv%ÿCodeVT.ZEINGANG
ÿ’ÿ¡
Pool.KVERTRAGÿPool.KVERTRAGÿBetrag.ZEINGANG
ÿÉÿ±ÿ™"ZEINGANG"ÿ£CodeVT.ZEINGANG
 ÿÙ
 ÿƒQuickStore("KVERTRAG")
 ÿßÿ³
 ÿ’ÿÿ
 
 
 
 
 ' Kontobersicht einzeln *** Andi 21.9.95
 ' =======================================================================
 
ÿÿUEBERSAG1()
 ÿ¡disabled%("KONTOUEBERSICHT")ÿpÿ’ÿÿ
 ÿƒDFile(3,"buchung"ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿ½ SET MENU OFF 
 ÿ¡_help%ÿ1ÿpÿƒDemoInfo(9)
 ma%ÿGetCodeMA%(cuma%)
 ÿ¡ma%ÿ0ÿp
ÿÉÿ¥ma%ÿ™"maadr"ÿ£codema.maadr
ÿ™"buchung"
ÿ½ CREATE DIALOG "Konto1",0,0,213,108,"Kontobersicht","MS Sans Serif",8
ÿ½ ADD DIALOG "Konto1",5,6,4,136,10,0,Headline$
ÿ½ ADD DIALOG "Konto1",5,6,19,167,9,0,"Bitte geben Sie ein, fr welchen Buchungszeitraum"
ÿ½ ADD DIALOG "Konto1",5,6,28,98,8,0,"Sie eine šbersicht wnschen."
ÿ½ ADD DIALOG "Konto1",5,6,38,174,10,0,"Wenn Sie keine Angaben zum Buchungszeitraum ein-"
ÿ½ ADD DIALOG "Konto1",5,6,48,203,9,0,"tragen, werden s„mtliche Vorg„nge der Agentur ausgegeben."
ÿ½ ADD DIALOG "Konto1",6,6,60,46,13,0,0,von$,8
ÿ½ ADD DIALOG "Konto1",6,58,60,46,13,0,0,bis$,8
ÿ½ ADD DIALOG "Konto1",5,53,62,5,13,0,"-"
ÿ½ ADD DIALOG "Konto1",5,6,74,14,8,0,"von"
ÿ½ ADD DIALOG "Konto1",5,58,74,12,8,0,"bis"
ÿ½ ADD DIALOG "Konto1",1,105,89,49,15,0,"&Weiter",1,1
ÿ½ ADD DIALOG "Konto1",1,156,89,50,15,0,"&Abbruch",0,0
ÿ½ DIALOG "Konto1",req%
ÿ½ REMOVE DIALOG "Konto1"

allProv$ÿ"n"
ÿ‰ÿñ"Konto1",0,0,221,165,title$,"MS Sans Serif",8
ÿ|ÿñ"Konto1",9,6,7,24,22,2
ÿ|ÿñ"Konto1",5,34,8,170,9,0,"Provisionsliste:"
ÿ|ÿñ"Konto1",4,34,14,176,5,0,""
ÿ|ÿñ"Konto1",5,34,22,175,16,0,"Bitte geben Sie ein, fr welchen Buchungszeitraum Sie eine šbersicht wnschen."
ÿ|ÿñ"Konto1",5,34,40,175,32,0,"Wenn Sie keine Angaben zum Buchungszeitraum eintragen, werden alle Provisionen bzw. die Provisionen des vorgegebenen Zeitraumes aufgelistet."
ÿ|ÿñ"Konto1",5,34,80,12,8,0,"von"
ÿ|ÿñ"Konto1",6,53,79,45,11,0,0,von$,8
ÿ|ÿñ"Konto1",5,102,80,12,8,0,"bis"
ÿ|ÿñ"Konto1",6,116,79,45,11,0,0,bis$,8
ÿ|ÿñ"Konto1",2,34,97,148,11,0,"alle berechneten Provisionen einbeziehen","j","n",allProv$
ÿ|ÿñ"Konto1",5,44,108,167,25,0,"(es werden auch die Provisionen angezeigt, die wegen fehlender Zahlungsbeitr„ge in der Mahnlist sind)"
ÿ|ÿñ"Konto1",1,50,144,55,15,1,"&Weiter",1,1
ÿ|ÿñ"Konto1",1,110,144,55,15,0,"&Abbruch",0,0
ÿñ"Konto1",req%
ÿ¾ÿñ"Konto1"

ÿ¡req%ÿ1ÿp
ÿ¡von$ÿ""ÿpvondat$ÿ"1.1.80"ÿ^vondat$ÿvon$
ÿ¡bis$ÿ""ÿpbisdat$ÿÿ(ÿQ)ÿ^bisdat$ÿbis$
ÿ¡RepType%ÿ0ÿp
ÿÁÿs"LISTPROV"
ÿÁÿ³Betrag.BUCHUNGÿU"SSumAgentur%",SR.BUCHUNGÿU"SSumStorno%",BetnGezahlt%ÿU"SSumNBez%",BetnDiff%ÿU"SGesSum%"
ÿ}ÿÁ
ÿÊÿÁÿí"F_REPORT"
ÿ¶ÿÁÿí
ÿ’ÿÁ
Header$ÿ"Kontobersicht "ÿnachname.maadr
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (bis "ÿÿ(ÿQ,"dd.mm.yy")ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (ab "ÿvon$ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (vom "ÿvon$ÿ" bis "ÿbis$ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (Gesamtbersicht)"
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
ÿCodeMA.MAADR,Betrag.BUCHUNGÿU"SumAgentur%",SR.BUCHUNGÿU"SumStorno%",BetnGezahlt%ÿU"SumNBez%",BetnDiff%ÿU"GesSum%"
ÿ€ÿCodeMA.MAADR
ÿÊÿÁÿí"H_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿCodeMA.MAADR
ÿÊÿÁÿí"F_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ‘ÿÁ
ÿ’ÿ
ÿDatum.BUCHUNG
ÿ€ÿDatum.BUCHUNG
ÿÊÿÁÿí"H_Datum.BUCH003"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿ^
ÿÁÿs"LISTPRO2"
ÿÁÿ³Volumen.BUCHUNGÿU"SSumVol%",Betrag.BUCHUNGÿU"SSumAgentur%",SR.BUCHUNGÿU"SSumStorno%",BetnGezahlt%ÿU"SSumNBez%",BetnDiff%ÿU"SGesSum%"
ÿ}ÿÁ
	ÿÊÿÁÿí"F_REPORT"
	ÿ¶ÿÁÿí
ÿ’ÿÁ
Header$ÿ"Kontobersicht "ÿnachname.maadr
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (bis "ÿÿ(ÿQ,"dd.mm.yy")ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (ab "ÿvon$ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (vom "ÿvon$ÿ" bis "ÿbis$ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (Gesamtbersicht)"
ÿŸ
	ÿÊÿÁÿí"H_PAGE"
	ÿ¶ÿÁÿí
ÿ’ÿŸ
ÿCodeMA.MAADR,Betrag.BUCHUNGÿU"SumAgentur%",SR.BUCHUNGÿU"SumStorno%",Volumen.BUCHUNGÿU"SumVol%",BetnGezahlt%ÿU"SumNBez%",BetnDiff%ÿU"GesSum%"
ÿ€ÿCodeMA.MAADR
	ÿÊÿÁÿí"H_CodeMA.MAA002"
	ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿCodeMA.MAADR
ÿÊÿÁÿí"F_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ‘ÿÁ
ÿ’ÿ
ÿDatum.BUCHUNG
	ÿ€ÿDatum.BUCHUNG
	ÿÊÿÁÿí"H_Datum.BUCH003"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿÉ
	ÿÊÿÁÿí"F_SELECT"
	ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿ’ÿ¡
ÿÊÿiÿe
ÿÊÿiÿáÿe
vondat%ÿÿ1(vondat$)
bisdat%ÿÿ1(bisdat$)
ÿßÿe
ÿ³ÿ_ÿwErrUEBERSAG1
ÿ¡allProv$ÿ"j"ÿp
ÿÉ;
	ÿĞCodeMA.BUCHUNGÿCodeMA.MAADRÿCodeMA.MAADRÿma%ÿDatum.BUCHUNGÿÿ1(vondat$)ÿDatum.BUCHUNGÿ	ÿ1(bisdat$)
	ÿµÿÁDatum.BUCHUNG
	ÿqÿ~
ÿ^
ÿÉ;
	ÿĞCodeMA.BUCHUNGÿCodeMA.MAADRÿCodeMA.MAADRÿma%ÿDatum.BUCHUNGÿÿ1(vondat$)ÿDatum.BUCHUNGÿ	ÿ1(bisdat$)ÿmahnung.buchungÿ"j"
	ÿµÿÁDatum.BUCHUNG
	ÿqÿ~
ÿ’ÿ¡
ErrUEBERSAG1: 
ÿ³ÿ_ÿwErrorHandler
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿßÿ³
 ÿ’ÿÿ


 
 ' Kontobersicht alle Agenturen ***** Andi 21.9.95
 ' =======================================================================
 
ÿÿUEBERSAG2()
 ÿ¡disabled%("KONTOUEBERSICHT")ÿpÿ’ÿÿ
 ÿƒDFile(3,"buchung"ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿ½ CREATE DIALOG "Konto1",0,0,187,108,"Kontobersicht","MS Sans Serif",8
 ÿ½  ADD DIALOG "Konto1",5,6,3,170,9,0,"Kontobersicht fr alle Agenturen:"
 ÿ½ ADD DIALOG "Konto1",5,6,19,167,9,0,"Bitte geben Sie ein, fr welchen Buchungszeitraum"
 ÿ½ ADD DIALOG "Konto1",5,6,28,98,8,0,"Sie eine šbersicht wnschen."
 ÿ½ ADD DIALOG "Konto1",5,6,37,174,10,0,"Wenn Sie keine Angaben zum Buchungszeitraum ein-"
 ÿ½ ADD DIALOG "Konto1",5,6,47,160,9,0,"tragen, werden s„mtliche Vorg„nge ausgegeben."
 ÿ½ ADD DIALOG "Konto1",6,6,60,46,13,0,0,von$,8
 ÿ½ ADD DIALOG "Konto1",6,58,60,46,13,0,0,bis$,8
 ÿ½ ADD DIALOG "Konto1",5,53,62,5,13,0,"-"
 ÿ½ ADD DIALOG "Konto1",5,6,74,14,8,0,"von"
 ÿ½ ADD DIALOG "Konto1",5,58,74,12,8,0,"bis"
 ÿ½ ADD DIALOG "Konto1",1,80,89,49,15,0,"&Weiter",1,1
 ÿ½ ADD DIALOG "Konto1",1,130,89,51,15,0,"&Abbruch",0,0
 ÿ½ DIALOG "Konto1",req%
 ÿ½ REMOVE DIALOG "Konto1"

 allProv$ÿ"n"
 ÿ‰ÿñ"Konto1",0,0,221,165,title$,"MS Sans Serif",8
 ÿ|ÿñ"Konto1",9,6,7,24,22,2
 ÿ|ÿñ"Konto1",5,34,8,170,9,0,"Provisionsliste:"
 ÿ|ÿñ"Konto1",4,34,14,176,5,0,""
 ÿ|ÿñ"Konto1",5,34,22,175,16,0,"Bitte geben Sie ein, fr welchen Buchungszeitraum Sie eine šbersicht wnschen."
 ÿ|ÿñ"Konto1",5,34,40,175,32,0,"Wenn Sie keine Angaben zum Buchungszeitraum eintragen, werden alle Provisionen bzw. die Provisionen des vorgegebenen Zeitraumes aufgelistet."
 ÿ|ÿñ"Konto1",5,34,80,12,8,0,"von"
 ÿ|ÿñ"Konto1",6,53,79,45,11,0,0,von$,8
 ÿ|ÿñ"Konto1",5,102,80,12,8,0,"bis"
 ÿ|ÿñ"Konto1",6,116,79,45,11,0,0,bis$,8
 ÿ|ÿñ"Konto1",2,34,97,148,11,0,"alle berechneten Provisionen einbeziehen","j","n",allProv$
 ÿ|ÿñ"Konto1",5,44,108,167,25,0,"(es werden auch die Provisionen angezeigt, die wegen fehlender Zahlungsbeitr„ge in der Mahnlist sind)"
 ÿ|ÿñ"Konto1",1,50,144,55,15,1,"&Weiter",1,1
 ÿ|ÿñ"Konto1",1,110,144,55,15,0,"&Abbruch",0,0
 ÿñ"Konto1",req%
 ÿ¾ÿñ"Konto1"

 ÿ¡req%ÿ1ÿp
ÿßÿe
ÿ¡von$ÿ""ÿpvondat$ÿ"1.1.80"ÿ^vondat$ÿvon$
ÿ¡bis$ÿ""ÿpbisdat$ÿÿ(ÿQ)ÿ^bisdat$ÿbis$
ÿ¡RepType%ÿ0ÿp
ÿÁÿs"LISTPROV"
ÿÁÿ³Betrag.BUCHUNGÿU"SSumAgentur%",SR.BUCHUNGÿU"SSumStorno%",BetnGezahlt%ÿU"SSumNBez%",BetnDiff%ÿU"SGesSum%"
ÿ}ÿÁ
ÿÊÿÁÿí"F_REPORT"
ÿ¶ÿÁÿí
ÿ’ÿÁ
ÿ½ andi 2.11.95
ÿ½ Header$ = "Kontobersicht " + nachname.maadr
Header$ÿ"Kontobersicht "
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (bis "ÿÿ(ÿQ,"dd.mm.yy")ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (ab "ÿvon$ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (vom "ÿvon$ÿ" bis "ÿbis$ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (Gesamtbersicht)"
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
ÿCodeMA.MAADR,Betrag.BUCHUNGÿU"SumAgentur%",SR.BUCHUNGÿU"SumStorno%",BetnGezahlt%ÿU"SumNBez%",BetnDiff%ÿU"GesSum%"
ÿ€ÿCodeMA.MAADR
ÿÊÿÁÿí"H_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿCodeMA.MAADR
ÿÊÿÁÿí"F_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ‘ÿÁ
ÿ’ÿ
ÿDatum.BUCHUNG
ÿ€ÿDatum.BUCHUNG
ÿÊÿÁÿí"H_Datum.BUCH003"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿ^
ÿÁÿs"LISTPRO2"
ÿÁÿ³Volumen.BUCHUNGÿU"SSumVol%",Betrag.BUCHUNGÿU"SSumAgentur%",SR.BUCHUNGÿU"SSumStorno%",BetnGezahlt%ÿU"SSumNBez%",BetnDiff%ÿU"SGesSum%"
ÿ}ÿÁ
	ÿÊÿÁÿí"F_REPORT"
	ÿ¶ÿÁÿí
ÿ’ÿÁ
Header$ÿ"Kontobersicht "ÿnachname.maadr
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (bis "ÿÿ(ÿQ,"dd.mm.yy")ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (ab "ÿvon$ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (vom "ÿvon$ÿ" bis "ÿbis$ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (Gesamtbersicht)"
ÿŸ
	ÿÊÿÁÿí"H_PAGE"
	ÿ¶ÿÁÿí
ÿ’ÿŸ
ÿCodeMA.MAADR,Betrag.BUCHUNGÿU"SumAgentur%",SR.BUCHUNGÿU"SumStorno%",Volumen.BUCHUNGÿU"SumVol%",BetnGezahlt%ÿU"SumNBez%",BetnDiff%ÿU"GesSum%"
ÿ€ÿCodeMA.MAADR
	ÿÊÿÁÿí"H_CodeMA.MAA002"
	ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿCodeMA.MAADR
ÿÊÿÁÿí"F_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ‘ÿÁ
ÿ’ÿ
ÿDatum.BUCHUNG
	ÿ€ÿDatum.BUCHUNG
	ÿÊÿÁÿí"H_Datum.BUCH003"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿÉ
	ÿÊÿÁÿí"F_SELECT"
	ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿ’ÿ¡
ÿÊÿiÿe
ÿÊÿiÿáÿe
ÿßÿe
vondat%ÿÿ1(vondat$)
bisdat%ÿÿ1(bisdat$)
ÿ³ÿ_ÿwErrUEBERSAG2
ÿ¡allProv$ÿ"j"ÿp
ÿÉ;
ÿĞCodeMA.BUCHUNGÿCodeMA.MAADRÿDatum.buchungÿvondat%ÿDatum.buchungÿ	bisdat%
ÿµÿÁNachname.MAADR,Nachname.BUCHUNG
ÿqÿ~
ÿ^
ÿÉ;
ÿĞCodeMA.BUCHUNGÿCodeMA.MAADRÿDatum.buchungÿvondat%ÿDatum.buchungÿ	bisdat%ÿmahnung.buchungÿ"j"
ÿµÿÁNachname.MAADR,Nachname.BUCHUNG
ÿqÿ~
ÿ’ÿ¡
ErrUEBERSAG2: 
ÿ³ÿ_ÿwErrorHandler 
 ÿ’ÿ¡
 ÿßÿ³
 ÿ’ÿÿ
 

 ' Zusatzbuchungen
 ' =======================================================================

ÿÿZUSATZBU()
 ÿ¡disabled%("BUCHUNGBEARB")ÿpÿ’ÿÿ
 ÿƒDFile(3,"buchung"ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿßÿe
 ÿ×LAgenturen$(ÿA("MAADR"))
 ÿ™"MAADR"
 ÿ£CodeMA.MAADR
 ÿÉÿ`
 a%ÿ0
 fprompt$ÿ"ZZZZZZZZZZZZZZ"
 aprompt$ÿ""
 ÿßÿe
 ÿØÿOÿB("MAADR")
LAgenturen$(a%)ÿNachname.MAADRÿ", "ÿVorname.MAADRÿÿ'(120)ÿÿ(CodeMA.MAADR,"000000")
ÿ¡CodeMA.MAADRÿ_ma%ÿpaprompt$ÿLAgenturen$(a%)
ÿ¡LAgenturen$(a%)ÿ
fprompt$ÿpfprompt$ÿLAgenturen$(a%)
a%ÿa%ÿ1
ÿÉÿ±ÿ™"MAADR"ÿ£CodeMA.MAADR
 ÿÙ
 ÿ¡aprompt$ÿ""ÿpAuswahl$ÿfprompt$ÿ^Auswahl$ÿaprompt$
 ok%ÿ1
 ÿØok%ÿ1
ÿÊÿË"Zusatzbuchungen"
ÿßÿ³
ÿÿ™"BUCHUNG"
ÿÊÿË"Datensatz neu angelegt..."
Datum.BUCHUNGÿÿQ
Buchungstext.BUCHUNGÿ"Zusatzbuchung:"
ÿ‰ÿñ"ZBUCHUNG",0,0,225,179,"Zusatzbuchung","MS Sans Serif",8
ÿ|ÿñ"ZBUCHUNG",4,0,0,225,152,0,""
ÿ|ÿñ"ZBUCHUNG",9,6,12,20,23,2
ÿ|ÿñ"ZBUCHUNG",5,40,15,176,21,0,"Bitte w„hlen Sie eine Agentur und fllen Sie die Felder Buchungstext und Betrag aus:"
ÿ|ÿñ"ZBUCHUNG",5,40,41,29,10,0,"Agentur:"
ÿ|ÿñ"ZBUCHUNG",8,40,52,175,95,259,2,Auswahl$,LAgenturen$
ÿ|ÿñ"ZBUCHUNG",6,83,72,41,12,0,0,Datum.BUCHUNG,10
ÿ|ÿñ"ZBUCHUNG",5,40,74,25,12,0,"Datum"
ÿ|ÿñ"ZBUCHUNG",6,83,86,60,12,0,0,Betrag.BUCHUNG,20
ÿ|ÿñ"ZBUCHUNG",5,40,88,37,9,0,"Betrag"
ÿ|ÿñ"ZBUCHUNG",6,83,101,132,39,4,2,Buchungstext.BUCHUNG,4000
ÿ|ÿñ"ZBUCHUNG",5,40,103,37,18,0,"Buchungs- text"
ÿ|ÿñ"ZBUCHUNG",1,50,156,55,15,0,"&Buchen",1,1
ÿ|ÿñ"ZBUCHUNG",1,108,156,55,15,0,"&Abbrechen",0,0
ÿñ"ZBUCHUNG",req%
ÿ¾ÿñ"ZBUCHUNG"
ÿßÿe
ÿ¡req%ÿ1ÿp
ÿÊÿË"Buchung wird gespeichert"
CodeBU.buchungÿÿI("buchung",1)
CodeMA.BUCHUNGÿÿ0(ÿ-(Auswahl$,6))
ÿƒFStore("BUCHUNG")
ÿ^
ok%ÿ0
ÿ’ÿ¡
ÿßÿ³
 ÿÙ
 ÿ’ÿÿ


ÿÿB3MASuchen():ÿ½ Agentur suchen
 ma%ÿCodeMA.buchung
 cuma%ÿGetCodeMA%(ma%)
 ÿ¡cuma%ÿ0ÿp
codema.buchungÿcuma%
ÿÉÿ¥cuma%ÿ™"maadr"ÿ£codema.maadr
ÿœ
 ÿ’ÿ¡
 ÿ’ÿÿ



 ' Ausgabe Provisionsliste *** Andi 21.9.95
 ' =======================================================================
 
ÿÿPROVILIST()
 ÿƒDFile(3,"buchung"ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿßÿe
 ÿÊÿË"Ausgabe wird vorbereitet..."
 Kopfzeile$ÿ""
 ÿ›z%ÿ1ÿq10
in$ÿReadConfig$("PROVIS","Header"ÿÿH(ÿ(z%,"99")))
ÿ¡in$ÿ""ÿin$ÿ"leer"ÿp
ÿ¡Kopfzeile$ÿ""ÿp
Kopfzeile$ÿin$
ÿ^
Kopfzeile$ÿKopfzeile$ÿÿ(13)ÿÿ(10)ÿin$
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ±z%
 Fuázeile$ÿ""
 ÿ›z%ÿ1ÿq10
in$ÿReadConfig$("PROVIS","Footer"ÿÿH(ÿ(z%,"99")))
ÿ¡in$ÿ""ÿin$ÿ"leer"ÿp
ÿ¡Fuázeile$ÿ""ÿp
Fuázeile$ÿin$
ÿ^
Fuázeile$ÿFuázeile$ÿÿ(13)ÿÿ(10)ÿin$
ÿ’ÿ¡
ÿ’ÿ¡
 ÿ±z%
 ÿ™"buchung"
 ÿ£CodeBU.buchung
 ÿÉÿb
 ÿØÿOÿB("buchung")ÿProvision.BUCHUNGÿ"j"
ÿÉÿg
 ÿÙ
 ÿ¡datum.Buchungÿ20ÿpcdat$ÿÿ(Datum.BUCHUNG)
 von$ÿcdat$
 bis$ÿcdat$
 allProv$ÿ"n"
 ÿ‰ÿñ"Konto1",0,0,221,165,title$,"MS Sans Serif",8
 ÿ|ÿñ"Konto1",9,6,7,24,22,2
 ÿ|ÿñ"Konto1",5,34,8,170,9,0,"Provisionsliste:"
 ÿ|ÿñ"Konto1",4,34,14,176,5,0,""
 ÿ|ÿñ"Konto1",5,34,22,175,16,0,"Bitte geben Sie ein, fr welchen Buchungszeitraum Sie eine šbersicht wnschen."
 ÿ|ÿñ"Konto1",5,34,40,175,32,0,"Wenn Sie keine Angaben zum Buchungszeitraum eintragen, werden alle Provisionen bzw. die Provisionen des vorgegebenen Zeitraumes aufgelistet."
 ÿ|ÿñ"Konto1",5,34,80,12,8,0,"von"
 ÿ|ÿñ"Konto1",6,53,79,45,11,0,0,von$,8
 ÿ|ÿñ"Konto1",5,102,80,12,8,0,"bis"
 ÿ|ÿñ"Konto1",6,116,79,45,11,0,0,bis$,8
 ÿ|ÿñ"Konto1",2,34,97,148,11,0,"alle berechneten Provisionen einbeziehen","j","n",allProv$
 ÿ|ÿñ"Konto1",5,44,108,167,25,0,"(es werden auch die Provisionen angezeigt, die wegen fehlender Zahlungsbeitr„ge in der Mahnlist sind)"
 ÿ|ÿñ"Konto1",1,50,144,55,15,1,"&Weiter",1,1
 ÿ|ÿñ"Konto1",1,110,144,55,15,0,"&Abbruch",0,0
 ÿñ"Konto1",req%
 ÿ¾ÿñ"Konto1"
 ÿßÿ³
 ÿ¡req%ÿ1ÿp
ÿßÿe
ÿ¡von$ÿ""ÿpvondat$ÿ"1.1.80"ÿ^vondat$ÿvon$
ÿ¡bis$ÿ""ÿpbisdat$ÿÿ(ÿQ)ÿ^bisdat$ÿbis$
ÿ¡RepType%ÿ0ÿp
ÿÁÿs"LISTPROV"
ÿÁÿ³Betrag.BUCHUNGÿU"SSumAgentur%",SR.BUCHUNGÿU"SSumStorno%",BetnGezahlt%ÿU"SSumNBez%",BetnDiff%ÿU"SGesSum%"
ÿ}ÿÁ
ÿÊÿÁÿí"F_REPORT"
ÿ¶ÿÁÿí
ÿ’ÿÁ
ÿ½ andi 2.11.95
ÿ½ Header$ = "Kontobersicht " + nachname.maadr
Header$ÿ"Kontobersicht "
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (bis "ÿÿ(ÿQ,"dd.mm.yy")ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (ab "ÿvon$ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (vom "ÿvon$ÿ" bis "ÿbis$ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿHeader$ÿ" (Gesamtbersicht)"
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
ÿCodeMA.MAADR,Betrag.BUCHUNGÿU"SumAgentur%",SR.BUCHUNGÿU"SumStorno%",BetnGezahlt%ÿU"SumNBez%",BetnDiff%ÿU"GesSum%"
ÿ€ÿCodeMA.MAADR
ÿÊÿÁÿí"H_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿCodeMA.MAADR
ÿÊÿÁÿí"F_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ‘ÿÁ
ÿ’ÿ
ÿDatum.BUCHUNG
ÿ€ÿDatum.BUCHUNG
ÿÊÿÁÿí"H_Datum.BUCH003"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿ^
ÿÁÿs"LISTPRO2"
ÿÁÿ³Volumen.BUCHUNGÿU"SSumVol%",Betrag.BUCHUNGÿU"SSumAgentur%",SR.BUCHUNGÿU"SSumStorno%",BetnGezahlt%ÿU"SSumNBez%",BetnDiff%ÿU"SGesSum%"
ÿ}ÿÁ
ÿÊÿÁÿí"F_REPORT"
ÿ¶ÿÁÿí
ÿ’ÿÁ
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
ÿCodeMA.MAADR,Betrag.BUCHUNGÿU"SumAgentur%",SR.BUCHUNGÿU"SumStorno%",Volumen.BUCHUNGÿU"SumVol%",BetnGezahlt%ÿU"SumNBez%",BetnDiff%ÿU"GesSum%"
ÿ€ÿCodeMA.MAADR
ÿÊÿÁÿí"H_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿCodeMA.MAADR
ÿÊÿÁÿí"F_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ‘ÿÁ
ÿ’ÿ
ÿDatum.BUCHUNG
ÿ€ÿDatum.BUCHUNG
ÿÊÿÁÿí"H_Datum.BUCH003"
ÿ¶ÿÁÿí
ÿ’ÿ
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿ’ÿ¡
ÿÊÿiÿe
ÿÊÿiÿáÿe
vondat%ÿÿ1(vondat$)
bisdat%ÿÿ1(bisdat$)
ÿ³ÿ_ÿwErrPROVLIST
ÿ¡allProv$ÿ"j"ÿp
ÿÉ;
ÿĞCodeMA.BUCHUNGÿCodeMA.MAADRÿDatum.buchungÿvondat%ÿDatum.buchungÿ	bisdat%
ÿµÿÁNachname.MAADR,Datum.BUCHUNG,Kunde$
ÿqÿ~
ÿ^
ÿÉ;
ÿĞCodeMA.BUCHUNGÿCodeMA.MAADRÿDatum.buchungÿvondat%ÿDatum.buchungÿ	bisdat%ÿMahnung.BUCHUNGÿ"j"
ÿµÿÁNachname.MAADR,Datum.BUCHUNG,Kunde$
ÿqÿ~
ÿ’ÿ¡
ErrPROVLIST: 
ÿ³ÿ_ÿwErrorHandler
 ÿ’ÿ¡
 ÿßÿ³
 ÿ’ÿÿ


 ' Provisionsberechnung
 ' einzelnen Vertrag berechnen
 ' =======================================================================
 ' 29.04.93/FA - Prfung auf einmalige Abschluáprovi und Pauschale
 ' 27.10.93/FA - nderung der Differenzrechnung
 ' 24.06.94/FA - Protokollierung von Fehlern in Log-Datei
 ' 28.06.94/FA - Laufzeit%-Berechnung ge„ndert
 ' 08.07.94/FA - wahlweiser Bezug BW-Zeitraum auf VSBeginn oder ProvBeginn
 ' 14.07.94/FA - LaufzeitPro% enth„lt Laufzeit seit Provisionsbeginn
 ' 22.09.94/FA - Umstellung auf Verwendung von VKOND
 '             - erweitertes CheckUp
 ' 13.10.94/FA - Streichung der SR-Berechnung bei Pflegeprovision
 

ÿÿPROVISION2()
 cfile$ÿÿ™
 ok%ÿ1
 ÿ½ **DEBUG ProviAb-Check
 ÿ¡ProviAb.KVERTRAGÿcdate%ÿp
ÿƒWriteLog("## Aufruf PROVISION2 mit ProviAb > cdate%")
ÿÂ"ProviAb > cdate%"
 ÿ’ÿ¡
 bwbezug$ÿReadConfig$("PROVIS","Bewertungszeitraum")
 ÿ¡bwbezug$ÿ"leer"ÿbwbezug$ÿ"Provisionierungsbeginn"ÿp
BWStart%ÿÿ1(ProviAb.KVERTRAG)
 ÿ^
BWStart%ÿÿ1(VS_Beginn.KVERTRAG)
 ÿ’ÿ¡
 Laufzeit%ÿÿ ((cdate%ÿBWStart%)ÿ30,0)
 LaufzeitPro%ÿÿ ((cdate%ÿÿ1(ProviAb.KVERTRAG))ÿ30,0)
 ÿ½ **DEBUG Laufzeit in LOG schreiben
 ÿ¡_debug%ÿ1ÿpÿƒWriteLog("## Laufzeit: "ÿÿ(lfdnr.KVERTRAG,"000000")ÿ" - "ÿÿ(Laufzeit%,"9999")ÿ" Monate")
 cuvt%ÿlfdnr.KVERTRAG
 codema%ÿCodeMA.kvertrag
 codege%ÿCodeGE.kvertrag
 codeva%ÿCodeVA.kvertrag
 ÿÉÿ¥CodeKO.KVERTRAGÿ™"VKOND"ÿ£CodeVK.VKOND
 ÿ¡ÿOÿC("VKOND")ÿp
ÿƒWriteLog("  kein Eintrag in Datei VKOND-gefunden!")
ÿƒAddLogInfo()
ok%ÿ0
 ÿ’ÿ¡
 vertrprov%ÿ0
 vertrsr%ÿ0
 ÿØok%ÿ1
ÿÉÿ¥CodeKO.VKONDÿ™"GEKOND"ÿ£lfdnr.GEKOND
ÿ¡ÿOÿC("GEKOND")ÿp
ÿƒWriteLog("  die angegebene Kondition ist nicht enthalten!")
ÿƒWriteLog("  SUPPORT: die in VKOND angegebene Kondition fehlt in GEKOND!")
ÿƒAddLogInfo()
ok%ÿ0
ÿ’ÿ¡
ÿ¡ok%ÿ1ÿp
codema%ÿCodeMA.GEKOND
 
ÿ½ --------------------
ÿ½ -- Abschluáprovision
ÿ½ --------------------
 
ÿ¡APjn.gekondÿ"j"ÿp
ÿ¡gez_Abschluá.kvertragÿ"j"ÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿAP.gekond)
	ÿ¡SRjn ÿ"j"ÿLaufzeit%ÿ
Haftung ÿp
sr%ÿsr.gekond
ÿ¡sr%ÿ0ÿp
Haftung%ÿÿ1(VS_Beginn.kvertrag)ÿ(Haftung.gekondÿ30)
ÿ^
Haftung%ÿ0
ÿ’ÿ¡
	ÿ^
sr%ÿ0
	ÿ’ÿ¡
	ÿƒRegProvis("Abschluá: "ÿVS_Nr.KVERTRAG,codema%,prov%,sr%,Haftung%)
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ½ -----------
ÿ½ -- Courtage
ÿ½ -----------
 
ÿ¡CourtageJN.gekondÿ"j"ÿp
_day%ÿÿ3(letzteProvi.KVERTRAG)
_month%ÿÿ5(letzteProvi.KVERTRAG)
_year%ÿÿ6(letzteProvi.KVERTRAG)
ÿ¡_year%ÿ
1980ÿp
	_year%ÿ1980
	_day%ÿ1
	_month%ÿ1
ÿ’ÿ¡
CourtGez$ÿ"n"
ÿ¡CourtageZWjn ÿ"n"ÿp
	ÿ½ -- abh„ngig von Zahlungsweise im Vertrag --
	ÿÉÿæZW.KVERTRAG
	ÿæ1
_year%ÿ_year%ÿ1
	ÿæ2
_month%ÿ_month%ÿ6
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
	ÿæ4
_month%ÿ_month%ÿ3
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
	ÿæ12
_month%ÿ_month%ÿ1
ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
ÿ’ÿ¡
	ÿæ0
_year%ÿ2100
	ÿ’ÿÉ
	nextprovi%ÿÿ1(ÿ(_day%,"00")ÿ"."ÿÿ(_month%,"00")ÿ"."ÿÿ(_year%,"9999"))
	ÿ¡ZW.KVERTRAGÿ0ÿletzteProvi.KVERTRAGÿ
1ÿp
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿCourtage.gekond)
CourtGez$ÿ"j"
	ÿ^
ÿ¡nextprovi%ÿ	cdate%ÿp
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿCourtage.gekond)
CourtGez$ÿ"j"
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ^
	ÿ½ -- Abh„ngig von Zahlweise in GEKOND --
	_month%ÿ_month%ÿCourtageZW.GEKOND
	ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
	ÿ’ÿ¡
	nextprovi%ÿÿ1(ÿ(_day%,"00")ÿ"."ÿÿ(_month%,"00")ÿ"."ÿÿ(_year%,"9999"))
	ÿ¡nextprovi%ÿ	cdate%ÿp
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿCourtage.gekond)
CourtGez$ÿ"j"
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡SRjn ÿ"j"ÿLaufzeit%ÿ
Haftung ÿp
	sr%ÿsr.gekond
ÿ^
	sr%ÿ0
ÿ’ÿ¡
ÿ¡sr%ÿ0ÿp
	Haftung%ÿÿ1(ProviAb.kvertrag)ÿ(Haftung.gekondÿ30)
ÿ^
	Haftung%ÿ0
ÿ’ÿ¡
ÿ¡CourtGez$ÿ"j"ÿpÿƒRegProvis("Courtage: "ÿVS_Nr.kvertrag,codema%,prov%,sr%,Haftung%)
ÿ’ÿ¡
 
ÿ½ ------------------
ÿ½ -- Pflegeprovision
ÿ½ ------------------
ÿ½ 13.10.94/FA - keine Berechung der Stornoreserve
 
ÿ¡PflegeJN.gekondÿ"j"ÿp
ÿ¡Laufzeit%ÿPflegezeit.gekondÿp
	_day%ÿÿ3(letztePflege.KVERTRAG)
	_month%ÿÿ5(letztePflege.KVERTRAG)
	_year%ÿÿ6(letztePflege.KVERTRAG)
	ÿ¡_year%ÿ
1980ÿp
_year%ÿ1980
_day%ÿ1
_month%ÿ1
	ÿ’ÿ¡
	_month%ÿ_month%ÿPflegeZW.GEKOND
	ÿ¡_month%ÿ12ÿp
_year%ÿ_year%ÿ1
_month%ÿ_month%ÿ12
	ÿ’ÿ¡
	nextpfl%ÿÿ1(ÿ(_day%,"00")ÿ"."ÿÿ(_month%,"00")ÿ"."ÿÿ(_year%,"9999"))
	ÿ¡nextpfl%ÿ	cdate%ÿp
prov%ÿ(((Beitrag.KVERTRAGÿZW.KVERTRAG)ÿ100)ÿPflegeProvi.gekond)
sr%ÿ0
Haftung%ÿ0
ÿ½ IF SRjn = "j" AND Laufzeit% < Haftung THEN 
ÿ½   sr% = sr.gekond
ÿ½ ELSE 
ÿ½   sr% = 0
ÿ½ END IF 
ÿ½ IF sr% <> 0 THEN 
ÿ½   Haftung% = DAYS (VS_Beginn.kvertrag) + (Haftung.gekond * 30)
ÿ½ ELSE 
ÿ½   Haftung% = 0
ÿ½ END IF 
ÿƒRegProvis("Pflege: "ÿVS_Nr.kvertrag,codema%,prov%,sr%,Haftung%)
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ½ ----------------
ÿ½ -- Vertragsdauer
ÿ½ ----------------
 
ÿ¡VDjn.gekondÿ"j"ÿp
ÿ¡gez_Abschluá.kvertragÿ"j"ÿp
	ÿÉÿæVS_Dauer.KVERTRAG
	ÿæVD1Dauer.gekond
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿVD1AP.gekond)
sr%ÿVD1SR.gekond
Haftung%ÿVD1HZ.GEKOND
	ÿæVD2Dauer.gekond
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿVD2AP.gekond)
sr%ÿVD2SR.gekond
Haftung%ÿVD2HZ.GEKOND
	ÿæVD3Dauer.gekond
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿVD3AP.gekond)
sr%ÿVD3SR.gekond
Haftung%ÿVD3HZ.GEKOND
	ÿæVD4Dauer.gekond
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿVD4AP.gekond)
sr%ÿVD4SR.gekond
Haftung%ÿVD4HZ.GEKOND
	ÿæVD5Dauer.gekond
prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿVD5AP.gekond)
sr%ÿVD5SR.gekond
Haftung%ÿVD5HZ.GEKOND
	ÿ’ÿÉ
	ÿ¡sr%ÿ0ÿp
Haftung%ÿ(Haftung%ÿ30)ÿÿ1(VS_beginn.kvertrag)
	ÿ^
Haftung%ÿ0
	ÿ’ÿ¡
	ÿƒRegProvis("VD: "ÿVS_Nr.kvertrag,codema%,prov%,sr%,Haftung%)
ÿ’ÿ¡
ÿ’ÿ¡

ÿ½ -----------------------------------
ÿ½ -- Teilzahlung/Ratenzahlung
ÿ½ -- z.Z. auf Ratenzahlung umgestellt
ÿ½ -----------------------------------
 
ÿ¡TZjn.gekondÿ"j"ÿp
ÿ¡TZRate.KVERTRAGÿ1ÿ1ÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ0.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD1.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ1.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD2.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ2.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD3.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ3.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD4.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ4.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD5.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ5.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD6.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ6.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD7.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ7.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD8.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ8.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD9.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ9.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD10.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ10.gekond)
ÿ’ÿ¡
ÿ¡TZRate.KVERTRAGÿ1ÿTZD11.gekondÿp
	prov%ÿ((Bewertungssumme.KVERTRAGÿ100)ÿTZ11.gekond)
ÿ’ÿ¡
ÿ¡prov%ÿ0ÿp
	ÿ¡SRjn ÿ"j"ÿLaufzeit%ÿ
Haftung ÿp
sr%ÿsr.gekond
	ÿ^
sr%ÿ0
	ÿ’ÿ¡
	ÿ¡sr%ÿ0ÿp
Haftung%ÿÿ1(VS_Beginn.kvertragÿ(Haftung.gekondÿ30))
	ÿ^
Haftung%ÿ0
	ÿ’ÿ¡
	ÿƒRegProvis("TZ ("ÿÿH(ÿ(TZRate.KVERTRAGÿ1,"999"))ÿ". Zahlung): "ÿVS_Nr.kvertrag,codema%,prov%,sr%,Haftung%)
ÿ^
	ÿƒWriteLog("!Konditionen fr Ratenzahlung/Teilzahlung unvollst„ndig")
	ÿƒWriteLog("    >> Rate: "ÿÿH(ÿ(TZRate.KVERTRAGÿ1,"999")))
	ÿƒWriteLog("    >> bei Abschluá:"ÿÿH(ÿ(TZ0.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD1.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ1.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD2.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ2.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD3.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ3.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD4.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ4.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD5.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ5.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD6.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ6.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD7.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ7.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD8.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ8.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD9.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ9.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD10.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ10.gekond,",999999.00")))
	ÿƒWriteLog("    >> nach dem "ÿÿH(ÿ(TZD11.gekond,"99"))ÿ". Monat)"ÿÿH(ÿ(TZ11.gekond,",999999.00")))
	ÿƒAddLogInfo()
ÿ’ÿ¡
 
ÿ’ÿ¡
 
ÿ½ ------------
ÿ½ -- Pauschale
ÿ½ ------------
 
ÿ¡PauschaleJN.gekondÿ"j"ÿp
ÿ¡gez_Pauschale.kvertragÿ"j"ÿp
	prov%ÿPauschale.gekond
	ÿ¡SRjn ÿ"j"ÿLaufzeit%ÿ
Haftung ÿp
sr%ÿsr.gekond
	ÿ^
sr%ÿ0
	ÿ’ÿ¡
	ÿ¡sr%ÿ0ÿp
Haftung%ÿÿ1(VS_Beginn.kvertrag)ÿ(Haftung.gekondÿ30)
	ÿ^
Haftung%ÿ0
	ÿ’ÿ¡
	ÿƒRegProvis("Pauschale: "ÿVS_Nr.kvertrag,codema%,prov%,sr%,Haftung%)
ÿ’ÿ¡
ÿ’ÿ¡
 
ÿ’ÿ¡
 
ÿ¡n„chsteKond.VKONDÿ0ÿp
ok%ÿ0
ÿ^
ÿÉÿ¥n„chsteKond.VKONDÿ™"VKOND"ÿ£CodeVK.VKOND
ÿ’ÿ¡

 ÿÙ
 ÿ’ÿÿ


ÿÿAddLogInfo()
 _ge%ÿCodeGE.GEADR
 _va%ÿCodeVA.SPARTEN
 _ma%ÿCodeMA.KVERTRAG
 _ku%ÿCodeKU.ADRESSEN
 ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
 ÿ¡ÿOÿC("GEADR")ÿpGesellschaft$ÿ"<nicht gefunden>"ÿ^Gesellschaft$ÿGesellschaft.GEADR
 ÿÉÿ¥CodeVA.KVERTRAGÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 ÿ¡ÿOÿC("SPARTEN")ÿpSparten$ÿ"<nicht gefunden>"ÿ^Sparten$ÿSparte.SPARTEN
 ÿÉÿ¥_ma%ÿ™"MAADR"ÿ£CodeMA.MAADR
 ÿ¡ÿOÿC("MAADR")ÿpAgentur$ÿ"<nicht gefunden>"ÿ^Agentur$ÿNachname.MAADRÿ", "ÿVorname.MAADR
 ÿÉÿ¥CodeKU.KVERTRAGÿ™"ADRESSEN"ÿ£CodeKU.ADRESSEN
 ÿ¡ÿOÿC("ADRESSEN")ÿpKunde$ÿ"<nicht gefunden>"ÿ^Kunde$ÿNachname.ADRESSENÿ", "ÿVorname.Adressen
 ÿƒWriteLog("    Vertrag: "ÿVS_Nr.KVERTRAGÿ" "ÿSparten$ÿ"/"ÿGesellschaft$)
 ÿƒWriteLog("    Beginn : "ÿÿ(ProviAb.KVERTRAG,"dd.mm.yy"))
 ÿƒWriteLog("    Kunde  : "ÿKunde$)
 ÿƒWriteLog("    Agentur: "ÿAgentur$)
 ÿƒWriteLog("")
 ÿÉÿ¥_ge%ÿ™"GEADR"ÿ£CodeGE.GEADR
 ÿÉÿ¥_va%ÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 ÿÉÿ¥_ma%ÿ™"MAADR"ÿ£CodeMA.MAADR
 ÿÉÿ¥_ku%ÿ™"ADRESSEN"ÿ£CodeKU.ADRESSEN
 ÿ’ÿÿ


 ' RegProvis
 ' =======================================================================
 ' Zweck:   tr„gt Buchungstext der Provisionsberechnung in die Buchungs-
 '          datei ein
 ' Nutzung: CALL RegProvis(remark$,codema%,provi%,sr%,srbis%)
 '          remark$     = Buchungstext
 '          ma%         = Agenturnummer
 '          provi%      = Provisionssumme
 '          sr%         = Stornoreserve in %
 '          Haftung%    = Datum der Stornoreserveauszahlung
 ' =======================================================================
 ' 29.04.93/FA     - Prfung auf einmalige Abschluáprovi und Pauschale
 '                 - Provisionsausweisung abzglich Stornoreserve
 ' 26.06.95/FA     - Korrektur der Registrierung gezahlter Pauschalen

ÿÿRegProvis(remark$,ma%,provi%,sr%,Haftung%)
 cfile$ÿÿ™
 ÿ™"kvertrag"
 _lfdnr%ÿlfdnr.KVERTRAG
 ÿÉÿ¥_lfdnr%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿÉÿ¥ma%ÿ™"maadr"ÿ£CodeMA.MAADR
 ÿ¡(CodeMA.maadrÿvorg„nger.maadr)ÿ(Vorg„nger.MAADRÿ0)ÿp
letzteProvi.kvertragÿcdate%
ÿ¡remark$ÿ"TZ (*"ÿp
TZRate.KVERTRAGÿTZRate.KVERTRAGÿ1
ÿ’ÿ¡
 ÿ’ÿ¡

 ÿ½ -- Einmalzahlungen registrieren --

 ÿ¡remark$ÿ"Abschlu*"ÿremark$ÿ"VD*"ÿpgezAbschluá%ÿ1
 ÿ¡remark$ÿ"Pflege*"ÿpgezPflege%ÿ1
 ÿ¡remark$ÿ"Pauschal*"ÿpgezPauschale%ÿ1
 ÿ¡CodeMA.MAADRÿVorg„nger.MAADRÿVorg„nger.MAADRÿ0ÿp
ÿ¡gezAbschluá%ÿ1ÿpgez_Abschluá.kvertragÿ"j"
ÿ¡gezPflege%ÿ1ÿpletztePflege.kvertragÿcdate%
ÿ¡gezPauschale%ÿ1ÿpgez_Pauschale.kvertragÿ"j"
 ÿ’ÿ¡

 ÿƒQuickStore("KVERTRAG")
 ÿ™"buchung"
 ÿ
 CodeBU.buchungÿÿI("buchung",1)
 Datum.buchungÿcdate%
 CodeVT.buchungÿlfdnr.kvertrag
 ÿ¡Kndigung.MAADRÿ	cdate%ÿNachfolger.MAADRÿ0ÿp
CodeMA.buchungÿNachfolger.MAADR
Buchungstext.buchungÿremark$ÿ" (Umbuchung von "ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ".)"
 ÿ^
CodeMA.buchungÿma%
Buchungstext.buchungÿremark$
 ÿ’ÿ¡
 SRBetrag%ÿ((provi%ÿvertrprov%)ÿ100)ÿsr%
 Betrag.buchungÿprovi%ÿvertrprov%ÿSRBetrag%
 Gesamtbetrag.BUCHUNGÿprovi%
 Bewertungssumme.BUCHUNGÿBewertungssumme.KVERTRAG
 Volumen.BUCHUNGÿVolumen.KVERTRAG
 Kndigung.BUCHUNGÿKndigung.KVERTRAG
 VS_Beginn.BUCHUNGÿVS_Beginn.KVERTRAG
 CodeKU.BUCHUNGÿCodeKU.KVERTRAG
 ÿÉÿ¥CodeVA.kvertragÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 Sparte.BUCHUNGÿSparte.SPARTEN
 ÿÉÿ¥CodeKU.KVERTRAGÿ™"ADRESSEN"ÿ£CodeKU.ADRESSEN
 Nachname.BUCHUNGÿNachname.ADRESSEN
 Vorname.BUCHUNGÿVorname.ADRESSEN
 ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
 Gesellschaft.BUCHUNGÿGesellschaft.GEADR
 Provision.buchungÿ"j"
 ÿ¡sr%ÿ0ÿp
SRgezahlt.buchungÿ"j"
SR.buchungÿ0
 ÿ^
SRAuszahlung.buchungÿHaftung%
SR.buchungÿSRBetrag%
 ÿ’ÿ¡
 
 ÿ½ -- Zahlungseingang prfen --
 ÿ¡check.KVERTRAGÿ"j"ÿp
_lfdnr%ÿlfdnr.KVERTRAG
ÿÉÿ¥_lfdnr%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
Pool.KVERTRAGÿPool.KVERTRAGÿBetrag.BUCHUNG
ÿ¡Pool.KVERTRAGÿ
0ÿp
Mahnung.KVERTRAGÿ"j"
Mahnung.BUCHUNGÿ"j"
ÿƒWriteLog("  fehlender Zahlungseingang von Gesellschaft")
ÿƒAddLogInfo()
ÿ’ÿ¡
ÿƒQuickStore("KVERTRAG")
 ÿ’ÿ¡
 ÿƒQuickStore("buchung")
 vertrprov%ÿprovi%
 ÿ’ÿÿ


 ' Zahlung von Stornoreserven
 ' =======================================================================

ÿÿSRZahlung()
 ÿßÿe
 ÿ¡cdate%ÿ0ÿpcdate%ÿÿQ
 ÿ™"BUCHUNG"
 ÿ£CodeBU.BUCHUNG
 fmax%ÿÿA("BUCHUNG")
 lp%ÿ0
 cp%ÿ0
 fcount%ÿ0
 ÿÉÿ`
 ÿØÿOÿB("BUCHUNG")
fcount%ÿfcount%ÿ1
cp%ÿÿ(100ÿfmax%ÿfcount%)
ÿ¡lp%ÿcp%ÿp
lp%ÿcp%
ÿÊÿË"Auszahlung Stornoreserve: "ÿÿH(ÿ(lp%,"999"))ÿ"%"
ÿ’ÿ¡
ÿ¡SRgezahlt.BUCHUNGÿ"j"ÿSRAuszahlung.BUCHUNGÿ
cdate%ÿp
_cubu%ÿCodeBU.BUCHUNG
_CodeMA%ÿCodeMA.BUCHUNG
_CodeVT%ÿCodeVT.BUCHUNG
_SR%ÿSR.BUCHUNG
ÿÉÿ¥_cubu%ÿáÿ™"BUCHUNG"ÿ£CodeBU.BUCHUNG
SRGezahlt.BUCHUNGÿ"j"
ÿƒQuickStore("BUCHUNG")
ÿÉÿ¥_CodeVT%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿÿ™"BUCHUNG"
CodeBU.BUCHUNGÿÿI("BUCHUNG",1)
Datum.BUCHUNGÿcdate%
CodeVT.BUCHUNGÿ_CodeVT%
CodeMA.BUCHUNGÿ_CodeMA%
SR.BUCHUNGÿ0
Betrag.BUCHUNGÿ_SR%
Buchungstext.BUCHUNGÿ"SR-Auszahlung "ÿVS_Nr.KVERTRAG
Bewertungssumme.BUCHUNGÿBewertungssumme.KVERTRAG
Kndigung.BUCHUNGÿKndigung.KVERTRAG
VS_Beginn.BUCHUNGÿVS_Beginn.KVERTRAG
CodeKU.BUCHUNGÿCodeKU.KVERTRAG
ÿÉÿ¥CodeVA.kvertragÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
Sparte.BUCHUNGÿSparte.SPARTEN
ÿÉÿ¥CodeKU.KVERTRAGÿ™"ADRESSEN"ÿ£CodeKU.ADRESSEN
Nachname.BUCHUNGÿNachname.ADRESSEN
Vorname.BUCHUNGÿVorname.ADRESSEN
ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
Gesellschaft.BUCHUNGÿGesellschaft.GEADR
SRgezahlt.buchungÿ"j"
Provision.BUCHUNGÿ"j"
SR.buchungÿ0
ÿƒQuickStore("BUCHUNG")
ÿÉÿ¥_cubu%ÿ™"BUCHUNG"ÿ£CodeBU.BUCHUNG
ÿ’ÿ¡
ÿÉÿ±ÿ™"BUCHUNG"ÿ£CodeBU.BUCHUNG
 ÿÙ
 ÿßÿ³
 ÿ’ÿÿ


 ' Listendruck Kundenliste, Vertragsliste
 ' =======================================================================
 
ÿÿPROLIST()
 ÿ¡disabled%("PROLIST")ÿpÿ’ÿÿ
 sel%ÿ1
 ÿ×Listen$(180)
 maxList%ÿ16
 Listen$(0)ÿ"Vertragsbersicht Kunden (gesamt)"
 Listen$(1)ÿ"Vertragsbersicht Kunden (Auswahl)"
 Listen$(2)ÿ"Vertragsbersicht Gesellschaften (gesamt)"
 Listen$(3)ÿ"Vertragsbersicht Gesellschaften (Auswahl)"
 Listen$(4)ÿ"Vertragsbersicht Agenturen (gesamt)"
 Listen$(5)ÿ"Vertragsbersicht Agenturen (Auswahl)"
 Listen$(6)ÿ"Provisionsliste"
 Listen$(7)ÿ"Kontenbersicht Agenturen (gesamt)"
 Listen$(8)ÿ"Kontenbersicht Agenturen (Auswahl)"
 Listen$(9)ÿ"Vertr„ge ohne Abschluá"
 Listen$(10)ÿ"Geburtstagsliste"
 Listen$(11)ÿ"Vertragsbersicht Fremdvertr„ge"
 Listen$(12)ÿ"Listengenerator (Vertr„ge)"
 Listen$(13)ÿ"Listengenerator (Konditionen)"
 Listen$(14)ÿ"Vertr„ge ohne Abschluá (keine Versicherungsnummer)"
 Listen$(15)ÿ"Mitarbeiter-/Agenturbersicht"
 Listen$(16)ÿ"Mahnliste - austehende Zahlungseing„nge"
 prompt$ÿListen$(0)
 ÿ›a%ÿ0ÿqmaxList%
Listen$(a%)ÿListen$(a%)ÿÿ'(120)ÿÿ(a%,"000000")
ÿ¡Listen$(a%)ÿ
prompt$ÿpprompt$ÿListen$(a%)
 ÿ±a%
 ÿ‰ÿñ"LISTDR",0,0,343,207,"Listendruck","MS Sans Serif",8
 ÿ|ÿñ"LISTDR",4,0,0,342,182,0,""
 ÿ|ÿñ"LISTDR",5,40,13,244,20,0,"Bitte w„hlen Sie die Liste aus, die Sie auf den Drucker bzw. auf den Bildschirm ausgeben lassen m”chten:"
 ÿ|ÿñ"LISTDR",9,8,14,20,21,2
 ÿ|ÿñ"LISTDR",7,40,35,292,145,2,2,Listen$,Auswahl$,prompt$
 ÿ|ÿñ"LISTDR",1,85,185,60,15,1,"&OK",1,1
 ÿ|ÿñ"LISTDR",1,148,185,60,15,0,"&Abbrechen",0,0
 ÿ|ÿñ"LISTDR",1,210,185,60,15,0,"&Kopf-/Fuázeilen",2,1
 ÿñ"LISTDR",req%
 ÿ¾ÿñ"LISTDR"
 ÿ¡req%ÿ1ÿp
rep%ÿÿ0(ÿ-(Auswahl$(0),6))
ÿÉÿærep%
ÿæ0
ÿƒLIST1()
ÿæ1
ÿƒLIST2(0)
ÿæ2
ÿƒLIST3()
ÿæ3
ÿƒLIST4()
ÿæ4
ÿƒLIST5()
ÿæ5
ÿƒLIST6()
ÿæ6
ÿƒPROVILIST()
ÿæ7
ÿƒUEBERSAG2()
ÿæ8
ÿƒUEBERSAG1()
ÿæ9
ÿƒLIST7()
ÿæ10
ÿƒGEBLISTE()
ÿæ11
ÿƒLIST9()
ÿæ12
ÿƒVertrUniRep(0,0,0,0,0,0,0,0,1)
ÿæ13
ÿ¡ÿOdisabled%("DATALOCK")ÿpÿƒGekondUniRep(0,0,0,1,1)
ÿæ14
ÿƒLIST10()
ÿæ15
ÿƒMAADRLIST()
ÿæ16
ÿƒMAHNLIST()
ÿ’ÿæ
 ÿ’ÿ¡
 ÿ¡req%ÿ2ÿpÿƒDRCONFIG()
 ÿœ
 ÿ’ÿÿ
 
 
 
 ' Liste 1 (alle Vertr„ge aller Kunden)
 ' =======================================================================
 
ÿÿLIST1()
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿÁÿs"LIST1"
 Ueberschr$ÿ"(alle Kunden)"
 ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
 ÿ’ÿŸ
 ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
 ÿ’ÿÉ
 ÿÊÿiÿe
 ÿÊÿiÿáÿe
 ÿßÿe
 ÿ³ÿ_ÿwErrLIST1
 ÿÉ;
ÿĞCodeMA.KVERTRAGÿCodeMA.MAADRÿCodeGE.KVERTRAGÿCodeGE.GEADRÿCodeVA.KVERTRAGÿcodeva.SPARTENÿCodeKU.KVERTRAGÿCodeKU.ADRESSEN
ÿµNachname.ADRESSEN,gesellschaft.geadr,sparte.SPARTEN
ÿqÿ~
ErrLIST1: 
 ÿ³ÿ_ÿwErrorHandler
 ÿßÿ³
 ÿ’ÿÿ
 
 
 ' Liste 2 (alle Vertr„ge ausgew„hlter Kunden)
 ' =======================================================================
 
ÿÿLIST2(knr%)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿÊÿË"Bereit"
 nachname$ÿ""
 ablistart%ÿ0
 cfile$ÿÿ™
 ÿ™"ADRESSEN"
 ÿ¡knr%ÿ0ÿp
ablistart%ÿ1
opt%ÿ1
ÿ‰ÿñ"SADR",0,0,132,111,caption$,"MS Sans Serif",8
ÿ|ÿñ"SADR",4,4,4,70,102,0," Suchen nach "
ÿ|ÿñ"SADR",6,6,89,63,13,0,0,suna$,30
ÿ|ÿñ"SADR",3,6,15,48,11,0,"Nachname",1,opt%
ÿ|ÿñ"SADR",3,6,27,40,11,0,"Vorname",2,opt%
ÿ|ÿñ"SADR",3,6,38,34,11,0,"Straáe",3,opt%
ÿ|ÿñ"SADR",3,6,50,26,11,0,"Ort",4,opt%
ÿ|ÿñ"SADR",3,6,62,51,12,0,"Postleitzahl",5,opt%
ÿ|ÿñ"SADR",3,6,75,56,11,0,"Telefon/FAX",6,opt%
ÿ|ÿñ"SADR",1,78,70,50,16,1,"&Suchen",1,1
ÿ|ÿñ"SADR",1,78,89,50,16,0,"&Abbruch",0,0
ÿñ"SADR",req%
ÿ¾ÿñÿt
ÿ¡req%ÿ1ÿp
ÿÉÿæopt%
ÿæ1
feld$ÿ"nachname.adressen"
ÿæ2
feld$ÿ"vorname.adressen"
ÿæ3
feld$ÿ"Straáe.adressen"
ÿæ4
feld$ÿ"Ort.adressen"
ÿæ5
feld$ÿ"PLZ.adressen"
ÿæ6
feld$ÿ"Telefon1.adressen"
ÿ’ÿÉ
ÿ™"adressen"
suna$ÿ"*"ÿsuna$ÿ"*"
ÿ£feld$$
ÿÊÿË"Suche Adressen..."
ÿÉÿ¥suna$ÿ£feld$$
ÿÂ"Auswahl","Nummer, Nachname, Vorname",20,req%,knr%,72,codeku.adressen,nachname.adressen,vorname.adressenÿ£nachname.adressenÿĞfeld$$ÿsuna$
ÿ¡req%ÿ1ÿp
ok%ÿ0
ÿ’ÿ¡
ÿ^
ok%ÿ0
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿ¡ok%ÿ0ÿp
ÿÉÿ¥knr%ÿ£codeku.adressen
ÿ¡ablistart%ÿ1ÿp
ÿÁÿs"LIST1"
ÿ^
ÿÁÿs"LISTKU1"
ÿÁÿ³ZW.KVERTRAGÿBeitrag.KVERTRAGÿU"sumbeitr%"
ÿ}ÿÁ
ÿÊÿÁÿí"F_REPORT"
ÿ¶ÿÁÿí
ÿ’ÿÁ
ÿ’ÿ¡
Ueberschr$ÿ"("ÿNachname.Adressenÿ", "ÿVorname.ADRESSENÿ")"
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿÊÿiÿe
ÿÊÿiÿáÿe
ÿßÿe
ÿ³ÿ_ÿwErrLIST2
ÿÉ;
ÿĞCodeMA.KVERTRAGÿCodeMA.MAADRÿCodeGE.KVERTRAGÿCodeGE.GEADRÿCodeVA.KVERTRAGÿcodeva.SPARTENÿCodeKU.KVERTRAGÿCodeKU.ADRESSENÿCodeKU.adressenÿknr%
ÿµNachname.ADRESSEN,gesellschaft.geadr,sparte.SPARTEN
ÿqÿ~
ErrLIST2: 
ÿ³ÿ_ÿwErrorHandler
 ÿ’ÿ¡
 ÿßÿ³
 ÿ™cfile$
 ÿ’ÿÿ
 
 
 ' Liste 3 (alle Vertr„ge aller Gesellschaften)
 ' =======================================================================
 
ÿÿLIST3()
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿÁÿs"LIST2"
 Ueberschr$ÿ"(alle Gesellschaften)"
 ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
 ÿ’ÿŸ
 ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
 ÿ’ÿÉ
 ÿÊÿiÿe
 ÿÊÿiÿáÿe
 ÿßÿe
 ÿ³ÿ_ÿwErrLIST3
 ÿÉ;
ÿĞCodeMA.KVERTRAGÿCodeMA.MAADRÿCodeGE.KVERTRAGÿCodeGE.GEADRÿCodeVA.KVERTRAGÿcodeva.SPARTENÿCodeKU.KVERTRAGÿCodeKU.ADRESSENÿCodeGE.KVERTRAGÿ2
ÿµGesellschaft.GEADR,sparte.SPARTEN
ÿqÿ~
ErrLIST3: 
ÿ³ÿ_ÿwErrorHandler
 ÿßÿ³
 ÿ’ÿÿ
 
 
 ' Liste 4 (alle Vertr„ge einer ausgew„hlten Gesellschaft)
 ' =======================================================================
 
ÿÿLIST4()
 ÿ¡ÿœÿ"GEADR"ÿp
cfile$ÿ"GEADR"
cuge%ÿCodeGE.GEADR
 ÿ^
cfile$ÿ""
cuge%ÿ0
 ÿ’ÿ¡
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 req%ÿ1
 ÿ¡cuge%ÿ0ÿpcuge%ÿGetCodeGE%(cuge%)
 ÿ¡cuge%ÿ0ÿp
ÿÉÿ¥cuge%ÿ™"geadr"ÿ£codege.geadr
ÿÁÿs"LIST2"
Ueberschr$ÿ"("ÿGesellschaft.geadrÿ")"
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿÊÿiÿe
ÿÊÿiÿáÿe
ÿßÿe
ÿ³ÿ_ÿwErrLIST41 
ÿÉ;
ÿĞCodeMA.KVERTRAGÿCodeMA.MAADRÿCodeGE.KVERTRAGÿCodeGE.GEADRÿCodeVA.KVERTRAGÿcodeva.SPARTENÿCodeKU.KVERTRAGÿCodeKU.ADRESSENÿCodeGE.KVERTRAGÿcuge%
ÿµGesellschaft.GEADR,sparte.SPARTEN
ÿqÿ~
ErrLIST41: 
ÿ³ÿ_ÿwErrorHandler
 ÿ’ÿ¡
 ÿ¡cfile$ÿ"GEADR"ÿp
ÿ™"GEADR"
ÿ£CodeGE.GEADR
ÿÉÿ¥cuge%ÿ™"GEADR"ÿ£CodeGE.GEADR
 ÿ’ÿ¡
 ÿœ
 ÿßÿ³
 ÿ’ÿÿ
 
 
 ' Liste 5 (alle Vertr„ge aller Agenturen)
 ' =======================================================================
 
ÿÿLIST5()
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿÁÿs"LIST3"
 Ueberschr$ÿ"(alle Agenturen)"
 ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
 ÿ’ÿŸ
 ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
 ÿ’ÿÉ
 ÿÊÿiÿe
 ÿÊÿiÿáÿe
 ÿßÿe
 ÿ³ÿ_ÿwErrLIST5
 ÿÉ;
ÿĞCodeMA.KVERTRAGÿCodeMA.MAADRÿCodeGE.KVERTRAGÿCodeGE.GEADRÿCodeVA.KVERTRAGÿcodeva.SPARTENÿCodeKU.KVERTRAGÿCodeKU.ADRESSEN
ÿµÿÁNachname.MAADR,Gesellschaft.GEADR,sparte.SPARTEN
ÿqÿ~
ErrLIST5: 
ÿ³ÿ_ÿwErrorHandler
 ÿßÿ³
 ÿ’ÿÿ
 
 
 ' Liste 6 (alle Vertr„ge einer ausgew„hlten Agentur)
 ' =======================================================================
 
ÿÿLIST6()
 ÿ¡ÿœÿ"MAADR"ÿp
cfile$ÿ"MAADR"
cuma%ÿCodeMA.MAADR
 ÿ^
cfile$ÿ""
cuma%ÿ0
 ÿ’ÿ¡
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 req%ÿ1
 ÿ¡cuma%ÿ0ÿpcuma%ÿGetCodeMA%(cuma%)
 ÿ¡cuma%ÿ0ÿp
ÿÉÿ¥cuma%ÿ™"maadr"ÿ£CodeMA.maadr
ÿÁÿs"LIST3"
Ueberschr$ÿ"("ÿNachname.maadrÿ")"
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿÊÿiÿe
ÿÊÿiÿáÿe
ÿßÿe
ÿ³ÿ_ÿwErrLIST6
ÿÉ;
ÿĞCodeMA.KVERTRAGÿCodeMA.MAADRÿCodeGE.KVERTRAGÿCodeGE.GEADRÿCodeVA.KVERTRAGÿcodeva.SPARTENÿCodeKU.KVERTRAGÿCodeKU.ADRESSENÿCodeMA.KVERTRAGÿcuma%
ÿµÿÁNachname.MAADR,Gesellschaft.GEADR,sparte.SPARTEN
ÿqÿ~
ErrLIST6: 
ÿ³ÿ_ÿwErrorHandler
 ÿ’ÿ¡
 ÿ¡cfile$ÿ"MAADR"ÿp
ÿ™"MAADR"
ÿ£CodeMA.MAADR
ÿÉÿ¥cuma%ÿ™"MAADR"ÿ£CodeMA.MAADR
 ÿ’ÿ¡
 ÿœ
 ÿßÿ³
 ÿ’ÿÿ
 
 
 ' Konditionsliste fr aktuelle Agentur
 ' =======================================================================
 
ÿÿKLIST()
 ÿßÿe
 ÿÊÿË"Ausgabe der Konditionsliste"
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 _ma%ÿCodeMA.MAADR
 
 ÿÁÿs"KONDLIST"
 ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
 ÿ’ÿŸ
 
 ÿCodeMA.MAADR
 ÿ€ÿCodeMA.MAADR
ÿÊÿÁÿí"H_CodeMA.MAA002"
ÿ¶ÿÁÿí
 ÿ’ÿ
 
 ÿ}ÿCodeMA.MAADR
ÿÊÿÁÿí"F_CodeMA.MAA002"
ÿ¶ÿÁÿí
ÿ‘ÿÁ
 ÿ’ÿ
 
 ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
 ÿ’ÿÉ
 
 ÿÊÿiÿe
 ÿÊÿiÿáÿe
 ÿ³ÿ_ÿwErrKLIST
 ÿÉ;
ÿĞCodeMA.MAADRÿCodeMA.GEKONDÿCodeVA.GEKONDÿcodeva.SPARTENÿCodeGE.GEKONDÿCodeGE.GEADRÿCodeMA.MAADRÿ_ma%
ÿµÿÁNachname.MAADR,Gesellschaft.GEADR,sparte.SPARTEN,BWvon.GEKOND
ÿqÿ~
ErrKLIST: 
 ÿ¡test%ÿ0ÿpÿ³ÿ_ÿwErrorHandler ÿ^ÿ³ÿ_
 ÿßÿ³
 ÿÊÿË"Bereit"
 ÿ’ÿÿ


ÿÿKLIST2()
 ÿ¡ÿOMNdisabled%("DATALOCK")ÿp
ÿƒGekondUniRep(CodeMA.MAADR,0,0,1,1)
 ÿ^
ÿƒGekondUniRep(CodeMA.MAADR,0,0,2,0)
 ÿ’ÿ¡
 ÿ’ÿÿ

ÿÿKLIST3()
 ÿ¡ÿOMNdisabled%("DATALOCK")ÿp
ÿƒGekondUniRep(CodeMA.GEKOND,CodeGE.GEKOND,CodeVA.GEKOND,1,1)
 ÿ^
ÿƒGekondUniRep(CodeMA.GEKOND,CodeGE.GEKOND,CodeVA.GEKOND,1,0)
 ÿ’ÿ¡
 ÿ’ÿÿ
 


 ' Liste 7 (Vertr„ge ohne Provisionszuordnung)
 ' =======================================================================
 ' 09.12.94/FA - Ausschluá von Fremdvertr„gen
 
ÿÿLIST7()
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿÁÿs"LIST1"
 Ueberschr$ÿ"(Vertr„ge ohne Abschluá)"
 ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
 ÿ’ÿŸ
 ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
 ÿ’ÿÉ
 ÿÊÿiÿe
 ÿÊÿiÿáÿe
 ÿßÿe
 ÿ³ÿ_ÿwErrLIST7
 ÿÉ;
ÿĞCodeMA.KVERTRAGÿCodeMA.MAADRÿCodeGE.KVERTRAGÿCodeGE.GEADRÿCodeVA.KVERTRAGÿcodeva.SPARTENÿCodeKU.KVERTRAGÿCodeKU.ADRESSENÿProviAb.KVERTRAGÿ
1ÿFremdvertrag.KVERTRAGÿ"j"ÿAltvertrag.KVERTRAGÿ"j"
ÿµKunde$,gesellschaft.geadr
ÿqÿ~
ErrLIST7: 
ÿ³ÿ_ÿwErrorHandler
 ÿßÿ³
 ÿ’ÿÿ


 ' Liste 8 (Vertragsbersicht der aktuellen Sparte)
 ' =======================================================================
 
ÿÿLIST8()
 cuva%ÿCodeVA.SPARTEN
 ÿƒVertrUniRep(0,0,CodeVA.SPARTEN,0,4,0,0,0,1)
 ÿ™"SPARTEN"
 ÿÉÿ¥cuva%ÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 ÿÊÿ£Sparte.SPARTEN
 ÿ£Sparte.SPARTEN
 ÿœ
 ÿ’ÿÿ

 ' Liste 9 (šbersicht ber alle Fremdvertr„ge)
 ' =======================================================================
 
ÿÿLIST9()
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿÁÿs"LIST1"
 Ueberschr$ÿ"(Fremdvertr„ge)"
 ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
 ÿ’ÿŸ
 ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
 ÿ’ÿÉ
 ÿÊÿiÿe
 ÿÊÿiÿáÿe
 ÿßÿe
 ÿ¡test%ÿ0ÿpÿ³ÿ_ÿwErrLIST9
 ÿÉ;
ÿĞFremdvertrag.KVERTRAGÿ"j"ÿCodeMA.KVERTRAGÿCodeMA.MAADRÿCodeGE.KVERTRAGÿCodeGE.GEADRÿCodeVA.KVERTRAGÿcodeva.SPARTENÿCodeKU.KVERTRAGÿCodeKU.ADRESSEN
ÿµNachname.ADRESSEN,gesellschaft.geadr,sparte.SPARTEN
ÿqÿ~
ErrLIST9: 
ÿ¡test%ÿ0ÿpÿ³ÿ_ÿwErrorHandler
 ÿßÿ³
 ÿ’ÿÿ


 ' Liste 10 (Vertr„ge ohne Abschluá - keine Versicherungsnummer
 ' =======================================================================
 ' 17.07.95/FA
 
ÿÿLIST10()
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿÁÿs"LIST1"
 Ueberschr$ÿ"(Vertr„ge ohne Abschluá)"
 ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
 ÿ’ÿŸ
 ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
 ÿ’ÿÉ
 ÿÊÿiÿe
 ÿÊÿiÿáÿe
 ÿßÿe
 ÿ³ÿ_ÿwErrLIST10
 ÿÉ;
ÿĞCodeMA.KVERTRAGÿCodeMA.MAADRÿCodeGE.KVERTRAGÿCodeGE.GEADRÿCodeVA.KVERTRAGÿcodeva.SPARTENÿCodeKU.KVERTRAGÿCodeKU.ADRESSENÿVS_Nr.KVERTRAGÿ""ÿFremdvertrag.KVERTRAGÿ"j"ÿAltvertrag.KVERTRAGÿ"j"
ÿµKunde$,gesellschaft.geadr,sparte.SPARTEN
ÿqÿ~
ErrLIST10: 
ÿ³ÿ_ÿwErrorHandler
 ÿßÿ³
 ÿ’ÿÿ
 
 
 




 '      *************************
 '      ** allgemeine Routinen **
 '      *************************


 ' Gesellschaftsdaten anzeigen
 ' =======================================================================

ProcShowGeadr: 
 w%ÿ120:h%ÿ120:st%ÿÿR
 d$ÿ"ShowCustoms"
 ÿ‰ÿñd$,0,0,w%,h%,"Angaben zur Gesellschaft","MS Sans Serif",8
 Ort$ÿPlz.geadrÿ" "ÿort.geadr
 Anspr$ÿvorname.geadrÿ" "ÿnachname.geadr
 ÿ|ÿñd$,5,4,20,90,9,0,gesellschaft.geadr
 ÿ|ÿñd$,5,4,28,90,9,0,Anspr$
 ÿ|ÿñd$,5,4,36,90,9,0,straáe.geadr
 ÿ|ÿñd$,5,4,44,90,9,0,ort$
 ÿ|ÿñd$,5,4,58,90,9,0,"Telefon 1"
 ÿ|ÿñd$,5,40,58,90,9,0,telefon1.geadr
 ÿ|ÿñd$,5,4,66,90,9,0,"Telefon 2"
 ÿ|ÿñd$,5,40,66,90,9,0,telefon2.geadr
 ÿ|ÿñd$,5,4,74,90,9,0,"Telefax"
 ÿ|ÿñd$,5,40,74,90,9,0,telefax.geadr
 ÿ|ÿñd$,5,4,82,90,9,0,"BTX"
 ÿ|ÿñd$,5,40,82,90,9,0,btx.geadr
 ÿ|ÿñd$,1,w%ÿ40,h%ÿ18,36,14,1,"OK",1,1
 ÿñd$,a%
 ÿ¾ÿñd$
 ÿÃ
 

 ' Agenturdaten anzeigen
 ' =======================================================================

ProcShowMaadr: 
 w%ÿ120:h%ÿ120:st%ÿÿR
 d$ÿ"ShowCustoms"
 ÿ‰ÿñd$,0,0,w%,h%,"Angaben zur Agentur","MS Sans Serif",8
 Mitarbeiter$ÿvorname.maadrÿ" "ÿnachname.maadr
 Ort$ÿPlz.maadrÿ" "ÿort.maadr
 ÿ|ÿñd$,5,4,20,90,9,0,anrede.maadr
 ÿ|ÿñd$,5,4,28,90,9,0,Mitarbeiter$
 ÿ|ÿñd$,5,4,36,90,9,0,straáe.maadr
 ÿ|ÿñd$,5,4,44,90,9,0,ort$
 ÿ|ÿñd$,5,4,58,90,9,0,"Telefon 1"
 ÿ|ÿñd$,5,40,58,90,9,0,telefon1.maadr
 ÿ|ÿñd$,5,4,66,90,9,0,"Telefon 2"
 ÿ|ÿñd$,5,40,66,90,9,0,telefon2.maadr
 ÿ|ÿñd$,5,4,74,90,9,0,"Telefax"
 ÿ|ÿñd$,5,40,74,90,9,0,telefax.maadr
 ÿ|ÿñd$,5,4,82,90,9,0,"BTX"
 ÿ|ÿñd$,5,40,82,90,9,0,btx.maadr
 ÿ|ÿñd$,1,w%ÿ40,h%ÿ18,36,14,1,"OK",1,1
 ÿñd$,a%
 ÿ¾ÿñd$
 ÿÃ


 '      *************************
 '      ** allgemeine Routinen **
 '      *************************



 '      ***********************
 '      ** Mendeklarationen **
 '      ***********************


 ' Hauptmen
 ' =======================================================================

ÿÿMNMAIN()
 ÿ¬ÿ…
 ÿƒMNProgramm()
 ÿ¬2,0,1,"&Adressen","",""
 ÿ¬2,1,1,"&Kunden","ADRESSEN",""
 ÿ¬2,2,1,"&Agenturen","MAADR",""
 ÿ¬2,3,1,"&Gesellschaften","GEADR",""
 ÿ¬3,0,1,"&Optionen","",""
 ÿ¬3,1,1,"&Einstellungen","SETUP",""
 ÿ¬3,2,1,"&Reorganisation","ReorgDB",""
 ÿ¬3,3,0,"Dateien korrigieren","GEKONDUpdate",""
 ÿ¬3,4,0,"&Konditionsanpassung","VKONDAkt",""
 ÿ¬3,5,0,"&SR-Rckzahlung","SRZahlung"
 ÿƒMNHilfe(4)
 ÿ’ÿÿ

ÿÿADRCOPY()
 cfile$ÿÿ™
 ÿ™"ADRESSEN"
 ÿˆÿaAnrede,Vorname,Nachname,Straáe,PLZ,Ort
 ÿ™cfile$
 ÿ’ÿÿ
 
  
 ' ADRESSEN
 ' =======================================================================

ÿÿMNADRESSEN()
 ÿ¬ÿ…
 ÿƒMNProgramm()
 ÿ¬1,1,1,"&Drucken..."
 ÿ¬1,1;1,1,"allg. Kundendaten","ADRDrucken","Druckausgabe"
 ÿ¬1,1;2,1,"Vertragsbersicht","VLIST1","Vertr„ge eines Kunden ausdrucken"
 ÿ¬1,1;3,1,"Provisionsbersicht","VLIST3","Provisionen aus Vertr„gen des aktuellen Kunden"
 ÿ¬2,0,1,"&Daten","",""
 ÿ¬2,1,1,"&Neu,F2","ADRNeu","einen neuen Datensatz erfassen"
 ÿ¬2,2,1,"S&ichern,F4","MStore",""
 ÿ¬2,3,1,"&Verwerfen,Alt+RckT","UNDO",""
 ÿ¬2,4,1,"&Duplizieren,Strg+D","ADRKopieren",""
 ÿ¡ÿOMNdisabled%("ADRLoeschen")ÿp
ÿ¬2,5,1,"&L”schen","ADRLoesch1",""
 ÿ^
ÿ¬2,5,0,"&L”schen"
 ÿ’ÿ¡
 ÿ¬2,6,1,"S&uchen,F6","ADRSuchen",""
 ÿ¬2,7,1,"Sperren","ADRSperre","aktuelle Adresse fr den Zugriff durch andere Mitarbeiter Sperren"
 ÿ¬3,0,1,"&Optionen","",""
 ÿ¬3,1,1,"&Termine","AKQUISE2",""
 ÿ¬3,2,1,"Telefon/&Fax","ADRTelefon",""
 ÿ¬3,3,1,"Fil&ter...","",""
 ÿ¬3,3;1,1,"normal","ADRFilter1",""
 ÿ¬3,3;2,1,"erweitert","ADRFilter2",""
 ÿ¬3,4,1,"Adressen &exportieren","ADRExport","Adressen nach dBase exportieren"
 ÿ¬3,5,1,"Adressen &importieren","ADRImport","Adressen aus dBase-Datei importieren"
 ÿƒMNDOK(4)
 ÿƒMNHilfe(5)
 ÿ’ÿÿ
 
 ' Umschaltung der Maskenvarianten

ÿÿADRM1()
 knr%ÿCodeKU.ADRESSEN
 ÿ†ÿœ
 cdir$ÿÿ
 ÿ_netpath$ÿ"PROVIS"
 ÿ½ DELETE "ADRESSEN.SBV"
 ÿˆ"ADR1.SBV"ÿq"ADRESSEN.SBV"
 ÿcdir$
 ÿ’ÿÿ


ÿÿADRM2()
 knr%ÿCodeKU.ADRESSEN
 ÿ†ÿœ
 cdir$ÿÿ
 ÿ_netpath$ÿ"PROVIS"
 ÿ½ DELETE "ADRESSEN.SBV"
 ÿˆ"ADR2.SBV"ÿq"ADRESSEN.SBV"
 ÿcdir$
 ÿ’ÿÿ


 ' VERTRGE
 ' =======================================================================
 ' 31.07.94/FA - Menpunkt Optionen entfernt

ÿÿMNVERTR()
 ÿ¬ÿ…
 ÿƒMNProgramm()
 ÿ¬1,1,1,"Drucken..."
 ÿ¬1,1;1,1,"Vertr„ge des aktuellen Kunden","VLIST2"
 ÿ¬1,1;2,1,"Vertr„ge ohne Abschluá","LIST7"
 ÿ¬1,1;3,1,"Provisionsbersicht akt. Kunde","VLIST3","Provisionen aus Vertr„gen des aktuellen Kunden"
 ÿ¬1,1;4,1,"Provisionsbersicht akt. Vertrag","VLIST4","Provisionen fr aktuellen Vertrag"
 ÿ¬2,0,1,"&Daten","",""
 ÿ¬2,1,1,"&Neu,F2","VERTRNeu","einen neuen Datensatz erfassen"
 ÿ¬2,2,1,"S&ichern,F4","MStore",""
 ÿ¬2,3,1,"&Kopieren,F5","VERTRKopieren","Vertrag kopieren"
 ÿ¬2,4,1,"&Verwerfen,Strg+RckT","UNDO",""
 ÿ¬2,5,1,"&L”schen","VERTRLoeschen",""
 ÿ¬2,6,1,"S&uchen,F6","VERTRSuchen()",""
 ÿ¬2,7,1,"Gesellschaft ausw„hlen,Strg+G","SGeadr"
 ÿ¬2,8,1,"Agentur ausw„hlen,Strg+A","SMaadr"
 ÿ¬2,9,1,"Sparte ausw„hlen,Strg+S","SCodeva"
 ÿ¬3,0,1,"&Optionen"
 ÿ¬3,1,1,"&Termin erfassen","AQRegister","zum aktuellen Kunden einen Termin erfassen"
 ÿ¬3,2,1,"Vertrags&status","VStat","Informationen zum aktuellen Vertrag"
 ÿ¬3,3,1,"Vertrag &deaktivieren","VERTRDeak","Vertrag aus Provisionsberechnung herausnehmen"
 ÿ¬3,4,1,"Vertrag &stornieren","VERTRStorno","Vertrag stornieren"
 ÿ¬4,0,1,"Do&kumente"
 ÿ¬4,1,1,"an Kunden","VDOKKunde","Dokument fr Kunden erstellen"
 ÿ¬4,2,1,"an Gesellschaft","VDOKGesellsch","Dokument fr Gesellschaft erstellen"
 ÿƒMNHilfe(5)
 ÿ’ÿÿ

 ' vertragsbezogene Dokumentenerstellung fr Kunden
 ' =======================================================================
 ' 12.09.95/FA
 
ÿÿVDOKKunde()
 ÿÊÿË"Dokumentenverwaltung (Dokumente an Kunden)"
 cuvt%ÿlfdnr.KVERTRAG
 ÿƒVERTRSync()
 ÿƒDOKUMENT("Dokumente an Kunden",cuvt%)
 ÿÊÿË""
 ÿ’ÿÿ
 
 ' vertragsbezogene Dokumentenerstellung fr Gesellschaften
 ' =======================================================================
 ' 12.09.95/FA
 
ÿÿVDOKGesellsch()
 ÿÊÿË"Dokumentenverwaltung (Dokumente an Gesellschaften)"
 cuvt%ÿlfdnr.KVERTRAG
 ÿƒVERTRSync()
 ÿƒDOKUMENT("Dokumente an Gesellschaften",cuvt%)
 ÿÊÿË""
 ÿ’ÿÿ

 ' korrekte Positionierung der verknpften Datei zur Datenbergabe an
 ' die Dokumentenverwaltung
 ' =======================================================================
 ' 13.09.95/FA

ÿÿVERTRSync()
 ÿ½ SELECT KEY cuvt% FILE "KVERTRAG" INDEX lfdnr.KVERTRAG
 ÿÉÿ¥CodeMA.KVERTRAGÿ™"MAADR"ÿ£CodeMA.MAADR
 ÿÉÿ¥CodeGE.KVERTRAGÿ™"GEADR"ÿ£CodeGE.GEADR
 ÿÉÿ¥CodeVA.KVERTRAGÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
 ÿÉÿ¥CodeKU.KVERTRAGÿ™"ADRESSEN"ÿ£CodeKU.ADRESSEN
 ÿ’ÿÿ
 
 

ÿÿVStat()
 ÿƒVStatus(lfdnr.KVERTRAG)
 ÿ’ÿÿ

 ' VERTRGE (Info)
 ' =======================================================================
 
ÿÿMNVERTRI()
 ÿ¬ÿ…
 ÿƒMNProgramm()
 ÿ¬1,1,1,"Drucken..."
 ÿ¬1,1;1,1,"Vertr„ge des aktuellen Kunden","VLIST2"
 ÿ¬1,1;2,1,"Vertr„ge ohne Abschluá","LIST7"
 ÿ¬2,0,1,"&Daten","",""
 ÿ¬2,1,0,"&Neu,F2","VERTRNeu","einen neuen Datensatz erfassen"
 ÿ¬2,2,0,"S&ichern,F4","MStore",""
 ÿ¬2,3,0,"&Verwerfen,Strg+RckT","UNDO",""
 ÿ¬2,4,0,"&L”schen","VERTRLoeschen",""
 ÿ¬2,5,1,"S&uchen,F6","VISuchen()",""
 ÿ¬3,0,1,"&Optionen","",""
 ÿ¬3,1,1,"&Zusatzversicherungen","VERTRZusatz",""
 ÿ¬3,2,0,"&Provisionierung","VERTRProvision",""
 ÿƒMNHilfe(4)
 ÿ’ÿÿ


ÿÿMNFRVERTR()
 ÿ¬ÿ…
 ÿƒMNProgramm()
 ÿ¬1,1,1,"Drucken..."
 ÿ¬1,1;1,1,"Vertr„ge des aktuellen Kunden","VLIST2"
 ÿ¬1,1;2,1,"Vertr„ge ohne Abschluá","LIST7"
 ÿ¬2,0,1,"&Daten","",""
 ÿ¬2,1,0,"&Neu,F2","VERTRNeu","einen neuen Datensatz erfassen"
 ÿ¬2,2,0,"S&ichern,F4","MStore",""
 ÿ¬2,3,0,"&Verwerfen,Strg+RckT","UNDO",""
 ÿ¬2,4,0,"&L”schen","VERTRLoeschen",""
 ÿ¬2,5,0,"S&uchen,F6","FRSuchen()",""
 ÿƒMNHilfe(3)
 ÿ’ÿÿ
 


 ' Vertragsnachbearbeitung
 ' =======================================================================
 
ÿÿMNVORGANG()
 ÿ¬ÿ…
 ÿƒMNProgramm()
 ÿ¬1,1,1,"Drucken..."
 ÿ¬1,1;1,1,"Vorg„nge des aktuellen Vertrages","VORGDruck","Auflistung aller Vorg„nge zum aktuellen Vertrag"
 ÿ¬2,0,1,"&Daten","",""
 ÿ¬2,1,1,"&Neu,F2","VorgangNeu","einen neuen Datensatz erfassen"
 ÿ¬2,2,1,"S&ichern,F4","MStore",""
 ÿ¬2,3,1,"&Verwerfen,Strg+RckT","UNDO",""
 ÿ¬2,4,1,"&L”schen","VorgangLoeschen",""
 ÿ¬2,5,1,"S&uchen,F6","VorgangSuchen",""
 ÿƒMNHilfe(3)
 ÿ’ÿÿ


 ' Mitarbeiteradressen MAADR
 ' =======================================================================

ÿÿMNMADR()
 ÿ¬ÿ…
 ÿƒMNProgramm()
 ÿ¬1,1,1,"Drucken..."
 ÿ¬1,1;1,1,"Agentur-/Mitarbeiterbersicht","MAADRLIST","Ausgabe einer Mitarbeiter-/Agenturbersicht"
 ÿ¬1,1;2,1,"Vertragsbersicht","LIST6"
 ÿ¬1,1;3,1,"Konditionsbersicht (kurz)","KLIST","allgemeine Konditionsbersicht"
 ÿ¬1,1;4,1,"Konditionsbersicht (lang)","KLIST2","ausfhrliche Konditionsbersicht"
 ÿ¬2,0,1,"&Daten","",""
 ÿ¬2,1,1,"&Neu,F2","MADRNeu","einen neuen Datensatz erfassen"
 ÿ¬2,2,1,"S&ichern,F4","MStore",""
 ÿ¬2,3,1,"&Verwerfen,Strg+RckT","UNDO",""
 ÿ¡MNdisabled%("MAADRLOESCHEN")ÿp
ÿ¬2,4,0,"&L”schen,Entf","MAADRLoeschen",""
 ÿ^
ÿ¬2,4,1,"&L”schen,Entf","MAADRLoeschen",""
 ÿ’ÿ¡
 ÿ¬2,5,1,"S&uchen,F6","MADRSuchen",""
 ÿ¬2,6,1,"Sper&ren","MAADRSperre","Agenturdaten fr den Zugriff durch andere Mitarbeiter sperren"
 ÿƒMNHilfe(3)
 ÿ’ÿÿ

 
 ' GEADR Gesellschaften
 ' =======================================================================

ÿÿMNGEADR()
 ÿ¬ÿ…
 ÿƒMNProgramm()
 ÿ¬1,1,1,"Drucken..."
 ÿ¬1,1;1,1,"Mahnliste","MAHNLIST","šbersicht ber ausstehende Zahlungseing„nge"
 ÿ¬2,0,1,"&Daten","",""
 ÿ¬2,1,1,"&Neu,F2","GEADRNeu","einen neuen Datensatz erfassen"
 ÿ¬2,2,1,"S&ichern,F4","MStore",""
 ÿ¬2,3,1,"&Verwerfen,Strg+RckT","UNDO",""
 ÿ¡MNdisabled%("GEADRLOESCHEN")ÿp
ÿ¬2,4,0,"&L”schen,Entf","GEADRLoeschen",""
 ÿ^
ÿ¬2,4,1,"&L”schen,Entf","GEADRLoeschen",""
 ÿ’ÿ¡
 ÿ¬2,5,1,"S&uchen,F6","GEADRSuchen",""
 ÿƒMNHilfe(3)
 ÿ’ÿÿ
 

 ' GEKOND Konditionen
 ' =======================================================================

ÿÿMNGEKOND()
 ÿ¬ÿ…
 ÿƒMNProgramm()
 ÿ¬1,1,1,"Drucken..."
 ÿ¬1,1;1,1,"Konditionsbersicht (kurz)","KLIST","allgemeine Konditionsbersicht"
 ÿ¬1,1;2,1,"Konditionsbersicht (lang)","KLIST3","ausfhrliche Konditionsbersicht"
 ÿ¬2,0,1,"&Daten","",""
 ÿ¬2,1,1,"&Neu,F2","GEKONDNeu","einen neuen Datensatz erfassen"
 ÿ¬2,2,1,"S&ichern,F4","MStore",""
 ÿ¬2,3,1,"&Verwerfen,Strg+RckT","UNDO",""
 ÿ¡MNdisabled%("GEKONDLOESCHEN")ÿp
ÿ¬2,4,0,"&L”schen,Entf","GEKONDLoeschen","aktuelle Kondition l”schen"
 ÿ^
ÿ¬2,4,1,"&L”schen,Entf","GEKONDLoeschen","aktuelle Kondition l”schen"
 ÿ’ÿ¡
 ÿ¬2,5,1,"S&uchen,F6","GEKONDSuchen",""
 ÿ¬2,6,3
 ÿ¬2,7,1,"&Gesellschaft ausw„hen,Strg+G","MASGeadr"
 ÿ¬2,8,1,"&Sparte ausw„hlen,Strg+S","MASCodeva"
 ÿ¬3,0,1,"&Bewegen","",""
 ÿ¬3,1,1,"&N„chster,BildAb","GEKONDNext","n„chster Datensatz"
 ÿ¬3,2,1,"&Vorheriger,BildAuf","GEKONDPrev",""
 ÿ¬4,0,1,"&Musteragentur","",""
 ÿ¬4,1,1,"&Bearbeiten","GEKONDM()",""
 ÿ¬4,2,1,"&šbernehmen","GEKONDUebern",""
 ÿ¬5,0,1,"&Anpassung","",""
 ÿ¬5,1,1,"&aktuelle Kondition","ANPASSUNG",""
 ÿ¬5,2,1,"a&lle Konditionen","ANPASSUNG2",""
 ÿƒMNHilfe(6)
 ÿ’ÿÿ

 
 ' GEKONDM Musterkonditionen
 ' =======================================================================

ÿÿMNGEKONDM()
 ÿ¬ÿ…
 ÿƒMNProgramm()
 ÿ¬2,0,1,"&Daten","",""
 ÿ¬2,1,1,"&Neu,F2","GEKONDMNeu","einen neuen Datensatz erfassen"
 ÿ¬2,2,1,"S&ichern,F4","MStore",""
 ÿ¬2,3,1,"&Verwerfen,Strg+RckT","UNDO",""
 ÿ¡MNdisabled%("GEKONDMLoeschen")ÿp
ÿ¬2,4,0,"&L”schen,Entf","GEKONDMDel","Musterkondition l”schen"
 ÿ^
ÿ¬2,4,1,"&L”schen,Entf","GEKONDMDel","Musterkondition l”schen"
 ÿ’ÿ¡
 ÿ¬2,5,1,"S&uchen,F6","GEKONDMSuchen",""
 ÿ¬3,0,1,"&Bewegen","",""
 ÿ¬3,1,1,"&N„chster,BildAb","PSelectNext","n„chster Datensatz"
 ÿ¬3,2,1,"&Vorheriger,BildAuf","PSelectPrev",""
 ÿƒMNHilfe(4)
 ÿ’ÿÿ

 
 ' SPARTEN
 ' =======================================================================

ÿÿMNCODEVA()
 ÿ¬ÿ…
 ÿƒMNProgramm()
 ÿ¬1,1,1,"&Drucken..."
 ÿ¬1,1;1,1,"Vertragsbersicht","LIST8","Auflistung der Vertr„ge dieser Sparte"
 ÿ¬2,0,1,"&Daten","",""
 ÿ¬2,1,1,"&Neu,F2","CODEVANeu","einen neuen Datensatz erfassen"
 ÿ¬2,2,1,"S&ichern,F4","MStore",""
 ÿ¬2,3,1,"&Verwerfen,Strg+RckT","UNDO",""
 ÿ¡MNdisabled%("SPARTENLOESCHEN")ÿp
ÿ¬2,4,0,"&L”schen,Entf","CODEVALoeschen",""
 ÿ^
ÿ¬2,4,1,"&L”schen,Entf","CODEVALoeschen","aktuelle Sparte l”schen"
 ÿ’ÿ¡
 ÿ¬2,5,1,"S&uchen,F6","CODEVASuchen",""
 ÿ¬3,0,1,"&Bewegen","",""
 ÿ¬3,1,1,"&N„chster,BildAb","PSelectNext","n„chster Datensatz"
 ÿ¬3,2,1,"&Vorheriger,BildAuf","PSelectPrev",""
 ÿ¬3,3,1,"&Erster","SelectFirst",""
 ÿ¬3,4,1,"&Letzter","SelectLast",""
 ÿƒMNHilfe(4)
 ÿ’ÿÿ


 ' Zahlungseingang
 ' =======================================================================
 
ÿÿMNEINGANG()
 ÿ¬ÿ…
 ÿƒMNProgramm()
 ÿ¬1,1,0,"&Drucken..."
 ÿ¬1,1;1,0,"šbersicht Zahlungseing„nge","ZEINList1","Ausgabe des Zahlungseingangsbericht"
 ÿ¬2,0,1,"&Daten","",""
 ÿ¬2,1,1,"&Neu,F2","ZEINNeu","einen neuen Datensatz erfassen"
 ÿ¬2,2,1,"S&ichern,F4","ZEINSichern","Zahlungseingang sichern"
 ÿ¬2,3,1,"&Verwerfen,Strg+RckT","UNDO","letzte nderung verwerfen"
 ÿ¡MNdisabled%("ZEINLOESCHEN")ÿp
ÿ¬2,4,0,"&L”schen,Entf","ZEINLoeschen","aktuellen Datensatz l”schen"
ÿ¬2,5,0,"&Vertragsberwachung deaktivieren","ZEDeaktiv","Vertragsberwachung deaktivieren"
 ÿ^
ÿ¬2,4,1,"&L”schen,Entf","ZEINLoeschen","aktuellen Datensatz l”schen"
ÿ¬2,5,1,"&Vertragsberwachung deaktivieren,F8","ZEDeaktiv","Vertragsberwachung deaktivieren"
 ÿ’ÿ¡
 ÿ¬2,6,1,"S&uchen,F6","ZEINSuchen","Zahlungseingang suchen"
 ÿƒMNHilfe(3)
 ÿ’ÿÿ
 

 ' ZBUCHUNG
 ' =======================================================================

ÿÿMNZBUCHUNG()
 ÿ¬ÿ…
 ÿƒMNProgramm()
 ÿ¬2,0,1,"&Daten","",""
 ÿ¬2,1,1,"&Neu,F2","BUNeu","einen neuen Datensatz erfassen"
 ÿ¬2,2,1,"S&ichern,F4","BUSichern",""
 ÿ¬2,3,1,"&Verwerfen,Strg+RckT","UNDO",""
 ÿ¬2,4,1,"&L”schen,Entf","BULoeschen",""
 ÿ¬2,5,1,"S&uchen,F6","BUSuchen()",""
 ÿƒMNHilfe(3)
 ÿ’ÿÿ
 


 ' Umstellung der Konditionen auf neue Struktur
 ' (Erzeugung VKOND.SBF)
 ' =======================================================================
 ' 01.10.94/FA
 
ÿÿVKONDAkt()
 ÿßÿe
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 ÿƒDFile(3,"vkond"ÿ_fpw$)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿƒCreateLog()
 ÿƒWriteLog("")
 ÿƒWriteLog("====================================")
 ÿƒWriteLog("Konditionsumstellung vom "ÿÿ(ÿQ,"dd.mm.yy"))
 ÿƒWriteLog("====================================")
 ÿƒWriteLog("")
 ÿ¾ÿaÿ™"VKOND"
 ÿ™"KVERTRAG"
 ÿ¡ÿ÷("UPDATE")ÿpup%ÿ1
 ÿÊÿË"Bereit"
 ÿ£lfdnr.KVERTRAG
 tmax%ÿÿA("KVERTRAG")
 cuvt%ÿlfdnr.KVERTRAG
 cp%ÿ0
 lp%ÿ0
 a%ÿ0
 ÿ¡up%ÿ1ÿpÿƒServer("UPDGAUGE","0")
 ÿƒServer("LOADMESSAGE","")
 ÿƒServer("MESSAGE","Bitte warten... Die Konditionsdaten werden in die ge„nderte Struktur bernommen. (Dieser Vorgang kann bei gr”áeren Datenbest„nden einige Zeit in Anspruch nehmen.)")
 lc$ÿ"|"
 ÿÉÿ`
 ÿØÿOÿB("KVERTRAG")
cvt%ÿlfdnr.KVERTRAG
a%ÿa%ÿ1
cp%ÿÿ(100ÿtmax%ÿa%)
ÿ¡up%ÿ1ÿp
ÿ¡lp%ÿcp%ÿp
ÿƒServer("UPDGAUGE",ÿH(ÿ(cp%,"999")))
lp%ÿcp%
ÿ’ÿ¡
ÿ^
ÿ¡lc$ÿ"|"ÿp
lc$ÿ"/"
ÿ^
ÿ¡lc$ÿ"/"ÿp
	lc$ÿ"-"
ÿ^
	ÿ¡lc$ÿ"-"ÿp
lc$ÿ"\"
	ÿ^
ÿ¡lc$ÿ"\"ÿp
lc$ÿ"|"
ÿ’ÿ¡
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ’ÿ¡
ÿÊÿË"Verarbeitung: "ÿÿH(ÿ(cp%,"9999"))ÿ"% "ÿlc$
ÿ’ÿ¡
ÿ¡ProviAb.KVERTRAGÿ0ÿp
kond%ÿGetKond%(lfdnr.KVERTRAG,0,ÿ1)
ÿÉÿ¥cvt%ÿáÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
CodeKO.KVERTRAGÿkond%
ÿƒQuickStore("KVERTRAG")
ÿ¡kond%ÿ0ÿp
ÿ½ SET STATUS "Fehlerbehebung..."
ÿ½ IF EXISTS (cvt%,CodeVT.VKOND) THEN REMOVE FROM FILE "VKOND" WHERE CodeVT.VKOND = cvt%
ÿ’ÿ¡
ÿ’ÿ¡
ÿÉÿ¥cvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
ÿÉÿ±ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿÙ
 ÿƒServer("UNLOADMESSAGE","")
 ÿƒCloseLog()
 ÿÉÿ¥cuvt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿ’ÿÿ
 

 ' Aktualisierung der VKOND mit aktuellen Konditionen
 ' =======================================================================
 
ÿÿGetKond%(vt%,ProviAb%,logging%)
 cfile$ÿÿ™
 ÿÉÿ¥vt%ÿ™"KVERTRAG"ÿ£lfdnr.KVERTRAG
 ÿ¡ProviAb%ÿ0ÿp
bwbezug$ÿReadConfig$("PROVIS","Bewertungszeitraum")
ÿ¡bwbezug$ÿ"leer"ÿbwbezug$ÿ"Provisionierungsbeginn"ÿp
BWStart%ÿÿ1(ProviAb.KVERTRAG)
ÿ^
BWStart%ÿÿ1(VS_Beginn.KVERTRAG)
ÿ’ÿ¡
 ÿ^
BWStart%ÿProviAb%
 ÿ’ÿ¡
 ÿ™"GEKOND"

 ÿ½ ### Andi Anfang
 ÿÉÿĞ
 ÿ£QuickCode.gekond:ÿ½ Fred
 ÿÉÿ`
 ÿ½ ### Andi Ende
 codema%ÿCodeMA.kvertrag
 codege%ÿCodeGE.kvertrag
 codeva%ÿCodeVA.kvertrag
 ÿ½ ###andi anfang
 ÿ™"maadr"
 ÿ£Codema
 ÿÉÿ`
 ÿÉÿ¥codema%ÿ™"maadr"ÿ£codema 
 ma$ÿÿH(nachname.maadr)
 ÿÉÿ`
 ÿ™"geadr"
 ÿ£CodeGE
 ÿÉÿ`
 ÿÉÿ¥codege%ÿ™"geadr"ÿ£codege 
 ge$ÿÿH(Gesellschaft.geadr)
 ÿÉÿ`
 ÿ™"sparten"
 ÿ£CodeVA
 ÿÉÿ`
 ÿÉÿ¥Codeva%ÿ™"Sparten"ÿ£codeva 
 sparte$ÿÿH(sparte.sparten)
 ÿÉÿ`
 ÿ™"GEKOND"
 beschreibung$ÿma$ÿ","ÿge$ÿ","ÿsparte$
 ÿ½ ### andi ende
 FirstKond%ÿ0
 LastKond%ÿ0
 ok%ÿ1

 ÿØCodeMA%ÿ0ÿok%ÿ1
ÿ™"GEKOND"
ÿ£QuickCode.gekond
SCode$ÿÿ(CodeMA%,"000000")ÿÿ(CodeGE%,"000000")ÿÿ(CodeVA%,"000000")
kondfound%ÿ1
ÿÉÿ¥codema%ÿ™"maadr"ÿ£CodeMA.MAADR
ÿÉÿ¥SCode$ÿ™"gekond"ÿ£QuickCode.gekond
ÿ¡ÿC("GEKOND")ÿp
notfound%ÿ1
ÿØnotfound%ÿ1ÿQuickCode.GEKONDÿSCode$ÿÿOÿB("GEKOND")
 
ÿ½ -------------------------------
ÿ½ -- Bewertungszeitraum ermitteln
ÿ½ -------------------------------
 
ÿ¡ÿ1(BWvon.GEKOND)ÿ
1ÿpBWvon%ÿÿ1("1.1.1980")ÿ^BWvon%ÿÿ1(BWvon.GEKOND)
ÿ¡ÿ1(BWbis.GEKOND)ÿ
1ÿpBWbis%ÿÿ1("31.12.1999")ÿ^BWbis%ÿÿ1(BWbis.GEKOND)
ÿ¡BWStart%ÿBWvon%ÿBWStart%ÿ	BWbis%ÿp
	notfound%ÿ0
ÿ^
	ÿÉÿ±ÿ™"gekond"ÿ£QuickCode.GEKOND
ÿ’ÿ¡
ÿÙ
ÿ¡notfound%ÿ1ÿp
tag$ÿÿ(BWStart%)
fehlnach$ÿ"Es wurden keine Konditionen fr "ÿbeschreibung$ÿ" im Zeitraum "ÿtag$ÿ" definiert"
ÿ¡logging%ÿp
	tag$ÿÿ(BWStart%)
	ÿƒWriteLog("!"ÿfehlnach$)
	ÿƒAddLogInfo()
ÿ’ÿ¡
ok%ÿ0
kondfound%ÿ0
ÿ’ÿ¡
ÿ^
fehlnach$ÿ"Es wurden keine Konditionen fr "ÿbeschreibung$ÿ" definiert"
kondfound%ÿ0
ÿ¡logging%ÿp
ÿƒWriteLog("!"ÿfehlnach$)
ÿƒAddLogInfo()
ÿ’ÿ¡
ÿ’ÿ¡
ÿ¡kondfound%ÿ1ÿp
ÿ½ ** Eintrag in VKOND erstellen
ÿÿ™"VKOND"
CodeVK.VKONDÿÿI("VKOND",1)
CodeKO.VKONDÿlfdnr.GEKOND
ÿ¡FirstKond%ÿ0ÿpFirstKond%ÿCodeVK.VKOND
CodeVT.VKONDÿvt%
CodeMA.VKONDÿcodema%
n„chsteKond.VKONDÿ0
_vk%ÿCodeVK.VKOND
ÿƒQuickStore("VKOND")
ÿ¡LastKond%ÿ0ÿp
ÿÉÿ¥LastKond%ÿáÿ™"VKOND"ÿ£CodeVK.VKOND
n„chsteKond.VKONDÿ_vk%
ÿƒQuickStore("VKOND")
ÿ’ÿ¡
LastKond%ÿ_vk%
ÿ^
ok%ÿ0
ÿ’ÿ¡
ÿÉÿ¥codema%ÿ™"maadr"ÿ£CodeMA.MAADR
ÿ¡Vorg„nger.MAADRÿ0ÿVorg„nger.MAADRÿCodeMA.MAADRÿp
CodeMA%ÿ0
ÿ^
CodeMA%ÿVorg„nger.MAADR
ÿ’ÿ¡
 ÿÙ
 ÿ¡ok%ÿ1ÿp
GetKond%ÿFirstKond%
 ÿ^
ÿ½ Eintr„ge wieder l”schen
ÿ¡FirstKond%ÿ0ÿp
ok%ÿ1
ÿØok%ÿ1
ÿÉÿ¥FirstKond%ÿáÿ™"VKOND"ÿ£CodeVK.VKOND
ÿ¡ÿC("VKOND")ÿp
	ÿÊÿË"Korrektur"
	_nkond%ÿn„chsteKond.VKOND
	ÿÉÿ¾ÿ™"VKOND"
	FirstKond%ÿ_nkond%
	ÿÊÿË"Bereit"
ÿ^
	ok%ÿ0
ÿ’ÿ¡
ÿÙ
ÿ’ÿ¡
GetKond%ÿ0
 ÿ’ÿ¡
 ÿ’ÿÿ

ÿÿADRLoesch1()
 ÿ¡title$ÿ"*DEMO*"ÿÿA("ADRESSEN")ÿ10ÿp
ÿƒDemoInfo()
ÿ’ÿÿ
 ÿ’ÿ¡
ÿƒDFile(3,"kvertrag"ÿ_fpw$)
_ok%ÿ0
 ÿ¡disabled%("ADRLoeschen")ÿpÿ’ÿÿ
 cuku%ÿCodeKU.adressen
 ÿ™"Kvertrag"
 ÿ¡ÿJ(cuku%,codeku.kvertrag)ÿp
ÿƒFehler("Adresse kann nicht gel”scht werden","Es existieren noch Vertr„ge")
_ok%ÿÿ1
 ÿ’ÿ¡
 ÿ¡_ok%ÿÿ1ÿp
 ÿ™"adressen"
 ÿÂ"Adresse wirklich l”schen?","",135,req%
 ÿ¡req%ÿ1ÿp
ÿÉÿ¥cuku%ÿáÿ™"ADRESSEN"ÿ£CodeKU.adressen
ÿÉÿ¾
ÿÉÿ±
ÿœ
 ÿ’ÿ¡
 ÿ’ÿ¡
 ÿœ
 ÿ’ÿÿ

 
 ' universeller Reportgenerator fr Vertragsbersichten
 ' ======================================================================
 ' ku%   Kundennummer (CodeKU) oder 0 fr alle
 ' ma%   Agenturnummer (CodeMA) oder 0 fr alle
 ' spa%  Spartennummer (CodeVA) oder 0 fr alle
 ' ge%   Gesellschaftsnummer (CodeGE) oder 0 fr alle
 ' so%   Sortierung: 1=Kunde, 2=Agentur, 3=Gesellschaft, 4=Sparte
 ' von%  Anfangsdatum oder 0 fr alle
 ' bis%  Enddatum oder 0 fr Open End
 ' bart% Berichtsart: 0=alle "normalen" Vertr„ge
 '                    1=Vertr„ge mit Bezug auf Ablaufdatum
 '                    2=Vertr„ge ohne Abschluá
 '                    3=Fremdvertr„ge
 '                    4=Fremdvertr„ge mit Bezug auf Ablaufdatum
 '                    5=Altvertr„ge
 ' dask% 0=ohne Abfrage ausfhren, 1=Optionen editierbar
 
ÿÿVertrUniRep(ku%,ma%,spa%,ge%,so%,von%,bis%,bart%,dask%)
 ÿƒDFile(2,"OFFICE\adressen"ÿ_fpw$)
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"kvertrag"ÿ_fpw$)
 doit%ÿ1
 incAltV$ÿ"n"
 incFremd$ÿ"n"
 incAntr$ÿ"n"
 ÿ¡dask%ÿ1ÿp
ÿ¡so%ÿ0ÿpso%ÿ1
ok%ÿÿ1
ÿØok%
ÿ¡ku%ÿ0ÿp
vKunde$ÿ"alle"
ÿ^
ÿÉÿ¥ku%ÿ™"ADRESSEN"ÿ£CodeKU.ADRESSEN
vkunde$ÿNachname.ADRESSENÿ", "ÿVorname.ADRESSEN
ÿ’ÿ¡
ÿ¡ma%ÿ0ÿp
Agentur$ÿ"alle"
ÿ^
ÿÉÿ¥ma%ÿ™"MAADR"ÿ£CodeMA.MAADR
agentur$ÿNachname.MAADRÿ", "ÿÿ+(Vorname.MAADR,1)ÿ"."
ÿ’ÿ¡
ÿ¡spa%ÿ0ÿp
vSparte$ÿ"alle"
ÿ^
ÿÉÿ¥spa%ÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
vsparte$ÿSparte.SPARTEN
ÿ’ÿ¡
ÿ¡ge%ÿ0ÿp
Gesellschaft$ÿ"alle"
ÿ^
ÿÉÿ¥ge%ÿ™"GEADR"ÿ£CodeGE.GEADR
Gesellschaft$ÿGesellschaft.GEADR
ÿ½ ** Gesellschaft ausw„hlen
ÿ’ÿ¡
ÿÉÿæbart%'                                        ; šberschrift festlegen
ÿæ0
st$ÿ"Vertragsbersicht"
ÿæ1
st$ÿ"Ablauf von Vertr„gen"
ÿæ2
st$ÿ"Vertr„ge ohne Abschluá"
ÿæ3
st$ÿ"Fremdvertr„ge"
ÿæ4
st$ÿ"Ablauf von Fremdvertr„gen"
ÿæ5
st$ÿ"Altvertr„ge"
ÿ’ÿÉ
ÿ¾ÿñÿt

ÿ‰ÿñ"BVERTRAG",0,0,250,205,title$ÿ" - "ÿst$,"MS Sans Serif",8
ÿ|ÿñ"BVERTRAG",4,5,7,240,58,0,"Filter"
ÿ|ÿñ"BVERTRAG",5,10,19,34,10,0,"Kunde"
ÿ|ÿñ"BVERTRAG",5,57,19,167,10,0,vKunde$
ÿ|ÿñ"BVERTRAG",1,228,19,15,10,0,"...",2,1
ÿ|ÿñ"BVERTRAG",5,10,30,28,10,0,"Agentur"
ÿ|ÿñ"BVERTRAG",5,57,30,167,10,0,Agentur$
ÿ|ÿñ"BVERTRAG",1,228,30,15,10,0,"...",3,1
ÿ|ÿñ"BVERTRAG",5,10,41,43,10,0,"Gesellschaft"
ÿ|ÿñ"BVERTRAG",5,57,41,167,10,0,Gesellschaft$
ÿ|ÿñ"BVERTRAG",1,228,41,14,10,0,"...",4,1
ÿ|ÿñ"BVERTRAG",5,10,52,25,10,0,"Sparte"
ÿ|ÿñ"BVERTRAG",5,57,52,167,10,0,vSparte$
ÿ|ÿñ"BVERTRAG",1,228,52,14,10,0,"...",5,1
ÿ|ÿñ"BVERTRAG",4,5,67,163,61,0,"Zeitraum"
ÿ|ÿñ"BVERTRAG",5,9,76,155,16,0,"Bitte w„hlen Sie den Zeitraum aus, fr den Sie die Vertragsbersicht wnschen."
ÿ|ÿñ"BVERTRAG",5,9,93,155,16,0,"Sie k”nnen die Datumsfelder auch freilassen, um alle Vertr„ge anzeigen zu lassen."
ÿ|ÿñ"BVERTRAG",5,9,113,16,10,0,"von"
ÿ|ÿñ"BVERTRAG",6,28,112,41,11,0,0,von$,20
ÿ|ÿñ"BVERTRAG",5,80,113,13,10,0,"bis"
ÿ|ÿñ"BVERTRAG",6,96,112,41,11,0,0,bis$,20
ÿ|ÿñ"BVERTRAG",4,171,67,74,61,0,"Sortierreihenfolge"
ÿ|ÿñ"BVERTRAG",3,177,81,64,11,0,"Kunde",1,so%
ÿ|ÿñ"BVERTRAG",3,177,92,64,11,0,"Agentur",2,so%
ÿ|ÿñ"BVERTRAG",3,177,103,64,11,0,"Gesellschaft",3,so%
ÿ|ÿñ"BVERTRAG",3,177,114,65,11,0,"Sparte",4,so%
ÿ|ÿñ"BVERTRAG",4,5,131,240,45,0,"Optionen"
ÿ|ÿñ"BVERTRAG",2,10,141,148,11,0,"nur Fremdvertr„ge","j","n",incFremd$
ÿ|ÿñ"BVERTRAG",2,10,151,148,11,0,"Altvertr„ge in Liste einbeziehen","j","n",incAltV$
ÿ|ÿñ"BVERTRAG",2,10,161,148,11,0,"Antr„ge in Liste einbeziehen","j","n",incAntr$
 
ÿ|ÿñ"BVERTRAG",1,66,184,55,15,1,"&OK",1,1
ÿ|ÿñ"BVERTRAG",1,124,184,55,15,0,"&Abbrechen",0,0
ÿñ"BVERTRAG",dreq%
ÿÉÿædreq%
ÿæ1
doit%ÿ1
ok%ÿ0
ÿæ2
ku%ÿADRSuche%(ku%)
ÿæ3
ma%ÿGetCodeMA%(ma%)
ÿæ4
ge%ÿGetCodeGE%(ge%)
ÿæ5
spa%ÿGetCodeVA%(spa%)
ÿæ0
ok%ÿ0
doit%ÿ0
ÿ’ÿÉ
ÿ¾ÿñ"BVERTRAG"
ÿÙ
 ÿ’ÿ¡
 ÿ¡doit%ÿ1ÿp
ÿ¡dask%ÿ0ÿp
ÿ¡von%ÿ0ÿpvon$ÿÿ1(von%)ÿ^von$ÿ""
ÿ¡bis%ÿ0ÿpbis$ÿÿ1(bis%)ÿ^bis$ÿ""
ÿ’ÿ¡
ÿ¡DateOK%(von$)ÿp
ÿ¡DateOK%(bis$)ÿp
ÿ™"KVERTRAG"
ÿ½ -- Quelle fr Reportausgabe erzeugen --
ÿ¡ÿJ("VREPORT.SBP")ÿpÿ"VREPORT.SBP"
ÿ¡ÿ÷("VREPORT")ÿpÿ†ÿ÷"VREPORT"
ÿ´"VREPORT.SBP"ÿ›ÿ¶
ÿ{" SUB VReport()"
ÿ½ ? "   DEBUG ASK"
ÿ¡1ÿ2ÿp
	ÿ{"   REPORT USING "ÿÿ(34)ÿ"BVERTRAG"ÿÿ(34)
ÿ^
	ÿ{"   REPORT USING "ÿÿ(34)ÿ"BV"ÿÿ(34)
	ÿ{"   REPORT ON Bewertungssumme.KVERTRAG AS "ÿÿ(34)ÿ"BewSum%"ÿÿ(34)ÿ",ZW.KVERTRAG * Beitrag.KVERTRAG AS "ÿÿ(34)ÿ"BeitrSum%"ÿÿ(34)
	ÿ{"   AFTER REPORT 
	ÿ{"   SET REPORT PAGE "ÿÿ(34)ÿ"F_REPORT"ÿÿ(34)
	ÿ{"   OUTPUT REPORT PAGE"
	ÿ{"   END REPORT"
ÿ’ÿ¡
ÿ¡von$ÿ""ÿpv$ÿ"1.1.80"ÿ^v$ÿvon$
ÿ¡bis$ÿ""ÿpb$ÿ"31.12.2010"ÿ^b$ÿbis$
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿ"(bis "ÿbis$ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿ"(ab "ÿvon$ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿ"(vom "ÿvon$ÿ" bis "ÿbis$ÿ")"
ÿ¡von$ÿ""ÿbis$ÿ""ÿpHeader$ÿ"(Gesamtbersicht)"
ÿ{"   Ueberschr$="ÿÿ(34)ÿHeader$ÿÿ(34)
ÿ{"   HEADING"
ÿ{"   SET REPORT PAGE "ÿÿ(34)ÿ"H_PAGE"ÿÿ(34)
ÿ{"   OUTPUT REPORT PAGE"
ÿ{"   END HEADING"
ÿ{"   AFTER SELECT"
ÿ{"   SET REPORT PAGE "ÿÿ(34)ÿ"F_SELECT"ÿÿ(34)
ÿ{"   OUTPUT REPORT PAGE"
ÿ{"   END SELECT"
ÿ{"   SET QUERY ON"
ÿ{"   SET QUERY LOCK OFF"
ÿ{"   MOUSE OFF"
ÿ{"   ON ERROR GOTO ErrVREP"
ÿ{"   SELECT ;"
ÿ{"   WHERE ";
ÿ¡MNdisabled%("DATALOCK")ÿp
	ÿ{"   Sperre.ADRESSEN=0 OR Sperre.ADRESSEN="ÿÿH(ÿ(vcodema%,"999999"))ÿ" AND ";
	ÿ{"   Sperre.MAADR=0 OR Sperre.MAADR="ÿÿH(ÿ(vcodema%,"999999"))ÿ" AND "
ÿ’ÿ¡
ÿ{"   CodeKU.KVERTRAG = CodeKU.ADRESSEN AND CodeVA.KVERTRAG = CodeVA.SPARTEN AND CodeGE.KVERTRAG = CodeGE.GEADR AND CodeMA.KVERTRAG = CodeMA.MAADR AND"
ÿ{"   VTNext.KVERTRAG < 1";
filt$ÿ""
ÿ¡von$ÿ""ÿpfilt$ÿfilt$ÿ" AND VS_Beginn.KVERTRAG>=days("ÿÿ(34)ÿv$ÿÿ(34)ÿ")"
ÿ¡bis$ÿ""ÿpfilt$ÿfilt$ÿ" AND VS_Beginn<=days("ÿÿ(34)ÿb$ÿÿ(34)ÿ")"
ÿ¡ku%ÿ0ÿpfilt$ÿfilt$ÿ" AND CodeKU="ÿÿH(ÿ(ku%,"999999"))
ÿ¡ma%ÿ0ÿpfilt$ÿfilt$ÿ" AND CodeMA="ÿÿH(ÿ(ma%,"999999"))
ÿ¡ge%ÿ0ÿpfilt$ÿfilt$ÿ" AND CodeGE="ÿÿH(ÿ(ge%,"999999"))
ÿ¡spa%ÿ0ÿpfilt$ÿfilt$ÿ" AND CodeVA="ÿÿH(ÿ(spa%,"999999"))
ÿ¡incFremd$ÿ"j"ÿp
	filt$ÿfilt$ÿ" AND Fremdvertrag = "ÿÿ(34)ÿ"j"ÿÿ(34)
ÿ^
	ÿ¡incAltV$ÿ"j"ÿp
filt$ÿfilt$ÿ" AND Altvertrag <> "ÿÿ(34)ÿ"j"ÿÿ(34)
	ÿ’ÿ¡
	ÿ¡incAntr$ÿ"n"ÿp
filt$ÿfilt$ÿ" AND ProviAb > 0"
	ÿ’ÿ¡
ÿ’ÿ¡
ÿ{filt$
ÿÉÿæso%
ÿæ1
	ord$ÿ"Kunde$,sparte.Sparten,Gesellschaft.GEADR"
ÿæ2
	ord$ÿ"Nachname.MAADR,sparte.Sparten,Gesellschaft.GEADR"
ÿæ3
	ord$ÿ"Gesellschaft.GEADR,sparte.Sparten"
ÿæ4
	ord$ÿ"sparte.Sparten,Nachname.maadr"
ÿ’ÿÉ
ÿ{"   ORDER REPORT "ÿord$
ÿ{"   TO ASK"
ÿ{"ErrVREP:"
ÿ{"   IF test% = 1 THEN ON ERROR ELSE ON ERROR GOTO ErrorHandler"
ÿ{"   MOUSE ON"
ÿ{" END SUB"
ÿ†ÿ¶
ÿ¨"VREPORT.SBP",ÿ°
ÿƒVReport()
ÿ†ÿ÷"VREPORT"
ÿ^
ÿƒFehler("Datum (bis) im falschen Format!","Bitte geben Sie das Datum in der Form 'tt.mm.jj' ein.")
ÿ’ÿ¡
ÿ^
ÿƒFehler("Datum (von) im falschen Format!","Bitte geben Sie das Datum in der Form 'tt.mm.jj' ein.")
ÿ’ÿ¡
 ÿ’ÿ¡
 ÿßÿ³
 ÿ’ÿÿ

 
 ' universeller Reportgenerator fr Konditionslisten
 ' ======================================================================
 ' ma%   Agenturnummer (CodeMA) oder 0 fr alle
 ' sp%   Spartennummer (CodeVA) oder 0 fr alle
 ' ge%   Gesellschaftsnummer (CodeGE) oder 0 fr alle
 ' so%   Sortierung: 1=Mitarbeiter, 2=Gesellschaft, 3=Sparte
 ' dask% 0=ohne Abfrage ausfhren, 1=Optionen editierbar
 
 
ÿÿGekondUniRep(ma%,ge%,sp%,so%,dask%)
 cfile$ÿÿ™
 ÿƒDFile(3,"sparten"ÿ_fpw$)
 ÿƒDFile(3,"geadr"ÿ_fpw$)
 ÿƒDFile(3,"maadr"ÿ_fpw$)
 ÿƒDFile(3,"gekond"ÿ_fpw$)
 ok%ÿÿ1
 ÿ¡dask%ÿ1ÿp
ÿØok%
ÿ¡ma%ÿ0ÿp
Agentur$ÿ"alle"
ÿ^
ÿÉÿ¥ma%ÿ™"MAADR"ÿ£CodeMA.MAADR
Agentur$ÿNachname.MAADRÿ", "ÿVorname.MAADR
ÿ’ÿ¡
ÿ¡ge%ÿ0ÿp
Gesellschaft$ÿ"alle"
ÿ^
ÿÉÿ¥ge%ÿ™"GEADR"ÿ£CodeGE.GEADR
Gesellschaft$ÿGesellschaft.GEADR
ÿ’ÿ¡
ÿ¡sp%ÿ0ÿp
Sparte$ÿ"alle"
ÿ^
ÿÉÿ¥sp%ÿ™"SPARTEN"ÿ£CodeVA.SPARTEN
Sparte$ÿSparte.SPARTEN
ÿ’ÿ¡
ÿ¡so%ÿ0ÿpso%ÿ1
opt%ÿso%
ÿ‰ÿñ"BGEKOND",0,0,241,183,"Konditionsliste","MS Sans Serif",8
ÿ|ÿñ"BGEKOND",4,0,0,241,160,0,""
ÿ|ÿñ"BGEKOND",9,5,11,20,23,2
ÿ|ÿñ"BGEKOND",5,36,12,198,36,0,"Um den Inhalt der Konditionsliste auf bestimmte Gesellschaften oder Sparten einzuschr„nken, k”nnen Sie vor dem dem Start die gewnschte Gesellschaft und Sparte jetzt ausw„hlen."
ÿ|ÿñ"BGEKOND",4,36,49,200,47,0,""
ÿ|ÿñ"BGEKOND",5,39,57,45,10,0,"&Agentur:"
ÿ|ÿñ"BGEKOND",5,87,57,129,10,0,Agentur$
ÿ|ÿñ"BGEKOND",1,220,57,13,10,0,"...",2,1
ÿ|ÿñ"BGEKOND",5,39,69,45,10,0,"&Gesellschaft:"
ÿ|ÿñ"BGEKOND",5,87,69,129,10,0,Gesellschaft$
ÿ|ÿñ"BGEKOND",1,220,69,13,10,0,"...",3,1
ÿ|ÿñ"BGEKOND",5,39,81,44,10,0,"&Sparte:"
ÿ|ÿñ"BGEKOND",5,87,81,129,10,0,Sparte$
ÿ|ÿñ"BGEKOND",1,220,81,13,10,0,"...",4,1
ÿ|ÿñ"BGEKOND",4,36,95,200,57,0,""
ÿ|ÿñ"BGEKOND",5,39,102,38,11,0,"Sor&tierung:"
ÿ|ÿñ"BGEKOND",3,39,114,55,11,0,"Agentur",1,opt%
ÿ|ÿñ"BGEKOND",3,39,126,55,11,0,"Gesellschaft",2,opt%
ÿ|ÿñ"BGEKOND",3,39,138,55,11,0,"Sparte",3,opt%
ÿ|ÿñ"BGEKOND",1,56,164,55,15,1,"OK",1,1
ÿ|ÿñ"BGEKOND",1,113,164,55,15,0,"Abbrechen",0,0
ÿñ"BGEKOND",req%
ÿ¾ÿñ"BGEKOND"
ÿÉÿæreq%
ÿæ0
ok%ÿ0
ÿæ1
ok%ÿ2
ÿæ2
ma%ÿGetCodeMA%(ma%)
ÿæ3
ge%ÿGetCodeGE%(ge%)
ÿæ4
sp%ÿGetCodeVA%(sp%)
ÿ’ÿÉ
ÿÙ
 ÿ’ÿ¡
 ÿ¡ok%ÿ0ÿp
ÿßÿe
filt$ÿ"CodeVA.GEKOND = CodeVA.SPARTEN AND CodeGE.GEKOND = CodeGE.GEADR AND CodeMA.GEKOND = CodeMA.MAADR"
ÿ¡ma%ÿ0ÿpfilt$ÿfilt$ÿ" AND CodeMA.GEKOND="ÿÿH(ÿ(ma%,"999999"))
ÿ¡ge%ÿ0ÿpfilt$ÿfilt$ÿ" AND CodeGE.GEKOND="ÿÿH(ÿ(ge%,"999999"))
ÿ¡sp%ÿ0ÿpfilt$ÿfilt$ÿ" AND CodeVA.GEKOND="ÿÿH(ÿ(sp%,"999999"))
ÿÉÿæopt%
ÿæ1
ord$ÿ"Agent$,Gesellschaft.GEADR,Sparte.SPARTEN"
ÿæ2
ord$ÿ"Gesellschaft.GEADR,Sparte.SPARTEN,Agentur$"
ÿæ3
ord$ÿ"Sparte.SPARTEN,Gesellschaft.GEADR,Agentur$"
ÿ’ÿÉ
ÿÁÿs"BGEKOND"
ÿŸ
ÿÊÿÁÿí"H_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿŸ
ÿš1
ÿÊÿÁÿí"F_PAGE"
ÿ¶ÿÁÿí
ÿ’ÿš
ÿ}ÿÉ
ÿÊÿÁÿí"F_SELECT"
ÿ¶ÿÁÿí
ÿ’ÿÉ
ÿÊÿiÿe
ÿÊÿiÿáÿe
ÿ³ÿ_ÿwErrUniGEKOND
ÿ–"SELECT ; WHERE "ÿfilt$ÿ" ORDER REPORT "ÿord$ÿ" TO ASK"
ErrUniGEKOND: 
ÿ¡test%ÿ1ÿpÿ³ÿ_ÿ^ÿ³ÿ_ÿwErrorHandler 
 ÿ’ÿ¡
 ÿßÿ³
 ÿ™cfile$
 ÿÊÿË"Bereit"
 ÿ’ÿÿ
 

 ' Umsetzung ZW.KVERTRAG in Klartext
 ' ======================================================================

ÿÿZW2Str$(zw%)
 ZW2Str$ÿÿ¡(ZW%ÿ1,"j„hrlich",ÿ¡(ZW%ÿ2,"halbj„hrlich",ÿ¡(ZW%ÿ4,"viertelj„hrlich",ÿ¡(ZW%ÿ12,"monatlich",ÿ¡(ZW%ÿ0,"einmalig","FEHLER!")))))
 ÿ’ÿÿ
 

ÿÿZahlart2Str$(za%)
 Zahlart2Str$ÿÿ¡(ZA%ÿ1,"Bankeinzug",ÿ¡(ZA%ÿ2,"šberweisung",ÿ¡(ZA%ÿ3,"Dauerauftrag",ÿ¡(ZA%ÿ4,"Scheck","<keine Zuordnung>"))))
 ÿ’ÿÿ
 

